function c7(e,n){for(var o=0;o<n.length;o++){const c=n[o];if(typeof c!="string"&&!Array.isArray(c)){for(const p in c)if(p!=="default"&&!(p in e)){const y=Object.getOwnPropertyDescriptor(c,p);y&&Object.defineProperty(e,p,y.get?y:{enumerable:!0,get:()=>c[p]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))c(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const w of y.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&c(w)}).observe(document,{childList:!0,subtree:!0});function o(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(p){if(p.ep)return;p.ep=!0;const y=o(p);fetch(p.href,y)}})();var Sg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var PL={exports:{}},I1={},IL={exports:{}},Yr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_=Symbol.for("react.element"),u7=Symbol.for("react.portal"),h7=Symbol.for("react.fragment"),d7=Symbol.for("react.strict_mode"),f7=Symbol.for("react.profiler"),p7=Symbol.for("react.provider"),m7=Symbol.for("react.context"),g7=Symbol.for("react.forward_ref"),_7=Symbol.for("react.suspense"),y7=Symbol.for("react.memo"),v7=Symbol.for("react.lazy"),eR=Symbol.iterator;function x7(e){return e===null||typeof e!="object"?null:(e=eR&&e[eR]||e["@@iterator"],typeof e=="function"?e:null)}var zL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RL=Object.assign,DL={};function Ap(e,n,o){this.props=e,this.context=n,this.refs=DL,this.updater=o||zL}Ap.prototype.isReactComponent={};Ap.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Ap.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function LL(){}LL.prototype=Ap.prototype;function nM(e,n,o){this.props=e,this.context=n,this.refs=DL,this.updater=o||zL}var iM=nM.prototype=new LL;iM.constructor=nM;RL(iM,Ap.prototype);iM.isPureReactComponent=!0;var tR=Array.isArray,OL=Object.prototype.hasOwnProperty,oM={current:null},BL={key:!0,ref:!0,__self:!0,__source:!0};function FL(e,n,o){var c,p={},y=null,w=null;if(n!=null)for(c in n.ref!==void 0&&(w=n.ref),n.key!==void 0&&(y=""+n.key),n)OL.call(n,c)&&!BL.hasOwnProperty(c)&&(p[c]=n[c]);var E=arguments.length-2;if(E===1)p.children=o;else if(1<E){for(var a=Array(E),P=0;P<E;P++)a[P]=arguments[P+2];p.children=a}if(e&&e.defaultProps)for(c in E=e.defaultProps,E)p[c]===void 0&&(p[c]=E[c]);return{$$typeof:G_,type:e,key:y,ref:w,props:p,_owner:oM.current}}function b7(e,n){return{$$typeof:G_,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function sM(e){return typeof e=="object"&&e!==null&&e.$$typeof===G_}function w7(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return n[o]})}var rR=/\/+/g;function GS(e,n){return typeof e=="object"&&e!==null&&e.key!=null?w7(""+e.key):n.toString(36)}function Vv(e,n,o,c,p){var y=typeof e;(y==="undefined"||y==="boolean")&&(e=null);var w=!1;if(e===null)w=!0;else switch(y){case"string":case"number":w=!0;break;case"object":switch(e.$$typeof){case G_:case u7:w=!0}}if(w)return w=e,p=p(w),e=c===""?"."+GS(w,0):c,tR(p)?(o="",e!=null&&(o=e.replace(rR,"$&/")+"/"),Vv(p,n,o,"",function(P){return P})):p!=null&&(sM(p)&&(p=b7(p,o+(!p.key||w&&w.key===p.key?"":(""+p.key).replace(rR,"$&/")+"/")+e)),n.push(p)),1;if(w=0,c=c===""?".":c+":",tR(e))for(var E=0;E<e.length;E++){y=e[E];var a=c+GS(y,E);w+=Vv(y,n,o,a,p)}else if(a=x7(e),typeof a=="function")for(e=a.call(e),E=0;!(y=e.next()).done;)y=y.value,a=c+GS(y,E++),w+=Vv(y,n,o,a,p);else if(y==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return w}function tv(e,n,o){if(e==null)return e;var c=[],p=0;return Vv(e,c,"","",function(y){return n.call(o,y,p++)}),c}function S7(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Fo={current:null},$v={transition:null},T7={ReactCurrentDispatcher:Fo,ReactCurrentBatchConfig:$v,ReactCurrentOwner:oM};Yr.Children={map:tv,forEach:function(e,n,o){tv(e,function(){n.apply(this,arguments)},o)},count:function(e){var n=0;return tv(e,function(){n++}),n},toArray:function(e){return tv(e,function(n){return n})||[]},only:function(e){if(!sM(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Yr.Component=Ap;Yr.Fragment=h7;Yr.Profiler=f7;Yr.PureComponent=nM;Yr.StrictMode=d7;Yr.Suspense=_7;Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T7;Yr.cloneElement=function(e,n,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var c=RL({},e.props),p=e.key,y=e.ref,w=e._owner;if(n!=null){if(n.ref!==void 0&&(y=n.ref,w=oM.current),n.key!==void 0&&(p=""+n.key),e.type&&e.type.defaultProps)var E=e.type.defaultProps;for(a in n)OL.call(n,a)&&!BL.hasOwnProperty(a)&&(c[a]=n[a]===void 0&&E!==void 0?E[a]:n[a])}var a=arguments.length-2;if(a===1)c.children=o;else if(1<a){E=Array(a);for(var P=0;P<a;P++)E[P]=arguments[P+2];c.children=E}return{$$typeof:G_,type:e.type,key:p,ref:y,props:c,_owner:w}};Yr.createContext=function(e){return e={$$typeof:m7,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:p7,_context:e},e.Consumer=e};Yr.createElement=FL;Yr.createFactory=function(e){var n=FL.bind(null,e);return n.type=e,n};Yr.createRef=function(){return{current:null}};Yr.forwardRef=function(e){return{$$typeof:g7,render:e}};Yr.isValidElement=sM;Yr.lazy=function(e){return{$$typeof:v7,_payload:{_status:-1,_result:e},_init:S7}};Yr.memo=function(e,n){return{$$typeof:y7,type:e,compare:n===void 0?null:n}};Yr.startTransition=function(e){var n=$v.transition;$v.transition={};try{e()}finally{$v.transition=n}};Yr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Yr.useCallback=function(e,n){return Fo.current.useCallback(e,n)};Yr.useContext=function(e){return Fo.current.useContext(e)};Yr.useDebugValue=function(){};Yr.useDeferredValue=function(e){return Fo.current.useDeferredValue(e)};Yr.useEffect=function(e,n){return Fo.current.useEffect(e,n)};Yr.useId=function(){return Fo.current.useId()};Yr.useImperativeHandle=function(e,n,o){return Fo.current.useImperativeHandle(e,n,o)};Yr.useInsertionEffect=function(e,n){return Fo.current.useInsertionEffect(e,n)};Yr.useLayoutEffect=function(e,n){return Fo.current.useLayoutEffect(e,n)};Yr.useMemo=function(e,n){return Fo.current.useMemo(e,n)};Yr.useReducer=function(e,n,o){return Fo.current.useReducer(e,n,o)};Yr.useRef=function(e){return Fo.current.useRef(e)};Yr.useState=function(e){return Fo.current.useState(e)};Yr.useSyncExternalStore=function(e,n,o){return Fo.current.useSyncExternalStore(e,n,o)};Yr.useTransition=function(){return Fo.current.useTransition()};Yr.version="18.2.0";IL.exports=Yr;var re=IL.exports;const Cs=P1(re),uE=c7({__proto__:null,default:Cs},[re]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E7=re,C7=Symbol.for("react.element"),M7=Symbol.for("react.fragment"),A7=Object.prototype.hasOwnProperty,k7=E7.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P7={key:!0,ref:!0,__self:!0,__source:!0};function NL(e,n,o){var c,p={},y=null,w=null;o!==void 0&&(y=""+o),n.key!==void 0&&(y=""+n.key),n.ref!==void 0&&(w=n.ref);for(c in n)A7.call(n,c)&&!P7.hasOwnProperty(c)&&(p[c]=n[c]);if(e&&e.defaultProps)for(c in n=e.defaultProps,n)p[c]===void 0&&(p[c]=n[c]);return{$$typeof:C7,type:e,key:y,ref:w,props:p,_owner:k7.current}}I1.Fragment=M7;I1.jsx=NL;I1.jsxs=NL;PL.exports=I1;var Q=PL.exports,jL={exports:{}},Ds={},VL={exports:{}},$L={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(Ot,ct){var Jt=Ot.length;Ot.push(ct);e:for(;0<Jt;){var qt=Jt-1>>>1,_r=Ot[qt];if(0<p(_r,ct))Ot[qt]=ct,Ot[Jt]=_r,Jt=qt;else break e}}function o(Ot){return Ot.length===0?null:Ot[0]}function c(Ot){if(Ot.length===0)return null;var ct=Ot[0],Jt=Ot.pop();if(Jt!==ct){Ot[0]=Jt;e:for(var qt=0,_r=Ot.length,wr=_r>>>1;qt<wr;){var Lr=2*(qt+1)-1,wi=Ot[Lr],sn=Lr+1,Xn=Ot[sn];if(0>p(wi,Jt))sn<_r&&0>p(Xn,wi)?(Ot[qt]=Xn,Ot[sn]=Jt,qt=sn):(Ot[qt]=wi,Ot[Lr]=Jt,qt=Lr);else if(sn<_r&&0>p(Xn,Jt))Ot[qt]=Xn,Ot[sn]=Jt,qt=sn;else break e}}return ct}function p(Ot,ct){var Jt=Ot.sortIndex-ct.sortIndex;return Jt!==0?Jt:Ot.id-ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var w=Date,E=w.now();e.unstable_now=function(){return w.now()-E}}var a=[],P=[],D=1,L=null,F=3,$=!1,H=!1,q=!1,le=typeof setTimeout=="function"?setTimeout:null,ie=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(Ot){for(var ct=o(P);ct!==null;){if(ct.callback===null)c(P);else if(ct.startTime<=Ot)c(P),ct.sortIndex=ct.expirationTime,n(a,ct);else break;ct=o(P)}}function be(Ot){if(q=!1,se(Ot),!H)if(o(a)!==null)H=!0,Mr(Ee);else{var ct=o(P);ct!==null&&xn(be,ct.startTime-Ot)}}function Ee(Ot,ct){H=!1,q&&(q=!1,ie(Ze),Ze=-1),$=!0;var Jt=F;try{for(se(ct),L=o(a);L!==null&&(!(L.expirationTime>ct)||Ot&&!Et());){var qt=L.callback;if(typeof qt=="function"){L.callback=null,F=L.priorityLevel;var _r=qt(L.expirationTime<=ct);ct=e.unstable_now(),typeof _r=="function"?L.callback=_r:L===o(a)&&c(a),se(ct)}else c(a);L=o(a)}if(L!==null)var wr=!0;else{var Lr=o(P);Lr!==null&&xn(be,Lr.startTime-ct),wr=!1}return wr}finally{L=null,F=Jt,$=!1}}var je=!1,Be=null,Ze=-1,ht=5,Pe=-1;function Et(){return!(e.unstable_now()-Pe<ht)}function or(){if(Be!==null){var Ot=e.unstable_now();Pe=Ot;var ct=!0;try{ct=Be(!0,Ot)}finally{ct?st():(je=!1,Be=null)}}else je=!1}var st;if(typeof te=="function")st=function(){te(or)};else if(typeof MessageChannel<"u"){var ar=new MessageChannel,Bn=ar.port2;ar.port1.onmessage=or,st=function(){Bn.postMessage(null)}}else st=function(){le(or,0)};function Mr(Ot){Be=Ot,je||(je=!0,st())}function xn(Ot,ct){Ze=le(function(){Ot(e.unstable_now())},ct)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ot){Ot.callback=null},e.unstable_continueExecution=function(){H||$||(H=!0,Mr(Ee))},e.unstable_forceFrameRate=function(Ot){0>Ot||125<Ot?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ht=0<Ot?Math.floor(1e3/Ot):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return o(a)},e.unstable_next=function(Ot){switch(F){case 1:case 2:case 3:var ct=3;break;default:ct=F}var Jt=F;F=ct;try{return Ot()}finally{F=Jt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ot,ct){switch(Ot){case 1:case 2:case 3:case 4:case 5:break;default:Ot=3}var Jt=F;F=Ot;try{return ct()}finally{F=Jt}},e.unstable_scheduleCallback=function(Ot,ct,Jt){var qt=e.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?qt+Jt:qt):Jt=qt,Ot){case 1:var _r=-1;break;case 2:_r=250;break;case 5:_r=1073741823;break;case 4:_r=1e4;break;default:_r=5e3}return _r=Jt+_r,Ot={id:D++,callback:ct,priorityLevel:Ot,startTime:Jt,expirationTime:_r,sortIndex:-1},Jt>qt?(Ot.sortIndex=Jt,n(P,Ot),o(a)===null&&Ot===o(P)&&(q?(ie(Ze),Ze=-1):q=!0,xn(be,Jt-qt))):(Ot.sortIndex=_r,n(a,Ot),H||$||(H=!0,Mr(Ee))),Ot},e.unstable_shouldYield=Et,e.unstable_wrapCallback=function(Ot){var ct=F;return function(){var Jt=F;F=ct;try{return Ot.apply(this,arguments)}finally{F=Jt}}}})($L);VL.exports=$L;var I7=VL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UL=re,Is=I7;function It(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GL=new Set,a_={};function hd(e,n){dp(e,n),dp(e+"Capture",n)}function dp(e,n){for(a_[e]=n,e=0;e<n.length;e++)GL.add(n[e])}var Cc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hE=Object.prototype.hasOwnProperty,z7=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nR={},iR={};function R7(e){return hE.call(iR,e)?!0:hE.call(nR,e)?!1:z7.test(e)?iR[e]=!0:(nR[e]=!0,!1)}function D7(e,n,o,c){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return c?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function L7(e,n,o,c){if(n===null||typeof n>"u"||D7(e,n,o,c))return!0;if(c)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function No(e,n,o,c,p,y,w){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=c,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=e,this.type=n,this.sanitizeURL=y,this.removeEmptyString=w}var lo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lo[e]=new No(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];lo[n]=new No(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lo[e]=new No(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lo[e]=new No(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lo[e]=new No(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lo[e]=new No(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lo[e]=new No(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lo[e]=new No(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lo[e]=new No(e,5,!1,e.toLowerCase(),null,!1,!1)});var aM=/[\-:]([a-z])/g;function lM(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(aM,lM);lo[n]=new No(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(aM,lM);lo[n]=new No(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(aM,lM);lo[n]=new No(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lo[e]=new No(e,1,!1,e.toLowerCase(),null,!1,!1)});lo.xlinkHref=new No("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lo[e]=new No(e,1,!1,e.toLowerCase(),null,!0,!0)});function cM(e,n,o,c){var p=lo.hasOwnProperty(n)?lo[n]:null;(p!==null?p.type!==0:c||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(L7(n,o,p,c)&&(o=null),c||p===null?R7(n)&&(o===null?e.removeAttribute(n):e.setAttribute(n,""+o)):p.mustUseProperty?e[p.propertyName]=o===null?p.type===3?!1:"":o:(n=p.attributeName,c=p.attributeNamespace,o===null?e.removeAttribute(n):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,c?e.setAttributeNS(c,n,o):e.setAttribute(n,o))))}var Dc=UL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rv=Symbol.for("react.element"),Cf=Symbol.for("react.portal"),Mf=Symbol.for("react.fragment"),uM=Symbol.for("react.strict_mode"),dE=Symbol.for("react.profiler"),WL=Symbol.for("react.provider"),qL=Symbol.for("react.context"),hM=Symbol.for("react.forward_ref"),fE=Symbol.for("react.suspense"),pE=Symbol.for("react.suspense_list"),dM=Symbol.for("react.memo"),gu=Symbol.for("react.lazy"),HL=Symbol.for("react.offscreen"),oR=Symbol.iterator;function ag(e){return e===null||typeof e!="object"?null:(e=oR&&e[oR]||e["@@iterator"],typeof e=="function"?e:null)}var ii=Object.assign,WS;function Tg(e){if(WS===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);WS=n&&n[1]||""}return`
`+WS+e}var qS=!1;function HS(e,n){if(!e||qS)return"";qS=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(P){var c=P}Reflect.construct(e,[],n)}else{try{n.call()}catch(P){c=P}e.call(n.prototype)}else{try{throw Error()}catch(P){c=P}e()}}catch(P){if(P&&c&&typeof P.stack=="string"){for(var p=P.stack.split(`
`),y=c.stack.split(`
`),w=p.length-1,E=y.length-1;1<=w&&0<=E&&p[w]!==y[E];)E--;for(;1<=w&&0<=E;w--,E--)if(p[w]!==y[E]){if(w!==1||E!==1)do if(w--,E--,0>E||p[w]!==y[E]){var a=`
`+p[w].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=w&&0<=E);break}}}finally{qS=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?Tg(e):""}function O7(e){switch(e.tag){case 5:return Tg(e.type);case 16:return Tg("Lazy");case 13:return Tg("Suspense");case 19:return Tg("SuspenseList");case 0:case 2:case 15:return e=HS(e.type,!1),e;case 11:return e=HS(e.type.render,!1),e;case 1:return e=HS(e.type,!0),e;default:return""}}function mE(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mf:return"Fragment";case Cf:return"Portal";case dE:return"Profiler";case uM:return"StrictMode";case fE:return"Suspense";case pE:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qL:return(e.displayName||"Context")+".Consumer";case WL:return(e._context.displayName||"Context")+".Provider";case hM:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case dM:return n=e.displayName||null,n!==null?n:mE(e.type)||"Memo";case gu:n=e._payload,e=e._init;try{return mE(e(n))}catch{}}return null}function B7(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mE(n);case 8:return n===uM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Lu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ZL(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function F7(e){var n=ZL(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),c=""+e[n];if(!e.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return p.call(this)},set:function(w){c=""+w,y.call(this,w)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function nv(e){e._valueTracker||(e._valueTracker=F7(e))}function XL(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var o=n.getValue(),c="";return e&&(c=ZL(e)?e.checked?"true":"false":e.value),e=c,e!==o?(n.setValue(e),!0):!1}function Tx(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gE(e,n){var o=n.checked;return ii({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function sR(e,n){var o=n.defaultValue==null?"":n.defaultValue,c=n.checked!=null?n.checked:n.defaultChecked;o=Lu(n.value!=null?n.value:o),e._wrapperState={initialChecked:c,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function YL(e,n){n=n.checked,n!=null&&cM(e,"checked",n,!1)}function _E(e,n){YL(e,n);var o=Lu(n.value),c=n.type;if(o!=null)c==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?yE(e,n.type,o):n.hasOwnProperty("defaultValue")&&yE(e,n.type,Lu(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function aR(e,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var c=n.type;if(!(c!=="submit"&&c!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,o||n===e.value||(e.value=n),e.defaultValue=n}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function yE(e,n,o){(n!=="number"||Tx(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var Eg=Array.isArray;function Kf(e,n,o,c){if(e=e.options,n){n={};for(var p=0;p<o.length;p++)n["$"+o[p]]=!0;for(o=0;o<e.length;o++)p=n.hasOwnProperty("$"+e[o].value),e[o].selected!==p&&(e[o].selected=p),p&&c&&(e[o].defaultSelected=!0)}else{for(o=""+Lu(o),n=null,p=0;p<e.length;p++){if(e[p].value===o){e[p].selected=!0,c&&(e[p].defaultSelected=!0);return}n!==null||e[p].disabled||(n=e[p])}n!==null&&(n.selected=!0)}}function vE(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(It(91));return ii({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function lR(e,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(It(92));if(Eg(o)){if(1<o.length)throw Error(It(93));o=o[0]}n=o}n==null&&(n=""),o=n}e._wrapperState={initialValue:Lu(o)}}function KL(e,n){var o=Lu(n.value),c=Lu(n.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),n.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),c!=null&&(e.defaultValue=""+c)}function cR(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function JL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xE(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?JL(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var iv,QL=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,c,p){MSApp.execUnsafeLocalFunction(function(){return e(n,o,c,p)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(iv=iv||document.createElement("div"),iv.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=iv.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function l_(e,n){if(n){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=n;return}}e.textContent=n}var Vg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N7=["Webkit","ms","Moz","O"];Object.keys(Vg).forEach(function(e){N7.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Vg[n]=Vg[e]})});function eO(e,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||Vg.hasOwnProperty(e)&&Vg[e]?(""+n).trim():n+"px"}function tO(e,n){e=e.style;for(var o in n)if(n.hasOwnProperty(o)){var c=o.indexOf("--")===0,p=eO(o,n[o],c);o==="float"&&(o="cssFloat"),c?e.setProperty(o,p):e[o]=p}}var j7=ii({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bE(e,n){if(n){if(j7[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(It(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(It(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(It(61))}if(n.style!=null&&typeof n.style!="object")throw Error(It(62))}}function wE(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var SE=null;function fM(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var TE=null,Jf=null,Qf=null;function uR(e){if(e=H_(e)){if(typeof TE!="function")throw Error(It(280));var n=e.stateNode;n&&(n=O1(n),TE(e.stateNode,e.type,n))}}function rO(e){Jf?Qf?Qf.push(e):Qf=[e]:Jf=e}function nO(){if(Jf){var e=Jf,n=Qf;if(Qf=Jf=null,uR(e),n)for(e=0;e<n.length;e++)uR(n[e])}}function iO(e,n){return e(n)}function oO(){}var ZS=!1;function sO(e,n,o){if(ZS)return e(n,o);ZS=!0;try{return iO(e,n,o)}finally{ZS=!1,(Jf!==null||Qf!==null)&&(oO(),nO())}}function c_(e,n){var o=e.stateNode;if(o===null)return null;var c=O1(o);if(c===null)return null;o=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(It(231,n,typeof o));return o}var EE=!1;if(Cc)try{var lg={};Object.defineProperty(lg,"passive",{get:function(){EE=!0}}),window.addEventListener("test",lg,lg),window.removeEventListener("test",lg,lg)}catch{EE=!1}function V7(e,n,o,c,p,y,w,E,a){var P=Array.prototype.slice.call(arguments,3);try{n.apply(o,P)}catch(D){this.onError(D)}}var $g=!1,Ex=null,Cx=!1,CE=null,$7={onError:function(e){$g=!0,Ex=e}};function U7(e,n,o,c,p,y,w,E,a){$g=!1,Ex=null,V7.apply($7,arguments)}function G7(e,n,o,c,p,y,w,E,a){if(U7.apply(this,arguments),$g){if($g){var P=Ex;$g=!1,Ex=null}else throw Error(It(198));Cx||(Cx=!0,CE=P)}}function dd(e){var n=e,o=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(o=n.return),e=n.return;while(e)}return n.tag===3?o:null}function aO(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function hR(e){if(dd(e)!==e)throw Error(It(188))}function W7(e){var n=e.alternate;if(!n){if(n=dd(e),n===null)throw Error(It(188));return n!==e?null:e}for(var o=e,c=n;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){o=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return hR(p),e;if(y===c)return hR(p),n;y=y.sibling}throw Error(It(188))}if(o.return!==c.return)o=p,c=y;else{for(var w=!1,E=p.child;E;){if(E===o){w=!0,o=p,c=y;break}if(E===c){w=!0,c=p,o=y;break}E=E.sibling}if(!w){for(E=y.child;E;){if(E===o){w=!0,o=y,c=p;break}if(E===c){w=!0,c=y,o=p;break}E=E.sibling}if(!w)throw Error(It(189))}}if(o.alternate!==c)throw Error(It(190))}if(o.tag!==3)throw Error(It(188));return o.stateNode.current===o?e:n}function lO(e){return e=W7(e),e!==null?cO(e):null}function cO(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=cO(e);if(n!==null)return n;e=e.sibling}return null}var uO=Is.unstable_scheduleCallback,dR=Is.unstable_cancelCallback,q7=Is.unstable_shouldYield,H7=Is.unstable_requestPaint,xi=Is.unstable_now,Z7=Is.unstable_getCurrentPriorityLevel,pM=Is.unstable_ImmediatePriority,hO=Is.unstable_UserBlockingPriority,Mx=Is.unstable_NormalPriority,X7=Is.unstable_LowPriority,dO=Is.unstable_IdlePriority,z1=null,Cl=null;function Y7(e){if(Cl&&typeof Cl.onCommitFiberRoot=="function")try{Cl.onCommitFiberRoot(z1,e,void 0,(e.current.flags&128)===128)}catch{}}var Oa=Math.clz32?Math.clz32:Q7,K7=Math.log,J7=Math.LN2;function Q7(e){return e>>>=0,e===0?32:31-(K7(e)/J7|0)|0}var ov=64,sv=4194304;function Cg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ax(e,n){var o=e.pendingLanes;if(o===0)return 0;var c=0,p=e.suspendedLanes,y=e.pingedLanes,w=o&268435455;if(w!==0){var E=w&~p;E!==0?c=Cg(E):(y&=w,y!==0&&(c=Cg(y)))}else w=o&~p,w!==0?c=Cg(w):y!==0&&(c=Cg(y));if(c===0)return 0;if(n!==0&&n!==c&&!(n&p)&&(p=c&-c,y=n&-n,p>=y||p===16&&(y&4194240)!==0))return n;if(c&4&&(c|=o&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=c;0<n;)o=31-Oa(n),p=1<<o,c|=e[o],n&=~p;return c}function e9(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function t9(e,n){for(var o=e.suspendedLanes,c=e.pingedLanes,p=e.expirationTimes,y=e.pendingLanes;0<y;){var w=31-Oa(y),E=1<<w,a=p[w];a===-1?(!(E&o)||E&c)&&(p[w]=e9(E,n)):a<=n&&(e.expiredLanes|=E),y&=~E}}function ME(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fO(){var e=ov;return ov<<=1,!(ov&4194240)&&(ov=64),e}function XS(e){for(var n=[],o=0;31>o;o++)n.push(e);return n}function W_(e,n,o){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Oa(n),e[n]=o}function r9(e,n){var o=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<o;){var p=31-Oa(o),y=1<<p;n[p]=0,c[p]=-1,e[p]=-1,o&=~y}}function mM(e,n){var o=e.entangledLanes|=n;for(e=e.entanglements;o;){var c=31-Oa(o),p=1<<c;p&n|e[c]&n&&(e[c]|=n),o&=~p}}var Mn=0;function pO(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mO,gM,gO,_O,yO,AE=!1,av=[],Cu=null,Mu=null,Au=null,u_=new Map,h_=new Map,vu=[],n9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fR(e,n){switch(e){case"focusin":case"focusout":Cu=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":Au=null;break;case"pointerover":case"pointerout":u_.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":h_.delete(n.pointerId)}}function cg(e,n,o,c,p,y){return e===null||e.nativeEvent!==y?(e={blockedOn:n,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},n!==null&&(n=H_(n),n!==null&&gM(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,p!==null&&n.indexOf(p)===-1&&n.push(p),e)}function i9(e,n,o,c,p){switch(n){case"focusin":return Cu=cg(Cu,e,n,o,c,p),!0;case"dragenter":return Mu=cg(Mu,e,n,o,c,p),!0;case"mouseover":return Au=cg(Au,e,n,o,c,p),!0;case"pointerover":var y=p.pointerId;return u_.set(y,cg(u_.get(y)||null,e,n,o,c,p)),!0;case"gotpointercapture":return y=p.pointerId,h_.set(y,cg(h_.get(y)||null,e,n,o,c,p)),!0}return!1}function vO(e){var n=Fh(e.target);if(n!==null){var o=dd(n);if(o!==null){if(n=o.tag,n===13){if(n=aO(o),n!==null){e.blockedOn=n,yO(e.priority,function(){gO(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Uv(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var o=kE(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var c=new o.constructor(o.type,o);SE=c,o.target.dispatchEvent(c),SE=null}else return n=H_(o),n!==null&&gM(n),e.blockedOn=o,!1;n.shift()}return!0}function pR(e,n,o){Uv(e)&&o.delete(n)}function o9(){AE=!1,Cu!==null&&Uv(Cu)&&(Cu=null),Mu!==null&&Uv(Mu)&&(Mu=null),Au!==null&&Uv(Au)&&(Au=null),u_.forEach(pR),h_.forEach(pR)}function ug(e,n){e.blockedOn===n&&(e.blockedOn=null,AE||(AE=!0,Is.unstable_scheduleCallback(Is.unstable_NormalPriority,o9)))}function d_(e){function n(p){return ug(p,e)}if(0<av.length){ug(av[0],e);for(var o=1;o<av.length;o++){var c=av[o];c.blockedOn===e&&(c.blockedOn=null)}}for(Cu!==null&&ug(Cu,e),Mu!==null&&ug(Mu,e),Au!==null&&ug(Au,e),u_.forEach(n),h_.forEach(n),o=0;o<vu.length;o++)c=vu[o],c.blockedOn===e&&(c.blockedOn=null);for(;0<vu.length&&(o=vu[0],o.blockedOn===null);)vO(o),o.blockedOn===null&&vu.shift()}var ep=Dc.ReactCurrentBatchConfig,kx=!0;function s9(e,n,o,c){var p=Mn,y=ep.transition;ep.transition=null;try{Mn=1,_M(e,n,o,c)}finally{Mn=p,ep.transition=y}}function a9(e,n,o,c){var p=Mn,y=ep.transition;ep.transition=null;try{Mn=4,_M(e,n,o,c)}finally{Mn=p,ep.transition=y}}function _M(e,n,o,c){if(kx){var p=kE(e,n,o,c);if(p===null)oT(e,n,c,Px,o),fR(e,c);else if(i9(p,e,n,o,c))c.stopPropagation();else if(fR(e,c),n&4&&-1<n9.indexOf(e)){for(;p!==null;){var y=H_(p);if(y!==null&&mO(y),y=kE(e,n,o,c),y===null&&oT(e,n,c,Px,o),y===p)break;p=y}p!==null&&c.stopPropagation()}else oT(e,n,c,null,o)}}var Px=null;function kE(e,n,o,c){if(Px=null,e=fM(c),e=Fh(e),e!==null)if(n=dd(e),n===null)e=null;else if(o=n.tag,o===13){if(e=aO(n),e!==null)return e;e=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Px=e,null}function xO(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z7()){case pM:return 1;case hO:return 4;case Mx:case X7:return 16;case dO:return 536870912;default:return 16}default:return 16}}var wu=null,yM=null,Gv=null;function bO(){if(Gv)return Gv;var e,n=yM,o=n.length,c,p="value"in wu?wu.value:wu.textContent,y=p.length;for(e=0;e<o&&n[e]===p[e];e++);var w=o-e;for(c=1;c<=w&&n[o-c]===p[y-c];c++);return Gv=p.slice(e,1<c?1-c:void 0)}function Wv(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function lv(){return!0}function mR(){return!1}function Ls(e){function n(o,c,p,y,w){this._reactName=o,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(o=e[E],this[E]=o?o(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?lv:mR,this.isPropagationStopped=mR,this}return ii(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=lv)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=lv)},persist:function(){},isPersistent:lv}),n}var kp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vM=Ls(kp),q_=ii({},kp,{view:0,detail:0}),l9=Ls(q_),YS,KS,hg,R1=ii({},q_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xM,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hg&&(hg&&e.type==="mousemove"?(YS=e.screenX-hg.screenX,KS=e.screenY-hg.screenY):KS=YS=0,hg=e),YS)},movementY:function(e){return"movementY"in e?e.movementY:KS}}),gR=Ls(R1),c9=ii({},R1,{dataTransfer:0}),u9=Ls(c9),h9=ii({},q_,{relatedTarget:0}),JS=Ls(h9),d9=ii({},kp,{animationName:0,elapsedTime:0,pseudoElement:0}),f9=Ls(d9),p9=ii({},kp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),m9=Ls(p9),g9=ii({},kp,{data:0}),_R=Ls(g9),_9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},y9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function x9(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=v9[e])?!!n[e]:!1}function xM(){return x9}var b9=ii({},q_,{key:function(e){if(e.key){var n=_9[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Wv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?y9[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xM,charCode:function(e){return e.type==="keypress"?Wv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),w9=Ls(b9),S9=ii({},R1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yR=Ls(S9),T9=ii({},q_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xM}),E9=Ls(T9),C9=ii({},kp,{propertyName:0,elapsedTime:0,pseudoElement:0}),M9=Ls(C9),A9=ii({},R1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),k9=Ls(A9),P9=[9,13,27,32],bM=Cc&&"CompositionEvent"in window,Ug=null;Cc&&"documentMode"in document&&(Ug=document.documentMode);var I9=Cc&&"TextEvent"in window&&!Ug,wO=Cc&&(!bM||Ug&&8<Ug&&11>=Ug),vR=" ",xR=!1;function SO(e,n){switch(e){case"keyup":return P9.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Af=!1;function z9(e,n){switch(e){case"compositionend":return TO(n);case"keypress":return n.which!==32?null:(xR=!0,vR);case"textInput":return e=n.data,e===vR&&xR?null:e;default:return null}}function R9(e,n){if(Af)return e==="compositionend"||!bM&&SO(e,n)?(e=bO(),Gv=yM=wu=null,Af=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return wO&&n.locale!=="ko"?null:n.data;default:return null}}var D9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bR(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!D9[e.type]:n==="textarea"}function EO(e,n,o,c){rO(c),n=Ix(n,"onChange"),0<n.length&&(o=new vM("onChange","change",null,o,c),e.push({event:o,listeners:n}))}var Gg=null,f_=null;function L9(e){OO(e,0)}function D1(e){var n=If(e);if(XL(n))return e}function O9(e,n){if(e==="change")return n}var CO=!1;if(Cc){var QS;if(Cc){var eT="oninput"in document;if(!eT){var wR=document.createElement("div");wR.setAttribute("oninput","return;"),eT=typeof wR.oninput=="function"}QS=eT}else QS=!1;CO=QS&&(!document.documentMode||9<document.documentMode)}function SR(){Gg&&(Gg.detachEvent("onpropertychange",MO),f_=Gg=null)}function MO(e){if(e.propertyName==="value"&&D1(f_)){var n=[];EO(n,f_,e,fM(e)),sO(L9,n)}}function B9(e,n,o){e==="focusin"?(SR(),Gg=n,f_=o,Gg.attachEvent("onpropertychange",MO)):e==="focusout"&&SR()}function F9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return D1(f_)}function N9(e,n){if(e==="click")return D1(n)}function j9(e,n){if(e==="input"||e==="change")return D1(n)}function V9(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Fa=typeof Object.is=="function"?Object.is:V9;function p_(e,n){if(Fa(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var o=Object.keys(e),c=Object.keys(n);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var p=o[c];if(!hE.call(n,p)||!Fa(e[p],n[p]))return!1}return!0}function TR(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ER(e,n){var o=TR(e);e=0;for(var c;o;){if(o.nodeType===3){if(c=e+o.textContent.length,e<=n&&c>=n)return{node:o,offset:n-e};e=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=TR(o)}}function AO(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?AO(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function kO(){for(var e=window,n=Tx();n instanceof e.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)e=n.contentWindow;else break;n=Tx(e.document)}return n}function wM(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function $9(e){var n=kO(),o=e.focusedElem,c=e.selectionRange;if(n!==o&&o&&o.ownerDocument&&AO(o.ownerDocument.documentElement,o)){if(c!==null&&wM(o)){if(n=c.start,e=c.end,e===void 0&&(e=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(e,o.value.length);else if(e=(n=o.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var p=o.textContent.length,y=Math.min(c.start,p);c=c.end===void 0?y:Math.min(c.end,p),!e.extend&&y>c&&(p=c,c=y,y=p),p=ER(o,y);var w=ER(o,c);p&&w&&(e.rangeCount!==1||e.anchorNode!==p.node||e.anchorOffset!==p.offset||e.focusNode!==w.node||e.focusOffset!==w.offset)&&(n=n.createRange(),n.setStart(p.node,p.offset),e.removeAllRanges(),y>c?(e.addRange(n),e.extend(w.node,w.offset)):(n.setEnd(w.node,w.offset),e.addRange(n)))}}for(n=[],e=o;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)e=n[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var U9=Cc&&"documentMode"in document&&11>=document.documentMode,kf=null,PE=null,Wg=null,IE=!1;function CR(e,n,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;IE||kf==null||kf!==Tx(c)||(c=kf,"selectionStart"in c&&wM(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Wg&&p_(Wg,c)||(Wg=c,c=Ix(PE,"onSelect"),0<c.length&&(n=new vM("onSelect","select",null,n,o),e.push({event:n,listeners:c}),n.target=kf)))}function cv(e,n){var o={};return o[e.toLowerCase()]=n.toLowerCase(),o["Webkit"+e]="webkit"+n,o["Moz"+e]="moz"+n,o}var Pf={animationend:cv("Animation","AnimationEnd"),animationiteration:cv("Animation","AnimationIteration"),animationstart:cv("Animation","AnimationStart"),transitionend:cv("Transition","TransitionEnd")},tT={},PO={};Cc&&(PO=document.createElement("div").style,"AnimationEvent"in window||(delete Pf.animationend.animation,delete Pf.animationiteration.animation,delete Pf.animationstart.animation),"TransitionEvent"in window||delete Pf.transitionend.transition);function L1(e){if(tT[e])return tT[e];if(!Pf[e])return e;var n=Pf[e],o;for(o in n)if(n.hasOwnProperty(o)&&o in PO)return tT[e]=n[o];return e}var IO=L1("animationend"),zO=L1("animationiteration"),RO=L1("animationstart"),DO=L1("transitionend"),LO=new Map,MR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ju(e,n){LO.set(e,n),hd(n,[e])}for(var rT=0;rT<MR.length;rT++){var nT=MR[rT],G9=nT.toLowerCase(),W9=nT[0].toUpperCase()+nT.slice(1);ju(G9,"on"+W9)}ju(IO,"onAnimationEnd");ju(zO,"onAnimationIteration");ju(RO,"onAnimationStart");ju("dblclick","onDoubleClick");ju("focusin","onFocus");ju("focusout","onBlur");ju(DO,"onTransitionEnd");dp("onMouseEnter",["mouseout","mouseover"]);dp("onMouseLeave",["mouseout","mouseover"]);dp("onPointerEnter",["pointerout","pointerover"]);dp("onPointerLeave",["pointerout","pointerover"]);hd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hd("onBeforeInput",["compositionend","keypress","textInput","paste"]);hd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q9=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mg));function AR(e,n,o){var c=e.type||"unknown-event";e.currentTarget=o,G7(c,n,void 0,e),e.currentTarget=null}function OO(e,n){n=(n&4)!==0;for(var o=0;o<e.length;o++){var c=e[o],p=c.event;c=c.listeners;e:{var y=void 0;if(n)for(var w=c.length-1;0<=w;w--){var E=c[w],a=E.instance,P=E.currentTarget;if(E=E.listener,a!==y&&p.isPropagationStopped())break e;AR(p,E,P),y=a}else for(w=0;w<c.length;w++){if(E=c[w],a=E.instance,P=E.currentTarget,E=E.listener,a!==y&&p.isPropagationStopped())break e;AR(p,E,P),y=a}}}if(Cx)throw e=CE,Cx=!1,CE=null,e}function qn(e,n){var o=n[OE];o===void 0&&(o=n[OE]=new Set);var c=e+"__bubble";o.has(c)||(BO(n,e,2,!1),o.add(c))}function iT(e,n,o){var c=0;n&&(c|=4),BO(o,e,c,n)}var uv="_reactListening"+Math.random().toString(36).slice(2);function m_(e){if(!e[uv]){e[uv]=!0,GL.forEach(function(o){o!=="selectionchange"&&(q9.has(o)||iT(o,!1,e),iT(o,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[uv]||(n[uv]=!0,iT("selectionchange",!1,n))}}function BO(e,n,o,c){switch(xO(n)){case 1:var p=s9;break;case 4:p=a9;break;default:p=_M}o=p.bind(null,n,o,e),p=void 0,!EE||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(p=!0),c?p!==void 0?e.addEventListener(n,o,{capture:!0,passive:p}):e.addEventListener(n,o,!0):p!==void 0?e.addEventListener(n,o,{passive:p}):e.addEventListener(n,o,!1)}function oT(e,n,o,c,p){var y=c;if(!(n&1)&&!(n&2)&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var E=c.stateNode.containerInfo;if(E===p||E.nodeType===8&&E.parentNode===p)break;if(w===4)for(w=c.return;w!==null;){var a=w.tag;if((a===3||a===4)&&(a=w.stateNode.containerInfo,a===p||a.nodeType===8&&a.parentNode===p))return;w=w.return}for(;E!==null;){if(w=Fh(E),w===null)return;if(a=w.tag,a===5||a===6){c=y=w;continue e}E=E.parentNode}}c=c.return}sO(function(){var P=y,D=fM(o),L=[];e:{var F=LO.get(e);if(F!==void 0){var $=vM,H=e;switch(e){case"keypress":if(Wv(o)===0)break e;case"keydown":case"keyup":$=w9;break;case"focusin":H="focus",$=JS;break;case"focusout":H="blur",$=JS;break;case"beforeblur":case"afterblur":$=JS;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=gR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=u9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=E9;break;case IO:case zO:case RO:$=f9;break;case DO:$=M9;break;case"scroll":$=l9;break;case"wheel":$=k9;break;case"copy":case"cut":case"paste":$=m9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=yR}var q=(n&4)!==0,le=!q&&e==="scroll",ie=q?F!==null?F+"Capture":null:F;q=[];for(var te=P,se;te!==null;){se=te;var be=se.stateNode;if(se.tag===5&&be!==null&&(se=be,ie!==null&&(be=c_(te,ie),be!=null&&q.push(g_(te,be,se)))),le)break;te=te.return}0<q.length&&(F=new $(F,H,null,o,D),L.push({event:F,listeners:q}))}}if(!(n&7)){e:{if(F=e==="mouseover"||e==="pointerover",$=e==="mouseout"||e==="pointerout",F&&o!==SE&&(H=o.relatedTarget||o.fromElement)&&(Fh(H)||H[Mc]))break e;if(($||F)&&(F=D.window===D?D:(F=D.ownerDocument)?F.defaultView||F.parentWindow:window,$?(H=o.relatedTarget||o.toElement,$=P,H=H?Fh(H):null,H!==null&&(le=dd(H),H!==le||H.tag!==5&&H.tag!==6)&&(H=null)):($=null,H=P),$!==H)){if(q=gR,be="onMouseLeave",ie="onMouseEnter",te="mouse",(e==="pointerout"||e==="pointerover")&&(q=yR,be="onPointerLeave",ie="onPointerEnter",te="pointer"),le=$==null?F:If($),se=H==null?F:If(H),F=new q(be,te+"leave",$,o,D),F.target=le,F.relatedTarget=se,be=null,Fh(D)===P&&(q=new q(ie,te+"enter",H,o,D),q.target=se,q.relatedTarget=le,be=q),le=be,$&&H)t:{for(q=$,ie=H,te=0,se=q;se;se=yf(se))te++;for(se=0,be=ie;be;be=yf(be))se++;for(;0<te-se;)q=yf(q),te--;for(;0<se-te;)ie=yf(ie),se--;for(;te--;){if(q===ie||ie!==null&&q===ie.alternate)break t;q=yf(q),ie=yf(ie)}q=null}else q=null;$!==null&&kR(L,F,$,q,!1),H!==null&&le!==null&&kR(L,le,H,q,!0)}}e:{if(F=P?If(P):window,$=F.nodeName&&F.nodeName.toLowerCase(),$==="select"||$==="input"&&F.type==="file")var Ee=O9;else if(bR(F))if(CO)Ee=j9;else{Ee=F9;var je=B9}else($=F.nodeName)&&$.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(Ee=N9);if(Ee&&(Ee=Ee(e,P))){EO(L,Ee,o,D);break e}je&&je(e,F,P),e==="focusout"&&(je=F._wrapperState)&&je.controlled&&F.type==="number"&&yE(F,"number",F.value)}switch(je=P?If(P):window,e){case"focusin":(bR(je)||je.contentEditable==="true")&&(kf=je,PE=P,Wg=null);break;case"focusout":Wg=PE=kf=null;break;case"mousedown":IE=!0;break;case"contextmenu":case"mouseup":case"dragend":IE=!1,CR(L,o,D);break;case"selectionchange":if(U9)break;case"keydown":case"keyup":CR(L,o,D)}var Be;if(bM)e:{switch(e){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Af?SO(e,o)&&(Ze="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Ze="onCompositionStart");Ze&&(wO&&o.locale!=="ko"&&(Af||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Af&&(Be=bO()):(wu=D,yM="value"in wu?wu.value:wu.textContent,Af=!0)),je=Ix(P,Ze),0<je.length&&(Ze=new _R(Ze,e,null,o,D),L.push({event:Ze,listeners:je}),Be?Ze.data=Be:(Be=TO(o),Be!==null&&(Ze.data=Be)))),(Be=I9?z9(e,o):R9(e,o))&&(P=Ix(P,"onBeforeInput"),0<P.length&&(D=new _R("onBeforeInput","beforeinput",null,o,D),L.push({event:D,listeners:P}),D.data=Be))}OO(L,n)})}function g_(e,n,o){return{instance:e,listener:n,currentTarget:o}}function Ix(e,n){for(var o=n+"Capture",c=[];e!==null;){var p=e,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=c_(e,o),y!=null&&c.unshift(g_(e,y,p)),y=c_(e,n),y!=null&&c.push(g_(e,y,p))),e=e.return}return c}function yf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function kR(e,n,o,c,p){for(var y=n._reactName,w=[];o!==null&&o!==c;){var E=o,a=E.alternate,P=E.stateNode;if(a!==null&&a===c)break;E.tag===5&&P!==null&&(E=P,p?(a=c_(o,y),a!=null&&w.unshift(g_(o,a,E))):p||(a=c_(o,y),a!=null&&w.push(g_(o,a,E)))),o=o.return}w.length!==0&&e.push({event:n,listeners:w})}var H9=/\r\n?/g,Z9=/\u0000|\uFFFD/g;function PR(e){return(typeof e=="string"?e:""+e).replace(H9,`
`).replace(Z9,"")}function hv(e,n,o){if(n=PR(n),PR(e)!==n&&o)throw Error(It(425))}function zx(){}var zE=null,RE=null;function DE(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var LE=typeof setTimeout=="function"?setTimeout:void 0,X9=typeof clearTimeout=="function"?clearTimeout:void 0,IR=typeof Promise=="function"?Promise:void 0,Y9=typeof queueMicrotask=="function"?queueMicrotask:typeof IR<"u"?function(e){return IR.resolve(null).then(e).catch(K9)}:LE;function K9(e){setTimeout(function(){throw e})}function sT(e,n){var o=n,c=0;do{var p=o.nextSibling;if(e.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(c===0){e.removeChild(p),d_(n);return}c--}else o!=="$"&&o!=="$?"&&o!=="$!"||c++;o=p}while(o);d_(n)}function ku(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function zR(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return e;n--}else o==="/$"&&n++}e=e.previousSibling}return null}var Pp=Math.random().toString(36).slice(2),wl="__reactFiber$"+Pp,__="__reactProps$"+Pp,Mc="__reactContainer$"+Pp,OE="__reactEvents$"+Pp,J9="__reactListeners$"+Pp,Q9="__reactHandles$"+Pp;function Fh(e){var n=e[wl];if(n)return n;for(var o=e.parentNode;o;){if(n=o[Mc]||o[wl]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(e=zR(e);e!==null;){if(o=e[wl])return o;e=zR(e)}return n}e=o,o=e.parentNode}return null}function H_(e){return e=e[wl]||e[Mc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function If(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(It(33))}function O1(e){return e[__]||null}var BE=[],zf=-1;function Vu(e){return{current:e}}function Zn(e){0>zf||(e.current=BE[zf],BE[zf]=null,zf--)}function Vn(e,n){zf++,BE[zf]=e.current,e.current=n}var Ou={},ko=Vu(Ou),ns=Vu(!1),ed=Ou;function fp(e,n){var o=e.type.contextTypes;if(!o)return Ou;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===n)return c.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=n[y];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=p),p}function is(e){return e=e.childContextTypes,e!=null}function Rx(){Zn(ns),Zn(ko)}function RR(e,n,o){if(ko.current!==Ou)throw Error(It(168));Vn(ko,n),Vn(ns,o)}function FO(e,n,o){var c=e.stateNode;if(n=n.childContextTypes,typeof c.getChildContext!="function")return o;c=c.getChildContext();for(var p in c)if(!(p in n))throw Error(It(108,B7(e)||"Unknown",p));return ii({},o,c)}function Dx(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ou,ed=ko.current,Vn(ko,e),Vn(ns,ns.current),!0}function DR(e,n,o){var c=e.stateNode;if(!c)throw Error(It(169));o?(e=FO(e,n,ed),c.__reactInternalMemoizedMergedChildContext=e,Zn(ns),Zn(ko),Vn(ko,e)):Zn(ns),Vn(ns,o)}var fc=null,B1=!1,aT=!1;function NO(e){fc===null?fc=[e]:fc.push(e)}function eG(e){B1=!0,NO(e)}function $u(){if(!aT&&fc!==null){aT=!0;var e=0,n=Mn;try{var o=fc;for(Mn=1;e<o.length;e++){var c=o[e];do c=c(!0);while(c!==null)}fc=null,B1=!1}catch(p){throw fc!==null&&(fc=fc.slice(e+1)),uO(pM,$u),p}finally{Mn=n,aT=!1}}return null}var Rf=[],Df=0,Lx=null,Ox=0,Qs=[],ea=0,td=null,gc=1,_c="";function Ph(e,n){Rf[Df++]=Ox,Rf[Df++]=Lx,Lx=e,Ox=n}function jO(e,n,o){Qs[ea++]=gc,Qs[ea++]=_c,Qs[ea++]=td,td=e;var c=gc;e=_c;var p=32-Oa(c)-1;c&=~(1<<p),o+=1;var y=32-Oa(n)+p;if(30<y){var w=p-p%5;y=(c&(1<<w)-1).toString(32),c>>=w,p-=w,gc=1<<32-Oa(n)+p|o<<p|c,_c=y+e}else gc=1<<y|o<<p|c,_c=e}function SM(e){e.return!==null&&(Ph(e,1),jO(e,1,0))}function TM(e){for(;e===Lx;)Lx=Rf[--Df],Rf[Df]=null,Ox=Rf[--Df],Rf[Df]=null;for(;e===td;)td=Qs[--ea],Qs[ea]=null,_c=Qs[--ea],Qs[ea]=null,gc=Qs[--ea],Qs[ea]=null}var Ms=null,Es=null,Yn=!1,Ia=null;function VO(e,n){var o=oa(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=e,n=e.deletions,n===null?(e.deletions=[o],e.flags|=16):n.push(o)}function LR(e,n){switch(e.tag){case 5:var o=e.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Ms=e,Es=ku(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Ms=e,Es=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=td!==null?{id:gc,overflow:_c}:null,e.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=oa(18,null,null,0),o.stateNode=n,o.return=e,e.child=o,Ms=e,Es=null,!0):!1;default:return!1}}function FE(e){return(e.mode&1)!==0&&(e.flags&128)===0}function NE(e){if(Yn){var n=Es;if(n){var o=n;if(!LR(e,n)){if(FE(e))throw Error(It(418));n=ku(o.nextSibling);var c=Ms;n&&LR(e,n)?VO(c,o):(e.flags=e.flags&-4097|2,Yn=!1,Ms=e)}}else{if(FE(e))throw Error(It(418));e.flags=e.flags&-4097|2,Yn=!1,Ms=e}}}function OR(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ms=e}function dv(e){if(e!==Ms)return!1;if(!Yn)return OR(e),Yn=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!DE(e.type,e.memoizedProps)),n&&(n=Es)){if(FE(e))throw $O(),Error(It(418));for(;n;)VO(e,n),n=ku(n.nextSibling)}if(OR(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(It(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(n===0){Es=ku(e.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}e=e.nextSibling}Es=null}}else Es=Ms?ku(e.stateNode.nextSibling):null;return!0}function $O(){for(var e=Es;e;)e=ku(e.nextSibling)}function pp(){Es=Ms=null,Yn=!1}function EM(e){Ia===null?Ia=[e]:Ia.push(e)}var tG=Dc.ReactCurrentBatchConfig;function ka(e,n){if(e&&e.defaultProps){n=ii({},n),e=e.defaultProps;for(var o in e)n[o]===void 0&&(n[o]=e[o]);return n}return n}var Bx=Vu(null),Fx=null,Lf=null,CM=null;function MM(){CM=Lf=Fx=null}function AM(e){var n=Bx.current;Zn(Bx),e._currentValue=n}function jE(e,n,o){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===o)break;e=e.return}}function tp(e,n){Fx=e,CM=Lf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(ts=!0),e.firstContext=null)}function aa(e){var n=e._currentValue;if(CM!==e)if(e={context:e,memoizedValue:n,next:null},Lf===null){if(Fx===null)throw Error(It(308));Lf=e,Fx.dependencies={lanes:0,firstContext:e}}else Lf=Lf.next=e;return n}var Nh=null;function kM(e){Nh===null?Nh=[e]:Nh.push(e)}function UO(e,n,o,c){var p=n.interleaved;return p===null?(o.next=o,kM(n)):(o.next=p.next,p.next=o),n.interleaved=o,Ac(e,c)}function Ac(e,n){e.lanes|=n;var o=e.alternate;for(o!==null&&(o.lanes|=n),o=e,e=e.return;e!==null;)e.childLanes|=n,o=e.alternate,o!==null&&(o.childLanes|=n),o=e,e=e.return;return o.tag===3?o.stateNode:null}var _u=!1;function PM(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GO(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xc(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Pu(e,n,o){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,ln&2){var p=c.pending;return p===null?n.next=n:(n.next=p.next,p.next=n),c.pending=n,Ac(e,o)}return p=c.interleaved,p===null?(n.next=n,kM(c)):(n.next=p.next,p.next=n),c.interleaved=n,Ac(e,o)}function qv(e,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var c=n.lanes;c&=e.pendingLanes,o|=c,n.lanes=o,mM(e,o)}}function BR(e,n){var o=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var w={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=w:y=y.next=w,o=o.next}while(o!==null);y===null?p=y=n:y=y.next=n}else p=y=n;o={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,effects:c.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=n:e.next=n,o.lastBaseUpdate=n}function Nx(e,n,o,c){var p=e.updateQueue;_u=!1;var y=p.firstBaseUpdate,w=p.lastBaseUpdate,E=p.shared.pending;if(E!==null){p.shared.pending=null;var a=E,P=a.next;a.next=null,w===null?y=P:w.next=P,w=a;var D=e.alternate;D!==null&&(D=D.updateQueue,E=D.lastBaseUpdate,E!==w&&(E===null?D.firstBaseUpdate=P:E.next=P,D.lastBaseUpdate=a))}if(y!==null){var L=p.baseState;w=0,D=P=a=null,E=y;do{var F=E.lane,$=E.eventTime;if((c&F)===F){D!==null&&(D=D.next={eventTime:$,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var H=e,q=E;switch(F=n,$=o,q.tag){case 1:if(H=q.payload,typeof H=="function"){L=H.call($,L,F);break e}L=H;break e;case 3:H.flags=H.flags&-65537|128;case 0:if(H=q.payload,F=typeof H=="function"?H.call($,L,F):H,F==null)break e;L=ii({},L,F);break e;case 2:_u=!0}}E.callback!==null&&E.lane!==0&&(e.flags|=64,F=p.effects,F===null?p.effects=[E]:F.push(E))}else $={eventTime:$,lane:F,tag:E.tag,payload:E.payload,callback:E.callback,next:null},D===null?(P=D=$,a=L):D=D.next=$,w|=F;if(E=E.next,E===null){if(E=p.shared.pending,E===null)break;F=E,E=F.next,F.next=null,p.lastBaseUpdate=F,p.shared.pending=null}}while(!0);if(D===null&&(a=L),p.baseState=a,p.firstBaseUpdate=P,p.lastBaseUpdate=D,n=p.shared.interleaved,n!==null){p=n;do w|=p.lane,p=p.next;while(p!==n)}else y===null&&(p.shared.lanes=0);nd|=w,e.lanes=w,e.memoizedState=L}}function FR(e,n,o){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var c=e[n],p=c.callback;if(p!==null){if(c.callback=null,c=o,typeof p!="function")throw Error(It(191,p));p.call(c)}}}var WO=new UL.Component().refs;function VE(e,n,o,c){n=e.memoizedState,o=o(c,n),o=o==null?n:ii({},n,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var F1={isMounted:function(e){return(e=e._reactInternals)?dd(e)===e:!1},enqueueSetState:function(e,n,o){e=e._reactInternals;var c=Oo(),p=zu(e),y=xc(c,p);y.payload=n,o!=null&&(y.callback=o),n=Pu(e,y,p),n!==null&&(Ba(n,e,p,c),qv(n,e,p))},enqueueReplaceState:function(e,n,o){e=e._reactInternals;var c=Oo(),p=zu(e),y=xc(c,p);y.tag=1,y.payload=n,o!=null&&(y.callback=o),n=Pu(e,y,p),n!==null&&(Ba(n,e,p,c),qv(n,e,p))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var o=Oo(),c=zu(e),p=xc(o,c);p.tag=2,n!=null&&(p.callback=n),n=Pu(e,p,c),n!==null&&(Ba(n,e,c,o),qv(n,e,c))}};function NR(e,n,o,c,p,y,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,y,w):n.prototype&&n.prototype.isPureReactComponent?!p_(o,c)||!p_(p,y):!0}function qO(e,n,o){var c=!1,p=Ou,y=n.contextType;return typeof y=="object"&&y!==null?y=aa(y):(p=is(n)?ed:ko.current,c=n.contextTypes,y=(c=c!=null)?fp(e,p):Ou),n=new n(o,y),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=F1,e.stateNode=n,n._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=p,e.__reactInternalMemoizedMaskedChildContext=y),n}function jR(e,n,o,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,c),n.state!==e&&F1.enqueueReplaceState(n,n.state,null)}function $E(e,n,o,c){var p=e.stateNode;p.props=o,p.state=e.memoizedState,p.refs=WO,PM(e);var y=n.contextType;typeof y=="object"&&y!==null?p.context=aa(y):(y=is(n)?ed:ko.current,p.context=fp(e,y)),p.state=e.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(VE(e,n,y,o),p.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(n=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),n!==p.state&&F1.enqueueReplaceState(p,p.state,null),Nx(e,o,p,c),p.state=e.memoizedState),typeof p.componentDidMount=="function"&&(e.flags|=4194308)}function dg(e,n,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(It(309));var c=o.stateNode}if(!c)throw Error(It(147,e));var p=c,y=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===y?n.ref:(n=function(w){var E=p.refs;E===WO&&(E=p.refs={}),w===null?delete E[y]:E[y]=w},n._stringRef=y,n)}if(typeof e!="string")throw Error(It(284));if(!o._owner)throw Error(It(290,e))}return e}function fv(e,n){throw e=Object.prototype.toString.call(n),Error(It(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function VR(e){var n=e._init;return n(e._payload)}function HO(e){function n(ie,te){if(e){var se=ie.deletions;se===null?(ie.deletions=[te],ie.flags|=16):se.push(te)}}function o(ie,te){if(!e)return null;for(;te!==null;)n(ie,te),te=te.sibling;return null}function c(ie,te){for(ie=new Map;te!==null;)te.key!==null?ie.set(te.key,te):ie.set(te.index,te),te=te.sibling;return ie}function p(ie,te){return ie=Ru(ie,te),ie.index=0,ie.sibling=null,ie}function y(ie,te,se){return ie.index=se,e?(se=ie.alternate,se!==null?(se=se.index,se<te?(ie.flags|=2,te):se):(ie.flags|=2,te)):(ie.flags|=1048576,te)}function w(ie){return e&&ie.alternate===null&&(ie.flags|=2),ie}function E(ie,te,se,be){return te===null||te.tag!==6?(te=pT(se,ie.mode,be),te.return=ie,te):(te=p(te,se),te.return=ie,te)}function a(ie,te,se,be){var Ee=se.type;return Ee===Mf?D(ie,te,se.props.children,be,se.key):te!==null&&(te.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===gu&&VR(Ee)===te.type)?(be=p(te,se.props),be.ref=dg(ie,te,se),be.return=ie,be):(be=Jv(se.type,se.key,se.props,null,ie.mode,be),be.ref=dg(ie,te,se),be.return=ie,be)}function P(ie,te,se,be){return te===null||te.tag!==4||te.stateNode.containerInfo!==se.containerInfo||te.stateNode.implementation!==se.implementation?(te=mT(se,ie.mode,be),te.return=ie,te):(te=p(te,se.children||[]),te.return=ie,te)}function D(ie,te,se,be,Ee){return te===null||te.tag!==7?(te=Wh(se,ie.mode,be,Ee),te.return=ie,te):(te=p(te,se),te.return=ie,te)}function L(ie,te,se){if(typeof te=="string"&&te!==""||typeof te=="number")return te=pT(""+te,ie.mode,se),te.return=ie,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case rv:return se=Jv(te.type,te.key,te.props,null,ie.mode,se),se.ref=dg(ie,null,te),se.return=ie,se;case Cf:return te=mT(te,ie.mode,se),te.return=ie,te;case gu:var be=te._init;return L(ie,be(te._payload),se)}if(Eg(te)||ag(te))return te=Wh(te,ie.mode,se,null),te.return=ie,te;fv(ie,te)}return null}function F(ie,te,se,be){var Ee=te!==null?te.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Ee!==null?null:E(ie,te,""+se,be);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case rv:return se.key===Ee?a(ie,te,se,be):null;case Cf:return se.key===Ee?P(ie,te,se,be):null;case gu:return Ee=se._init,F(ie,te,Ee(se._payload),be)}if(Eg(se)||ag(se))return Ee!==null?null:D(ie,te,se,be,null);fv(ie,se)}return null}function $(ie,te,se,be,Ee){if(typeof be=="string"&&be!==""||typeof be=="number")return ie=ie.get(se)||null,E(te,ie,""+be,Ee);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case rv:return ie=ie.get(be.key===null?se:be.key)||null,a(te,ie,be,Ee);case Cf:return ie=ie.get(be.key===null?se:be.key)||null,P(te,ie,be,Ee);case gu:var je=be._init;return $(ie,te,se,je(be._payload),Ee)}if(Eg(be)||ag(be))return ie=ie.get(se)||null,D(te,ie,be,Ee,null);fv(te,be)}return null}function H(ie,te,se,be){for(var Ee=null,je=null,Be=te,Ze=te=0,ht=null;Be!==null&&Ze<se.length;Ze++){Be.index>Ze?(ht=Be,Be=null):ht=Be.sibling;var Pe=F(ie,Be,se[Ze],be);if(Pe===null){Be===null&&(Be=ht);break}e&&Be&&Pe.alternate===null&&n(ie,Be),te=y(Pe,te,Ze),je===null?Ee=Pe:je.sibling=Pe,je=Pe,Be=ht}if(Ze===se.length)return o(ie,Be),Yn&&Ph(ie,Ze),Ee;if(Be===null){for(;Ze<se.length;Ze++)Be=L(ie,se[Ze],be),Be!==null&&(te=y(Be,te,Ze),je===null?Ee=Be:je.sibling=Be,je=Be);return Yn&&Ph(ie,Ze),Ee}for(Be=c(ie,Be);Ze<se.length;Ze++)ht=$(Be,ie,Ze,se[Ze],be),ht!==null&&(e&&ht.alternate!==null&&Be.delete(ht.key===null?Ze:ht.key),te=y(ht,te,Ze),je===null?Ee=ht:je.sibling=ht,je=ht);return e&&Be.forEach(function(Et){return n(ie,Et)}),Yn&&Ph(ie,Ze),Ee}function q(ie,te,se,be){var Ee=ag(se);if(typeof Ee!="function")throw Error(It(150));if(se=Ee.call(se),se==null)throw Error(It(151));for(var je=Ee=null,Be=te,Ze=te=0,ht=null,Pe=se.next();Be!==null&&!Pe.done;Ze++,Pe=se.next()){Be.index>Ze?(ht=Be,Be=null):ht=Be.sibling;var Et=F(ie,Be,Pe.value,be);if(Et===null){Be===null&&(Be=ht);break}e&&Be&&Et.alternate===null&&n(ie,Be),te=y(Et,te,Ze),je===null?Ee=Et:je.sibling=Et,je=Et,Be=ht}if(Pe.done)return o(ie,Be),Yn&&Ph(ie,Ze),Ee;if(Be===null){for(;!Pe.done;Ze++,Pe=se.next())Pe=L(ie,Pe.value,be),Pe!==null&&(te=y(Pe,te,Ze),je===null?Ee=Pe:je.sibling=Pe,je=Pe);return Yn&&Ph(ie,Ze),Ee}for(Be=c(ie,Be);!Pe.done;Ze++,Pe=se.next())Pe=$(Be,ie,Ze,Pe.value,be),Pe!==null&&(e&&Pe.alternate!==null&&Be.delete(Pe.key===null?Ze:Pe.key),te=y(Pe,te,Ze),je===null?Ee=Pe:je.sibling=Pe,je=Pe);return e&&Be.forEach(function(or){return n(ie,or)}),Yn&&Ph(ie,Ze),Ee}function le(ie,te,se,be){if(typeof se=="object"&&se!==null&&se.type===Mf&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case rv:e:{for(var Ee=se.key,je=te;je!==null;){if(je.key===Ee){if(Ee=se.type,Ee===Mf){if(je.tag===7){o(ie,je.sibling),te=p(je,se.props.children),te.return=ie,ie=te;break e}}else if(je.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===gu&&VR(Ee)===je.type){o(ie,je.sibling),te=p(je,se.props),te.ref=dg(ie,je,se),te.return=ie,ie=te;break e}o(ie,je);break}else n(ie,je);je=je.sibling}se.type===Mf?(te=Wh(se.props.children,ie.mode,be,se.key),te.return=ie,ie=te):(be=Jv(se.type,se.key,se.props,null,ie.mode,be),be.ref=dg(ie,te,se),be.return=ie,ie=be)}return w(ie);case Cf:e:{for(je=se.key;te!==null;){if(te.key===je)if(te.tag===4&&te.stateNode.containerInfo===se.containerInfo&&te.stateNode.implementation===se.implementation){o(ie,te.sibling),te=p(te,se.children||[]),te.return=ie,ie=te;break e}else{o(ie,te);break}else n(ie,te);te=te.sibling}te=mT(se,ie.mode,be),te.return=ie,ie=te}return w(ie);case gu:return je=se._init,le(ie,te,je(se._payload),be)}if(Eg(se))return H(ie,te,se,be);if(ag(se))return q(ie,te,se,be);fv(ie,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,te!==null&&te.tag===6?(o(ie,te.sibling),te=p(te,se),te.return=ie,ie=te):(o(ie,te),te=pT(se,ie.mode,be),te.return=ie,ie=te),w(ie)):o(ie,te)}return le}var mp=HO(!0),ZO=HO(!1),Z_={},Ml=Vu(Z_),y_=Vu(Z_),v_=Vu(Z_);function jh(e){if(e===Z_)throw Error(It(174));return e}function IM(e,n){switch(Vn(v_,n),Vn(y_,e),Vn(Ml,Z_),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:xE(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=xE(n,e)}Zn(Ml),Vn(Ml,n)}function gp(){Zn(Ml),Zn(y_),Zn(v_)}function XO(e){jh(v_.current);var n=jh(Ml.current),o=xE(n,e.type);n!==o&&(Vn(y_,e),Vn(Ml,o))}function zM(e){y_.current===e&&(Zn(Ml),Zn(y_))}var ti=Vu(0);function jx(e){for(var n=e;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var lT=[];function RM(){for(var e=0;e<lT.length;e++)lT[e]._workInProgressVersionPrimary=null;lT.length=0}var Hv=Dc.ReactCurrentDispatcher,cT=Dc.ReactCurrentBatchConfig,rd=0,ni=null,ji=null,Wi=null,Vx=!1,qg=!1,x_=0,rG=0;function To(){throw Error(It(321))}function DM(e,n){if(n===null)return!1;for(var o=0;o<n.length&&o<e.length;o++)if(!Fa(e[o],n[o]))return!1;return!0}function LM(e,n,o,c,p,y){if(rd=y,ni=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Hv.current=e===null||e.memoizedState===null?sG:aG,e=o(c,p),qg){y=0;do{if(qg=!1,x_=0,25<=y)throw Error(It(301));y+=1,Wi=ji=null,n.updateQueue=null,Hv.current=lG,e=o(c,p)}while(qg)}if(Hv.current=$x,n=ji!==null&&ji.next!==null,rd=0,Wi=ji=ni=null,Vx=!1,n)throw Error(It(300));return e}function OM(){var e=x_!==0;return x_=0,e}function yl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wi===null?ni.memoizedState=Wi=e:Wi=Wi.next=e,Wi}function la(){if(ji===null){var e=ni.alternate;e=e!==null?e.memoizedState:null}else e=ji.next;var n=Wi===null?ni.memoizedState:Wi.next;if(n!==null)Wi=n,ji=e;else{if(e===null)throw Error(It(310));ji=e,e={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},Wi===null?ni.memoizedState=Wi=e:Wi=Wi.next=e}return Wi}function b_(e,n){return typeof n=="function"?n(e):n}function uT(e){var n=la(),o=n.queue;if(o===null)throw Error(It(311));o.lastRenderedReducer=e;var c=ji,p=c.baseQueue,y=o.pending;if(y!==null){if(p!==null){var w=p.next;p.next=y.next,y.next=w}c.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,c=c.baseState;var E=w=null,a=null,P=y;do{var D=P.lane;if((rd&D)===D)a!==null&&(a=a.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),c=P.hasEagerState?P.eagerState:e(c,P.action);else{var L={lane:D,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};a===null?(E=a=L,w=c):a=a.next=L,ni.lanes|=D,nd|=D}P=P.next}while(P!==null&&P!==y);a===null?w=c:a.next=E,Fa(c,n.memoizedState)||(ts=!0),n.memoizedState=c,n.baseState=w,n.baseQueue=a,o.lastRenderedState=c}if(e=o.interleaved,e!==null){p=e;do y=p.lane,ni.lanes|=y,nd|=y,p=p.next;while(p!==e)}else p===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function hT(e){var n=la(),o=n.queue;if(o===null)throw Error(It(311));o.lastRenderedReducer=e;var c=o.dispatch,p=o.pending,y=n.memoizedState;if(p!==null){o.pending=null;var w=p=p.next;do y=e(y,w.action),w=w.next;while(w!==p);Fa(y,n.memoizedState)||(ts=!0),n.memoizedState=y,n.baseQueue===null&&(n.baseState=y),o.lastRenderedState=y}return[y,c]}function YO(){}function KO(e,n){var o=ni,c=la(),p=n(),y=!Fa(c.memoizedState,p);if(y&&(c.memoizedState=p,ts=!0),c=c.queue,BM(eB.bind(null,o,c,e),[e]),c.getSnapshot!==n||y||Wi!==null&&Wi.memoizedState.tag&1){if(o.flags|=2048,w_(9,QO.bind(null,o,c,p,n),void 0,null),qi===null)throw Error(It(349));rd&30||JO(o,n,p)}return p}function JO(e,n,o){e.flags|=16384,e={getSnapshot:n,value:o},n=ni.updateQueue,n===null?(n={lastEffect:null,stores:null},ni.updateQueue=n,n.stores=[e]):(o=n.stores,o===null?n.stores=[e]:o.push(e))}function QO(e,n,o,c){n.value=o,n.getSnapshot=c,tB(n)&&rB(e)}function eB(e,n,o){return o(function(){tB(n)&&rB(e)})}function tB(e){var n=e.getSnapshot;e=e.value;try{var o=n();return!Fa(e,o)}catch{return!0}}function rB(e){var n=Ac(e,1);n!==null&&Ba(n,e,1,-1)}function $R(e){var n=yl();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b_,lastRenderedState:e},n.queue=e,e=e.dispatch=oG.bind(null,ni,e),[n.memoizedState,e]}function w_(e,n,o,c){return e={tag:e,create:n,destroy:o,deps:c,next:null},n=ni.updateQueue,n===null?(n={lastEffect:null,stores:null},ni.updateQueue=n,n.lastEffect=e.next=e):(o=n.lastEffect,o===null?n.lastEffect=e.next=e:(c=o.next,o.next=e,e.next=c,n.lastEffect=e)),e}function nB(){return la().memoizedState}function Zv(e,n,o,c){var p=yl();ni.flags|=e,p.memoizedState=w_(1|n,o,void 0,c===void 0?null:c)}function N1(e,n,o,c){var p=la();c=c===void 0?null:c;var y=void 0;if(ji!==null){var w=ji.memoizedState;if(y=w.destroy,c!==null&&DM(c,w.deps)){p.memoizedState=w_(n,o,y,c);return}}ni.flags|=e,p.memoizedState=w_(1|n,o,y,c)}function UR(e,n){return Zv(8390656,8,e,n)}function BM(e,n){return N1(2048,8,e,n)}function iB(e,n){return N1(4,2,e,n)}function oB(e,n){return N1(4,4,e,n)}function sB(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function aB(e,n,o){return o=o!=null?o.concat([e]):null,N1(4,4,sB.bind(null,n,e),o)}function FM(){}function lB(e,n){var o=la();n=n===void 0?null:n;var c=o.memoizedState;return c!==null&&n!==null&&DM(n,c[1])?c[0]:(o.memoizedState=[e,n],e)}function cB(e,n){var o=la();n=n===void 0?null:n;var c=o.memoizedState;return c!==null&&n!==null&&DM(n,c[1])?c[0]:(e=e(),o.memoizedState=[e,n],e)}function uB(e,n,o){return rd&21?(Fa(o,n)||(o=fO(),ni.lanes|=o,nd|=o,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,ts=!0),e.memoizedState=o)}function nG(e,n){var o=Mn;Mn=o!==0&&4>o?o:4,e(!0);var c=cT.transition;cT.transition={};try{e(!1),n()}finally{Mn=o,cT.transition=c}}function hB(){return la().memoizedState}function iG(e,n,o){var c=zu(e);if(o={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null},dB(e))fB(n,o);else if(o=UO(e,n,o,c),o!==null){var p=Oo();Ba(o,e,c,p),pB(o,n,c)}}function oG(e,n,o){var c=zu(e),p={lane:c,action:o,hasEagerState:!1,eagerState:null,next:null};if(dB(e))fB(n,p);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=n.lastRenderedReducer,y!==null))try{var w=n.lastRenderedState,E=y(w,o);if(p.hasEagerState=!0,p.eagerState=E,Fa(E,w)){var a=n.interleaved;a===null?(p.next=p,kM(n)):(p.next=a.next,a.next=p),n.interleaved=p;return}}catch{}finally{}o=UO(e,n,p,c),o!==null&&(p=Oo(),Ba(o,e,c,p),pB(o,n,c))}}function dB(e){var n=e.alternate;return e===ni||n!==null&&n===ni}function fB(e,n){qg=Vx=!0;var o=e.pending;o===null?n.next=n:(n.next=o.next,o.next=n),e.pending=n}function pB(e,n,o){if(o&4194240){var c=n.lanes;c&=e.pendingLanes,o|=c,n.lanes=o,mM(e,o)}}var $x={readContext:aa,useCallback:To,useContext:To,useEffect:To,useImperativeHandle:To,useInsertionEffect:To,useLayoutEffect:To,useMemo:To,useReducer:To,useRef:To,useState:To,useDebugValue:To,useDeferredValue:To,useTransition:To,useMutableSource:To,useSyncExternalStore:To,useId:To,unstable_isNewReconciler:!1},sG={readContext:aa,useCallback:function(e,n){return yl().memoizedState=[e,n===void 0?null:n],e},useContext:aa,useEffect:UR,useImperativeHandle:function(e,n,o){return o=o!=null?o.concat([e]):null,Zv(4194308,4,sB.bind(null,n,e),o)},useLayoutEffect:function(e,n){return Zv(4194308,4,e,n)},useInsertionEffect:function(e,n){return Zv(4,2,e,n)},useMemo:function(e,n){var o=yl();return n=n===void 0?null:n,e=e(),o.memoizedState=[e,n],e},useReducer:function(e,n,o){var c=yl();return n=o!==void 0?o(n):n,c.memoizedState=c.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},c.queue=e,e=e.dispatch=iG.bind(null,ni,e),[c.memoizedState,e]},useRef:function(e){var n=yl();return e={current:e},n.memoizedState=e},useState:$R,useDebugValue:FM,useDeferredValue:function(e){return yl().memoizedState=e},useTransition:function(){var e=$R(!1),n=e[0];return e=nG.bind(null,e[1]),yl().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,o){var c=ni,p=yl();if(Yn){if(o===void 0)throw Error(It(407));o=o()}else{if(o=n(),qi===null)throw Error(It(349));rd&30||JO(c,n,o)}p.memoizedState=o;var y={value:o,getSnapshot:n};return p.queue=y,UR(eB.bind(null,c,y,e),[e]),c.flags|=2048,w_(9,QO.bind(null,c,y,o,n),void 0,null),o},useId:function(){var e=yl(),n=qi.identifierPrefix;if(Yn){var o=_c,c=gc;o=(c&~(1<<32-Oa(c)-1)).toString(32)+o,n=":"+n+"R"+o,o=x_++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=rG++,n=":"+n+"r"+o.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},aG={readContext:aa,useCallback:lB,useContext:aa,useEffect:BM,useImperativeHandle:aB,useInsertionEffect:iB,useLayoutEffect:oB,useMemo:cB,useReducer:uT,useRef:nB,useState:function(){return uT(b_)},useDebugValue:FM,useDeferredValue:function(e){var n=la();return uB(n,ji.memoizedState,e)},useTransition:function(){var e=uT(b_)[0],n=la().memoizedState;return[e,n]},useMutableSource:YO,useSyncExternalStore:KO,useId:hB,unstable_isNewReconciler:!1},lG={readContext:aa,useCallback:lB,useContext:aa,useEffect:BM,useImperativeHandle:aB,useInsertionEffect:iB,useLayoutEffect:oB,useMemo:cB,useReducer:hT,useRef:nB,useState:function(){return hT(b_)},useDebugValue:FM,useDeferredValue:function(e){var n=la();return ji===null?n.memoizedState=e:uB(n,ji.memoizedState,e)},useTransition:function(){var e=hT(b_)[0],n=la().memoizedState;return[e,n]},useMutableSource:YO,useSyncExternalStore:KO,useId:hB,unstable_isNewReconciler:!1};function _p(e,n){try{var o="",c=n;do o+=O7(c),c=c.return;while(c);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:e,source:n,stack:p,digest:null}}function dT(e,n,o){return{value:e,source:null,stack:o??null,digest:n??null}}function UE(e,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var cG=typeof WeakMap=="function"?WeakMap:Map;function mB(e,n,o){o=xc(-1,o),o.tag=3,o.payload={element:null};var c=n.value;return o.callback=function(){Gx||(Gx=!0,QE=c),UE(e,n)},o}function gB(e,n,o){o=xc(-1,o),o.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var p=n.value;o.payload=function(){return c(p)},o.callback=function(){UE(e,n)}}var y=e.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){UE(e,n),typeof c!="function"&&(Iu===null?Iu=new Set([this]):Iu.add(this));var w=n.stack;this.componentDidCatch(n.value,{componentStack:w!==null?w:""})}),o}function GR(e,n,o){var c=e.pingCache;if(c===null){c=e.pingCache=new cG;var p=new Set;c.set(n,p)}else p=c.get(n),p===void 0&&(p=new Set,c.set(n,p));p.has(o)||(p.add(o),e=SG.bind(null,e,n,o),n.then(e,e))}function WR(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function qR(e,n,o,c,p){return e.mode&1?(e.flags|=65536,e.lanes=p,e):(e===n?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=xc(-1,1),n.tag=2,Pu(o,n,1))),o.lanes|=1),e)}var uG=Dc.ReactCurrentOwner,ts=!1;function Do(e,n,o,c){n.child=e===null?ZO(n,null,o,c):mp(n,e.child,o,c)}function HR(e,n,o,c,p){o=o.render;var y=n.ref;return tp(n,p),c=LM(e,n,o,c,y,p),o=OM(),e!==null&&!ts?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,kc(e,n,p)):(Yn&&o&&SM(n),n.flags|=1,Do(e,n,c,p),n.child)}function ZR(e,n,o,c,p){if(e===null){var y=o.type;return typeof y=="function"&&!qM(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=y,_B(e,n,y,c,p)):(e=Jv(o.type,null,c,n,n.mode,p),e.ref=n.ref,e.return=n,n.child=e)}if(y=e.child,!(e.lanes&p)){var w=y.memoizedProps;if(o=o.compare,o=o!==null?o:p_,o(w,c)&&e.ref===n.ref)return kc(e,n,p)}return n.flags|=1,e=Ru(y,c),e.ref=n.ref,e.return=n,n.child=e}function _B(e,n,o,c,p){if(e!==null){var y=e.memoizedProps;if(p_(y,c)&&e.ref===n.ref)if(ts=!1,n.pendingProps=c=y,(e.lanes&p)!==0)e.flags&131072&&(ts=!0);else return n.lanes=e.lanes,kc(e,n,p)}return GE(e,n,o,c,p)}function yB(e,n,o){var c=n.pendingProps,p=c.children,y=e!==null?e.memoizedState:null;if(c.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vn(Bf,Ts),Ts|=o;else{if(!(o&1073741824))return e=y!==null?y.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Vn(Bf,Ts),Ts|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=y!==null?y.baseLanes:o,Vn(Bf,Ts),Ts|=c}else y!==null?(c=y.baseLanes|o,n.memoizedState=null):c=o,Vn(Bf,Ts),Ts|=c;return Do(e,n,p,o),n.child}function vB(e,n){var o=n.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function GE(e,n,o,c,p){var y=is(o)?ed:ko.current;return y=fp(n,y),tp(n,p),o=LM(e,n,o,c,y,p),c=OM(),e!==null&&!ts?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~p,kc(e,n,p)):(Yn&&c&&SM(n),n.flags|=1,Do(e,n,o,p),n.child)}function XR(e,n,o,c,p){if(is(o)){var y=!0;Dx(n)}else y=!1;if(tp(n,p),n.stateNode===null)Xv(e,n),qO(n,o,c),$E(n,o,c,p),c=!0;else if(e===null){var w=n.stateNode,E=n.memoizedProps;w.props=E;var a=w.context,P=o.contextType;typeof P=="object"&&P!==null?P=aa(P):(P=is(o)?ed:ko.current,P=fp(n,P));var D=o.getDerivedStateFromProps,L=typeof D=="function"||typeof w.getSnapshotBeforeUpdate=="function";L||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(E!==c||a!==P)&&jR(n,w,c,P),_u=!1;var F=n.memoizedState;w.state=F,Nx(n,c,w,p),a=n.memoizedState,E!==c||F!==a||ns.current||_u?(typeof D=="function"&&(VE(n,o,D,c),a=n.memoizedState),(E=_u||NR(n,o,E,c,F,a,P))?(L||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(n.flags|=4194308)):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=a),w.props=c,w.state=a,w.context=P,c=E):(typeof w.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{w=n.stateNode,GO(e,n),E=n.memoizedProps,P=n.type===n.elementType?E:ka(n.type,E),w.props=P,L=n.pendingProps,F=w.context,a=o.contextType,typeof a=="object"&&a!==null?a=aa(a):(a=is(o)?ed:ko.current,a=fp(n,a));var $=o.getDerivedStateFromProps;(D=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(E!==L||F!==a)&&jR(n,w,c,a),_u=!1,F=n.memoizedState,w.state=F,Nx(n,c,w,p);var H=n.memoizedState;E!==L||F!==H||ns.current||_u?(typeof $=="function"&&(VE(n,o,$,c),H=n.memoizedState),(P=_u||NR(n,o,P,c,F,H,a)||!1)?(D||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(c,H,a),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(c,H,a)),typeof w.componentDidUpdate=="function"&&(n.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof w.componentDidUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=H),w.props=c,w.state=H,w.context=a,c=P):(typeof w.componentDidUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||E===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),c=!1)}return WE(e,n,o,c,y,p)}function WE(e,n,o,c,p,y){vB(e,n);var w=(n.flags&128)!==0;if(!c&&!w)return p&&DR(n,o,!1),kc(e,n,y);c=n.stateNode,uG.current=n;var E=w&&typeof o.getDerivedStateFromError!="function"?null:c.render();return n.flags|=1,e!==null&&w?(n.child=mp(n,e.child,null,y),n.child=mp(n,null,E,y)):Do(e,n,E,y),n.memoizedState=c.state,p&&DR(n,o,!0),n.child}function xB(e){var n=e.stateNode;n.pendingContext?RR(e,n.pendingContext,n.pendingContext!==n.context):n.context&&RR(e,n.context,!1),IM(e,n.containerInfo)}function YR(e,n,o,c,p){return pp(),EM(p),n.flags|=256,Do(e,n,o,c),n.child}var qE={dehydrated:null,treeContext:null,retryLane:0};function HE(e){return{baseLanes:e,cachePool:null,transitions:null}}function bB(e,n,o){var c=n.pendingProps,p=ti.current,y=!1,w=(n.flags&128)!==0,E;if((E=w)||(E=e!==null&&e.memoizedState===null?!1:(p&2)!==0),E?(y=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(p|=1),Vn(ti,p&1),e===null)return NE(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(w=c.children,e=c.fallback,y?(c=n.mode,y=n.child,w={mode:"hidden",children:w},!(c&1)&&y!==null?(y.childLanes=0,y.pendingProps=w):y=$1(w,c,0,null),e=Wh(e,c,o,null),y.return=n,e.return=n,y.sibling=e,n.child=y,n.child.memoizedState=HE(o),n.memoizedState=qE,e):NM(n,w));if(p=e.memoizedState,p!==null&&(E=p.dehydrated,E!==null))return hG(e,n,w,c,E,p,o);if(y){y=c.fallback,w=n.mode,p=e.child,E=p.sibling;var a={mode:"hidden",children:c.children};return!(w&1)&&n.child!==p?(c=n.child,c.childLanes=0,c.pendingProps=a,n.deletions=null):(c=Ru(p,a),c.subtreeFlags=p.subtreeFlags&14680064),E!==null?y=Ru(E,y):(y=Wh(y,w,o,null),y.flags|=2),y.return=n,c.return=n,c.sibling=y,n.child=c,c=y,y=n.child,w=e.child.memoizedState,w=w===null?HE(o):{baseLanes:w.baseLanes|o,cachePool:null,transitions:w.transitions},y.memoizedState=w,y.childLanes=e.childLanes&~o,n.memoizedState=qE,c}return y=e.child,e=y.sibling,c=Ru(y,{mode:"visible",children:c.children}),!(n.mode&1)&&(c.lanes=o),c.return=n,c.sibling=null,e!==null&&(o=n.deletions,o===null?(n.deletions=[e],n.flags|=16):o.push(e)),n.child=c,n.memoizedState=null,c}function NM(e,n){return n=$1({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function pv(e,n,o,c){return c!==null&&EM(c),mp(n,e.child,null,o),e=NM(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function hG(e,n,o,c,p,y,w){if(o)return n.flags&256?(n.flags&=-257,c=dT(Error(It(422))),pv(e,n,w,c)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(y=c.fallback,p=n.mode,c=$1({mode:"visible",children:c.children},p,0,null),y=Wh(y,p,w,null),y.flags|=2,c.return=n,y.return=n,c.sibling=y,n.child=c,n.mode&1&&mp(n,e.child,null,w),n.child.memoizedState=HE(w),n.memoizedState=qE,y);if(!(n.mode&1))return pv(e,n,w,null);if(p.data==="$!"){if(c=p.nextSibling&&p.nextSibling.dataset,c)var E=c.dgst;return c=E,y=Error(It(419)),c=dT(y,c,void 0),pv(e,n,w,c)}if(E=(w&e.childLanes)!==0,ts||E){if(c=qi,c!==null){switch(w&-w){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=p&(c.suspendedLanes|w)?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,Ac(e,p),Ba(c,e,p,-1))}return WM(),c=dT(Error(It(421))),pv(e,n,w,c)}return p.data==="$?"?(n.flags|=128,n.child=e.child,n=TG.bind(null,e),p._reactRetry=n,null):(e=y.treeContext,Es=ku(p.nextSibling),Ms=n,Yn=!0,Ia=null,e!==null&&(Qs[ea++]=gc,Qs[ea++]=_c,Qs[ea++]=td,gc=e.id,_c=e.overflow,td=n),n=NM(n,c.children),n.flags|=4096,n)}function KR(e,n,o){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),jE(e.return,n,o)}function fT(e,n,o,c,p){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:p}:(y.isBackwards=n,y.rendering=null,y.renderingStartTime=0,y.last=c,y.tail=o,y.tailMode=p)}function wB(e,n,o){var c=n.pendingProps,p=c.revealOrder,y=c.tail;if(Do(e,n,c.children,o),c=ti.current,c&2)c=c&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&KR(e,o,n);else if(e.tag===19)KR(e,o,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(Vn(ti,c),!(n.mode&1))n.memoizedState=null;else switch(p){case"forwards":for(o=n.child,p=null;o!==null;)e=o.alternate,e!==null&&jx(e)===null&&(p=o),o=o.sibling;o=p,o===null?(p=n.child,n.child=null):(p=o.sibling,o.sibling=null),fT(n,!1,p,o,y);break;case"backwards":for(o=null,p=n.child,n.child=null;p!==null;){if(e=p.alternate,e!==null&&jx(e)===null){n.child=p;break}e=p.sibling,p.sibling=o,o=p,p=e}fT(n,!0,o,null,y);break;case"together":fT(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Xv(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function kc(e,n,o){if(e!==null&&(n.dependencies=e.dependencies),nd|=n.lanes,!(o&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(It(153));if(n.child!==null){for(e=n.child,o=Ru(e,e.pendingProps),n.child=o,o.return=n;e.sibling!==null;)e=e.sibling,o=o.sibling=Ru(e,e.pendingProps),o.return=n;o.sibling=null}return n.child}function dG(e,n,o){switch(n.tag){case 3:xB(n),pp();break;case 5:XO(n);break;case 1:is(n.type)&&Dx(n);break;case 4:IM(n,n.stateNode.containerInfo);break;case 10:var c=n.type._context,p=n.memoizedProps.value;Vn(Bx,c._currentValue),c._currentValue=p;break;case 13:if(c=n.memoizedState,c!==null)return c.dehydrated!==null?(Vn(ti,ti.current&1),n.flags|=128,null):o&n.child.childLanes?bB(e,n,o):(Vn(ti,ti.current&1),e=kc(e,n,o),e!==null?e.sibling:null);Vn(ti,ti.current&1);break;case 19:if(c=(o&n.childLanes)!==0,e.flags&128){if(c)return wB(e,n,o);n.flags|=128}if(p=n.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Vn(ti,ti.current),c)break;return null;case 22:case 23:return n.lanes=0,yB(e,n,o)}return kc(e,n,o)}var SB,ZE,TB,EB;SB=function(e,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};ZE=function(){};TB=function(e,n,o,c){var p=e.memoizedProps;if(p!==c){e=n.stateNode,jh(Ml.current);var y=null;switch(o){case"input":p=gE(e,p),c=gE(e,c),y=[];break;case"select":p=ii({},p,{value:void 0}),c=ii({},c,{value:void 0}),y=[];break;case"textarea":p=vE(e,p),c=vE(e,c),y=[];break;default:typeof p.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=zx)}bE(o,c);var w;o=null;for(P in p)if(!c.hasOwnProperty(P)&&p.hasOwnProperty(P)&&p[P]!=null)if(P==="style"){var E=p[P];for(w in E)E.hasOwnProperty(w)&&(o||(o={}),o[w]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(a_.hasOwnProperty(P)?y||(y=[]):(y=y||[]).push(P,null));for(P in c){var a=c[P];if(E=p!=null?p[P]:void 0,c.hasOwnProperty(P)&&a!==E&&(a!=null||E!=null))if(P==="style")if(E){for(w in E)!E.hasOwnProperty(w)||a&&a.hasOwnProperty(w)||(o||(o={}),o[w]="");for(w in a)a.hasOwnProperty(w)&&E[w]!==a[w]&&(o||(o={}),o[w]=a[w])}else o||(y||(y=[]),y.push(P,o)),o=a;else P==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,E=E?E.__html:void 0,a!=null&&E!==a&&(y=y||[]).push(P,a)):P==="children"?typeof a!="string"&&typeof a!="number"||(y=y||[]).push(P,""+a):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(a_.hasOwnProperty(P)?(a!=null&&P==="onScroll"&&qn("scroll",e),y||E===a||(y=[])):(y=y||[]).push(P,a))}o&&(y=y||[]).push("style",o);var P=y;(n.updateQueue=P)&&(n.flags|=4)}};EB=function(e,n,o,c){o!==c&&(n.flags|=4)};function fg(e,n){if(!Yn)switch(e.tailMode){case"hidden":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Eo(e){var n=e.alternate!==null&&e.alternate.child===e.child,o=0,c=0;if(n)for(var p=e.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags&14680064,c|=p.flags&14680064,p.return=e,p=p.sibling;else for(p=e.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=e,p=p.sibling;return e.subtreeFlags|=c,e.childLanes=o,n}function fG(e,n,o){var c=n.pendingProps;switch(TM(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Eo(n),null;case 1:return is(n.type)&&Rx(),Eo(n),null;case 3:return c=n.stateNode,gp(),Zn(ns),Zn(ko),RM(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(dv(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Ia!==null&&(rC(Ia),Ia=null))),ZE(e,n),Eo(n),null;case 5:zM(n);var p=jh(v_.current);if(o=n.type,e!==null&&n.stateNode!=null)TB(e,n,o,c,p),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!c){if(n.stateNode===null)throw Error(It(166));return Eo(n),null}if(e=jh(Ml.current),dv(n)){c=n.stateNode,o=n.type;var y=n.memoizedProps;switch(c[wl]=n,c[__]=y,e=(n.mode&1)!==0,o){case"dialog":qn("cancel",c),qn("close",c);break;case"iframe":case"object":case"embed":qn("load",c);break;case"video":case"audio":for(p=0;p<Mg.length;p++)qn(Mg[p],c);break;case"source":qn("error",c);break;case"img":case"image":case"link":qn("error",c),qn("load",c);break;case"details":qn("toggle",c);break;case"input":sR(c,y),qn("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!y.multiple},qn("invalid",c);break;case"textarea":lR(c,y),qn("invalid",c)}bE(o,y),p=null;for(var w in y)if(y.hasOwnProperty(w)){var E=y[w];w==="children"?typeof E=="string"?c.textContent!==E&&(y.suppressHydrationWarning!==!0&&hv(c.textContent,E,e),p=["children",E]):typeof E=="number"&&c.textContent!==""+E&&(y.suppressHydrationWarning!==!0&&hv(c.textContent,E,e),p=["children",""+E]):a_.hasOwnProperty(w)&&E!=null&&w==="onScroll"&&qn("scroll",c)}switch(o){case"input":nv(c),aR(c,y,!0);break;case"textarea":nv(c),cR(c);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(c.onclick=zx)}c=p,n.updateQueue=c,c!==null&&(n.flags|=4)}else{w=p.nodeType===9?p:p.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=JL(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=w.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=w.createElement(o,{is:c.is}):(e=w.createElement(o),o==="select"&&(w=e,c.multiple?w.multiple=!0:c.size&&(w.size=c.size))):e=w.createElementNS(e,o),e[wl]=n,e[__]=c,SB(e,n,!1,!1),n.stateNode=e;e:{switch(w=wE(o,c),o){case"dialog":qn("cancel",e),qn("close",e),p=c;break;case"iframe":case"object":case"embed":qn("load",e),p=c;break;case"video":case"audio":for(p=0;p<Mg.length;p++)qn(Mg[p],e);p=c;break;case"source":qn("error",e),p=c;break;case"img":case"image":case"link":qn("error",e),qn("load",e),p=c;break;case"details":qn("toggle",e),p=c;break;case"input":sR(e,c),p=gE(e,c),qn("invalid",e);break;case"option":p=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},p=ii({},c,{value:void 0}),qn("invalid",e);break;case"textarea":lR(e,c),p=vE(e,c),qn("invalid",e);break;default:p=c}bE(o,p),E=p;for(y in E)if(E.hasOwnProperty(y)){var a=E[y];y==="style"?tO(e,a):y==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&QL(e,a)):y==="children"?typeof a=="string"?(o!=="textarea"||a!=="")&&l_(e,a):typeof a=="number"&&l_(e,""+a):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a_.hasOwnProperty(y)?a!=null&&y==="onScroll"&&qn("scroll",e):a!=null&&cM(e,y,a,w))}switch(o){case"input":nv(e),aR(e,c,!1);break;case"textarea":nv(e),cR(e);break;case"option":c.value!=null&&e.setAttribute("value",""+Lu(c.value));break;case"select":e.multiple=!!c.multiple,y=c.value,y!=null?Kf(e,!!c.multiple,y,!1):c.defaultValue!=null&&Kf(e,!!c.multiple,c.defaultValue,!0);break;default:typeof p.onClick=="function"&&(e.onclick=zx)}switch(o){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Eo(n),null;case 6:if(e&&n.stateNode!=null)EB(e,n,e.memoizedProps,c);else{if(typeof c!="string"&&n.stateNode===null)throw Error(It(166));if(o=jh(v_.current),jh(Ml.current),dv(n)){if(c=n.stateNode,o=n.memoizedProps,c[wl]=n,(y=c.nodeValue!==o)&&(e=Ms,e!==null))switch(e.tag){case 3:hv(c.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hv(c.nodeValue,o,(e.mode&1)!==0)}y&&(n.flags|=4)}else c=(o.nodeType===9?o:o.ownerDocument).createTextNode(c),c[wl]=n,n.stateNode=c}return Eo(n),null;case 13:if(Zn(ti),c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Yn&&Es!==null&&n.mode&1&&!(n.flags&128))$O(),pp(),n.flags|=98560,y=!1;else if(y=dv(n),c!==null&&c.dehydrated!==null){if(e===null){if(!y)throw Error(It(318));if(y=n.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(It(317));y[wl]=n}else pp(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Eo(n),y=!1}else Ia!==null&&(rC(Ia),Ia=null),y=!0;if(!y)return n.flags&65536?n:null}return n.flags&128?(n.lanes=o,n):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(n.child.flags|=8192,n.mode&1&&(e===null||ti.current&1?Vi===0&&(Vi=3):WM())),n.updateQueue!==null&&(n.flags|=4),Eo(n),null);case 4:return gp(),ZE(e,n),e===null&&m_(n.stateNode.containerInfo),Eo(n),null;case 10:return AM(n.type._context),Eo(n),null;case 17:return is(n.type)&&Rx(),Eo(n),null;case 19:if(Zn(ti),y=n.memoizedState,y===null)return Eo(n),null;if(c=(n.flags&128)!==0,w=y.rendering,w===null)if(c)fg(y,!1);else{if(Vi!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(w=jx(e),w!==null){for(n.flags|=128,fg(y,!1),c=w.updateQueue,c!==null&&(n.updateQueue=c,n.flags|=4),n.subtreeFlags=0,c=o,o=n.child;o!==null;)y=o,e=c,y.flags&=14680066,w=y.alternate,w===null?(y.childLanes=0,y.lanes=e,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=w.childLanes,y.lanes=w.lanes,y.child=w.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=w.memoizedProps,y.memoizedState=w.memoizedState,y.updateQueue=w.updateQueue,y.type=w.type,e=w.dependencies,y.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return Vn(ti,ti.current&1|2),n.child}e=e.sibling}y.tail!==null&&xi()>yp&&(n.flags|=128,c=!0,fg(y,!1),n.lanes=4194304)}else{if(!c)if(e=jx(w),e!==null){if(n.flags|=128,c=!0,o=e.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),fg(y,!0),y.tail===null&&y.tailMode==="hidden"&&!w.alternate&&!Yn)return Eo(n),null}else 2*xi()-y.renderingStartTime>yp&&o!==1073741824&&(n.flags|=128,c=!0,fg(y,!1),n.lanes=4194304);y.isBackwards?(w.sibling=n.child,n.child=w):(o=y.last,o!==null?o.sibling=w:n.child=w,y.last=w)}return y.tail!==null?(n=y.tail,y.rendering=n,y.tail=n.sibling,y.renderingStartTime=xi(),n.sibling=null,o=ti.current,Vn(ti,c?o&1|2:o&1),n):(Eo(n),null);case 22:case 23:return GM(),c=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(n.flags|=8192),c&&n.mode&1?Ts&1073741824&&(Eo(n),n.subtreeFlags&6&&(n.flags|=8192)):Eo(n),null;case 24:return null;case 25:return null}throw Error(It(156,n.tag))}function pG(e,n){switch(TM(n),n.tag){case 1:return is(n.type)&&Rx(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return gp(),Zn(ns),Zn(ko),RM(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return zM(n),null;case 13:if(Zn(ti),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(It(340));pp()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Zn(ti),null;case 4:return gp(),null;case 10:return AM(n.type._context),null;case 22:case 23:return GM(),null;case 24:return null;default:return null}}var mv=!1,Ao=!1,mG=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function Of(e,n){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(c){ui(e,n,c)}else o.current=null}function XE(e,n,o){try{o()}catch(c){ui(e,n,c)}}var JR=!1;function gG(e,n){if(zE=kx,e=kO(),wM(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var w=0,E=-1,a=-1,P=0,D=0,L=e,F=null;t:for(;;){for(var $;L!==o||p!==0&&L.nodeType!==3||(E=w+p),L!==y||c!==0&&L.nodeType!==3||(a=w+c),L.nodeType===3&&(w+=L.nodeValue.length),($=L.firstChild)!==null;)F=L,L=$;for(;;){if(L===e)break t;if(F===o&&++P===p&&(E=w),F===y&&++D===c&&(a=w),($=L.nextSibling)!==null)break;L=F,F=L.parentNode}L=$}o=E===-1||a===-1?null:{start:E,end:a}}else o=null}o=o||{start:0,end:0}}else o=null;for(RE={focusedElem:e,selectionRange:o},kx=!1,Yt=n;Yt!==null;)if(n=Yt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,Yt=e;else for(;Yt!==null;){n=Yt;try{var H=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(H!==null){var q=H.memoizedProps,le=H.memoizedState,ie=n.stateNode,te=ie.getSnapshotBeforeUpdate(n.elementType===n.type?q:ka(n.type,q),le);ie.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var se=n.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(It(163))}}catch(be){ui(n,n.return,be)}if(e=n.sibling,e!==null){e.return=n.return,Yt=e;break}Yt=n.return}return H=JR,JR=!1,H}function Hg(e,n,o){var c=n.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var p=c=c.next;do{if((p.tag&e)===e){var y=p.destroy;p.destroy=void 0,y!==void 0&&XE(n,o,y)}p=p.next}while(p!==c)}}function j1(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var c=o.create;o.destroy=c()}o=o.next}while(o!==n)}}function YE(e){var n=e.ref;if(n!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof n=="function"?n(e):n.current=e}}function CB(e){var n=e.alternate;n!==null&&(e.alternate=null,CB(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[wl],delete n[__],delete n[OE],delete n[J9],delete n[Q9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function MB(e){return e.tag===5||e.tag===3||e.tag===4}function QR(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||MB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function KE(e,n,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(e,n):o.insertBefore(e,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(e,o)):(n=o,n.appendChild(e)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=zx));else if(c!==4&&(e=e.child,e!==null))for(KE(e,n,o),e=e.sibling;e!==null;)KE(e,n,o),e=e.sibling}function JE(e,n,o){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?o.insertBefore(e,n):o.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(JE(e,n,o),e=e.sibling;e!==null;)JE(e,n,o),e=e.sibling}var ro=null,Pa=!1;function hu(e,n,o){for(o=o.child;o!==null;)AB(e,n,o),o=o.sibling}function AB(e,n,o){if(Cl&&typeof Cl.onCommitFiberUnmount=="function")try{Cl.onCommitFiberUnmount(z1,o)}catch{}switch(o.tag){case 5:Ao||Of(o,n);case 6:var c=ro,p=Pa;ro=null,hu(e,n,o),ro=c,Pa=p,ro!==null&&(Pa?(e=ro,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):ro.removeChild(o.stateNode));break;case 18:ro!==null&&(Pa?(e=ro,o=o.stateNode,e.nodeType===8?sT(e.parentNode,o):e.nodeType===1&&sT(e,o),d_(e)):sT(ro,o.stateNode));break;case 4:c=ro,p=Pa,ro=o.stateNode.containerInfo,Pa=!0,hu(e,n,o),ro=c,Pa=p;break;case 0:case 11:case 14:case 15:if(!Ao&&(c=o.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){p=c=c.next;do{var y=p,w=y.destroy;y=y.tag,w!==void 0&&(y&2||y&4)&&XE(o,n,w),p=p.next}while(p!==c)}hu(e,n,o);break;case 1:if(!Ao&&(Of(o,n),c=o.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=o.memoizedProps,c.state=o.memoizedState,c.componentWillUnmount()}catch(E){ui(o,n,E)}hu(e,n,o);break;case 21:hu(e,n,o);break;case 22:o.mode&1?(Ao=(c=Ao)||o.memoizedState!==null,hu(e,n,o),Ao=c):hu(e,n,o);break;default:hu(e,n,o)}}function e4(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new mG),n.forEach(function(c){var p=EG.bind(null,e,c);o.has(c)||(o.add(c),c.then(p,p))})}}function Ma(e,n){var o=n.deletions;if(o!==null)for(var c=0;c<o.length;c++){var p=o[c];try{var y=e,w=n,E=w;e:for(;E!==null;){switch(E.tag){case 5:ro=E.stateNode,Pa=!1;break e;case 3:ro=E.stateNode.containerInfo,Pa=!0;break e;case 4:ro=E.stateNode.containerInfo,Pa=!0;break e}E=E.return}if(ro===null)throw Error(It(160));AB(y,w,p),ro=null,Pa=!1;var a=p.alternate;a!==null&&(a.return=null),p.return=null}catch(P){ui(p,n,P)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)kB(n,e),n=n.sibling}function kB(e,n){var o=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ma(n,e),ml(e),c&4){try{Hg(3,e,e.return),j1(3,e)}catch(q){ui(e,e.return,q)}try{Hg(5,e,e.return)}catch(q){ui(e,e.return,q)}}break;case 1:Ma(n,e),ml(e),c&512&&o!==null&&Of(o,o.return);break;case 5:if(Ma(n,e),ml(e),c&512&&o!==null&&Of(o,o.return),e.flags&32){var p=e.stateNode;try{l_(p,"")}catch(q){ui(e,e.return,q)}}if(c&4&&(p=e.stateNode,p!=null)){var y=e.memoizedProps,w=o!==null?o.memoizedProps:y,E=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{E==="input"&&y.type==="radio"&&y.name!=null&&YL(p,y),wE(E,w);var P=wE(E,y);for(w=0;w<a.length;w+=2){var D=a[w],L=a[w+1];D==="style"?tO(p,L):D==="dangerouslySetInnerHTML"?QL(p,L):D==="children"?l_(p,L):cM(p,D,L,P)}switch(E){case"input":_E(p,y);break;case"textarea":KL(p,y);break;case"select":var F=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var $=y.value;$!=null?Kf(p,!!y.multiple,$,!1):F!==!!y.multiple&&(y.defaultValue!=null?Kf(p,!!y.multiple,y.defaultValue,!0):Kf(p,!!y.multiple,y.multiple?[]:"",!1))}p[__]=y}catch(q){ui(e,e.return,q)}}break;case 6:if(Ma(n,e),ml(e),c&4){if(e.stateNode===null)throw Error(It(162));p=e.stateNode,y=e.memoizedProps;try{p.nodeValue=y}catch(q){ui(e,e.return,q)}}break;case 3:if(Ma(n,e),ml(e),c&4&&o!==null&&o.memoizedState.isDehydrated)try{d_(n.containerInfo)}catch(q){ui(e,e.return,q)}break;case 4:Ma(n,e),ml(e);break;case 13:Ma(n,e),ml(e),p=e.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||($M=xi())),c&4&&e4(e);break;case 22:if(D=o!==null&&o.memoizedState!==null,e.mode&1?(Ao=(P=Ao)||D,Ma(n,e),Ao=P):Ma(n,e),ml(e),c&8192){if(P=e.memoizedState!==null,(e.stateNode.isHidden=P)&&!D&&e.mode&1)for(Yt=e,D=e.child;D!==null;){for(L=Yt=D;Yt!==null;){switch(F=Yt,$=F.child,F.tag){case 0:case 11:case 14:case 15:Hg(4,F,F.return);break;case 1:Of(F,F.return);var H=F.stateNode;if(typeof H.componentWillUnmount=="function"){c=F,o=F.return;try{n=c,H.props=n.memoizedProps,H.state=n.memoizedState,H.componentWillUnmount()}catch(q){ui(c,o,q)}}break;case 5:Of(F,F.return);break;case 22:if(F.memoizedState!==null){r4(L);continue}}$!==null?($.return=F,Yt=$):r4(L)}D=D.sibling}e:for(D=null,L=e;;){if(L.tag===5){if(D===null){D=L;try{p=L.stateNode,P?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(E=L.stateNode,a=L.memoizedProps.style,w=a!=null&&a.hasOwnProperty("display")?a.display:null,E.style.display=eO("display",w))}catch(q){ui(e,e.return,q)}}}else if(L.tag===6){if(D===null)try{L.stateNode.nodeValue=P?"":L.memoizedProps}catch(q){ui(e,e.return,q)}}else if((L.tag!==22&&L.tag!==23||L.memoizedState===null||L===e)&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===e)break e;for(;L.sibling===null;){if(L.return===null||L.return===e)break e;D===L&&(D=null),L=L.return}D===L&&(D=null),L.sibling.return=L.return,L=L.sibling}}break;case 19:Ma(n,e),ml(e),c&4&&e4(e);break;case 21:break;default:Ma(n,e),ml(e)}}function ml(e){var n=e.flags;if(n&2){try{e:{for(var o=e.return;o!==null;){if(MB(o)){var c=o;break e}o=o.return}throw Error(It(160))}switch(c.tag){case 5:var p=c.stateNode;c.flags&32&&(l_(p,""),c.flags&=-33);var y=QR(e);JE(e,y,p);break;case 3:case 4:var w=c.stateNode.containerInfo,E=QR(e);KE(e,E,w);break;default:throw Error(It(161))}}catch(a){ui(e,e.return,a)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function _G(e,n,o){Yt=e,PB(e)}function PB(e,n,o){for(var c=(e.mode&1)!==0;Yt!==null;){var p=Yt,y=p.child;if(p.tag===22&&c){var w=p.memoizedState!==null||mv;if(!w){var E=p.alternate,a=E!==null&&E.memoizedState!==null||Ao;E=mv;var P=Ao;if(mv=w,(Ao=a)&&!P)for(Yt=p;Yt!==null;)w=Yt,a=w.child,w.tag===22&&w.memoizedState!==null?n4(p):a!==null?(a.return=w,Yt=a):n4(p);for(;y!==null;)Yt=y,PB(y),y=y.sibling;Yt=p,mv=E,Ao=P}t4(e)}else p.subtreeFlags&8772&&y!==null?(y.return=p,Yt=y):t4(e)}}function t4(e){for(;Yt!==null;){var n=Yt;if(n.flags&8772){var o=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Ao||j1(5,n);break;case 1:var c=n.stateNode;if(n.flags&4&&!Ao)if(o===null)c.componentDidMount();else{var p=n.elementType===n.type?o.memoizedProps:ka(n.type,o.memoizedProps);c.componentDidUpdate(p,o.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var y=n.updateQueue;y!==null&&FR(n,y,c);break;case 3:var w=n.updateQueue;if(w!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}FR(n,w,o)}break;case 5:var E=n.stateNode;if(o===null&&n.flags&4){o=E;var a=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&o.focus();break;case"img":a.src&&(o.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var P=n.alternate;if(P!==null){var D=P.memoizedState;if(D!==null){var L=D.dehydrated;L!==null&&d_(L)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(It(163))}Ao||n.flags&512&&YE(n)}catch(F){ui(n,n.return,F)}}if(n===e){Yt=null;break}if(o=n.sibling,o!==null){o.return=n.return,Yt=o;break}Yt=n.return}}function r4(e){for(;Yt!==null;){var n=Yt;if(n===e){Yt=null;break}var o=n.sibling;if(o!==null){o.return=n.return,Yt=o;break}Yt=n.return}}function n4(e){for(;Yt!==null;){var n=Yt;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{j1(4,n)}catch(a){ui(n,o,a)}break;case 1:var c=n.stateNode;if(typeof c.componentDidMount=="function"){var p=n.return;try{c.componentDidMount()}catch(a){ui(n,p,a)}}var y=n.return;try{YE(n)}catch(a){ui(n,y,a)}break;case 5:var w=n.return;try{YE(n)}catch(a){ui(n,w,a)}}}catch(a){ui(n,n.return,a)}if(n===e){Yt=null;break}var E=n.sibling;if(E!==null){E.return=n.return,Yt=E;break}Yt=n.return}}var yG=Math.ceil,Ux=Dc.ReactCurrentDispatcher,jM=Dc.ReactCurrentOwner,sa=Dc.ReactCurrentBatchConfig,ln=0,qi=null,ki=null,ao=0,Ts=0,Bf=Vu(0),Vi=0,S_=null,nd=0,V1=0,VM=0,Zg=null,Qo=null,$M=0,yp=1/0,dc=null,Gx=!1,QE=null,Iu=null,gv=!1,Su=null,Wx=0,Xg=0,eC=null,Yv=-1,Kv=0;function Oo(){return ln&6?xi():Yv!==-1?Yv:Yv=xi()}function zu(e){return e.mode&1?ln&2&&ao!==0?ao&-ao:tG.transition!==null?(Kv===0&&(Kv=fO()),Kv):(e=Mn,e!==0||(e=window.event,e=e===void 0?16:xO(e.type)),e):1}function Ba(e,n,o,c){if(50<Xg)throw Xg=0,eC=null,Error(It(185));W_(e,o,c),(!(ln&2)||e!==qi)&&(e===qi&&(!(ln&2)&&(V1|=o),Vi===4&&xu(e,ao)),os(e,c),o===1&&ln===0&&!(n.mode&1)&&(yp=xi()+500,B1&&$u()))}function os(e,n){var o=e.callbackNode;t9(e,n);var c=Ax(e,e===qi?ao:0);if(c===0)o!==null&&dR(o),e.callbackNode=null,e.callbackPriority=0;else if(n=c&-c,e.callbackPriority!==n){if(o!=null&&dR(o),n===1)e.tag===0?eG(i4.bind(null,e)):NO(i4.bind(null,e)),Y9(function(){!(ln&6)&&$u()}),o=null;else{switch(pO(c)){case 1:o=pM;break;case 4:o=hO;break;case 16:o=Mx;break;case 536870912:o=dO;break;default:o=Mx}o=FB(o,IB.bind(null,e))}e.callbackPriority=n,e.callbackNode=o}}function IB(e,n){if(Yv=-1,Kv=0,ln&6)throw Error(It(327));var o=e.callbackNode;if(rp()&&e.callbackNode!==o)return null;var c=Ax(e,e===qi?ao:0);if(c===0)return null;if(c&30||c&e.expiredLanes||n)n=qx(e,c);else{n=c;var p=ln;ln|=2;var y=RB();(qi!==e||ao!==n)&&(dc=null,yp=xi()+500,Gh(e,n));do try{bG();break}catch(E){zB(e,E)}while(!0);MM(),Ux.current=y,ln=p,ki!==null?n=0:(qi=null,ao=0,n=Vi)}if(n!==0){if(n===2&&(p=ME(e),p!==0&&(c=p,n=tC(e,p))),n===1)throw o=S_,Gh(e,0),xu(e,c),os(e,xi()),o;if(n===6)xu(e,c);else{if(p=e.current.alternate,!(c&30)&&!vG(p)&&(n=qx(e,c),n===2&&(y=ME(e),y!==0&&(c=y,n=tC(e,y))),n===1))throw o=S_,Gh(e,0),xu(e,c),os(e,xi()),o;switch(e.finishedWork=p,e.finishedLanes=c,n){case 0:case 1:throw Error(It(345));case 2:Ih(e,Qo,dc);break;case 3:if(xu(e,c),(c&130023424)===c&&(n=$M+500-xi(),10<n)){if(Ax(e,0)!==0)break;if(p=e.suspendedLanes,(p&c)!==c){Oo(),e.pingedLanes|=e.suspendedLanes&p;break}e.timeoutHandle=LE(Ih.bind(null,e,Qo,dc),n);break}Ih(e,Qo,dc);break;case 4:if(xu(e,c),(c&4194240)===c)break;for(n=e.eventTimes,p=-1;0<c;){var w=31-Oa(c);y=1<<w,w=n[w],w>p&&(p=w),c&=~y}if(c=p,c=xi()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*yG(c/1960))-c,10<c){e.timeoutHandle=LE(Ih.bind(null,e,Qo,dc),c);break}Ih(e,Qo,dc);break;case 5:Ih(e,Qo,dc);break;default:throw Error(It(329))}}}return os(e,xi()),e.callbackNode===o?IB.bind(null,e):null}function tC(e,n){var o=Zg;return e.current.memoizedState.isDehydrated&&(Gh(e,n).flags|=256),e=qx(e,n),e!==2&&(n=Qo,Qo=o,n!==null&&rC(n)),e}function rC(e){Qo===null?Qo=e:Qo.push.apply(Qo,e)}function vG(e){for(var n=e;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var c=0;c<o.length;c++){var p=o[c],y=p.getSnapshot;p=p.value;try{if(!Fa(y(),p))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function xu(e,n){for(n&=~VM,n&=~V1,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var o=31-Oa(n),c=1<<o;e[o]=-1,n&=~c}}function i4(e){if(ln&6)throw Error(It(327));rp();var n=Ax(e,0);if(!(n&1))return os(e,xi()),null;var o=qx(e,n);if(e.tag!==0&&o===2){var c=ME(e);c!==0&&(n=c,o=tC(e,c))}if(o===1)throw o=S_,Gh(e,0),xu(e,n),os(e,xi()),o;if(o===6)throw Error(It(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Ih(e,Qo,dc),os(e,xi()),null}function UM(e,n){var o=ln;ln|=1;try{return e(n)}finally{ln=o,ln===0&&(yp=xi()+500,B1&&$u())}}function id(e){Su!==null&&Su.tag===0&&!(ln&6)&&rp();var n=ln;ln|=1;var o=sa.transition,c=Mn;try{if(sa.transition=null,Mn=1,e)return e()}finally{Mn=c,sa.transition=o,ln=n,!(ln&6)&&$u()}}function GM(){Ts=Bf.current,Zn(Bf)}function Gh(e,n){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,X9(o)),ki!==null)for(o=ki.return;o!==null;){var c=o;switch(TM(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Rx();break;case 3:gp(),Zn(ns),Zn(ko),RM();break;case 5:zM(c);break;case 4:gp();break;case 13:Zn(ti);break;case 19:Zn(ti);break;case 10:AM(c.type._context);break;case 22:case 23:GM()}o=o.return}if(qi=e,ki=e=Ru(e.current,null),ao=Ts=n,Vi=0,S_=null,VM=V1=nd=0,Qo=Zg=null,Nh!==null){for(n=0;n<Nh.length;n++)if(o=Nh[n],c=o.interleaved,c!==null){o.interleaved=null;var p=c.next,y=o.pending;if(y!==null){var w=y.next;y.next=p,c.next=w}o.pending=c}Nh=null}return e}function zB(e,n){do{var o=ki;try{if(MM(),Hv.current=$x,Vx){for(var c=ni.memoizedState;c!==null;){var p=c.queue;p!==null&&(p.pending=null),c=c.next}Vx=!1}if(rd=0,Wi=ji=ni=null,qg=!1,x_=0,jM.current=null,o===null||o.return===null){Vi=1,S_=n,ki=null;break}e:{var y=e,w=o.return,E=o,a=n;if(n=ao,E.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var P=a,D=E,L=D.tag;if(!(D.mode&1)&&(L===0||L===11||L===15)){var F=D.alternate;F?(D.updateQueue=F.updateQueue,D.memoizedState=F.memoizedState,D.lanes=F.lanes):(D.updateQueue=null,D.memoizedState=null)}var $=WR(w);if($!==null){$.flags&=-257,qR($,w,E,y,n),$.mode&1&&GR(y,P,n),n=$,a=P;var H=n.updateQueue;if(H===null){var q=new Set;q.add(a),n.updateQueue=q}else H.add(a);break e}else{if(!(n&1)){GR(y,P,n),WM();break e}a=Error(It(426))}}else if(Yn&&E.mode&1){var le=WR(w);if(le!==null){!(le.flags&65536)&&(le.flags|=256),qR(le,w,E,y,n),EM(_p(a,E));break e}}y=a=_p(a,E),Vi!==4&&(Vi=2),Zg===null?Zg=[y]:Zg.push(y),y=w;do{switch(y.tag){case 3:y.flags|=65536,n&=-n,y.lanes|=n;var ie=mB(y,a,n);BR(y,ie);break e;case 1:E=a;var te=y.type,se=y.stateNode;if(!(y.flags&128)&&(typeof te.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(Iu===null||!Iu.has(se)))){y.flags|=65536,n&=-n,y.lanes|=n;var be=gB(y,E,n);BR(y,be);break e}}y=y.return}while(y!==null)}LB(o)}catch(Ee){n=Ee,ki===o&&o!==null&&(ki=o=o.return);continue}break}while(!0)}function RB(){var e=Ux.current;return Ux.current=$x,e===null?$x:e}function WM(){(Vi===0||Vi===3||Vi===2)&&(Vi=4),qi===null||!(nd&268435455)&&!(V1&268435455)||xu(qi,ao)}function qx(e,n){var o=ln;ln|=2;var c=RB();(qi!==e||ao!==n)&&(dc=null,Gh(e,n));do try{xG();break}catch(p){zB(e,p)}while(!0);if(MM(),ln=o,Ux.current=c,ki!==null)throw Error(It(261));return qi=null,ao=0,Vi}function xG(){for(;ki!==null;)DB(ki)}function bG(){for(;ki!==null&&!q7();)DB(ki)}function DB(e){var n=BB(e.alternate,e,Ts);e.memoizedProps=e.pendingProps,n===null?LB(e):ki=n,jM.current=null}function LB(e){var n=e;do{var o=n.alternate;if(e=n.return,n.flags&32768){if(o=pG(o,n),o!==null){o.flags&=32767,ki=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vi=6,ki=null;return}}else if(o=fG(o,n,Ts),o!==null){ki=o;return}if(n=n.sibling,n!==null){ki=n;return}ki=n=e}while(n!==null);Vi===0&&(Vi=5)}function Ih(e,n,o){var c=Mn,p=sa.transition;try{sa.transition=null,Mn=1,wG(e,n,o,c)}finally{sa.transition=p,Mn=c}return null}function wG(e,n,o,c){do rp();while(Su!==null);if(ln&6)throw Error(It(327));o=e.finishedWork;var p=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(It(177));e.callbackNode=null,e.callbackPriority=0;var y=o.lanes|o.childLanes;if(r9(e,y),e===qi&&(ki=qi=null,ao=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||gv||(gv=!0,FB(Mx,function(){return rp(),null})),y=(o.flags&15990)!==0,o.subtreeFlags&15990||y){y=sa.transition,sa.transition=null;var w=Mn;Mn=1;var E=ln;ln|=4,jM.current=null,gG(e,o),kB(o,e),$9(RE),kx=!!zE,RE=zE=null,e.current=o,_G(o),H7(),ln=E,Mn=w,sa.transition=y}else e.current=o;if(gv&&(gv=!1,Su=e,Wx=p),y=e.pendingLanes,y===0&&(Iu=null),Y7(o.stateNode),os(e,xi()),n!==null)for(c=e.onRecoverableError,o=0;o<n.length;o++)p=n[o],c(p.value,{componentStack:p.stack,digest:p.digest});if(Gx)throw Gx=!1,e=QE,QE=null,e;return Wx&1&&e.tag!==0&&rp(),y=e.pendingLanes,y&1?e===eC?Xg++:(Xg=0,eC=e):Xg=0,$u(),null}function rp(){if(Su!==null){var e=pO(Wx),n=sa.transition,o=Mn;try{if(sa.transition=null,Mn=16>e?16:e,Su===null)var c=!1;else{if(e=Su,Su=null,Wx=0,ln&6)throw Error(It(331));var p=ln;for(ln|=4,Yt=e.current;Yt!==null;){var y=Yt,w=y.child;if(Yt.flags&16){var E=y.deletions;if(E!==null){for(var a=0;a<E.length;a++){var P=E[a];for(Yt=P;Yt!==null;){var D=Yt;switch(D.tag){case 0:case 11:case 15:Hg(8,D,y)}var L=D.child;if(L!==null)L.return=D,Yt=L;else for(;Yt!==null;){D=Yt;var F=D.sibling,$=D.return;if(CB(D),D===P){Yt=null;break}if(F!==null){F.return=$,Yt=F;break}Yt=$}}}var H=y.alternate;if(H!==null){var q=H.child;if(q!==null){H.child=null;do{var le=q.sibling;q.sibling=null,q=le}while(q!==null)}}Yt=y}}if(y.subtreeFlags&2064&&w!==null)w.return=y,Yt=w;else e:for(;Yt!==null;){if(y=Yt,y.flags&2048)switch(y.tag){case 0:case 11:case 15:Hg(9,y,y.return)}var ie=y.sibling;if(ie!==null){ie.return=y.return,Yt=ie;break e}Yt=y.return}}var te=e.current;for(Yt=te;Yt!==null;){w=Yt;var se=w.child;if(w.subtreeFlags&2064&&se!==null)se.return=w,Yt=se;else e:for(w=te;Yt!==null;){if(E=Yt,E.flags&2048)try{switch(E.tag){case 0:case 11:case 15:j1(9,E)}}catch(Ee){ui(E,E.return,Ee)}if(E===w){Yt=null;break e}var be=E.sibling;if(be!==null){be.return=E.return,Yt=be;break e}Yt=E.return}}if(ln=p,$u(),Cl&&typeof Cl.onPostCommitFiberRoot=="function")try{Cl.onPostCommitFiberRoot(z1,e)}catch{}c=!0}return c}finally{Mn=o,sa.transition=n}}return!1}function o4(e,n,o){n=_p(o,n),n=mB(e,n,1),e=Pu(e,n,1),n=Oo(),e!==null&&(W_(e,1,n),os(e,n))}function ui(e,n,o){if(e.tag===3)o4(e,e,o);else for(;n!==null;){if(n.tag===3){o4(n,e,o);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Iu===null||!Iu.has(c))){e=_p(o,e),e=gB(n,e,1),n=Pu(n,e,1),e=Oo(),n!==null&&(W_(n,1,e),os(n,e));break}}n=n.return}}function SG(e,n,o){var c=e.pingCache;c!==null&&c.delete(n),n=Oo(),e.pingedLanes|=e.suspendedLanes&o,qi===e&&(ao&o)===o&&(Vi===4||Vi===3&&(ao&130023424)===ao&&500>xi()-$M?Gh(e,0):VM|=o),os(e,n)}function OB(e,n){n===0&&(e.mode&1?(n=sv,sv<<=1,!(sv&130023424)&&(sv=4194304)):n=1);var o=Oo();e=Ac(e,n),e!==null&&(W_(e,n,o),os(e,o))}function TG(e){var n=e.memoizedState,o=0;n!==null&&(o=n.retryLane),OB(e,o)}function EG(e,n){var o=0;switch(e.tag){case 13:var c=e.stateNode,p=e.memoizedState;p!==null&&(o=p.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(It(314))}c!==null&&c.delete(n),OB(e,o)}var BB;BB=function(e,n,o){if(e!==null)if(e.memoizedProps!==n.pendingProps||ns.current)ts=!0;else{if(!(e.lanes&o)&&!(n.flags&128))return ts=!1,dG(e,n,o);ts=!!(e.flags&131072)}else ts=!1,Yn&&n.flags&1048576&&jO(n,Ox,n.index);switch(n.lanes=0,n.tag){case 2:var c=n.type;Xv(e,n),e=n.pendingProps;var p=fp(n,ko.current);tp(n,o),p=LM(null,n,c,e,p,o);var y=OM();return n.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,is(c)?(y=!0,Dx(n)):y=!1,n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,PM(n),p.updater=F1,n.stateNode=p,p._reactInternals=n,$E(n,c,e,o),n=WE(null,n,c,!0,y,o)):(n.tag=0,Yn&&y&&SM(n),Do(null,n,p,o),n=n.child),n;case 16:c=n.elementType;e:{switch(Xv(e,n),e=n.pendingProps,p=c._init,c=p(c._payload),n.type=c,p=n.tag=MG(c),e=ka(c,e),p){case 0:n=GE(null,n,c,e,o);break e;case 1:n=XR(null,n,c,e,o);break e;case 11:n=HR(null,n,c,e,o);break e;case 14:n=ZR(null,n,c,ka(c.type,e),o);break e}throw Error(It(306,c,""))}return n;case 0:return c=n.type,p=n.pendingProps,p=n.elementType===c?p:ka(c,p),GE(e,n,c,p,o);case 1:return c=n.type,p=n.pendingProps,p=n.elementType===c?p:ka(c,p),XR(e,n,c,p,o);case 3:e:{if(xB(n),e===null)throw Error(It(387));c=n.pendingProps,y=n.memoizedState,p=y.element,GO(e,n),Nx(n,c,null,o);var w=n.memoizedState;if(c=w.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},n.updateQueue.baseState=y,n.memoizedState=y,n.flags&256){p=_p(Error(It(423)),n),n=YR(e,n,c,o,p);break e}else if(c!==p){p=_p(Error(It(424)),n),n=YR(e,n,c,o,p);break e}else for(Es=ku(n.stateNode.containerInfo.firstChild),Ms=n,Yn=!0,Ia=null,o=ZO(n,null,c,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(pp(),c===p){n=kc(e,n,o);break e}Do(e,n,c,o)}n=n.child}return n;case 5:return XO(n),e===null&&NE(n),c=n.type,p=n.pendingProps,y=e!==null?e.memoizedProps:null,w=p.children,DE(c,p)?w=null:y!==null&&DE(c,y)&&(n.flags|=32),vB(e,n),Do(e,n,w,o),n.child;case 6:return e===null&&NE(n),null;case 13:return bB(e,n,o);case 4:return IM(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=mp(n,null,c,o):Do(e,n,c,o),n.child;case 11:return c=n.type,p=n.pendingProps,p=n.elementType===c?p:ka(c,p),HR(e,n,c,p,o);case 7:return Do(e,n,n.pendingProps,o),n.child;case 8:return Do(e,n,n.pendingProps.children,o),n.child;case 12:return Do(e,n,n.pendingProps.children,o),n.child;case 10:e:{if(c=n.type._context,p=n.pendingProps,y=n.memoizedProps,w=p.value,Vn(Bx,c._currentValue),c._currentValue=w,y!==null)if(Fa(y.value,w)){if(y.children===p.children&&!ns.current){n=kc(e,n,o);break e}}else for(y=n.child,y!==null&&(y.return=n);y!==null;){var E=y.dependencies;if(E!==null){w=y.child;for(var a=E.firstContext;a!==null;){if(a.context===c){if(y.tag===1){a=xc(-1,o&-o),a.tag=2;var P=y.updateQueue;if(P!==null){P=P.shared;var D=P.pending;D===null?a.next=a:(a.next=D.next,D.next=a),P.pending=a}}y.lanes|=o,a=y.alternate,a!==null&&(a.lanes|=o),jE(y.return,o,n),E.lanes|=o;break}a=a.next}}else if(y.tag===10)w=y.type===n.type?null:y.child;else if(y.tag===18){if(w=y.return,w===null)throw Error(It(341));w.lanes|=o,E=w.alternate,E!==null&&(E.lanes|=o),jE(w,o,n),w=y.sibling}else w=y.child;if(w!==null)w.return=y;else for(w=y;w!==null;){if(w===n){w=null;break}if(y=w.sibling,y!==null){y.return=w.return,w=y;break}w=w.return}y=w}Do(e,n,p.children,o),n=n.child}return n;case 9:return p=n.type,c=n.pendingProps.children,tp(n,o),p=aa(p),c=c(p),n.flags|=1,Do(e,n,c,o),n.child;case 14:return c=n.type,p=ka(c,n.pendingProps),p=ka(c.type,p),ZR(e,n,c,p,o);case 15:return _B(e,n,n.type,n.pendingProps,o);case 17:return c=n.type,p=n.pendingProps,p=n.elementType===c?p:ka(c,p),Xv(e,n),n.tag=1,is(c)?(e=!0,Dx(n)):e=!1,tp(n,o),qO(n,c,p),$E(n,c,p,o),WE(null,n,c,!0,e,o);case 19:return wB(e,n,o);case 22:return yB(e,n,o)}throw Error(It(156,n.tag))};function FB(e,n){return uO(e,n)}function CG(e,n,o,c){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(e,n,o,c){return new CG(e,n,o,c)}function qM(e){return e=e.prototype,!(!e||!e.isReactComponent)}function MG(e){if(typeof e=="function")return qM(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hM)return 11;if(e===dM)return 14}return 2}function Ru(e,n){var o=e.alternate;return o===null?(o=oa(e.tag,n,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=n,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,n=e.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function Jv(e,n,o,c,p,y){var w=2;if(c=e,typeof e=="function")qM(e)&&(w=1);else if(typeof e=="string")w=5;else e:switch(e){case Mf:return Wh(o.children,p,y,n);case uM:w=8,p|=8;break;case dE:return e=oa(12,o,n,p|2),e.elementType=dE,e.lanes=y,e;case fE:return e=oa(13,o,n,p),e.elementType=fE,e.lanes=y,e;case pE:return e=oa(19,o,n,p),e.elementType=pE,e.lanes=y,e;case HL:return $1(o,p,y,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case WL:w=10;break e;case qL:w=9;break e;case hM:w=11;break e;case dM:w=14;break e;case gu:w=16,c=null;break e}throw Error(It(130,e==null?e:typeof e,""))}return n=oa(w,o,n,p),n.elementType=e,n.type=c,n.lanes=y,n}function Wh(e,n,o,c){return e=oa(7,e,c,n),e.lanes=o,e}function $1(e,n,o,c){return e=oa(22,e,c,n),e.elementType=HL,e.lanes=o,e.stateNode={isHidden:!1},e}function pT(e,n,o){return e=oa(6,e,null,n),e.lanes=o,e}function mT(e,n,o){return n=oa(4,e.children!==null?e.children:[],e.key,n),n.lanes=o,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function AG(e,n,o,c,p){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=XS(0),this.expirationTimes=XS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=XS(0),this.identifierPrefix=c,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function HM(e,n,o,c,p,y,w,E,a){return e=new AG(e,n,o,E,a),n===1?(n=1,y===!0&&(n|=8)):n=0,y=oa(3,null,null,n),e.current=y,y.stateNode=e,y.memoizedState={element:c,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},PM(y),e}function kG(e,n,o){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cf,key:c==null?null:""+c,children:e,containerInfo:n,implementation:o}}function NB(e){if(!e)return Ou;e=e._reactInternals;e:{if(dd(e)!==e||e.tag!==1)throw Error(It(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(is(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(It(171))}if(e.tag===1){var o=e.type;if(is(o))return FO(e,o,n)}return n}function jB(e,n,o,c,p,y,w,E,a){return e=HM(o,c,!0,e,p,y,w,E,a),e.context=NB(null),o=e.current,c=Oo(),p=zu(o),y=xc(c,p),y.callback=n??null,Pu(o,y,p),e.current.lanes=p,W_(e,p,c),os(e,c),e}function U1(e,n,o,c){var p=n.current,y=Oo(),w=zu(p);return o=NB(o),n.context===null?n.context=o:n.pendingContext=o,n=xc(y,w),n.payload={element:e},c=c===void 0?null:c,c!==null&&(n.callback=c),e=Pu(p,n,w),e!==null&&(Ba(e,p,w,y),qv(e,p,w)),w}function Hx(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function s4(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<n?o:n}}function ZM(e,n){s4(e,n),(e=e.alternate)&&s4(e,n)}function PG(){return null}var VB=typeof reportError=="function"?reportError:function(e){console.error(e)};function XM(e){this._internalRoot=e}G1.prototype.render=XM.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(It(409));U1(e,n,null,null)};G1.prototype.unmount=XM.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;id(function(){U1(null,e,null,null)}),n[Mc]=null}};function G1(e){this._internalRoot=e}G1.prototype.unstable_scheduleHydration=function(e){if(e){var n=_O();e={blockedOn:null,target:e,priority:n};for(var o=0;o<vu.length&&n!==0&&n<vu[o].priority;o++);vu.splice(o,0,e),o===0&&vO(e)}};function YM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function W1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function a4(){}function IG(e,n,o,c,p){if(p){if(typeof c=="function"){var y=c;c=function(){var P=Hx(w);y.call(P)}}var w=jB(n,c,e,0,null,!1,!1,"",a4);return e._reactRootContainer=w,e[Mc]=w.current,m_(e.nodeType===8?e.parentNode:e),id(),w}for(;p=e.lastChild;)e.removeChild(p);if(typeof c=="function"){var E=c;c=function(){var P=Hx(a);E.call(P)}}var a=HM(e,0,!1,null,null,!1,!1,"",a4);return e._reactRootContainer=a,e[Mc]=a.current,m_(e.nodeType===8?e.parentNode:e),id(function(){U1(n,a,o,c)}),a}function q1(e,n,o,c,p){var y=o._reactRootContainer;if(y){var w=y;if(typeof p=="function"){var E=p;p=function(){var a=Hx(w);E.call(a)}}U1(n,w,e,p)}else w=IG(o,n,e,p,c);return Hx(w)}mO=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var o=Cg(n.pendingLanes);o!==0&&(mM(n,o|1),os(n,xi()),!(ln&6)&&(yp=xi()+500,$u()))}break;case 13:id(function(){var c=Ac(e,1);if(c!==null){var p=Oo();Ba(c,e,1,p)}}),ZM(e,1)}};gM=function(e){if(e.tag===13){var n=Ac(e,134217728);if(n!==null){var o=Oo();Ba(n,e,134217728,o)}ZM(e,134217728)}};gO=function(e){if(e.tag===13){var n=zu(e),o=Ac(e,n);if(o!==null){var c=Oo();Ba(o,e,n,c)}ZM(e,n)}};_O=function(){return Mn};yO=function(e,n){var o=Mn;try{return Mn=e,n()}finally{Mn=o}};TE=function(e,n,o){switch(n){case"input":if(_E(e,o),n=o.name,o.type==="radio"&&n!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var c=o[n];if(c!==e&&c.form===e.form){var p=O1(c);if(!p)throw Error(It(90));XL(c),_E(c,p)}}}break;case"textarea":KL(e,o);break;case"select":n=o.value,n!=null&&Kf(e,!!o.multiple,n,!1)}};iO=UM;oO=id;var zG={usingClientEntryPoint:!1,Events:[H_,If,O1,rO,nO,UM]},pg={findFiberByHostInstance:Fh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},RG={bundleType:pg.bundleType,version:pg.version,rendererPackageName:pg.rendererPackageName,rendererConfig:pg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Dc.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=lO(e),e===null?null:e.stateNode},findFiberByHostInstance:pg.findFiberByHostInstance||PG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _v=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_v.isDisabled&&_v.supportsFiber)try{z1=_v.inject(RG),Cl=_v}catch{}}Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zG;Ds.createPortal=function(e,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!YM(n))throw Error(It(200));return kG(e,n,null,o)};Ds.createRoot=function(e,n){if(!YM(e))throw Error(It(299));var o=!1,c="",p=VB;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),n=HM(e,1,!1,null,null,o,!1,c,p),e[Mc]=n.current,m_(e.nodeType===8?e.parentNode:e),new XM(n)};Ds.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(It(188)):(e=Object.keys(e).join(","),Error(It(268,e)));return e=lO(n),e=e===null?null:e.stateNode,e};Ds.flushSync=function(e){return id(e)};Ds.hydrate=function(e,n,o){if(!W1(n))throw Error(It(200));return q1(null,e,n,!0,o)};Ds.hydrateRoot=function(e,n,o){if(!YM(e))throw Error(It(405));var c=o!=null&&o.hydratedSources||null,p=!1,y="",w=VB;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),n=jB(n,null,e,1,o??null,p,!1,y,w),e[Mc]=n.current,m_(e),c)for(e=0;e<c.length;e++)o=c[e],p=o._getVersion,p=p(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,p]:n.mutableSourceEagerHydrationData.push(o,p);return new G1(n)};Ds.render=function(e,n,o){if(!W1(n))throw Error(It(200));return q1(null,e,n,!1,o)};Ds.unmountComponentAtNode=function(e){if(!W1(e))throw Error(It(40));return e._reactRootContainer?(id(function(){q1(null,null,e,!1,function(){e._reactRootContainer=null,e[Mc]=null})}),!0):!1};Ds.unstable_batchedUpdates=UM;Ds.unstable_renderSubtreeIntoContainer=function(e,n,o,c){if(!W1(o))throw Error(It(200));if(e==null||e._reactInternals===void 0)throw Error(It(38));return q1(e,n,o,!1,c)};Ds.version="18.2.0-next-9e3b772b8-20220608";function $B(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($B)}catch(e){console.error(e)}}$B(),jL.exports=Ds;var KM=jL.exports,UB,l4=KM;UB=l4.createRoot,l4.hydrateRoot;/**
 * @remix-run/router v1.15.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T_(){return T_=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},T_.apply(this,arguments)}var Tu;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Tu||(Tu={}));const c4="popstate";function DG(e){e===void 0&&(e={});function n(c,p){let{pathname:y,search:w,hash:E}=c.location;return nC("",{pathname:y,search:w,hash:E},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function o(c,p){return typeof p=="string"?p:Zx(p)}return OG(n,o,null,e)}function Ii(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function GB(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function LG(){return Math.random().toString(36).substr(2,8)}function u4(e,n){return{usr:e.state,key:e.key,idx:n}}function nC(e,n,o,c){return o===void 0&&(o=null),T_({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?Ip(n):n,{state:o,key:n&&n.key||c||LG()})}function Zx(e){let{pathname:n="/",search:o="",hash:c=""}=e;return o&&o!=="?"&&(n+=o.charAt(0)==="?"?o:"?"+o),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function Ip(e){let n={};if(e){let o=e.indexOf("#");o>=0&&(n.hash=e.substr(o),e=e.substr(0,o));let c=e.indexOf("?");c>=0&&(n.search=e.substr(c),e=e.substr(0,c)),e&&(n.pathname=e)}return n}function OG(e,n,o,c){c===void 0&&(c={});let{window:p=document.defaultView,v5Compat:y=!1}=c,w=p.history,E=Tu.Pop,a=null,P=D();P==null&&(P=0,w.replaceState(T_({},w.state,{idx:P}),""));function D(){return(w.state||{idx:null}).idx}function L(){E=Tu.Pop;let le=D(),ie=le==null?null:le-P;P=le,a&&a({action:E,location:q.location,delta:ie})}function F(le,ie){E=Tu.Push;let te=nC(q.location,le,ie);o&&o(te,le),P=D()+1;let se=u4(te,P),be=q.createHref(te);try{w.pushState(se,"",be)}catch(Ee){if(Ee instanceof DOMException&&Ee.name==="DataCloneError")throw Ee;p.location.assign(be)}y&&a&&a({action:E,location:q.location,delta:1})}function $(le,ie){E=Tu.Replace;let te=nC(q.location,le,ie);o&&o(te,le),P=D();let se=u4(te,P),be=q.createHref(te);w.replaceState(se,"",be),y&&a&&a({action:E,location:q.location,delta:0})}function H(le){let ie=p.location.origin!=="null"?p.location.origin:p.location.href,te=typeof le=="string"?le:Zx(le);return te=te.replace(/ $/,"%20"),Ii(ie,"No window.location.(origin|href) available to create URL for href: "+te),new URL(te,ie)}let q={get action(){return E},get location(){return e(p,w)},listen(le){if(a)throw new Error("A history only accepts one active listener");return p.addEventListener(c4,L),a=le,()=>{p.removeEventListener(c4,L),a=null}},createHref(le){return n(p,le)},createURL:H,encodeLocation(le){let ie=H(le);return{pathname:ie.pathname,search:ie.search,hash:ie.hash}},push:F,replace:$,go(le){return w.go(le)}};return q}var h4;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(h4||(h4={}));function BG(e,n,o){o===void 0&&(o="/");let c=typeof n=="string"?Ip(n):n,p=JM(c.pathname||"/",o);if(p==null)return null;let y=WB(e);FG(y);let w=null;for(let E=0;w==null&&E<y.length;++E){let a=YG(p);w=HG(y[E],a)}return w}function WB(e,n,o,c){n===void 0&&(n=[]),o===void 0&&(o=[]),c===void 0&&(c="");let p=(y,w,E)=>{let a={relativePath:E===void 0?y.path||"":E,caseSensitive:y.caseSensitive===!0,childrenIndex:w,route:y};a.relativePath.startsWith("/")&&(Ii(a.relativePath.startsWith(c),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(c.length));let P=Du([c,a.relativePath]),D=o.concat(a);y.children&&y.children.length>0&&(Ii(y.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+P+'".')),WB(y.children,n,D,P)),!(y.path==null&&!y.index)&&n.push({path:P,score:WG(P,y.index),routesMeta:D})};return e.forEach((y,w)=>{var E;if(y.path===""||!((E=y.path)!=null&&E.includes("?")))p(y,w);else for(let a of qB(y.path))p(y,w,a)}),n}function qB(e){let n=e.split("/");if(n.length===0)return[];let[o,...c]=n,p=o.endsWith("?"),y=o.replace(/\?$/,"");if(c.length===0)return p?[y,""]:[y];let w=qB(c.join("/")),E=[];return E.push(...w.map(a=>a===""?y:[y,a].join("/"))),p&&E.push(...w),E.map(a=>e.startsWith("/")&&a===""?"/":a)}function FG(e){e.sort((n,o)=>n.score!==o.score?o.score-n.score:qG(n.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}const NG=/^:[\w-]+$/,jG=3,VG=2,$G=1,UG=10,GG=-2,d4=e=>e==="*";function WG(e,n){let o=e.split("/"),c=o.length;return o.some(d4)&&(c+=GG),n&&(c+=VG),o.filter(p=>!d4(p)).reduce((p,y)=>p+(NG.test(y)?jG:y===""?$G:UG),c)}function qG(e,n){return e.length===n.length&&e.slice(0,-1).every((c,p)=>c===n[p])?e[e.length-1]-n[n.length-1]:0}function HG(e,n){let{routesMeta:o}=e,c={},p="/",y=[];for(let w=0;w<o.length;++w){let E=o[w],a=w===o.length-1,P=p==="/"?n:n.slice(p.length)||"/",D=ZG({path:E.relativePath,caseSensitive:E.caseSensitive,end:a},P);if(!D)return null;Object.assign(c,D.params);let L=E.route;y.push({params:c,pathname:Du([p,D.pathname]),pathnameBase:eW(Du([p,D.pathnameBase])),route:L}),D.pathnameBase!=="/"&&(p=Du([p,D.pathnameBase]))}return y}function ZG(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,c]=XG(e.path,e.caseSensitive,e.end),p=n.match(o);if(!p)return null;let y=p[0],w=y.replace(/(.)\/+$/,"$1"),E=p.slice(1);return{params:c.reduce((P,D,L)=>{let{paramName:F,isOptional:$}=D;if(F==="*"){let q=E[L]||"";w=y.slice(0,y.length-q.length).replace(/(.)\/+$/,"$1")}const H=E[L];return $&&!H?P[F]=void 0:P[F]=(H||"").replace(/%2F/g,"/"),P},{}),pathname:y,pathnameBase:w,pattern:e}}function XG(e,n,o){n===void 0&&(n=!1),o===void 0&&(o=!0),GB(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let c=[],p="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(w,E,a)=>(c.push({paramName:E,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(c.push({paramName:"*"}),p+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?p+="\\/*$":e!==""&&e!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,n?void 0:"i"),c]}function YG(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return GB(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function JM(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let o=n.endsWith("/")?n.length-1:n.length,c=e.charAt(o);return c&&c!=="/"?null:e.slice(o)||"/"}function KG(e,n){n===void 0&&(n="/");let{pathname:o,search:c="",hash:p=""}=typeof e=="string"?Ip(e):e;return{pathname:o?o.startsWith("/")?o:JG(o,n):n,search:tW(c),hash:rW(p)}}function JG(e,n){let o=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(p=>{p===".."?o.length>1&&o.pop():p!=="."&&o.push(p)}),o.length>1?o.join("/"):"/"}function gT(e,n,o,c){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QG(e){return e.filter((n,o)=>o===0||n.route.path&&n.route.path.length>0)}function HB(e,n){let o=QG(e);return n?o.map((c,p)=>p===e.length-1?c.pathname:c.pathnameBase):o.map(c=>c.pathnameBase)}function ZB(e,n,o,c){c===void 0&&(c=!1);let p;typeof e=="string"?p=Ip(e):(p=T_({},e),Ii(!p.pathname||!p.pathname.includes("?"),gT("?","pathname","search",p)),Ii(!p.pathname||!p.pathname.includes("#"),gT("#","pathname","hash",p)),Ii(!p.search||!p.search.includes("#"),gT("#","search","hash",p)));let y=e===""||p.pathname==="",w=y?"/":p.pathname,E;if(w==null)E=o;else{let L=n.length-1;if(!c&&w.startsWith("..")){let F=w.split("/");for(;F[0]==="..";)F.shift(),L-=1;p.pathname=F.join("/")}E=L>=0?n[L]:"/"}let a=KG(p,E),P=w&&w!=="/"&&w.endsWith("/"),D=(y||w===".")&&o.endsWith("/");return!a.pathname.endsWith("/")&&(P||D)&&(a.pathname+="/"),a}const Du=e=>e.join("/").replace(/\/\/+/g,"/"),eW=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),tW=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,rW=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function nW(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const XB=["post","put","patch","delete"];new Set(XB);const iW=["get",...XB];new Set(iW);/**
 * React Router v6.22.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function E_(){return E_=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},E_.apply(this,arguments)}const QM=re.createContext(null),oW=re.createContext(null),fd=re.createContext(null),H1=re.createContext(null),pd=re.createContext({outlet:null,matches:[],isDataRoute:!1}),YB=re.createContext(null);function sW(e,n){let{relative:o}=n===void 0?{}:n;X_()||Ii(!1);let{basename:c,navigator:p}=re.useContext(fd),{hash:y,pathname:w,search:E}=JB(e,{relative:o}),a=w;return c!=="/"&&(a=w==="/"?c:Du([c,w])),p.createHref({pathname:a,search:E,hash:y})}function X_(){return re.useContext(H1)!=null}function Z1(){return X_()||Ii(!1),re.useContext(H1).location}function KB(e){re.useContext(fd).static||re.useLayoutEffect(e)}function aW(){let{isDataRoute:e}=re.useContext(pd);return e?xW():lW()}function lW(){X_()||Ii(!1);let e=re.useContext(QM),{basename:n,future:o,navigator:c}=re.useContext(fd),{matches:p}=re.useContext(pd),{pathname:y}=Z1(),w=JSON.stringify(HB(p,o.v7_relativeSplatPath)),E=re.useRef(!1);return KB(()=>{E.current=!0}),re.useCallback(function(P,D){if(D===void 0&&(D={}),!E.current)return;if(typeof P=="number"){c.go(P);return}let L=ZB(P,JSON.parse(w),y,D.relative==="path");e==null&&n!=="/"&&(L.pathname=L.pathname==="/"?n:Du([n,L.pathname])),(D.replace?c.replace:c.push)(L,D.state,D)},[n,c,w,y,e])}function JB(e,n){let{relative:o}=n===void 0?{}:n,{future:c}=re.useContext(fd),{matches:p}=re.useContext(pd),{pathname:y}=Z1(),w=JSON.stringify(HB(p,c.v7_relativeSplatPath));return re.useMemo(()=>ZB(e,JSON.parse(w),y,o==="path"),[e,w,y,o])}function cW(e,n){return uW(e,n)}function uW(e,n,o,c){X_()||Ii(!1);let{navigator:p}=re.useContext(fd),{matches:y}=re.useContext(pd),w=y[y.length-1],E=w?w.params:{};w&&w.pathname;let a=w?w.pathnameBase:"/";w&&w.route;let P=Z1(),D;if(n){var L;let le=typeof n=="string"?Ip(n):n;a==="/"||(L=le.pathname)!=null&&L.startsWith(a)||Ii(!1),D=le}else D=P;let F=D.pathname||"/",$=F;if(a!=="/"){let le=a.replace(/^\//,"").split("/");$="/"+F.replace(/^\//,"").split("/").slice(le.length).join("/")}let H=BG(e,{pathname:$}),q=mW(H&&H.map(le=>Object.assign({},le,{params:Object.assign({},E,le.params),pathname:Du([a,p.encodeLocation?p.encodeLocation(le.pathname).pathname:le.pathname]),pathnameBase:le.pathnameBase==="/"?a:Du([a,p.encodeLocation?p.encodeLocation(le.pathnameBase).pathname:le.pathnameBase])})),y,o,c);return n&&q?re.createElement(H1.Provider,{value:{location:E_({pathname:"/",search:"",hash:"",state:null,key:"default"},D),navigationType:Tu.Pop}},q):q}function hW(){let e=vW(),n=nW(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,p={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},n),o?re.createElement("pre",{style:p},o):null,null)}const dW=re.createElement(hW,null);class fW extends re.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,o){return o.location!==n.location||o.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:o.error,location:o.location,revalidation:n.revalidation||o.revalidation}}componentDidCatch(n,o){console.error("React Router caught the following error during render",n,o)}render(){return this.state.error!==void 0?re.createElement(pd.Provider,{value:this.props.routeContext},re.createElement(YB.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pW(e){let{routeContext:n,match:o,children:c}=e,p=re.useContext(QM);return p&&p.static&&p.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=o.route.id),re.createElement(pd.Provider,{value:n},c)}function mW(e,n,o,c){var p;if(n===void 0&&(n=[]),o===void 0&&(o=null),c===void 0&&(c=null),e==null){var y;if((y=o)!=null&&y.errors)e=o.matches;else return null}let w=e,E=(p=o)==null?void 0:p.errors;if(E!=null){let D=w.findIndex(L=>L.route.id&&(E==null?void 0:E[L.route.id]));D>=0||Ii(!1),w=w.slice(0,Math.min(w.length,D+1))}let a=!1,P=-1;if(o&&c&&c.v7_partialHydration)for(let D=0;D<w.length;D++){let L=w[D];if((L.route.HydrateFallback||L.route.hydrateFallbackElement)&&(P=D),L.route.id){let{loaderData:F,errors:$}=o,H=L.route.loader&&F[L.route.id]===void 0&&(!$||$[L.route.id]===void 0);if(L.route.lazy||H){a=!0,P>=0?w=w.slice(0,P+1):w=[w[0]];break}}}return w.reduceRight((D,L,F)=>{let $,H=!1,q=null,le=null;o&&($=E&&L.route.id?E[L.route.id]:void 0,q=L.route.errorElement||dW,a&&(P<0&&F===0?(bW("route-fallback",!1),H=!0,le=null):P===F&&(H=!0,le=L.route.hydrateFallbackElement||null)));let ie=n.concat(w.slice(0,F+1)),te=()=>{let se;return $?se=q:H?se=le:L.route.Component?se=re.createElement(L.route.Component,null):L.route.element?se=L.route.element:se=D,re.createElement(pW,{match:L,routeContext:{outlet:D,matches:ie,isDataRoute:o!=null},children:se})};return o&&(L.route.ErrorBoundary||L.route.errorElement||F===0)?re.createElement(fW,{location:o.location,revalidation:o.revalidation,component:q,error:$,children:te(),routeContext:{outlet:null,matches:ie,isDataRoute:!0}}):te()},null)}var QB=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(QB||{}),Xx=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Xx||{});function gW(e){let n=re.useContext(QM);return n||Ii(!1),n}function _W(e){let n=re.useContext(oW);return n||Ii(!1),n}function yW(e){let n=re.useContext(pd);return n||Ii(!1),n}function eF(e){let n=yW(),o=n.matches[n.matches.length-1];return o.route.id||Ii(!1),o.route.id}function vW(){var e;let n=re.useContext(YB),o=_W(Xx.UseRouteError),c=eF(Xx.UseRouteError);return n!==void 0?n:(e=o.errors)==null?void 0:e[c]}function xW(){let{router:e}=gW(QB.UseNavigateStable),n=eF(Xx.UseNavigateStable),o=re.useRef(!1);return KB(()=>{o.current=!0}),re.useCallback(function(p,y){y===void 0&&(y={}),o.current&&(typeof p=="number"?e.navigate(p):e.navigate(p,E_({fromRouteId:n},y)))},[e,n])}const f4={};function bW(e,n,o){!n&&!f4[e]&&(f4[e]=!0)}function Qv(e){Ii(!1)}function wW(e){let{basename:n="/",children:o=null,location:c,navigationType:p=Tu.Pop,navigator:y,static:w=!1,future:E}=e;X_()&&Ii(!1);let a=n.replace(/^\/*/,"/"),P=re.useMemo(()=>({basename:a,navigator:y,static:w,future:E_({v7_relativeSplatPath:!1},E)}),[a,E,y,w]);typeof c=="string"&&(c=Ip(c));let{pathname:D="/",search:L="",hash:F="",state:$=null,key:H="default"}=c,q=re.useMemo(()=>{let le=JM(D,a);return le==null?null:{location:{pathname:le,search:L,hash:F,state:$,key:H},navigationType:p}},[a,D,L,F,$,H,p]);return q==null?null:re.createElement(fd.Provider,{value:P},re.createElement(H1.Provider,{children:o,value:q}))}function SW(e){let{children:n,location:o}=e;return cW(iC(n),o)}new Promise(()=>{});function iC(e,n){n===void 0&&(n=[]);let o=[];return re.Children.forEach(e,(c,p)=>{if(!re.isValidElement(c))return;let y=[...n,p];if(c.type===re.Fragment){o.push.apply(o,iC(c.props.children,y));return}c.type!==Qv&&Ii(!1),!c.props.index||!c.props.children||Ii(!1);let w={id:c.props.id||y.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(w.children=iC(c.props.children,y)),o.push(w)}),o}/**
 * React Router DOM v6.22.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oC(){return oC=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},oC.apply(this,arguments)}function TW(e,n){if(e==null)return{};var o={},c=Object.keys(e),p,y;for(y=0;y<c.length;y++)p=c[y],!(n.indexOf(p)>=0)&&(o[p]=e[p]);return o}function EW(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function CW(e,n){return e.button===0&&(!n||n==="_self")&&!EW(e)}const MW=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],AW="6";try{window.__reactRouterVersion=AW}catch{}const kW="startTransition",p4=uE[kW];function PW(e){let{basename:n,children:o,future:c,window:p}=e,y=re.useRef();y.current==null&&(y.current=DG({window:p,v5Compat:!0}));let w=y.current,[E,a]=re.useState({action:w.action,location:w.location}),{v7_startTransition:P}=c||{},D=re.useCallback(L=>{P&&p4?p4(()=>a(L)):a(L)},[a,P]);return re.useLayoutEffect(()=>w.listen(D),[w,D]),re.createElement(wW,{basename:n,children:o,location:E.location,navigationType:E.action,navigator:w,future:c})}const IW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_T=re.forwardRef(function(n,o){let{onClick:c,relative:p,reloadDocument:y,replace:w,state:E,target:a,to:P,preventScrollReset:D,unstable_viewTransition:L}=n,F=TW(n,MW),{basename:$}=re.useContext(fd),H,q=!1;if(typeof P=="string"&&zW.test(P)&&(H=P,IW))try{let se=new URL(window.location.href),be=P.startsWith("//")?new URL(se.protocol+P):new URL(P),Ee=JM(be.pathname,$);be.origin===se.origin&&Ee!=null?P=Ee+be.search+be.hash:q=!0}catch{}let le=sW(P,{relative:p}),ie=RW(P,{replace:w,state:E,target:a,preventScrollReset:D,relative:p,unstable_viewTransition:L});function te(se){c&&c(se),se.defaultPrevented||ie(se)}return re.createElement("a",oC({},F,{href:H||le,onClick:q||y?c:te,ref:o,target:a}))});var m4;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(m4||(m4={}));var g4;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(g4||(g4={}));function RW(e,n){let{target:o,replace:c,state:p,preventScrollReset:y,relative:w,unstable_viewTransition:E}=n===void 0?{}:n,a=aW(),P=Z1(),D=JB(e,{relative:w});return re.useCallback(L=>{if(CW(L,o)){L.preventDefault();let F=c!==void 0?c:Zx(P)===Zx(D);a(e,{replace:F,state:p,preventScrollReset:y,relative:w,unstable_viewTransition:E})}},[P,a,D,c,p,o,e,y,w,E])}function DW(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function LW(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var OW=function(){function e(o){var c=this;this._insertTag=function(p){var y;c.tags.length===0?c.insertionPoint?y=c.insertionPoint.nextSibling:c.prepend?y=c.container.firstChild:y=c.before:y=c.tags[c.tags.length-1].nextSibling,c.container.insertBefore(p,y),c.tags.push(p)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(c){c.forEach(this._insertTag)},n.insert=function(c){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(LW(this));var p=this.tags[this.tags.length-1];if(this.isSpeedy){var y=DW(p);try{y.insertRule(c,y.cssRules.length)}catch{}}else p.appendChild(document.createTextNode(c));this.ctr++},n.flush=function(){this.tags.forEach(function(c){return c.parentNode&&c.parentNode.removeChild(c)}),this.tags=[],this.ctr=0},e}(),Co="-ms-",Yx="-moz-",gn="-webkit-",tF="comm",eA="rule",tA="decl",BW="@import",rF="@keyframes",FW="@layer",NW=Math.abs,X1=String.fromCharCode,jW=Object.assign;function VW(e,n){return oo(e,0)^45?(((n<<2^oo(e,0))<<2^oo(e,1))<<2^oo(e,2))<<2^oo(e,3):0}function nF(e){return e.trim()}function $W(e,n){return(e=n.exec(e))?e[0]:e}function _n(e,n,o){return e.replace(n,o)}function sC(e,n){return e.indexOf(n)}function oo(e,n){return e.charCodeAt(n)|0}function C_(e,n,o){return e.slice(n,o)}function xl(e){return e.length}function rA(e){return e.length}function yv(e,n){return n.push(e),e}function UW(e,n){return e.map(n).join("")}var Y1=1,vp=1,iF=0,ss=0,Ai=0,zp="";function K1(e,n,o,c,p,y,w){return{value:e,root:n,parent:o,type:c,props:p,children:y,line:Y1,column:vp,length:w,return:""}}function mg(e,n){return jW(K1("",null,null,"",null,null,0),e,{length:-e.length},n)}function GW(){return Ai}function WW(){return Ai=ss>0?oo(zp,--ss):0,vp--,Ai===10&&(vp=1,Y1--),Ai}function As(){return Ai=ss<iF?oo(zp,ss++):0,vp++,Ai===10&&(vp=1,Y1++),Ai}function Al(){return oo(zp,ss)}function ex(){return ss}function Y_(e,n){return C_(zp,e,n)}function M_(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function oF(e){return Y1=vp=1,iF=xl(zp=e),ss=0,[]}function sF(e){return zp="",e}function tx(e){return nF(Y_(ss-1,aC(e===91?e+2:e===40?e+1:e)))}function qW(e){for(;(Ai=Al())&&Ai<33;)As();return M_(e)>2||M_(Ai)>3?"":" "}function HW(e,n){for(;--n&&As()&&!(Ai<48||Ai>102||Ai>57&&Ai<65||Ai>70&&Ai<97););return Y_(e,ex()+(n<6&&Al()==32&&As()==32))}function aC(e){for(;As();)switch(Ai){case e:return ss;case 34:case 39:e!==34&&e!==39&&aC(Ai);break;case 40:e===41&&aC(e);break;case 92:As();break}return ss}function ZW(e,n){for(;As()&&e+Ai!==57;)if(e+Ai===84&&Al()===47)break;return"/*"+Y_(n,ss-1)+"*"+X1(e===47?e:As())}function XW(e){for(;!M_(Al());)As();return Y_(e,ss)}function YW(e){return sF(rx("",null,null,null,[""],e=oF(e),0,[0],e))}function rx(e,n,o,c,p,y,w,E,a){for(var P=0,D=0,L=w,F=0,$=0,H=0,q=1,le=1,ie=1,te=0,se="",be=p,Ee=y,je=c,Be=se;le;)switch(H=te,te=As()){case 40:if(H!=108&&oo(Be,L-1)==58){sC(Be+=_n(tx(te),"&","&\f"),"&\f")!=-1&&(ie=-1);break}case 34:case 39:case 91:Be+=tx(te);break;case 9:case 10:case 13:case 32:Be+=qW(H);break;case 92:Be+=HW(ex()-1,7);continue;case 47:switch(Al()){case 42:case 47:yv(KW(ZW(As(),ex()),n,o),a);break;default:Be+="/"}break;case 123*q:E[P++]=xl(Be)*ie;case 125*q:case 59:case 0:switch(te){case 0:case 125:le=0;case 59+D:ie==-1&&(Be=_n(Be,/\f/g,"")),$>0&&xl(Be)-L&&yv($>32?y4(Be+";",c,o,L-1):y4(_n(Be," ","")+";",c,o,L-2),a);break;case 59:Be+=";";default:if(yv(je=_4(Be,n,o,P,D,p,E,se,be=[],Ee=[],L),y),te===123)if(D===0)rx(Be,n,je,je,be,y,L,E,Ee);else switch(F===99&&oo(Be,3)===110?100:F){case 100:case 108:case 109:case 115:rx(e,je,je,c&&yv(_4(e,je,je,0,0,p,E,se,p,be=[],L),Ee),p,Ee,L,E,c?be:Ee);break;default:rx(Be,je,je,je,[""],Ee,0,E,Ee)}}P=D=$=0,q=ie=1,se=Be="",L=w;break;case 58:L=1+xl(Be),$=H;default:if(q<1){if(te==123)--q;else if(te==125&&q++==0&&WW()==125)continue}switch(Be+=X1(te),te*q){case 38:ie=D>0?1:(Be+="\f",-1);break;case 44:E[P++]=(xl(Be)-1)*ie,ie=1;break;case 64:Al()===45&&(Be+=tx(As())),F=Al(),D=L=xl(se=Be+=XW(ex())),te++;break;case 45:H===45&&xl(Be)==2&&(q=0)}}return y}function _4(e,n,o,c,p,y,w,E,a,P,D){for(var L=p-1,F=p===0?y:[""],$=rA(F),H=0,q=0,le=0;H<c;++H)for(var ie=0,te=C_(e,L+1,L=NW(q=w[H])),se=e;ie<$;++ie)(se=nF(q>0?F[ie]+" "+te:_n(te,/&\f/g,F[ie])))&&(a[le++]=se);return K1(e,n,o,p===0?eA:E,a,P,D)}function KW(e,n,o){return K1(e,n,o,tF,X1(GW()),C_(e,2,-2),0)}function y4(e,n,o,c){return K1(e,n,o,tA,C_(e,0,c),C_(e,c+1,-1),c)}function np(e,n){for(var o="",c=rA(e),p=0;p<c;p++)o+=n(e[p],p,e,n)||"";return o}function JW(e,n,o,c){switch(e.type){case FW:if(e.children.length)break;case BW:case tA:return e.return=e.return||e.value;case tF:return"";case rF:return e.return=e.value+"{"+np(e.children,c)+"}";case eA:e.value=e.props.join(",")}return xl(o=np(e.children,c))?e.return=e.value+"{"+o+"}":""}function QW(e){var n=rA(e);return function(o,c,p,y){for(var w="",E=0;E<n;E++)w+=e[E](o,c,p,y)||"";return w}}function eq(e){return function(n){n.root||(n=n.return)&&e(n)}}var v4=function(n){var o=new WeakMap;return function(c){if(o.has(c))return o.get(c);var p=n(c);return o.set(c,p),p}};function aF(e){var n=Object.create(null);return function(o){return n[o]===void 0&&(n[o]=e(o)),n[o]}}var tq=function(n,o,c){for(var p=0,y=0;p=y,y=Al(),p===38&&y===12&&(o[c]=1),!M_(y);)As();return Y_(n,ss)},rq=function(n,o){var c=-1,p=44;do switch(M_(p)){case 0:p===38&&Al()===12&&(o[c]=1),n[c]+=tq(ss-1,o,c);break;case 2:n[c]+=tx(p);break;case 4:if(p===44){n[++c]=Al()===58?"&\f":"",o[c]=n[c].length;break}default:n[c]+=X1(p)}while(p=As());return n},nq=function(n,o){return sF(rq(oF(n),o))},x4=new WeakMap,iq=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var o=n.value,c=n.parent,p=n.column===c.column&&n.line===c.line;c.type!=="rule";)if(c=c.parent,!c)return;if(!(n.props.length===1&&o.charCodeAt(0)!==58&&!x4.get(c))&&!p){x4.set(n,!0);for(var y=[],w=nq(o,y),E=c.props,a=0,P=0;a<w.length;a++)for(var D=0;D<E.length;D++,P++)n.props[P]=y[a]?w[a].replace(/&\f/g,E[D]):E[D]+" "+w[a]}}},oq=function(n){if(n.type==="decl"){var o=n.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(n.return="",n.value="")}};function lF(e,n){switch(VW(e,n)){case 5103:return gn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return gn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return gn+e+Yx+e+Co+e+e;case 6828:case 4268:return gn+e+Co+e+e;case 6165:return gn+e+Co+"flex-"+e+e;case 5187:return gn+e+_n(e,/(\w+).+(:[^]+)/,gn+"box-$1$2"+Co+"flex-$1$2")+e;case 5443:return gn+e+Co+"flex-item-"+_n(e,/flex-|-self/,"")+e;case 4675:return gn+e+Co+"flex-line-pack"+_n(e,/align-content|flex-|-self/,"")+e;case 5548:return gn+e+Co+_n(e,"shrink","negative")+e;case 5292:return gn+e+Co+_n(e,"basis","preferred-size")+e;case 6060:return gn+"box-"+_n(e,"-grow","")+gn+e+Co+_n(e,"grow","positive")+e;case 4554:return gn+_n(e,/([^-])(transform)/g,"$1"+gn+"$2")+e;case 6187:return _n(_n(_n(e,/(zoom-|grab)/,gn+"$1"),/(image-set)/,gn+"$1"),e,"")+e;case 5495:case 3959:return _n(e,/(image-set\([^]*)/,gn+"$1$`$1");case 4968:return _n(_n(e,/(.+:)(flex-)?(.*)/,gn+"box-pack:$3"+Co+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+gn+e+e;case 4095:case 3583:case 4068:case 2532:return _n(e,/(.+)-inline(.+)/,gn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xl(e)-1-n>6)switch(oo(e,n+1)){case 109:if(oo(e,n+4)!==45)break;case 102:return _n(e,/(.+:)(.+)-([^]+)/,"$1"+gn+"$2-$3$1"+Yx+(oo(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~sC(e,"stretch")?lF(_n(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(oo(e,n+1)!==115)break;case 6444:switch(oo(e,xl(e)-3-(~sC(e,"!important")&&10))){case 107:return _n(e,":",":"+gn)+e;case 101:return _n(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+gn+(oo(e,14)===45?"inline-":"")+"box$3$1"+gn+"$2$3$1"+Co+"$2box$3")+e}break;case 5936:switch(oo(e,n+11)){case 114:return gn+e+Co+_n(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return gn+e+Co+_n(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return gn+e+Co+_n(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return gn+e+Co+e+e}return e}var sq=function(n,o,c,p){if(n.length>-1&&!n.return)switch(n.type){case tA:n.return=lF(n.value,n.length);break;case rF:return np([mg(n,{value:_n(n.value,"@","@"+gn)})],p);case eA:if(n.length)return UW(n.props,function(y){switch($W(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return np([mg(n,{props:[_n(y,/:(read-\w+)/,":"+Yx+"$1")]})],p);case"::placeholder":return np([mg(n,{props:[_n(y,/:(plac\w+)/,":"+gn+"input-$1")]}),mg(n,{props:[_n(y,/:(plac\w+)/,":"+Yx+"$1")]}),mg(n,{props:[_n(y,/:(plac\w+)/,Co+"input-$1")]})],p)}return""})}},aq=[sq],lq=function(n){var o=n.key;if(o==="css"){var c=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(c,function(q){var le=q.getAttribute("data-emotion");le.indexOf(" ")!==-1&&(document.head.appendChild(q),q.setAttribute("data-s",""))})}var p=n.stylisPlugins||aq,y={},w,E=[];w=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(q){for(var le=q.getAttribute("data-emotion").split(" "),ie=1;ie<le.length;ie++)y[le[ie]]=!0;E.push(q)});var a,P=[iq,oq];{var D,L=[JW,eq(function(q){D.insert(q)})],F=QW(P.concat(p,L)),$=function(le){return np(YW(le),F)};a=function(le,ie,te,se){D=te,$(le?le+"{"+ie.styles+"}":ie.styles),se&&(H.inserted[ie.name]=!0)}}var H={key:o,sheet:new OW({key:o,container:w,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:y,registered:{},insert:a};return H.sheet.hydrate(E),H};function od(){return od=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},od.apply(this,arguments)}var cF={exports:{}},An={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hi=typeof Symbol=="function"&&Symbol.for,nA=Hi?Symbol.for("react.element"):60103,iA=Hi?Symbol.for("react.portal"):60106,J1=Hi?Symbol.for("react.fragment"):60107,Q1=Hi?Symbol.for("react.strict_mode"):60108,eb=Hi?Symbol.for("react.profiler"):60114,tb=Hi?Symbol.for("react.provider"):60109,rb=Hi?Symbol.for("react.context"):60110,oA=Hi?Symbol.for("react.async_mode"):60111,nb=Hi?Symbol.for("react.concurrent_mode"):60111,ib=Hi?Symbol.for("react.forward_ref"):60112,ob=Hi?Symbol.for("react.suspense"):60113,cq=Hi?Symbol.for("react.suspense_list"):60120,sb=Hi?Symbol.for("react.memo"):60115,ab=Hi?Symbol.for("react.lazy"):60116,uq=Hi?Symbol.for("react.block"):60121,hq=Hi?Symbol.for("react.fundamental"):60117,dq=Hi?Symbol.for("react.responder"):60118,fq=Hi?Symbol.for("react.scope"):60119;function Os(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case nA:switch(e=e.type,e){case oA:case nb:case J1:case eb:case Q1:case ob:return e;default:switch(e=e&&e.$$typeof,e){case rb:case ib:case ab:case sb:case tb:return e;default:return n}}case iA:return n}}}function uF(e){return Os(e)===nb}An.AsyncMode=oA;An.ConcurrentMode=nb;An.ContextConsumer=rb;An.ContextProvider=tb;An.Element=nA;An.ForwardRef=ib;An.Fragment=J1;An.Lazy=ab;An.Memo=sb;An.Portal=iA;An.Profiler=eb;An.StrictMode=Q1;An.Suspense=ob;An.isAsyncMode=function(e){return uF(e)||Os(e)===oA};An.isConcurrentMode=uF;An.isContextConsumer=function(e){return Os(e)===rb};An.isContextProvider=function(e){return Os(e)===tb};An.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===nA};An.isForwardRef=function(e){return Os(e)===ib};An.isFragment=function(e){return Os(e)===J1};An.isLazy=function(e){return Os(e)===ab};An.isMemo=function(e){return Os(e)===sb};An.isPortal=function(e){return Os(e)===iA};An.isProfiler=function(e){return Os(e)===eb};An.isStrictMode=function(e){return Os(e)===Q1};An.isSuspense=function(e){return Os(e)===ob};An.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===J1||e===nb||e===eb||e===Q1||e===ob||e===cq||typeof e=="object"&&e!==null&&(e.$$typeof===ab||e.$$typeof===sb||e.$$typeof===tb||e.$$typeof===rb||e.$$typeof===ib||e.$$typeof===hq||e.$$typeof===dq||e.$$typeof===fq||e.$$typeof===uq)};An.typeOf=Os;cF.exports=An;var pq=cF.exports,hF=pq,mq={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},gq={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},dF={};dF[hF.ForwardRef]=mq;dF[hF.Memo]=gq;var _q=!0;function yq(e,n,o){var c="";return o.split(" ").forEach(function(p){e[p]!==void 0?n.push(e[p]+";"):c+=p+" "}),c}var fF=function(n,o,c){var p=n.key+"-"+o.name;(c===!1||_q===!1)&&n.registered[p]===void 0&&(n.registered[p]=o.styles)},pF=function(n,o,c){fF(n,o,c);var p=n.key+"-"+o.name;if(n.inserted[o.name]===void 0){var y=o;do n.insert(o===y?"."+p:"",y,n.sheet,!0),y=y.next;while(y!==void 0)}};function vq(e){for(var n=0,o,c=0,p=e.length;p>=4;++c,p-=4)o=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,n=(o&65535)*1540483477+((o>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(p){case 3:n^=(e.charCodeAt(c+2)&255)<<16;case 2:n^=(e.charCodeAt(c+1)&255)<<8;case 1:n^=e.charCodeAt(c)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var xq={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},bq=/[A-Z]|^ms/g,wq=/_EMO_([^_]+?)_([^]*?)_EMO_/g,mF=function(n){return n.charCodeAt(1)===45},b4=function(n){return n!=null&&typeof n!="boolean"},yT=aF(function(e){return mF(e)?e:e.replace(bq,"-$&").toLowerCase()}),w4=function(n,o){switch(n){case"animation":case"animationName":if(typeof o=="string")return o.replace(wq,function(c,p,y){return bl={name:p,styles:y,next:bl},p})}return xq[n]!==1&&!mF(n)&&typeof o=="number"&&o!==0?o+"px":o};function A_(e,n,o){if(o==null)return"";if(o.__emotion_styles!==void 0)return o;switch(typeof o){case"boolean":return"";case"object":{if(o.anim===1)return bl={name:o.name,styles:o.styles,next:bl},o.name;if(o.styles!==void 0){var c=o.next;if(c!==void 0)for(;c!==void 0;)bl={name:c.name,styles:c.styles,next:bl},c=c.next;var p=o.styles+";";return p}return Sq(e,n,o)}case"function":{if(e!==void 0){var y=bl,w=o(e);return bl=y,A_(e,n,w)}break}}if(n==null)return o;var E=n[o];return E!==void 0?E:o}function Sq(e,n,o){var c="";if(Array.isArray(o))for(var p=0;p<o.length;p++)c+=A_(e,n,o[p])+";";else for(var y in o){var w=o[y];if(typeof w!="object")n!=null&&n[w]!==void 0?c+=y+"{"+n[w]+"}":b4(w)&&(c+=yT(y)+":"+w4(y,w)+";");else if(Array.isArray(w)&&typeof w[0]=="string"&&(n==null||n[w[0]]===void 0))for(var E=0;E<w.length;E++)b4(w[E])&&(c+=yT(y)+":"+w4(y,w[E])+";");else{var a=A_(e,n,w);switch(y){case"animation":case"animationName":{c+=yT(y)+":"+a+";";break}default:c+=y+"{"+a+"}"}}}return c}var S4=/label:\s*([^\s;\n{]+)\s*(;|$)/g,bl,sA=function(n,o,c){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var p=!0,y="";bl=void 0;var w=n[0];w==null||w.raw===void 0?(p=!1,y+=A_(c,o,w)):y+=w[0];for(var E=1;E<n.length;E++)y+=A_(c,o,n[E]),p&&(y+=w[E]);S4.lastIndex=0;for(var a="",P;(P=S4.exec(y))!==null;)a+="-"+P[1];var D=vq(y)+a;return{name:D,styles:y,next:bl}},Tq=function(n){return n()},gF=uE.useInsertionEffect?uE.useInsertionEffect:!1,Eq=gF||Tq,T4=gF||re.useLayoutEffect,_F=re.createContext(typeof HTMLElement<"u"?lq({key:"css"}):null);_F.Provider;var yF=function(n){return re.forwardRef(function(o,c){var p=re.useContext(_F);return n(o,p,c)})},k_=re.createContext({}),Cq=function(n,o){if(typeof o=="function"){var c=o(n);return c}return od({},n,o)},Mq=v4(function(e){return v4(function(n){return Cq(e,n)})}),Aq=function(n){var o=re.useContext(k_);return n.theme!==o&&(o=Mq(o)(n.theme)),re.createElement(k_.Provider,{value:o},n.children)},lb=yF(function(e,n){var o=e.styles,c=sA([o],void 0,re.useContext(k_)),p=re.useRef();return T4(function(){var y=n.key+"-global",w=new n.sheet.constructor({key:y,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),E=!1,a=document.querySelector('style[data-emotion="'+y+" "+c.name+'"]');return n.sheet.tags.length&&(w.before=n.sheet.tags[0]),a!==null&&(E=!0,a.setAttribute("data-emotion",y),w.hydrate([a])),p.current=[w,E],function(){w.flush()}},[n]),T4(function(){var y=p.current,w=y[0],E=y[1];if(E){y[1]=!1;return}if(c.next!==void 0&&pF(n,c.next,!0),w.tags.length){var a=w.tags[w.tags.length-1].nextElementSibling;w.before=a,w.flush()}n.insert("",c,w,!1)},[n,c.name]),null});function kq(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return sA(n)}var Pq=function(){var n=kq.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},vF=String.raw,xF=vF`
  :root,
  :host {
    --chakra-vh: 100vh;
  }

  @supports (height: -webkit-fill-available) {
    :root,
    :host {
      --chakra-vh: -webkit-fill-available;
    }
  }

  @supports (height: -moz-fill-available) {
    :root,
    :host {
      --chakra-vh: -moz-fill-available;
    }
  }

  @supports (height: 100dvh) {
    :root,
    :host {
      --chakra-vh: 100dvh;
    }
  }
`,Iq=()=>Q.jsx(lb,{styles:xF}),zq=({scope:e=""})=>Q.jsx(lb,{styles:vF`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      body {
        position: relative;
        min-height: 100%;
        margin: 0;
        font-feature-settings: "kern";
      }

      ${e} :where(*, *::before, *::after) {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
        word-wrap: break-word;
      }

      main {
        display: block;
      }

      ${e} hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      ${e} :where(pre, code, kbd,samp) {
        font-family: SFMono-Regular, Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      ${e} a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      ${e} abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      ${e} :where(b, strong) {
        font-weight: bold;
      }

      ${e} small {
        font-size: 80%;
      }

      ${e} :where(sub,sup) {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      ${e} sub {
        bottom: -0.25em;
      }

      ${e} sup {
        top: -0.5em;
      }

      ${e} img {
        border-style: none;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      ${e} :where(button, input) {
        overflow: visible;
      }

      ${e} :where(button, select) {
        text-transform: none;
      }

      ${e} :where(
          button::-moz-focus-inner,
          [type="button"]::-moz-focus-inner,
          [type="reset"]::-moz-focus-inner,
          [type="submit"]::-moz-focus-inner
        ) {
        border-style: none;
        padding: 0;
      }

      ${e} fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      ${e} legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      ${e} progress {
        vertical-align: baseline;
      }

      ${e} textarea {
        overflow: auto;
      }

      ${e} :where([type="checkbox"], [type="radio"]) {
        box-sizing: border-box;
        padding: 0;
      }

      ${e} input[type="number"]::-webkit-inner-spin-button,
      ${e} input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      ${e} input[type="number"] {
        -moz-appearance: textfield;
      }

      ${e} input[type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      ${e} input[type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ${e} ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      ${e} details {
        display: block;
      }

      ${e} summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      ${e} :where(
          blockquote,
          dl,
          dd,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          hr,
          figure,
          p,
          pre
        ) {
        margin: 0;
      }

      ${e} button {
        background: transparent;
        padding: 0;
      }

      ${e} fieldset {
        margin: 0;
        padding: 0;
      }

      ${e} :where(ol, ul) {
        margin: 0;
        padding: 0;
      }

      ${e} textarea {
        resize: vertical;
      }

      ${e} :where(button, [role="button"]) {
        cursor: pointer;
      }

      ${e} button::-moz-focus-inner {
        border: 0 !important;
      }

      ${e} table {
        border-collapse: collapse;
      }

      ${e} :where(h1, h2, h3, h4, h5, h6) {
        font-size: inherit;
        font-weight: inherit;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      ${e} :where(img, svg, video, canvas, audio, iframe, embed, object) {
        display: block;
      }

      ${e} :where(img, video) {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible]
        :focus:not([data-focus-visible-added]):not(
          [data-focus-visible-disabled]
        ) {
        outline: none;
        box-shadow: none;
      }

      ${e} select::-ms-expand {
        display: none;
      }

      ${xF}
    `});function Rq(e,n){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${n}`}function co(e={}){const{name:n,strict:o=!0,hookName:c="useContext",providerName:p="Provider",errorMessage:y,defaultValue:w}=e,E=re.createContext(w);E.displayName=n;function a(){var P;const D=re.useContext(E);if(!D&&o){const L=new Error(y??Rq(c,p));throw L.name="ContextError",(P=Error.captureStackTrace)==null||P.call(Error,L,a),L}return D}return[E.Provider,a,E]}var[Dq,Lq]=co({strict:!1,name:"PortalManagerContext"});function bF(e){const{children:n,zIndex:o}=e;return Q.jsx(Dq,{value:{zIndex:o},children:n})}bF.displayName="PortalManager";var P_=globalThis!=null&&globalThis.document?re.useLayoutEffect:re.useEffect,[wF,Oq]=co({strict:!1,name:"PortalContext"}),aA="chakra-portal",Bq=".chakra-portal",Fq=e=>Q.jsx("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0},children:e.children}),Nq=e=>{const{appendToParentPortal:n,children:o}=e,[c,p]=re.useState(null),y=re.useRef(null),[,w]=re.useState({});re.useEffect(()=>w({}),[]);const E=Oq(),a=Lq();P_(()=>{if(!c)return;const D=c.ownerDocument,L=n?E??D.body:D.body;if(!L)return;y.current=D.createElement("div"),y.current.className=aA,L.appendChild(y.current),w({});const F=y.current;return()=>{L.contains(F)&&L.removeChild(F)}},[c]);const P=a!=null&&a.zIndex?Q.jsx(Fq,{zIndex:a==null?void 0:a.zIndex,children:o}):o;return y.current?KM.createPortal(Q.jsx(wF,{value:y.current,children:P}),y.current):Q.jsx("span",{ref:D=>{D&&p(D)}})},jq=e=>{const{children:n,containerRef:o,appendToParentPortal:c}=e,p=o.current,y=p??(typeof window<"u"?document.body:void 0),w=re.useMemo(()=>{const a=p==null?void 0:p.ownerDocument.createElement("div");return a&&(a.className=aA),a},[p]),[,E]=re.useState({});return P_(()=>E({}),[]),P_(()=>{if(!(!w||!y))return y.appendChild(w),()=>{y.removeChild(w)}},[w,y]),y&&w?KM.createPortal(Q.jsx(wF,{value:c?w:null,children:n}),w):null};function K_(e){const n={appendToParentPortal:!0,...e},{containerRef:o,...c}=n;return o?Q.jsx(jq,{containerRef:o,...c}):Q.jsx(Nq,{...c})}K_.className=aA;K_.selector=Bq;K_.displayName="Portal";function Vq(){const e=re.useContext(k_);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var lA=re.createContext({});lA.displayName="ColorModeContext";function cb(){const e=re.useContext(lA);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e}function gl(e,n){const{colorMode:o}=cb();return o==="dark"?n:e}var vv={light:"chakra-ui-light",dark:"chakra-ui-dark"};function $q(e={}){const{preventTransition:n=!0}=e,o={setDataset:c=>{const p=n?o.preventTransition():void 0;document.documentElement.dataset.theme=c,document.documentElement.style.colorScheme=c,p==null||p()},setClassName(c){document.body.classList.add(c?vv.dark:vv.light),document.body.classList.remove(c?vv.light:vv.dark)},query(){return window.matchMedia("(prefers-color-scheme: dark)")},getSystemTheme(c){var p;return((p=o.query().matches)!=null?p:c==="dark")?"dark":"light"},addListener(c){const p=o.query(),y=w=>{c(w.matches?"dark":"light")};return typeof p.addListener=="function"?p.addListener(y):p.addEventListener("change",y),()=>{typeof p.removeListener=="function"?p.removeListener(y):p.removeEventListener("change",y)}},preventTransition(){const c=document.createElement("style");return c.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(c),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(c)})})}}};return o}var Uq="chakra-ui-color-mode";function Gq(e){return{ssr:!1,type:"localStorage",get(n){if(!(globalThis!=null&&globalThis.document))return n;let o;try{o=localStorage.getItem(e)||n}catch{}return o||n},set(n){try{localStorage.setItem(e,n)}catch{}}}}var Wq=Gq(Uq),E4=()=>{};function C4(e,n){return e.type==="cookie"&&e.ssr?e.get(n):n}function SF(e){const{value:n,children:o,options:{useSystemColorMode:c,initialColorMode:p,disableTransitionOnChange:y}={},colorModeManager:w=Wq}=e,E=p==="dark"?"dark":"light",[a,P]=re.useState(()=>C4(w,E)),[D,L]=re.useState(()=>C4(w)),{getSystemTheme:F,setClassName:$,setDataset:H,addListener:q}=re.useMemo(()=>$q({preventTransition:y}),[y]),le=p==="system"&&!a?D:a,ie=re.useCallback(be=>{const Ee=be==="system"?F():be;P(Ee),$(Ee==="dark"),H(Ee),w.set(Ee)},[w,F,$,H]);P_(()=>{p==="system"&&L(F())},[]),re.useEffect(()=>{const be=w.get();if(be){ie(be);return}if(p==="system"){ie("system");return}ie(E)},[w,E,p,ie]);const te=re.useCallback(()=>{ie(le==="dark"?"light":"dark")},[le,ie]);re.useEffect(()=>{if(c)return q(ie)},[c,q,ie]);const se=re.useMemo(()=>({colorMode:n??le,toggleColorMode:n?E4:te,setColorMode:n?E4:ie,forced:n!==void 0}),[le,te,ie,n]);return Q.jsx(lA.Provider,{value:se,children:o})}SF.displayName="ColorModeProvider";function qq(){const e=cb(),n=Vq();return{...e,theme:n}}var Kr=(...e)=>e.filter(Boolean).join(" ");function Hq(){return!1}function ks(e){const n=typeof e;return e!=null&&(n==="object"||n==="function")&&!Array.isArray(e)}var J_=e=>{const{condition:n,message:o}=e;n&&Hq()&&console.warn(o)};function Eu(e,...n){return Zq(e)?e(...n):e}var Zq=e=>typeof e=="function",On=e=>e?"":void 0,ip=e=>e?!0:void 0;function vi(...e){return function(o){e.some(c=>(c==null||c(o),o==null?void 0:o.defaultPrevented))}}function Xq(...e){return function(o){e.forEach(c=>{c==null||c(o)})}}var Kx={exports:{}};Kx.exports;(function(e,n){var o=200,c="__lodash_hash_undefined__",p=800,y=16,w=9007199254740991,E="[object Arguments]",a="[object Array]",P="[object AsyncFunction]",D="[object Boolean]",L="[object Date]",F="[object Error]",$="[object Function]",H="[object GeneratorFunction]",q="[object Map]",le="[object Number]",ie="[object Null]",te="[object Object]",se="[object Proxy]",be="[object RegExp]",Ee="[object Set]",je="[object String]",Be="[object Undefined]",Ze="[object WeakMap]",ht="[object ArrayBuffer]",Pe="[object DataView]",Et="[object Float32Array]",or="[object Float64Array]",st="[object Int8Array]",ar="[object Int16Array]",Bn="[object Int32Array]",Mr="[object Uint8Array]",xn="[object Uint8ClampedArray]",Ot="[object Uint16Array]",ct="[object Uint32Array]",Jt=/[\\^$.*+?()[\]{}|]/g,qt=/^\[object .+?Constructor\]$/,_r=/^(?:0|[1-9]\d*)$/,wr={};wr[Et]=wr[or]=wr[st]=wr[ar]=wr[Bn]=wr[Mr]=wr[xn]=wr[Ot]=wr[ct]=!0,wr[E]=wr[a]=wr[ht]=wr[D]=wr[Pe]=wr[L]=wr[F]=wr[$]=wr[q]=wr[le]=wr[te]=wr[be]=wr[Ee]=wr[je]=wr[Ze]=!1;var Lr=typeof Sg=="object"&&Sg&&Sg.Object===Object&&Sg,wi=typeof self=="object"&&self&&self.Object===Object&&self,sn=Lr||wi||Function("return this")(),Xn=n&&!n.nodeType&&n,Si=Xn&&!0&&e&&!e.nodeType&&e,uo=Si&&Si.exports===Xn,Ti=uo&&Lr.process,Tr=function(){try{var ye=Si&&Si.require&&Si.require("util").types;return ye||Ti&&Ti.binding&&Ti.binding("util")}catch{}}(),oi=Tr&&Tr.isTypedArray;function cs(ye,Re,Ve){switch(Ve.length){case 0:return ye.call(Re);case 1:return ye.call(Re,Ve[0]);case 2:return ye.call(Re,Ve[0],Ve[1]);case 3:return ye.call(Re,Ve[0],Ve[1],Ve[2])}return ye.apply(Re,Ve)}function Zi(ye,Re){for(var Ve=-1,Wt=Array(ye);++Ve<ye;)Wt[Ve]=Re(Ve);return Wt}function ja(ye){return function(Re){return ye(Re)}}function kr(ye,Re){return ye==null?void 0:ye[Re]}function tt(ye,Re){return function(Ve){return ye(Re(Ve))}}var de=Array.prototype,me=Function.prototype,Ce=Object.prototype,rt=sn["__core-js_shared__"],Qe=me.toString,bt=Ce.hasOwnProperty,zt=function(){var ye=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||"");return ye?"Symbol(src)_1."+ye:""}(),it=Ce.toString,jt=Qe.call(Object),Ht=RegExp("^"+Qe.call(bt).replace(Jt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=uo?sn.Buffer:void 0,Fr=sn.Symbol,en=sn.Uint8Array,In=Zt?Zt.allocUnsafe:void 0,Jr=tt(Object.getPrototypeOf,Object),tn=Object.create,Ur=Ce.propertyIsEnumerable,Jn=de.splice,kn=Fr?Fr.toStringTag:void 0,zi=function(){try{var ye=Wu(Object,"defineProperty");return ye({},"",{}),ye}catch{}}(),Ri=Zt?Zt.isBuffer:void 0,jo=Math.max,si=Date.now,Vo=Wu(sn,"Map"),ho=Wu(Object,"create"),ai=function(){function ye(){}return function(Re){if(!Un(Re))return{};if(tn)return tn(Re);ye.prototype=Re;var Ve=new ye;return ye.prototype=void 0,Ve}}();function $e(ye){var Re=-1,Ve=ye==null?0:ye.length;for(this.clear();++Re<Ve;){var Wt=ye[Re];this.set(Wt[0],Wt[1])}}function Ye(){this.__data__=ho?ho(null):{},this.size=0}function at(ye){var Re=this.has(ye)&&delete this.__data__[ye];return this.size-=Re?1:0,Re}function ut(ye){var Re=this.__data__;if(ho){var Ve=Re[ye];return Ve===c?void 0:Ve}return bt.call(Re,ye)?Re[ye]:void 0}function pt(ye){var Re=this.__data__;return ho?Re[ye]!==void 0:bt.call(Re,ye)}function xt(ye,Re){var Ve=this.__data__;return this.size+=this.has(ye)?0:1,Ve[ye]=ho&&Re===void 0?c:Re,this}$e.prototype.clear=Ye,$e.prototype.delete=at,$e.prototype.get=ut,$e.prototype.has=pt,$e.prototype.set=xt;function mt(ye){var Re=-1,Ve=ye==null?0:ye.length;for(this.clear();++Re<Ve;){var Wt=ye[Re];this.set(Wt[0],Wt[1])}}function gt(){this.__data__=[],this.size=0}function kt(ye){var Re=this.__data__,Ve=ca(Re,ye);if(Ve<0)return!1;var Wt=Re.length-1;return Ve==Wt?Re.pop():Jn.call(Re,Ve,1),--this.size,!0}function dt(ye){var Re=this.__data__,Ve=ca(Re,ye);return Ve<0?void 0:Re[Ve][1]}function Qt(ye){return ca(this.__data__,ye)>-1}function Pr(ye,Re){var Ve=this.__data__,Wt=ca(Ve,ye);return Wt<0?(++this.size,Ve.push([ye,Re])):Ve[Wt][1]=Re,this}mt.prototype.clear=gt,mt.prototype.delete=kt,mt.prototype.get=dt,mt.prototype.has=Qt,mt.prototype.set=Pr;function Bt(ye){var Re=-1,Ve=ye==null?0:ye.length;for(this.clear();++Re<Ve;){var Wt=ye[Re];this.set(Wt[0],Wt[1])}}function Or(){this.size=0,this.__data__={hash:new $e,map:new(Vo||mt),string:new $e}}function bn(ye){var Re=$a(this,ye).delete(ye);return this.size-=Re?1:0,Re}function Tn(ye){return $a(this,ye).get(ye)}function zn(ye){return $a(this,ye).has(ye)}function hi(ye,Re){var Ve=$a(this,ye),Wt=Ve.size;return Ve.set(ye,Re),this.size+=Ve.size==Wt?0:1,this}Bt.prototype.clear=Or,Bt.prototype.delete=bn,Bt.prototype.get=Tn,Bt.prototype.has=zn,Bt.prototype.set=hi;function li(ye){var Re=this.__data__=new mt(ye);this.size=Re.size}function fo(){this.__data__=new mt,this.size=0}function Xi(ye){var Re=this.__data__,Ve=Re.delete(ye);return this.size=Re.size,Ve}function di(ye){return this.__data__.get(ye)}function Ui(ye){return this.__data__.has(ye)}function us(ye,Re){var Ve=this.__data__;if(Ve instanceof mt){var Wt=Ve.__data__;if(!Vo||Wt.length<o-1)return Wt.push([ye,Re]),this.size=++Ve.size,this;Ve=this.__data__=new Bt(Wt)}return Ve.set(ye,Re),this.size=Ve.size,this}li.prototype.clear=fo,li.prototype.delete=Xi,li.prototype.get=di,li.prototype.has=Ui,li.prototype.set=us;function Va(ye,Re){var Ve=Wa(ye),Wt=!Ve&&ds(ye),Br=!Ve&&!Wt&&Fc(ye),Dr=!Ve&&!Wt&&!Br&&Ns(ye),cn=Ve||Wt||Br||Dr,Ar=cn?Zi(ye.length,String):[],Xt=Ar.length;for(var go in ye)(Re||bt.call(ye,go))&&!(cn&&(go=="length"||Br&&(go=="offset"||go=="parent")||Dr&&(go=="buffer"||go=="byteLength"||go=="byteOffset")||pr(go,Xt)))&&Ar.push(go);return Ar}function Dl(ye,Re,Ve){(Ve!==void 0&&!Ga(ye[Re],Ve)||Ve===void 0&&!(Re in ye))&&Ll(ye,Re,Ve)}function Oc(ye,Re,Ve){var Wt=ye[Re];(!(bt.call(ye,Re)&&Ga(Wt,Ve))||Ve===void 0&&!(Re in ye))&&Ll(ye,Re,Ve)}function ca(ye,Re){for(var Ve=ye.length;Ve--;)if(Ga(ye[Ve][0],Re))return Ve;return-1}function Ll(ye,Re,Ve){Re=="__proto__"&&zi?zi(ye,Re,{configurable:!0,enumerable:!0,value:Ve,writable:!0}):ye[Re]=Ve}var Ol=Io();function $o(ye){return ye==null?ye===void 0?Be:ie:kn&&kn in Object(ye)?da(ye):Bs(ye)}function Gu(ye){return Hr(ye)&&$o(ye)==E}function Di(ye){if(!Un(ye)||Ua(ye))return!1;var Re=Ha(ye)?Ht:qt;return Re.test(pa(ye))}function Bc(ye){return Hr(ye)&&Nc(ye.length)&&!!wr[$o(ye)]}function ua(ye){if(!Un(ye))return fa(ye);var Re=cr(ye),Ve=[];for(var Wt in ye)Wt=="constructor"&&(Re||!bt.call(ye,Wt))||Ve.push(Wt);return Ve}function po(ye,Re,Ve,Wt,Br){ye!==Re&&Ol(Re,function(Dr,cn){if(Br||(Br=new li),Un(Dr))ha(ye,Re,cn,Ve,po,Wt,Br);else{var Ar=Wt?Wt(fi(ye,cn),Dr,cn+"",ye,Re,Br):void 0;Ar===void 0&&(Ar=Dr),Dl(ye,cn,Ar)}},Yi)}function ha(ye,Re,Ve,Wt,Br,Dr,cn){var Ar=fi(ye,Ve),Xt=fi(Re,Ve),go=cn.get(Xt);if(go){Dl(ye,Ve,go);return}var Ei=Dr?Dr(Ar,Xt,Ve+"",ye,Re,cn):void 0,_o=Ei===void 0;if(_o){var jc=Wa(Xt),Nl=!jc&&Fc(Xt),fs=!jc&&!Nl&&Ns(Xt);Ei=Xt,jc||Nl||fs?Wa(Ar)?Ei=Ar:qa(Ar)?Ei=Rn(Ar):Nl?(_o=!1,Ei=Pt(Xt,!0)):fs?(_o=!1,Ei=Po(Xt,!0)):Ei=[]:qu(Xt)||ds(Xt)?(Ei=Ar,ds(Ar)?Ei=Li(Ar):(!Un(Ar)||Ha(Ar))&&(Ei=Je(Xt))):_o=!1}_o&&(cn.set(Xt,Ei),Br(Ei,Xt,Wt,Dr,cn),cn.delete(Xt)),Dl(ye,Ve,Ei)}function Uo(ye,Re){return qr(Bl(ye,Re,Fn),ye+"")}var ze=zi?function(ye,Re){return zi(ye,"toString",{configurable:!0,enumerable:!1,value:Za(Re),writable:!0})}:Fn;function Pt(ye,Re){if(Re)return ye.slice();var Ve=ye.length,Wt=In?In(Ve):new ye.constructor(Ve);return ye.copy(Wt),Wt}function Go(ye){var Re=new ye.constructor(ye.byteLength);return new en(Re).set(new en(ye)),Re}function Po(ye,Re){var Ve=Re?Go(ye.buffer):ye.buffer;return new ye.constructor(Ve,ye.byteOffset,ye.length)}function Rn(ye,Re){var Ve=-1,Wt=ye.length;for(Re||(Re=Array(Wt));++Ve<Wt;)Re[Ve]=ye[Ve];return Re}function hs(ye,Re,Ve,Wt){var Br=!Ve;Ve||(Ve={});for(var Dr=-1,cn=Re.length;++Dr<cn;){var Ar=Re[Dr],Xt=Wt?Wt(Ve[Ar],ye[Ar],Ar,Ve,ye):void 0;Xt===void 0&&(Xt=ye[Ar]),Br?Ll(Ve,Ar,Xt):Oc(Ve,Ar,Xt)}return Ve}function Lp(ye){return Uo(function(Re,Ve){var Wt=-1,Br=Ve.length,Dr=Br>1?Ve[Br-1]:void 0,cn=Br>2?Ve[2]:void 0;for(Dr=ye.length>3&&typeof Dr=="function"?(Br--,Dr):void 0,cn&&Er(Ve[0],Ve[1],cn)&&(Dr=Br<3?void 0:Dr,Br=1),Re=Object(Re);++Wt<Br;){var Ar=Ve[Wt];Ar&&ye(Re,Ar,Wt,Dr)}return Re})}function Io(ye){return function(Re,Ve,Wt){for(var Br=-1,Dr=Object(Re),cn=Wt(Re),Ar=cn.length;Ar--;){var Xt=cn[ye?Ar:++Br];if(Ve(Dr[Xt],Xt,Dr)===!1)break}return Re}}function $a(ye,Re){var Ve=ye.__data__;return mo(Re)?Ve[typeof Re=="string"?"string":"hash"]:Ve.map}function Wu(ye,Re){var Ve=kr(ye,Re);return Di(Ve)?Ve:void 0}function da(ye){var Re=bt.call(ye,kn),Ve=ye[kn];try{ye[kn]=void 0;var Wt=!0}catch{}var Br=it.call(ye);return Wt&&(Re?ye[kn]=Ve:delete ye[kn]),Br}function Je(ye){return typeof ye.constructor=="function"&&!cr(ye)?ai(Jr(ye)):{}}function pr(ye,Re){var Ve=typeof ye;return Re=Re??w,!!Re&&(Ve=="number"||Ve!="symbol"&&_r.test(ye))&&ye>-1&&ye%1==0&&ye<Re}function Er(ye,Re,Ve){if(!Un(Ve))return!1;var Wt=typeof Re;return(Wt=="number"?Fs(Ve)&&pr(Re,Ve.length):Wt=="string"&&Re in Ve)?Ga(Ve[Re],ye):!1}function mo(ye){var Re=typeof ye;return Re=="string"||Re=="number"||Re=="symbol"||Re=="boolean"?ye!=="__proto__":ye===null}function Ua(ye){return!!zt&&zt in ye}function cr(ye){var Re=ye&&ye.constructor,Ve=typeof Re=="function"&&Re.prototype||Ce;return ye===Ve}function fa(ye){var Re=[];if(ye!=null)for(var Ve in Object(ye))Re.push(Ve);return Re}function Bs(ye){return it.call(ye)}function Bl(ye,Re,Ve){return Re=jo(Re===void 0?ye.length-1:Re,0),function(){for(var Wt=arguments,Br=-1,Dr=jo(Wt.length-Re,0),cn=Array(Dr);++Br<Dr;)cn[Br]=Wt[Re+Br];Br=-1;for(var Ar=Array(Re+1);++Br<Re;)Ar[Br]=Wt[Br];return Ar[Re]=Ve(cn),cs(ye,this,Ar)}}function fi(ye,Re){if(!(Re==="constructor"&&typeof ye[Re]=="function")&&Re!="__proto__")return ye[Re]}var qr=Op(ze);function Op(ye){var Re=0,Ve=0;return function(){var Wt=si(),Br=y-(Wt-Ve);if(Ve=Wt,Br>0){if(++Re>=p)return arguments[0]}else Re=0;return ye.apply(void 0,arguments)}}function pa(ye){if(ye!=null){try{return Qe.call(ye)}catch{}try{return ye+""}catch{}}return""}function Ga(ye,Re){return ye===Re||ye!==ye&&Re!==Re}var ds=Gu(function(){return arguments}())?Gu:function(ye){return Hr(ye)&&bt.call(ye,"callee")&&!Ur.call(ye,"callee")},Wa=Array.isArray;function Fs(ye){return ye!=null&&Nc(ye.length)&&!Ha(ye)}function qa(ye){return Hr(ye)&&Fs(ye)}var Fc=Ri||Fl;function Ha(ye){if(!Un(ye))return!1;var Re=$o(ye);return Re==$||Re==H||Re==P||Re==se}function Nc(ye){return typeof ye=="number"&&ye>-1&&ye%1==0&&ye<=w}function Un(ye){var Re=typeof ye;return ye!=null&&(Re=="object"||Re=="function")}function Hr(ye){return ye!=null&&typeof ye=="object"}function qu(ye){if(!Hr(ye)||$o(ye)!=te)return!1;var Re=Jr(ye);if(Re===null)return!0;var Ve=bt.call(Re,"constructor")&&Re.constructor;return typeof Ve=="function"&&Ve instanceof Ve&&Qe.call(Ve)==jt}var Ns=oi?ja(oi):Bc;function Li(ye){return hs(ye,Yi(ye))}function Yi(ye){return Fs(ye)?Va(ye,!0):ua(ye)}var yd=Lp(function(ye,Re,Ve,Wt){po(ye,Re,Ve,Wt)});function Za(ye){return function(){return ye}}function Fn(ye){return ye}function Fl(){return!1}e.exports=yd})(Kx,Kx.exports);var Yq=Kx.exports;const Tl=P1(Yq);var Kq=e=>/!(important)?$/.test(e),M4=e=>typeof e=="string"?e.replace(/!(important)?$/,"").trim():e,Jq=(e,n)=>o=>{const c=String(n),p=Kq(c),y=M4(c),w=e?`${e}.${y}`:y;let E=ks(o.__cssMap)&&w in o.__cssMap?o.__cssMap[w].varRef:n;return E=M4(E),p?`${E} !important`:E};function cA(e){const{scale:n,transform:o,compose:c}=e;return(y,w)=>{var E;const a=Jq(n,y)(w);let P=(E=o==null?void 0:o(a,w))!=null?E:a;return c&&(P=c(P,w)),P}}var xv=(...e)=>n=>e.reduce((o,c)=>c(o),n);function Xs(e,n){return o=>{const c={property:o,scale:e};return c.transform=cA({scale:e,transform:n}),c}}var Qq=({rtl:e,ltr:n})=>o=>o.direction==="rtl"?e:n;function eH(e){const{property:n,scale:o,transform:c}=e;return{scale:o,property:Qq(n),transform:o?cA({scale:o,compose:c}):c}}var TF=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function tH(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...TF].join(" ")}function rH(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...TF].join(" ")}var nH={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},iH={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function oH(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var sH={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},lC={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},aH=new Set(Object.values(lC)),cC=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),lH=e=>e.trim();function cH(e,n){if(e==null||cC.has(e))return e;if(!(uC(e)||cC.has(e)))return`url('${e}')`;const p=/(^[a-z-A-Z]+)\((.*)\)/g.exec(e),y=p==null?void 0:p[1],w=p==null?void 0:p[2];if(!y||!w)return e;const E=y.includes("-gradient")?y:`${y}-gradient`,[a,...P]=w.split(",").map(lH).filter(Boolean);if((P==null?void 0:P.length)===0)return e;const D=a in lC?lC[a]:a;P.unshift(D);const L=P.map(F=>{if(aH.has(F))return F;const $=F.indexOf(" "),[H,q]=$!==-1?[F.substr(0,$),F.substr($+1)]:[F],le=uC(q)?q:q&&q.split(" "),ie=`colors.${H}`,te=ie in n.__cssMap?n.__cssMap[ie].varRef:H;return le?[te,...Array.isArray(le)?le:[le]].join(" "):te});return`${E}(${L.join(", ")})`}var uC=e=>typeof e=="string"&&e.includes("(")&&e.includes(")"),uH=(e,n)=>cH(e,n??{});function hH(e){return/^var\(--.+\)$/.test(e)}var dH=e=>{const n=parseFloat(e.toString()),o=e.toString().replace(String(n),"");return{unitless:!o,value:n,unit:o}},_l=e=>n=>`${e}(${n})`,Qr={filter(e){return e!=="auto"?e:nH},backdropFilter(e){return e!=="auto"?e:iH},ring(e){return oH(Qr.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?tH():e==="auto-gpu"?rH():e},vh(e){return e==="$100vh"?"var(--chakra-vh)":e},px(e){if(e==null)return e;const{unitless:n}=dH(e);return n||typeof e=="number"?`${e}px`:e},fraction(e){return typeof e!="number"||e>1?e:`${e*100}%`},float(e,n){const o={left:"right",right:"left"};return n.direction==="rtl"?o[e]:e},degree(e){if(hH(e)||e==null)return e;const n=typeof e=="string"&&!e.endsWith("deg");return typeof e=="number"||n?`${e}deg`:e},gradient:uH,blur:_l("blur"),opacity:_l("opacity"),brightness:_l("brightness"),contrast:_l("contrast"),dropShadow:_l("drop-shadow"),grayscale:_l("grayscale"),hueRotate:e=>_l("hue-rotate")(Qr.degree(e)),invert:_l("invert"),saturate:_l("saturate"),sepia:_l("sepia"),bgImage(e){return e==null||uC(e)||cC.has(e)?e:`url(${e})`},outline(e){const n=String(e)==="0"||String(e)==="none";return e!==null&&n?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var n;const{space:o,divide:c}=(n=sH[e])!=null?n:{},p={flexDirection:e};return o&&(p[o]=1),c&&(p[c]=1),p}},Le={borderWidths:Xs("borderWidths"),borderStyles:Xs("borderStyles"),colors:Xs("colors"),borders:Xs("borders"),gradients:Xs("gradients",Qr.gradient),radii:Xs("radii",Qr.px),space:Xs("space",xv(Qr.vh,Qr.px)),spaceT:Xs("space",xv(Qr.vh,Qr.px)),degreeT(e){return{property:e,transform:Qr.degree}},prop(e,n,o){return{property:e,scale:n,...n&&{transform:cA({scale:n,transform:o})}}},propT(e,n){return{property:e,transform:n}},sizes:Xs("sizes",xv(Qr.vh,Qr.px)),sizesT:Xs("sizes",xv(Qr.vh,Qr.fraction)),shadows:Xs("shadows"),logical:eH,blur:Xs("blur",Qr.blur)},nx={background:Le.colors("background"),backgroundColor:Le.colors("backgroundColor"),backgroundImage:Le.gradients("backgroundImage"),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:Qr.bgClip},bgSize:Le.prop("backgroundSize"),bgPosition:Le.prop("backgroundPosition"),bg:Le.colors("background"),bgColor:Le.colors("backgroundColor"),bgPos:Le.prop("backgroundPosition"),bgRepeat:Le.prop("backgroundRepeat"),bgAttachment:Le.prop("backgroundAttachment"),bgGradient:Le.gradients("backgroundImage"),bgClip:{transform:Qr.bgClip}};Object.assign(nx,{bgImage:nx.backgroundImage,bgImg:nx.backgroundImage});var mn={border:Le.borders("border"),borderWidth:Le.borderWidths("borderWidth"),borderStyle:Le.borderStyles("borderStyle"),borderColor:Le.colors("borderColor"),borderRadius:Le.radii("borderRadius"),borderTop:Le.borders("borderTop"),borderBlockStart:Le.borders("borderBlockStart"),borderTopLeftRadius:Le.radii("borderTopLeftRadius"),borderStartStartRadius:Le.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:Le.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:Le.radii("borderTopRightRadius"),borderStartEndRadius:Le.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:Le.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:Le.borders("borderRight"),borderInlineEnd:Le.borders("borderInlineEnd"),borderBottom:Le.borders("borderBottom"),borderBlockEnd:Le.borders("borderBlockEnd"),borderBottomLeftRadius:Le.radii("borderBottomLeftRadius"),borderBottomRightRadius:Le.radii("borderBottomRightRadius"),borderLeft:Le.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:Le.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:Le.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:Le.borders(["borderLeft","borderRight"]),borderInline:Le.borders("borderInline"),borderY:Le.borders(["borderTop","borderBottom"]),borderBlock:Le.borders("borderBlock"),borderTopWidth:Le.borderWidths("borderTopWidth"),borderBlockStartWidth:Le.borderWidths("borderBlockStartWidth"),borderTopColor:Le.colors("borderTopColor"),borderBlockStartColor:Le.colors("borderBlockStartColor"),borderTopStyle:Le.borderStyles("borderTopStyle"),borderBlockStartStyle:Le.borderStyles("borderBlockStartStyle"),borderBottomWidth:Le.borderWidths("borderBottomWidth"),borderBlockEndWidth:Le.borderWidths("borderBlockEndWidth"),borderBottomColor:Le.colors("borderBottomColor"),borderBlockEndColor:Le.colors("borderBlockEndColor"),borderBottomStyle:Le.borderStyles("borderBottomStyle"),borderBlockEndStyle:Le.borderStyles("borderBlockEndStyle"),borderLeftWidth:Le.borderWidths("borderLeftWidth"),borderInlineStartWidth:Le.borderWidths("borderInlineStartWidth"),borderLeftColor:Le.colors("borderLeftColor"),borderInlineStartColor:Le.colors("borderInlineStartColor"),borderLeftStyle:Le.borderStyles("borderLeftStyle"),borderInlineStartStyle:Le.borderStyles("borderInlineStartStyle"),borderRightWidth:Le.borderWidths("borderRightWidth"),borderInlineEndWidth:Le.borderWidths("borderInlineEndWidth"),borderRightColor:Le.colors("borderRightColor"),borderInlineEndColor:Le.colors("borderInlineEndColor"),borderRightStyle:Le.borderStyles("borderRightStyle"),borderInlineEndStyle:Le.borderStyles("borderInlineEndStyle"),borderTopRadius:Le.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:Le.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:Le.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:Le.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(mn,{rounded:mn.borderRadius,roundedTop:mn.borderTopRadius,roundedTopLeft:mn.borderTopLeftRadius,roundedTopRight:mn.borderTopRightRadius,roundedTopStart:mn.borderStartStartRadius,roundedTopEnd:mn.borderStartEndRadius,roundedBottom:mn.borderBottomRadius,roundedBottomLeft:mn.borderBottomLeftRadius,roundedBottomRight:mn.borderBottomRightRadius,roundedBottomStart:mn.borderEndStartRadius,roundedBottomEnd:mn.borderEndEndRadius,roundedLeft:mn.borderLeftRadius,roundedRight:mn.borderRightRadius,roundedStart:mn.borderInlineStartRadius,roundedEnd:mn.borderInlineEndRadius,borderStart:mn.borderInlineStart,borderEnd:mn.borderInlineEnd,borderTopStartRadius:mn.borderStartStartRadius,borderTopEndRadius:mn.borderStartEndRadius,borderBottomStartRadius:mn.borderEndStartRadius,borderBottomEndRadius:mn.borderEndEndRadius,borderStartRadius:mn.borderInlineStartRadius,borderEndRadius:mn.borderInlineEndRadius,borderStartWidth:mn.borderInlineStartWidth,borderEndWidth:mn.borderInlineEndWidth,borderStartColor:mn.borderInlineStartColor,borderEndColor:mn.borderInlineEndColor,borderStartStyle:mn.borderInlineStartStyle,borderEndStyle:mn.borderInlineEndStyle});var fH={color:Le.colors("color"),textColor:Le.colors("color"),fill:Le.colors("fill"),stroke:Le.colors("stroke")},hC={boxShadow:Le.shadows("boxShadow"),mixBlendMode:!0,blendMode:Le.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:Le.prop("backgroundBlendMode"),opacity:!0};Object.assign(hC,{shadow:hC.boxShadow});var pH={filter:{transform:Qr.filter},blur:Le.blur("--chakra-blur"),brightness:Le.propT("--chakra-brightness",Qr.brightness),contrast:Le.propT("--chakra-contrast",Qr.contrast),hueRotate:Le.propT("--chakra-hue-rotate",Qr.hueRotate),invert:Le.propT("--chakra-invert",Qr.invert),saturate:Le.propT("--chakra-saturate",Qr.saturate),dropShadow:Le.propT("--chakra-drop-shadow",Qr.dropShadow),backdropFilter:{transform:Qr.backdropFilter},backdropBlur:Le.blur("--chakra-backdrop-blur"),backdropBrightness:Le.propT("--chakra-backdrop-brightness",Qr.brightness),backdropContrast:Le.propT("--chakra-backdrop-contrast",Qr.contrast),backdropHueRotate:Le.propT("--chakra-backdrop-hue-rotate",Qr.hueRotate),backdropInvert:Le.propT("--chakra-backdrop-invert",Qr.invert),backdropSaturate:Le.propT("--chakra-backdrop-saturate",Qr.saturate)},Jx={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:Qr.flexDirection},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:Le.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:Le.space("gap"),rowGap:Le.space("rowGap"),columnGap:Le.space("columnGap")};Object.assign(Jx,{flexDir:Jx.flexDirection});var EF={gridGap:Le.space("gridGap"),gridColumnGap:Le.space("gridColumnGap"),gridRowGap:Le.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},mH={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:Qr.outline},outlineOffset:!0,outlineColor:Le.colors("outlineColor")},Ks={width:Le.sizesT("width"),inlineSize:Le.sizesT("inlineSize"),height:Le.sizes("height"),blockSize:Le.sizes("blockSize"),boxSize:Le.sizes(["width","height"]),minWidth:Le.sizes("minWidth"),minInlineSize:Le.sizes("minInlineSize"),minHeight:Le.sizes("minHeight"),minBlockSize:Le.sizes("minBlockSize"),maxWidth:Le.sizes("maxWidth"),maxInlineSize:Le.sizes("maxInlineSize"),maxHeight:Le.sizes("maxHeight"),maxBlockSize:Le.sizes("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,aspectRatio:!0,hideFrom:{scale:"breakpoints",transform:(e,n)=>{var o,c,p;return{[`@media screen and (min-width: ${(p=(c=(o=n.__breakpoints)==null?void 0:o.get(e))==null?void 0:c.minW)!=null?p:e})`]:{display:"none"}}}},hideBelow:{scale:"breakpoints",transform:(e,n)=>{var o,c,p;return{[`@media screen and (max-width: ${(p=(c=(o=n.__breakpoints)==null?void 0:o.get(e))==null?void 0:c._minW)!=null?p:e})`]:{display:"none"}}}},verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:Le.propT("float",Qr.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(Ks,{w:Ks.width,h:Ks.height,minW:Ks.minWidth,maxW:Ks.maxWidth,minH:Ks.minHeight,maxH:Ks.maxHeight,overscroll:Ks.overscrollBehavior,overscrollX:Ks.overscrollBehaviorX,overscrollY:Ks.overscrollBehaviorY});var gH={listStyleType:!0,listStylePosition:!0,listStylePos:Le.prop("listStylePosition"),listStyleImage:!0,listStyleImg:Le.prop("listStyleImage")};function _H(e,n,o,c){const p=typeof n=="string"?n.split("."):[n];for(c=0;c<p.length&&e;c+=1)e=e[p[c]];return e===void 0?o:e}var yH=e=>{const n=new WeakMap;return(c,p,y,w)=>{if(typeof c>"u")return e(c,p,y);n.has(c)||n.set(c,new Map);const E=n.get(c);if(E.has(p))return E.get(p);const a=e(c,p,y,w);return E.set(p,a),a}},vH=yH(_H),xH={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},bH={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},vT=(e,n,o)=>{const c={},p=vH(e,n,{});for(const y in p)y in o&&o[y]!=null||(c[y]=p[y]);return c},wH={srOnly:{transform(e){return e===!0?xH:e==="focusable"?bH:{}}},layerStyle:{processResult:!0,transform:(e,n,o)=>vT(n,`layerStyles.${e}`,o)},textStyle:{processResult:!0,transform:(e,n,o)=>vT(n,`textStyles.${e}`,o)},apply:{processResult:!0,transform:(e,n,o)=>vT(n,e,o)}},Yg={position:!0,pos:Le.prop("position"),zIndex:Le.prop("zIndex","zIndices"),inset:Le.spaceT("inset"),insetX:Le.spaceT(["left","right"]),insetInline:Le.spaceT("insetInline"),insetY:Le.spaceT(["top","bottom"]),insetBlock:Le.spaceT("insetBlock"),top:Le.spaceT("top"),insetBlockStart:Le.spaceT("insetBlockStart"),bottom:Le.spaceT("bottom"),insetBlockEnd:Le.spaceT("insetBlockEnd"),left:Le.spaceT("left"),insetInlineStart:Le.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:Le.spaceT("right"),insetInlineEnd:Le.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(Yg,{insetStart:Yg.insetInlineStart,insetEnd:Yg.insetInlineEnd});var SH={ring:{transform:Qr.ring},ringColor:Le.colors("--chakra-ring-color"),ringOffset:Le.prop("--chakra-ring-offset-width"),ringOffsetColor:Le.colors("--chakra-ring-offset-color"),ringInset:Le.prop("--chakra-ring-inset")},Hn={margin:Le.spaceT("margin"),marginTop:Le.spaceT("marginTop"),marginBlockStart:Le.spaceT("marginBlockStart"),marginRight:Le.spaceT("marginRight"),marginInlineEnd:Le.spaceT("marginInlineEnd"),marginBottom:Le.spaceT("marginBottom"),marginBlockEnd:Le.spaceT("marginBlockEnd"),marginLeft:Le.spaceT("marginLeft"),marginInlineStart:Le.spaceT("marginInlineStart"),marginX:Le.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:Le.spaceT("marginInline"),marginY:Le.spaceT(["marginTop","marginBottom"]),marginBlock:Le.spaceT("marginBlock"),padding:Le.space("padding"),paddingTop:Le.space("paddingTop"),paddingBlockStart:Le.space("paddingBlockStart"),paddingRight:Le.space("paddingRight"),paddingBottom:Le.space("paddingBottom"),paddingBlockEnd:Le.space("paddingBlockEnd"),paddingLeft:Le.space("paddingLeft"),paddingInlineStart:Le.space("paddingInlineStart"),paddingInlineEnd:Le.space("paddingInlineEnd"),paddingX:Le.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:Le.space("paddingInline"),paddingY:Le.space(["paddingTop","paddingBottom"]),paddingBlock:Le.space("paddingBlock")};Object.assign(Hn,{m:Hn.margin,mt:Hn.marginTop,mr:Hn.marginRight,me:Hn.marginInlineEnd,marginEnd:Hn.marginInlineEnd,mb:Hn.marginBottom,ml:Hn.marginLeft,ms:Hn.marginInlineStart,marginStart:Hn.marginInlineStart,mx:Hn.marginX,my:Hn.marginY,p:Hn.padding,pt:Hn.paddingTop,py:Hn.paddingY,px:Hn.paddingX,pb:Hn.paddingBottom,pl:Hn.paddingLeft,ps:Hn.paddingInlineStart,paddingStart:Hn.paddingInlineStart,pr:Hn.paddingRight,pe:Hn.paddingInlineEnd,paddingEnd:Hn.paddingInlineEnd});var TH={textDecorationColor:Le.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:Le.shadows("textShadow")},EH={clipPath:!0,transform:Le.propT("transform",Qr.transform),transformOrigin:!0,translateX:Le.spaceT("--chakra-translate-x"),translateY:Le.spaceT("--chakra-translate-y"),skewX:Le.degreeT("--chakra-skew-x"),skewY:Le.degreeT("--chakra-skew-y"),scaleX:Le.prop("--chakra-scale-x"),scaleY:Le.prop("--chakra-scale-y"),scale:Le.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:Le.degreeT("--chakra-rotate")},CH={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:Le.prop("transitionDuration","transition.duration"),transitionProperty:Le.prop("transitionProperty","transition.property"),transitionTimingFunction:Le.prop("transitionTimingFunction","transition.easing")},MH={fontFamily:Le.prop("fontFamily","fonts"),fontSize:Le.prop("fontSize","fontSizes",Qr.px),fontWeight:Le.prop("fontWeight","fontWeights"),lineHeight:Le.prop("lineHeight","lineHeights"),letterSpacing:Le.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"}},AH={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:Le.spaceT("scrollMargin"),scrollMarginTop:Le.spaceT("scrollMarginTop"),scrollMarginBottom:Le.spaceT("scrollMarginBottom"),scrollMarginLeft:Le.spaceT("scrollMarginLeft"),scrollMarginRight:Le.spaceT("scrollMarginRight"),scrollMarginX:Le.spaceT(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:Le.spaceT(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:Le.spaceT("scrollPadding"),scrollPaddingTop:Le.spaceT("scrollPaddingTop"),scrollPaddingBottom:Le.spaceT("scrollPaddingBottom"),scrollPaddingLeft:Le.spaceT("scrollPaddingLeft"),scrollPaddingRight:Le.spaceT("scrollPaddingRight"),scrollPaddingX:Le.spaceT(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:Le.spaceT(["scrollPaddingTop","scrollPaddingBottom"])};function CF(e){return ks(e)&&e.reference?e.reference:String(e)}var ub=(e,...n)=>n.map(CF).join(` ${e} `).replace(/calc/g,""),A4=(...e)=>`calc(${ub("+",...e)})`,k4=(...e)=>`calc(${ub("-",...e)})`,dC=(...e)=>`calc(${ub("*",...e)})`,P4=(...e)=>`calc(${ub("/",...e)})`,I4=e=>{const n=CF(e);return n!=null&&!Number.isNaN(parseFloat(n))?String(n).startsWith("-")?String(n).slice(1):`-${n}`:dC(n,-1)},Oh=Object.assign(e=>({add:(...n)=>Oh(A4(e,...n)),subtract:(...n)=>Oh(k4(e,...n)),multiply:(...n)=>Oh(dC(e,...n)),divide:(...n)=>Oh(P4(e,...n)),negate:()=>Oh(I4(e)),toString:()=>e.toString()}),{add:A4,subtract:k4,multiply:dC,divide:P4,negate:I4});function kH(e,n="-"){return e.replace(/\s+/g,n)}function PH(e){const n=kH(e.toString());return zH(IH(n))}function IH(e){return e.includes("\\.")?e:!Number.isInteger(parseFloat(e.toString()))?e.replace(".","\\."):e}function zH(e){return e.replace(/[!-,/:-@[-^`{-~]/g,"\\$&")}function RH(e,n=""){return[n,e].filter(Boolean).join("-")}function DH(e,n){return`var(${e}${n?`, ${n}`:""})`}function LH(e,n=""){return PH(`--${RH(e,n)}`)}function fr(e,n,o){const c=LH(e,o);return{variable:c,reference:DH(c,n)}}function OH(e,n){const o={};for(const c of n){if(Array.isArray(c)){const[p,y]=c;o[p]=fr(`${e}-${p}`,y);continue}o[c]=fr(`${e}-${c}`)}return o}function BH(e){const n=e==null?0:e.length;return n?e[n-1]:void 0}function FH(e){const n=parseFloat(e.toString()),o=e.toString().replace(String(n),"");return{unitless:!o,value:n,unit:o}}function fC(e){if(e==null)return e;const{unitless:n}=FH(e);return n||typeof e=="number"?`${e}px`:e}var MF=(e,n)=>parseInt(e[1],10)>parseInt(n[1],10)?1:-1,uA=e=>Object.fromEntries(Object.entries(e).sort(MF));function z4(e){const n=uA(e);return Object.assign(Object.values(n),n)}function NH(e){const n=Object.keys(uA(e));return new Set(n)}function R4(e){var n;if(!e)return e;e=(n=fC(e))!=null?n:e;const o=-.02;return typeof e=="number"?`${e+o}`:e.replace(/(\d+\.?\d*)/u,c=>`${parseFloat(c)+o}`)}function Ag(e,n){const o=["@media screen"];return e&&o.push("and",`(min-width: ${fC(e)})`),n&&o.push("and",`(max-width: ${fC(n)})`),o.join(" ")}function jH(e){var n;if(!e)return null;e.base=(n=e.base)!=null?n:"0px";const o=z4(e),c=Object.entries(e).sort(MF).map(([w,E],a,P)=>{var D;let[,L]=(D=P[a+1])!=null?D:[];return L=parseFloat(L)>0?R4(L):void 0,{_minW:R4(E),breakpoint:w,minW:E,maxW:L,maxWQuery:Ag(null,L),minWQuery:Ag(E),minMaxQuery:Ag(E,L)}}),p=NH(e),y=Array.from(p.values());return{keys:p,normalized:o,isResponsive(w){const E=Object.keys(w);return E.length>0&&E.every(a=>p.has(a))},asObject:uA(e),asArray:z4(e),details:c,get(w){return c.find(E=>E.breakpoint===w)},media:[null,...o.map(w=>Ag(w)).slice(1)],toArrayValue(w){if(!ks(w))throw new Error("toArrayValue: value must be an object");const E=y.map(a=>{var P;return(P=w[a])!=null?P:null});for(;BH(E)===null;)E.pop();return E},toObjectValue(w){if(!Array.isArray(w))throw new Error("toObjectValue: value must be an array");return w.reduce((E,a,P)=>{const D=y[P];return D!=null&&a!=null&&(E[D]=a),E},{})}}}var to={hover:(e,n)=>`${e}:hover ${n}, ${e}[data-hover] ${n}`,focus:(e,n)=>`${e}:focus ${n}, ${e}[data-focus] ${n}`,focusVisible:(e,n)=>`${e}:focus-visible ${n}`,focusWithin:(e,n)=>`${e}:focus-within ${n}`,active:(e,n)=>`${e}:active ${n}, ${e}[data-active] ${n}`,disabled:(e,n)=>`${e}:disabled ${n}, ${e}[data-disabled] ${n}`,invalid:(e,n)=>`${e}:invalid ${n}, ${e}[data-invalid] ${n}`,checked:(e,n)=>`${e}:checked ${n}, ${e}[data-checked] ${n}`,indeterminate:(e,n)=>`${e}:indeterminate ${n}, ${e}[aria-checked=mixed] ${n}, ${e}[data-indeterminate] ${n}`,readOnly:(e,n)=>`${e}:read-only ${n}, ${e}[readonly] ${n}, ${e}[data-read-only] ${n}`,expanded:(e,n)=>`${e}:read-only ${n}, ${e}[aria-expanded=true] ${n}, ${e}[data-expanded] ${n}`,placeholderShown:(e,n)=>`${e}:placeholder-shown ${n}`},du=e=>AF(n=>e(n,"&"),"[role=group]","[data-group]",".group"),uc=e=>AF(n=>e(n,"~ &"),"[data-peer]",".peer"),AF=(e,...n)=>n.map(e).join(", "),hb={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible, &[data-focus-visible]",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_firstLetter:"&::first-letter",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:du(to.hover),_peerHover:uc(to.hover),_groupFocus:du(to.focus),_peerFocus:uc(to.focus),_groupFocusVisible:du(to.focusVisible),_peerFocusVisible:uc(to.focusVisible),_groupActive:du(to.active),_peerActive:uc(to.active),_groupDisabled:du(to.disabled),_peerDisabled:uc(to.disabled),_groupInvalid:du(to.invalid),_peerInvalid:uc(to.invalid),_groupChecked:du(to.checked),_peerChecked:uc(to.checked),_groupFocusWithin:du(to.focusWithin),_peerFocusWithin:uc(to.focusWithin),_peerPlaceholderShown:uc(to.placeholderShown),_placeholder:"&::placeholder",_placeholderShown:"&:placeholder-shown",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &, &[dir=rtl]",_ltr:"[dir=ltr] &, &[dir=ltr]",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".chakra-ui-dark &:not([data-theme]),[data-theme=dark] &:not([data-theme]),&[data-theme=dark]",_light:".chakra-ui-light &:not([data-theme]),[data-theme=light] &:not([data-theme]),&[data-theme=light]",_horizontal:"&[data-orientation=horizontal]",_vertical:"&[data-orientation=vertical]"},kF=Object.keys(hb);function D4(e,n){return fr(String(e).replace(/\./g,"-"),void 0,n)}function VH(e,n){let o={};const c={};for(const[p,y]of Object.entries(e)){const{isSemantic:w,value:E}=y,{variable:a,reference:P}=D4(p,n==null?void 0:n.cssVarPrefix);if(!w){if(p.startsWith("space")){const F=p.split("."),[$,...H]=F,q=`${$}.-${H.join(".")}`,le=Oh.negate(E),ie=Oh.negate(P);c[q]={value:le,var:a,varRef:ie}}o[a]=E,c[p]={value:E,var:a,varRef:P};continue}const D=F=>{const H=[String(p).split(".")[0],F].join(".");if(!e[H])return F;const{reference:le}=D4(H,n==null?void 0:n.cssVarPrefix);return le},L=ks(E)?E:{default:E};o=Tl(o,Object.entries(L).reduce((F,[$,H])=>{var q,le;if(!H)return F;const ie=D(`${H}`);if($==="default")return F[a]=ie,F;const te=(le=(q=hb)==null?void 0:q[$])!=null?le:$;return F[te]={[a]:ie},F},{})),c[p]={value:P,var:a,varRef:P}}return{cssVars:o,cssMap:c}}function $H(e,n=[]){const o=Object.assign({},e);for(const c of n)c in o&&delete o[c];return o}function UH(e,n){const o={};for(const c of n)c in e&&(o[c]=e[c]);return o}function GH(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}function L4(e,n,o={}){const{stop:c,getKey:p}=o;function y(w,E=[]){var a;if(GH(w)||Array.isArray(w)){const P={};for(const[D,L]of Object.entries(w)){const F=(a=p==null?void 0:p(D))!=null?a:D,$=[...E,F];if(c!=null&&c(w,$))return n(w,E);P[F]=y(L,$)}return P}return n(w,E)}return y(e)}var WH=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","gradients","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur","breakpoints"];function qH(e){return UH(e,WH)}function HH(e){return e.semanticTokens}function ZH(e){const{__cssMap:n,__cssVars:o,__breakpoints:c,...p}=e;return p}var XH=e=>kF.includes(e)||e==="default";function YH({tokens:e,semanticTokens:n}){const o={};return L4(e,(c,p)=>{c!=null&&(o[p.join(".")]={isSemantic:!1,value:c})}),L4(n,(c,p)=>{c!=null&&(o[p.join(".")]={isSemantic:!0,value:c})},{stop:c=>Object.keys(c).every(XH)}),o}function KH(e){var n;const o=ZH(e),c=qH(o),p=HH(o),y=YH({tokens:c,semanticTokens:p}),w=(n=o.config)==null?void 0:n.cssVarPrefix,{cssMap:E,cssVars:a}=VH(y,{cssVarPrefix:w});return Object.assign(o,{__cssVars:{...{"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"},...a},__cssMap:E,__breakpoints:jH(o.breakpoints)}),o}var hA=Tl({},nx,mn,fH,Jx,Ks,pH,SH,mH,EF,wH,Yg,hC,Hn,AH,MH,TH,EH,gH,CH),JH=Object.assign({},Hn,Ks,Jx,EF,Yg),PF=Object.keys(JH),QH=[...Object.keys(hA),...kF],eZ={...hA,...hb},tZ=e=>e in eZ,rZ=e=>n=>{if(!n.__breakpoints)return e;const{isResponsive:o,toArrayValue:c,media:p}=n.__breakpoints,y={};for(const w in e){let E=Eu(e[w],n);if(E==null)continue;if(E=ks(E)&&o(E)?c(E):E,!Array.isArray(E)){y[w]=E;continue}const a=E.slice(0,p.length).length;for(let P=0;P<a;P+=1){const D=p==null?void 0:p[P];if(!D){y[w]=E[P];continue}y[D]=y[D]||{},E[P]!=null&&(y[D][w]=E[P])}}return y};function nZ(e){const n=[];let o="",c=!1;for(let p=0;p<e.length;p++){const y=e[p];y==="("?(c=!0,o+=y):y===")"?(c=!1,o+=y):y===","&&!c?(n.push(o),o=""):o+=y}return o=o.trim(),o&&n.push(o),n}function iZ(e){return/^var\(--.+\)$/.test(e)}var oZ=(e,n)=>e.startsWith("--")&&typeof n=="string"&&!iZ(n),sZ=(e,n)=>{var o,c;if(n==null)return n;const p=a=>{var P,D;return(D=(P=e.__cssMap)==null?void 0:P[a])==null?void 0:D.varRef},y=a=>{var P;return(P=p(a))!=null?P:a},[w,E]=nZ(n);return n=(c=(o=p(w))!=null?o:y(E))!=null?c:y(n),n};function aZ(e){const{configs:n={},pseudos:o={},theme:c}=e,p=(y,w=!1)=>{var E,a,P;const D=Eu(y,c),L=rZ(D)(c);let F={};for(let $ in L){const H=L[$];let q=Eu(H,c);$ in o&&($=o[$]),oZ($,q)&&(q=sZ(c,q));let le=n[$];if(le===!0&&(le={property:$}),ks(q)){F[$]=(E=F[$])!=null?E:{},F[$]=Tl({},F[$],p(q,!0));continue}let ie=(P=(a=le==null?void 0:le.transform)==null?void 0:a.call(le,q,c,D))!=null?P:q;ie=le!=null&&le.processResult?p(ie,!0):ie;const te=Eu(le==null?void 0:le.property,c);if(!w&&(le!=null&&le.static)){const se=Eu(le.static,c);F=Tl({},F,se)}if(te&&Array.isArray(te)){for(const se of te)F[se]=ie;continue}if(te){te==="&"&&ks(ie)?F=Tl({},F,ie):F[te]=ie;continue}if(ks(ie)){F=Tl({},F,ie);continue}F[$]=ie}return F};return p}var IF=e=>n=>aZ({theme:n,pseudos:hb,configs:hA})(e);function $n(e){return{definePartsStyle(n){return n},defineMultiStyleConfig(n){return{parts:e,...n}}}}function lZ(e,n){if(Array.isArray(e))return e;if(ks(e))return n(e);if(e!=null)return[e]}function cZ(e,n){for(let o=n+1;o<e.length;o++)if(e[o]!=null)return o;return-1}function uZ(e){const n=e.__breakpoints;return function(c,p,y,w){var E,a;if(!n)return;const P={},D=lZ(y,n.toArrayValue);if(!D)return P;const L=D.length,F=L===1,$=!!c.parts;for(let H=0;H<L;H++){const q=n.details[H],le=n.details[cZ(D,H)],ie=Ag(q.minW,le==null?void 0:le._minW),te=Eu((E=c[p])==null?void 0:E[D[H]],w);if(te){if($){(a=c.parts)==null||a.forEach(se=>{Tl(P,{[se]:F?te[se]:{[ie]:te[se]}})});continue}if(!$){F?Tl(P,te):P[ie]=te;continue}P[ie]=te}}return P}}function hZ(e){return n=>{var o;const{variant:c,size:p,theme:y}=n,w=uZ(y);return Tl({},Eu((o=e.baseStyle)!=null?o:{},n),w(e,"sizes",p,n),w(e,"variants",c,n))}}function ls(e){return $H(e,["styleConfig","size","variant","colorScheme"])}var dZ={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},fZ={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},pZ={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},mZ={property:dZ,easing:fZ,duration:pZ},gZ=mZ,_Z={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},yZ=_Z,vZ={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},xZ=vZ,bZ={base:"0em",sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"},wZ=bZ,SZ={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},TZ=SZ,EZ={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},CZ=EZ,MZ={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},AZ=MZ,kZ={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},PZ=kZ,IZ={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{"3xs":"0.45rem","2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},zF=IZ,RF={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},zZ={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem",prose:"60ch"},RZ={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},DZ={...RF,...zZ,container:RZ},DF=DZ,LZ={breakpoints:wZ,zIndices:yZ,radii:CZ,blur:PZ,colors:TZ,...zF,sizes:DF,shadows:AZ,space:RF,borders:xZ,transition:gZ},{defineMultiStyleConfig:OZ,definePartsStyle:kg}=$n(["stepper","step","title","description","indicator","separator","icon","number"]),pc=fr("stepper-indicator-size"),Ff=fr("stepper-icon-size"),Nf=fr("stepper-title-font-size"),Pg=fr("stepper-description-font-size"),gg=fr("stepper-accent-color"),BZ=kg(({colorScheme:e})=>({stepper:{display:"flex",justifyContent:"space-between",gap:"4","&[data-orientation=vertical]":{flexDirection:"column",alignItems:"flex-start"},"&[data-orientation=horizontal]":{flexDirection:"row",alignItems:"center"},[gg.variable]:`colors.${e}.500`,_dark:{[gg.variable]:`colors.${e}.200`}},title:{fontSize:Nf.reference,fontWeight:"medium"},description:{fontSize:Pg.reference,color:"chakra-subtle-text"},number:{fontSize:Nf.reference},step:{flexShrink:0,position:"relative",display:"flex",gap:"2","&[data-orientation=horizontal]":{alignItems:"center"},flex:"1","&:last-of-type:not([data-stretch])":{flex:"initial"}},icon:{flexShrink:0,width:Ff.reference,height:Ff.reference},indicator:{flexShrink:0,borderRadius:"full",width:pc.reference,height:pc.reference,display:"flex",justifyContent:"center",alignItems:"center","&[data-status=active]":{borderWidth:"2px",borderColor:gg.reference},"&[data-status=complete]":{bg:gg.reference,color:"chakra-inverse-text"},"&[data-status=incomplete]":{borderWidth:"2px"}},separator:{bg:"chakra-border-color",flex:"1","&[data-status=complete]":{bg:gg.reference},"&[data-orientation=horizontal]":{width:"100%",height:"2px",marginStart:"2"},"&[data-orientation=vertical]":{width:"2px",position:"absolute",height:"100%",maxHeight:`calc(100% - ${pc.reference} - 8px)`,top:`calc(${pc.reference} + 4px)`,insetStart:`calc(${pc.reference} / 2 - 1px)`}}})),FZ=OZ({baseStyle:BZ,sizes:{xs:kg({stepper:{[pc.variable]:"sizes.4",[Ff.variable]:"sizes.3",[Nf.variable]:"fontSizes.xs",[Pg.variable]:"fontSizes.xs"}}),sm:kg({stepper:{[pc.variable]:"sizes.6",[Ff.variable]:"sizes.4",[Nf.variable]:"fontSizes.sm",[Pg.variable]:"fontSizes.xs"}}),md:kg({stepper:{[pc.variable]:"sizes.8",[Ff.variable]:"sizes.5",[Nf.variable]:"fontSizes.md",[Pg.variable]:"fontSizes.sm"}}),lg:kg({stepper:{[pc.variable]:"sizes.10",[Ff.variable]:"sizes.6",[Nf.variable]:"fontSizes.lg",[Pg.variable]:"fontSizes.md"}})},defaultProps:{size:"md",colorScheme:"blue"}});function vn(e,n={}){let o=!1;function c(){if(!o){o=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function p(...D){c();for(const L of D)n[L]=a(L);return vn(e,n)}function y(...D){for(const L of D)L in n||(n[L]=a(L));return vn(e,n)}function w(){return Object.fromEntries(Object.entries(n).map(([L,F])=>[L,F.selector]))}function E(){return Object.fromEntries(Object.entries(n).map(([L,F])=>[L,F.className]))}function a(D){const $=`chakra-${(["container","root"].includes(D??"")?[e]:[e,D]).filter(Boolean).join("__")}`;return{className:$,selector:`.${$}`,toString:()=>D}}return{parts:p,toPart:a,extend:y,selectors:w,classnames:E,get keys(){return Object.keys(n)},__type:{}}}var NZ=vn("accordion").parts("root","container","button","panel").extend("icon"),jZ=vn("alert").parts("title","description","container").extend("icon","spinner"),VZ=vn("avatar").parts("label","badge","container").extend("excessLabel","group"),$Z=vn("breadcrumb").parts("link","item","container").extend("separator");vn("button").parts();var UZ=vn("checkbox").parts("control","icon","container").extend("label");vn("progress").parts("track","filledTrack").extend("label");var GZ=vn("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),WZ=vn("editable").parts("preview","input","textarea"),qZ=vn("form").parts("container","requiredIndicator","helperText"),HZ=vn("formError").parts("text","icon"),ZZ=vn("input").parts("addon","field","element","group"),XZ=vn("list").parts("container","item","icon"),YZ=vn("menu").parts("button","list","item").extend("groupTitle","icon","command","divider"),KZ=vn("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),JZ=vn("numberinput").parts("root","field","stepperGroup","stepper");vn("pininput").parts("field");var QZ=vn("popover").parts("content","header","body","footer").extend("popper","arrow","closeButton"),eX=vn("progress").parts("label","filledTrack","track"),tX=vn("radio").parts("container","control","label"),rX=vn("select").parts("field","icon"),nX=vn("slider").parts("container","track","thumb","filledTrack","mark"),iX=vn("stat").parts("container","label","helpText","number","icon"),oX=vn("switch").parts("container","track","thumb","label"),sX=vn("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),aX=vn("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),lX=vn("tag").parts("container","label","closeButton"),cX=vn("card").parts("container","header","body","footer");vn("stepper").parts("stepper","step","title","description","indicator","separator","icon","number");function Vh(e,n,o){return Math.min(Math.max(e,o),n)}class uX extends Error{constructor(n){super(`Failed to parse color: "${n}"`)}}var Ig=uX;function dA(e){if(typeof e!="string")throw new Ig(e);if(e.trim().toLowerCase()==="transparent")return[0,0,0,0];let n=e.trim();n=yX.test(e)?fX(e):e;const o=pX.exec(n);if(o){const w=Array.from(o).slice(1);return[...w.slice(0,3).map(E=>parseInt(I_(E,2),16)),parseInt(I_(w[3]||"f",2),16)/255]}const c=mX.exec(n);if(c){const w=Array.from(c).slice(1);return[...w.slice(0,3).map(E=>parseInt(E,16)),parseInt(w[3]||"ff",16)/255]}const p=gX.exec(n);if(p){const w=Array.from(p).slice(1);return[...w.slice(0,3).map(E=>parseInt(E,10)),parseFloat(w[3]||"1")]}const y=_X.exec(n);if(y){const[w,E,a,P]=Array.from(y).slice(1).map(parseFloat);if(Vh(0,100,E)!==E)throw new Ig(e);if(Vh(0,100,a)!==a)throw new Ig(e);return[...vX(w,E,a),Number.isNaN(P)?1:P]}throw new Ig(e)}function hX(e){let n=5381,o=e.length;for(;o;)n=n*33^e.charCodeAt(--o);return(n>>>0)%2341}const O4=e=>parseInt(e.replace(/_/g,""),36),dX="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((e,n)=>{const o=O4(n.substring(0,3)),c=O4(n.substring(3)).toString(16);let p="";for(let y=0;y<6-c.length;y++)p+="0";return e[o]=`${p}${c}`,e},{});function fX(e){const n=e.toLowerCase().trim(),o=dX[hX(n)];if(!o)throw new Ig(e);return`#${o}`}const I_=(e,n)=>Array.from(Array(n)).map(()=>e).join(""),pX=new RegExp(`^#${I_("([a-f0-9])",3)}([a-f0-9])?$`,"i"),mX=new RegExp(`^#${I_("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),gX=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${I_(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),_X=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,yX=/^[a-z]+$/i,B4=e=>Math.round(e*255),vX=(e,n,o)=>{let c=o/100;if(n===0)return[c,c,c].map(B4);const p=(e%360+360)%360/60,y=(1-Math.abs(2*c-1))*(n/100),w=y*(1-Math.abs(p%2-1));let E=0,a=0,P=0;p>=0&&p<1?(E=y,a=w):p>=1&&p<2?(E=w,a=y):p>=2&&p<3?(a=y,P=w):p>=3&&p<4?(a=w,P=y):p>=4&&p<5?(E=w,P=y):p>=5&&p<6&&(E=y,P=w);const D=c-y/2,L=E+D,F=a+D,$=P+D;return[L,F,$].map(B4)};function xX(e,n,o,c){return`rgba(${Vh(0,255,e).toFixed()}, ${Vh(0,255,n).toFixed()}, ${Vh(0,255,o).toFixed()}, ${parseFloat(Vh(0,1,c).toFixed(3))})`}function bX(e,n){const[o,c,p,y]=dA(e);return xX(o,c,p,y-n)}function wX(e){const[n,o,c,p]=dA(e);let y=w=>{const E=Vh(0,255,w).toString(16);return E.length===1?`0${E}`:E};return`#${y(n)}${y(o)}${y(c)}${p<1?y(Math.round(p*255)):""}`}function SX(e,n,o,c,p){for(n=n.split?n.split("."):n,c=0;c<n.length;c++)e=e?e[n[c]]:p;return e===p?o:e}var TX=e=>Object.keys(e).length===0,Lo=(e,n,o)=>{const c=SX(e,`colors.${n}`,n);try{return wX(c),c}catch{return o??"#000000"}},EX=e=>{const[n,o,c]=dA(e);return(n*299+o*587+c*114)/1e3},CX=e=>n=>{const o=Lo(n,e);return EX(o)<128?"dark":"light"},MX=e=>n=>CX(e)(n)==="dark",xp=(e,n)=>o=>{const c=Lo(o,e);return bX(c,1-n)};function F4(e="1rem",n="rgba(255, 255, 255, 0.15)"){return{backgroundImage:`linear-gradient(
    45deg,
    ${n} 25%,
    transparent 25%,
    transparent 50%,
    ${n} 50%,
    ${n} 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:`${e} ${e}`}}var AX=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;function kX(e){const n=AX();return!e||TX(e)?n:e.string&&e.colors?IX(e.string,e.colors):e.string&&!e.colors?PX(e.string):e.colors&&!e.string?zX(e.colors):n}function PX(e){let n=0;if(e.length===0)return n.toString();for(let c=0;c<e.length;c+=1)n=e.charCodeAt(c)+((n<<5)-n),n=n&n;let o="#";for(let c=0;c<3;c+=1){const p=n>>c*8&255;o+=`00${p.toString(16)}`.substr(-2)}return o}function IX(e,n){let o=0;if(e.length===0)return n[0];for(let c=0;c<e.length;c+=1)o=e.charCodeAt(c)+((o<<5)-o),o=o&o;return o=(o%n.length+n.length)%n.length,n[o]}function zX(e){return e[Math.floor(Math.random()*e.length)]}function dr(e,n){return o=>o.colorMode==="dark"?n:e}function fA(e){const{orientation:n,vertical:o,horizontal:c}=e;return n?n==="vertical"?o:c:{}}function LF(e){return ks(e)&&e.reference?e.reference:String(e)}var db=(e,...n)=>n.map(LF).join(` ${e} `).replace(/calc/g,""),N4=(...e)=>`calc(${db("+",...e)})`,j4=(...e)=>`calc(${db("-",...e)})`,pC=(...e)=>`calc(${db("*",...e)})`,V4=(...e)=>`calc(${db("/",...e)})`,$4=e=>{const n=LF(e);return n!=null&&!Number.isNaN(parseFloat(n))?String(n).startsWith("-")?String(n).slice(1):`-${n}`:pC(n,-1)},mc=Object.assign(e=>({add:(...n)=>mc(N4(e,...n)),subtract:(...n)=>mc(j4(e,...n)),multiply:(...n)=>mc(pC(e,...n)),divide:(...n)=>mc(V4(e,...n)),negate:()=>mc($4(e)),toString:()=>e.toString()}),{add:N4,subtract:j4,multiply:pC,divide:V4,negate:$4});function RX(e){return!Number.isInteger(parseFloat(e.toString()))}function DX(e,n="-"){return e.replace(/\s+/g,n)}function OF(e){const n=DX(e.toString());return n.includes("\\.")?e:RX(e)?n.replace(".","\\."):e}function LX(e,n=""){return[n,OF(e)].filter(Boolean).join("-")}function OX(e,n){return`var(${OF(e)}${n?`, ${n}`:""})`}function BX(e,n=""){return`--${LX(e,n)}`}function $i(e,n){const o=BX(e,n==null?void 0:n.prefix);return{variable:o,reference:OX(o,FX(n==null?void 0:n.fallback))}}function FX(e){return typeof e=="string"?e:e==null?void 0:e.reference}var{defineMultiStyleConfig:NX,definePartsStyle:ix}=$n(oX.keys),Kg=$i("switch-track-width"),qh=$i("switch-track-height"),xT=$i("switch-track-diff"),jX=mc.subtract(Kg,qh),mC=$i("switch-thumb-x"),_g=$i("switch-bg"),VX=e=>{const{colorScheme:n}=e;return{borderRadius:"full",p:"0.5",width:[Kg.reference],height:[qh.reference],transitionProperty:"common",transitionDuration:"fast",[_g.variable]:"colors.gray.300",_dark:{[_g.variable]:"colors.whiteAlpha.400"},_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{[_g.variable]:`colors.${n}.500`,_dark:{[_g.variable]:`colors.${n}.200`}},bg:_g.reference}},$X={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[qh.reference],height:[qh.reference],_checked:{transform:`translateX(${mC.reference})`}},UX=ix(e=>({container:{[xT.variable]:jX,[mC.variable]:xT.reference,_rtl:{[mC.variable]:mc(xT).negate().toString()}},track:VX(e),thumb:$X})),GX={sm:ix({container:{[Kg.variable]:"1.375rem",[qh.variable]:"sizes.3"}}),md:ix({container:{[Kg.variable]:"1.875rem",[qh.variable]:"sizes.4"}}),lg:ix({container:{[Kg.variable]:"2.875rem",[qh.variable]:"sizes.6"}})},WX=NX({baseStyle:UX,sizes:GX,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:qX,definePartsStyle:op}=$n(sX.keys),HX=op({table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}}),Qx={"&[data-is-numeric=true]":{textAlign:"end"}},ZX=op(e=>{const{colorScheme:n}=e;return{th:{color:dr("gray.600","gray.400")(e),borderBottom:"1px",borderColor:dr(`${n}.100`,`${n}.700`)(e),...Qx},td:{borderBottom:"1px",borderColor:dr(`${n}.100`,`${n}.700`)(e),...Qx},caption:{color:dr("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),XX=op(e=>{const{colorScheme:n}=e;return{th:{color:dr("gray.600","gray.400")(e),borderBottom:"1px",borderColor:dr(`${n}.100`,`${n}.700`)(e),...Qx},td:{borderBottom:"1px",borderColor:dr(`${n}.100`,`${n}.700`)(e),...Qx},caption:{color:dr("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:dr(`${n}.100`,`${n}.700`)(e)},td:{background:dr(`${n}.100`,`${n}.700`)(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),YX={simple:ZX,striped:XX,unstyled:{}},KX={sm:op({th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}}),md:op({th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}}),lg:op({th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}})},JX=qX({baseStyle:HX,variants:YX,sizes:KX,defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}}),es=fr("tabs-color"),Ra=fr("tabs-bg"),bv=fr("tabs-border-color"),{defineMultiStyleConfig:QX,definePartsStyle:kl}=$n(aX.keys),eY=e=>{const{orientation:n}=e;return{display:n==="vertical"?"flex":"block"}},tY=e=>{const{isFitted:n}=e;return{flex:n?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focusVisible:{zIndex:1,boxShadow:"outline"},_disabled:{cursor:"not-allowed",opacity:.4}}},rY=e=>{const{align:n="start",orientation:o}=e;return{justifyContent:{end:"flex-end",center:"center",start:"flex-start"}[n],flexDirection:o==="vertical"?"column":"row"}},nY={p:4},iY=kl(e=>({root:eY(e),tab:tY(e),tablist:rY(e),tabpanel:nY})),oY={sm:kl({tab:{py:1,px:4,fontSize:"sm"}}),md:kl({tab:{fontSize:"md",py:2,px:4}}),lg:kl({tab:{fontSize:"lg",py:3,px:4}})},sY=kl(e=>{const{colorScheme:n,orientation:o}=e,c=o==="vertical",p=c?"borderStart":"borderBottom",y=c?"marginStart":"marginBottom";return{tablist:{[p]:"2px solid",borderColor:"inherit"},tab:{[p]:"2px solid",borderColor:"transparent",[y]:"-2px",_selected:{[es.variable]:`colors.${n}.600`,_dark:{[es.variable]:`colors.${n}.300`},borderColor:"currentColor"},_active:{[Ra.variable]:"colors.gray.200",_dark:{[Ra.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:es.reference,bg:Ra.reference}}}),aY=kl(e=>{const{colorScheme:n}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",[bv.variable]:"transparent",_selected:{[es.variable]:`colors.${n}.600`,[bv.variable]:"colors.white",_dark:{[es.variable]:`colors.${n}.300`,[bv.variable]:"colors.gray.800"},borderColor:"inherit",borderBottomColor:bv.reference},color:es.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),lY=kl(e=>{const{colorScheme:n}=e;return{tab:{border:"1px solid",borderColor:"inherit",[Ra.variable]:"colors.gray.50",_dark:{[Ra.variable]:"colors.whiteAlpha.50"},mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{[Ra.variable]:"colors.white",[es.variable]:`colors.${n}.600`,_dark:{[Ra.variable]:"colors.gray.800",[es.variable]:`colors.${n}.300`},borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"},color:es.reference,bg:Ra.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),cY=kl(e=>{const{colorScheme:n,theme:o}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:Lo(o,`${n}.700`),bg:Lo(o,`${n}.100`)}}}}),uY=kl(e=>{const{colorScheme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",[es.variable]:"colors.gray.600",_dark:{[es.variable]:"inherit"},_selected:{[es.variable]:"colors.white",[Ra.variable]:`colors.${n}.600`,_dark:{[es.variable]:"colors.gray.800",[Ra.variable]:`colors.${n}.300`}},color:es.reference,bg:Ra.reference}}}),hY=kl({}),dY={line:sY,enclosed:aY,"enclosed-colored":lY,"soft-rounded":cY,"solid-rounded":uY,unstyled:hY},fY=QX({baseStyle:iY,sizes:oY,variants:dY,defaultProps:{size:"md",variant:"line",colorScheme:"blue"}}),bi=OH("badge",["bg","color","shadow"]),pY={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold",bg:bi.bg.reference,color:bi.color.reference,boxShadow:bi.shadow.reference},mY=e=>{const{colorScheme:n,theme:o}=e,c=xp(`${n}.500`,.6)(o);return{[bi.bg.variable]:`colors.${n}.500`,[bi.color.variable]:"colors.white",_dark:{[bi.bg.variable]:c,[bi.color.variable]:"colors.whiteAlpha.800"}}},gY=e=>{const{colorScheme:n,theme:o}=e,c=xp(`${n}.200`,.16)(o);return{[bi.bg.variable]:`colors.${n}.100`,[bi.color.variable]:`colors.${n}.800`,_dark:{[bi.bg.variable]:c,[bi.color.variable]:`colors.${n}.200`}}},_Y=e=>{const{colorScheme:n,theme:o}=e,c=xp(`${n}.200`,.8)(o);return{[bi.color.variable]:`colors.${n}.500`,_dark:{[bi.color.variable]:c},[bi.shadow.variable]:`inset 0 0 0px 1px ${bi.color.reference}`}},yY={solid:mY,subtle:gY,outline:_Y},Jg={baseStyle:pY,variants:yY,defaultProps:{variant:"subtle",colorScheme:"gray"}},{defineMultiStyleConfig:vY,definePartsStyle:Hh}=$n(lX.keys),U4=fr("tag-bg"),G4=fr("tag-color"),bT=fr("tag-shadow"),ox=fr("tag-min-height"),sx=fr("tag-min-width"),ax=fr("tag-font-size"),lx=fr("tag-padding-inline"),xY={fontWeight:"medium",lineHeight:1.2,outline:0,[G4.variable]:bi.color.reference,[U4.variable]:bi.bg.reference,[bT.variable]:bi.shadow.reference,color:G4.reference,bg:U4.reference,boxShadow:bT.reference,borderRadius:"md",minH:ox.reference,minW:sx.reference,fontSize:ax.reference,px:lx.reference,_focusVisible:{[bT.variable]:"shadows.outline"}},bY={lineHeight:1.2,overflow:"visible"},wY={fontSize:"lg",w:"5",h:"5",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"1.5",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},SY=Hh({container:xY,label:bY,closeButton:wY}),TY={sm:Hh({container:{[ox.variable]:"sizes.5",[sx.variable]:"sizes.5",[ax.variable]:"fontSizes.xs",[lx.variable]:"space.2"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}}),md:Hh({container:{[ox.variable]:"sizes.6",[sx.variable]:"sizes.6",[ax.variable]:"fontSizes.sm",[lx.variable]:"space.2"}}),lg:Hh({container:{[ox.variable]:"sizes.8",[sx.variable]:"sizes.8",[ax.variable]:"fontSizes.md",[lx.variable]:"space.3"}})},EY={subtle:Hh(e=>{var n;return{container:(n=Jg.variants)==null?void 0:n.subtle(e)}}),solid:Hh(e=>{var n;return{container:(n=Jg.variants)==null?void 0:n.solid(e)}}),outline:Hh(e=>{var n;return{container:(n=Jg.variants)==null?void 0:n.outline(e)}})},CY=vY({variants:EY,baseStyle:SY,sizes:TY,defaultProps:{size:"md",variant:"subtle",colorScheme:"gray"}}),{definePartsStyle:yc,defineMultiStyleConfig:MY}=$n(ZZ.keys),jf=fr("input-height"),Vf=fr("input-font-size"),$f=fr("input-padding"),Uf=fr("input-border-radius"),AY=yc({addon:{height:jf.reference,fontSize:Vf.reference,px:$f.reference,borderRadius:Uf.reference},field:{width:"100%",height:jf.reference,fontSize:Vf.reference,px:$f.reference,borderRadius:Uf.reference,minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"}}}),fu={lg:{[Vf.variable]:"fontSizes.lg",[$f.variable]:"space.4",[Uf.variable]:"radii.md",[jf.variable]:"sizes.12"},md:{[Vf.variable]:"fontSizes.md",[$f.variable]:"space.4",[Uf.variable]:"radii.md",[jf.variable]:"sizes.10"},sm:{[Vf.variable]:"fontSizes.sm",[$f.variable]:"space.3",[Uf.variable]:"radii.sm",[jf.variable]:"sizes.8"},xs:{[Vf.variable]:"fontSizes.xs",[$f.variable]:"space.2",[Uf.variable]:"radii.sm",[jf.variable]:"sizes.6"}},kY={lg:yc({field:fu.lg,group:fu.lg}),md:yc({field:fu.md,group:fu.md}),sm:yc({field:fu.sm,group:fu.sm}),xs:yc({field:fu.xs,group:fu.xs})};function pA(e){const{focusBorderColor:n,errorBorderColor:o}=e;return{focusBorderColor:n||dr("blue.500","blue.300")(e),errorBorderColor:o||dr("red.500","red.300")(e)}}var PY=yc(e=>{const{theme:n}=e,{focusBorderColor:o,errorBorderColor:c}=pA(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:dr("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Lo(n,c),boxShadow:`0 0 0 1px ${Lo(n,c)}`},_focusVisible:{zIndex:1,borderColor:Lo(n,o),boxShadow:`0 0 0 1px ${Lo(n,o)}`}},addon:{border:"1px solid",borderColor:dr("inherit","whiteAlpha.50")(e),bg:dr("gray.100","whiteAlpha.300")(e)}}}),IY=yc(e=>{const{theme:n}=e,{focusBorderColor:o,errorBorderColor:c}=pA(e);return{field:{border:"2px solid",borderColor:"transparent",bg:dr("gray.100","whiteAlpha.50")(e),_hover:{bg:dr("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Lo(n,c)},_focusVisible:{bg:"transparent",borderColor:Lo(n,o)}},addon:{border:"2px solid",borderColor:"transparent",bg:dr("gray.100","whiteAlpha.50")(e)}}}),zY=yc(e=>{const{theme:n}=e,{focusBorderColor:o,errorBorderColor:c}=pA(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Lo(n,c),boxShadow:`0px 1px 0px 0px ${Lo(n,c)}`},_focusVisible:{borderColor:Lo(n,o),boxShadow:`0px 1px 0px 0px ${Lo(n,o)}`}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}}),RY=yc({field:{bg:"transparent",px:"0",height:"auto"},addon:{bg:"transparent",px:"0",height:"auto"}}),DY={outline:PY,filled:IY,flushed:zY,unstyled:RY},yn=MY({baseStyle:AY,sizes:kY,variants:DY,defaultProps:{size:"md",variant:"outline"}}),W4,LY={...(W4=yn.baseStyle)==null?void 0:W4.field,paddingY:"2",minHeight:"20",lineHeight:"short",verticalAlign:"top"},q4,H4,OY={outline:e=>{var n,o;return(o=(n=yn.variants)==null?void 0:n.outline(e).field)!=null?o:{}},flushed:e=>{var n,o;return(o=(n=yn.variants)==null?void 0:n.flushed(e).field)!=null?o:{}},filled:e=>{var n,o;return(o=(n=yn.variants)==null?void 0:n.filled(e).field)!=null?o:{}},unstyled:(H4=(q4=yn.variants)==null?void 0:q4.unstyled.field)!=null?H4:{}},Z4,X4,Y4,K4,J4,Q4,eD,tD,BY={xs:(X4=(Z4=yn.sizes)==null?void 0:Z4.xs.field)!=null?X4:{},sm:(K4=(Y4=yn.sizes)==null?void 0:Y4.sm.field)!=null?K4:{},md:(Q4=(J4=yn.sizes)==null?void 0:J4.md.field)!=null?Q4:{},lg:(tD=(eD=yn.sizes)==null?void 0:eD.lg.field)!=null?tD:{}},FY={baseStyle:LY,sizes:BY,variants:OY,defaultProps:{size:"md",variant:"outline"}},wv=$i("tooltip-bg"),wT=$i("tooltip-fg"),NY=$i("popper-arrow-bg"),jY={bg:wv.reference,color:wT.reference,[wv.variable]:"colors.gray.700",[wT.variable]:"colors.whiteAlpha.900",_dark:{[wv.variable]:"colors.gray.300",[wT.variable]:"colors.gray.900"},[NY.variable]:wv.reference,px:"2",py:"0.5",borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"xs",zIndex:"tooltip"},VY={baseStyle:jY},{defineMultiStyleConfig:$Y,definePartsStyle:zg}=$n(eX.keys),UY=e=>{const{colorScheme:n,theme:o,isIndeterminate:c,hasStripe:p}=e,y=dr(F4(),F4("1rem","rgba(0,0,0,0.1)"))(e),w=dr(`${n}.500`,`${n}.200`)(e),E=`linear-gradient(
    to right,
    transparent 0%,
    ${Lo(o,w)} 50%,
    transparent 100%
  )`;return{...!c&&p&&y,...c?{bgImage:E}:{bgColor:w}}},GY={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},WY=e=>({bg:dr("gray.100","whiteAlpha.300")(e)}),qY=e=>({transitionProperty:"common",transitionDuration:"slow",...UY(e)}),HY=zg(e=>({label:GY,filledTrack:qY(e),track:WY(e)})),ZY={xs:zg({track:{h:"1"}}),sm:zg({track:{h:"2"}}),md:zg({track:{h:"3"}}),lg:zg({track:{h:"4"}})},XY=$Y({sizes:ZY,baseStyle:HY,defaultProps:{size:"md",colorScheme:"blue"}}),YY=e=>typeof e=="function";function Bo(e,...n){return YY(e)?e(...n):e}var{definePartsStyle:cx,defineMultiStyleConfig:KY}=$n(UZ.keys),Qg=fr("checkbox-size"),JY=e=>{const{colorScheme:n}=e;return{w:Qg.reference,h:Qg.reference,transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:dr(`${n}.500`,`${n}.200`)(e),borderColor:dr(`${n}.500`,`${n}.200`)(e),color:dr("white","gray.900")(e),_hover:{bg:dr(`${n}.600`,`${n}.300`)(e),borderColor:dr(`${n}.600`,`${n}.300`)(e)},_disabled:{borderColor:dr("gray.200","transparent")(e),bg:dr("gray.200","whiteAlpha.300")(e),color:dr("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:dr(`${n}.500`,`${n}.200`)(e),borderColor:dr(`${n}.500`,`${n}.200`)(e),color:dr("white","gray.900")(e)},_disabled:{bg:dr("gray.100","whiteAlpha.100")(e),borderColor:dr("gray.100","transparent")(e)},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:dr("red.500","red.300")(e)}}},QY={_disabled:{cursor:"not-allowed"}},eK={userSelect:"none",_disabled:{opacity:.4}},tK={transitionProperty:"transform",transitionDuration:"normal"},rK=cx(e=>({icon:tK,container:QY,control:Bo(JY,e),label:eK})),nK={sm:cx({control:{[Qg.variable]:"sizes.3"},label:{fontSize:"sm"},icon:{fontSize:"3xs"}}),md:cx({control:{[Qg.variable]:"sizes.4"},label:{fontSize:"md"},icon:{fontSize:"2xs"}}),lg:cx({control:{[Qg.variable]:"sizes.5"},label:{fontSize:"lg"},icon:{fontSize:"2xs"}})},e1=KY({baseStyle:rK,sizes:nK,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:iK,definePartsStyle:ux}=$n(tX.keys),oK=e=>{var n;const o=(n=Bo(e1.baseStyle,e))==null?void 0:n.control;return{...o,borderRadius:"full",_checked:{...o==null?void 0:o._checked,_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}}}},sK=ux(e=>{var n,o,c,p;return{label:(o=(n=e1).baseStyle)==null?void 0:o.call(n,e).label,container:(p=(c=e1).baseStyle)==null?void 0:p.call(c,e).container,control:oK(e)}}),aK={md:ux({control:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:ux({control:{w:"5",h:"5"},label:{fontSize:"lg"}}),sm:ux({control:{width:"3",height:"3"},label:{fontSize:"sm"}})},lK=iK({baseStyle:sK,sizes:aK,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:cK,definePartsStyle:uK}=$n(rX.keys),Sv=fr("select-bg"),rD,hK={...(rD=yn.baseStyle)==null?void 0:rD.field,appearance:"none",paddingBottom:"1px",lineHeight:"normal",bg:Sv.reference,[Sv.variable]:"colors.white",_dark:{[Sv.variable]:"colors.gray.700"},"> option, > optgroup":{bg:Sv.reference}},dK={width:"6",height:"100%",insetEnd:"2",position:"relative",color:"currentColor",fontSize:"xl",_disabled:{opacity:.5}},fK=uK({field:hK,icon:dK}),Tv={paddingInlineEnd:"8"},nD,iD,oD,sD,aD,lD,cD,uD,pK={lg:{...(nD=yn.sizes)==null?void 0:nD.lg,field:{...(iD=yn.sizes)==null?void 0:iD.lg.field,...Tv}},md:{...(oD=yn.sizes)==null?void 0:oD.md,field:{...(sD=yn.sizes)==null?void 0:sD.md.field,...Tv}},sm:{...(aD=yn.sizes)==null?void 0:aD.sm,field:{...(lD=yn.sizes)==null?void 0:lD.sm.field,...Tv}},xs:{...(cD=yn.sizes)==null?void 0:cD.xs,field:{...(uD=yn.sizes)==null?void 0:uD.xs.field,...Tv},icon:{insetEnd:"1"}}},mK=cK({baseStyle:fK,sizes:pK,variants:yn.variants,defaultProps:yn.defaultProps}),ST=fr("skeleton-start-color"),TT=fr("skeleton-end-color"),gK={[ST.variable]:"colors.gray.100",[TT.variable]:"colors.gray.400",_dark:{[ST.variable]:"colors.gray.800",[TT.variable]:"colors.gray.600"},background:ST.reference,borderColor:TT.reference,opacity:.7,borderRadius:"sm"},_K={baseStyle:gK},ET=fr("skip-link-bg"),yK={borderRadius:"md",fontWeight:"semibold",_focusVisible:{boxShadow:"outline",padding:"4",position:"fixed",top:"6",insetStart:"6",[ET.variable]:"colors.white",_dark:{[ET.variable]:"colors.gray.700"},bg:ET.reference}},vK={baseStyle:yK},{defineMultiStyleConfig:xK,definePartsStyle:fb}=$n(nX.keys),z_=fr("slider-thumb-size"),R_=fr("slider-track-size"),bu=fr("slider-bg"),bK=e=>{const{orientation:n}=e;return{display:"inline-block",position:"relative",cursor:"pointer",_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"},...fA({orientation:n,vertical:{h:"100%"},horizontal:{w:"100%"}})}},wK=e=>({...fA({orientation:e.orientation,horizontal:{h:R_.reference},vertical:{w:R_.reference}}),overflow:"hidden",borderRadius:"sm",[bu.variable]:"colors.gray.200",_dark:{[bu.variable]:"colors.whiteAlpha.200"},_disabled:{[bu.variable]:"colors.gray.300",_dark:{[bu.variable]:"colors.whiteAlpha.300"}},bg:bu.reference}),SK=e=>{const{orientation:n}=e;return{...fA({orientation:n,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}}),w:z_.reference,h:z_.reference,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",outline:0,zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{bg:"gray.300"}}},TK=e=>{const{colorScheme:n}=e;return{width:"inherit",height:"inherit",[bu.variable]:`colors.${n}.500`,_dark:{[bu.variable]:`colors.${n}.200`},bg:bu.reference}},EK=fb(e=>({container:bK(e),track:wK(e),thumb:SK(e),filledTrack:TK(e)})),CK=fb({container:{[z_.variable]:"sizes.4",[R_.variable]:"sizes.1"}}),MK=fb({container:{[z_.variable]:"sizes.3.5",[R_.variable]:"sizes.1"}}),AK=fb({container:{[z_.variable]:"sizes.2.5",[R_.variable]:"sizes.0.5"}}),kK={lg:CK,md:MK,sm:AK},PK=xK({baseStyle:EK,sizes:kK,defaultProps:{size:"md",colorScheme:"blue"}}),Bh=$i("spinner-size"),IK={width:[Bh.reference],height:[Bh.reference]},zK={xs:{[Bh.variable]:"sizes.3"},sm:{[Bh.variable]:"sizes.4"},md:{[Bh.variable]:"sizes.6"},lg:{[Bh.variable]:"sizes.8"},xl:{[Bh.variable]:"sizes.12"}},RK={baseStyle:IK,sizes:zK,defaultProps:{size:"md"}},{defineMultiStyleConfig:DK,definePartsStyle:BF}=$n(iX.keys),LK={fontWeight:"medium"},OK={opacity:.8,marginBottom:"2"},BK={verticalAlign:"baseline",fontWeight:"semibold"},FK={marginEnd:1,w:"3.5",h:"3.5",verticalAlign:"middle"},NK=BF({container:{},label:LK,helpText:OK,number:BK,icon:FK}),jK={md:BF({label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}})},VK=DK({baseStyle:NK,sizes:jK,defaultProps:{size:"md"}}),CT=fr("kbd-bg"),$K={[CT.variable]:"colors.gray.100",_dark:{[CT.variable]:"colors.whiteAlpha.100"},bg:CT.reference,borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"},UK={baseStyle:$K},GK={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},WK={baseStyle:GK},{defineMultiStyleConfig:qK,definePartsStyle:HK}=$n(XZ.keys),ZK={marginEnd:"2",display:"inline",verticalAlign:"text-bottom"},XK=HK({icon:ZK}),YK=qK({baseStyle:XK}),{defineMultiStyleConfig:KK,definePartsStyle:JK}=$n(YZ.keys),vl=fr("menu-bg"),MT=fr("menu-shadow"),QK={[vl.variable]:"#fff",[MT.variable]:"shadows.sm",_dark:{[vl.variable]:"colors.gray.700",[MT.variable]:"shadows.dark-lg"},color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px",bg:vl.reference,boxShadow:MT.reference},eJ={py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{[vl.variable]:"colors.gray.100",_dark:{[vl.variable]:"colors.whiteAlpha.100"}},_active:{[vl.variable]:"colors.gray.200",_dark:{[vl.variable]:"colors.whiteAlpha.200"}},_expanded:{[vl.variable]:"colors.gray.100",_dark:{[vl.variable]:"colors.whiteAlpha.100"}},_disabled:{opacity:.4,cursor:"not-allowed"},bg:vl.reference},tJ={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},rJ={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0},nJ={opacity:.6},iJ={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"2",opacity:.6},oJ={transitionProperty:"common",transitionDuration:"normal"},sJ=JK({button:oJ,list:QK,item:eJ,groupTitle:tJ,icon:rJ,command:nJ,divider:iJ}),aJ=KK({baseStyle:sJ}),{defineMultiStyleConfig:lJ,definePartsStyle:gC}=$n(KZ.keys),AT=fr("modal-bg"),kT=fr("modal-shadow"),cJ={bg:"blackAlpha.600",zIndex:"modal"},uJ=e=>{const{isCentered:n,scrollBehavior:o}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:n?"center":"flex-start",overflow:o==="inside"?"hidden":"auto",overscrollBehaviorY:"none"}},hJ=e=>{const{isCentered:n,scrollBehavior:o}=e;return{borderRadius:"md",color:"inherit",my:n?"auto":"16",mx:n?"auto":void 0,zIndex:"modal",maxH:o==="inside"?"calc(100% - 7.5rem)":void 0,[AT.variable]:"colors.white",[kT.variable]:"shadows.lg",_dark:{[AT.variable]:"colors.gray.700",[kT.variable]:"shadows.dark-lg"},bg:AT.reference,boxShadow:kT.reference}},dJ={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},fJ={position:"absolute",top:"2",insetEnd:"3"},pJ=e=>{const{scrollBehavior:n}=e;return{px:"6",py:"2",flex:"1",overflow:n==="inside"?"auto":void 0}},mJ={px:"6",py:"4"},gJ=gC(e=>({overlay:cJ,dialogContainer:Bo(uJ,e),dialog:Bo(hJ,e),header:dJ,closeButton:fJ,body:Bo(pJ,e),footer:mJ}));function Aa(e){return gC(e==="full"?{dialog:{maxW:"100vw",minH:"$100vh",my:"0",borderRadius:"0"}}:{dialog:{maxW:e}})}var _J={xs:Aa("xs"),sm:Aa("sm"),md:Aa("md"),lg:Aa("lg"),xl:Aa("xl"),"2xl":Aa("2xl"),"3xl":Aa("3xl"),"4xl":Aa("4xl"),"5xl":Aa("5xl"),"6xl":Aa("6xl"),full:Aa("full")},yJ=lJ({baseStyle:gJ,sizes:_J,defaultProps:{size:"md"}}),{defineMultiStyleConfig:vJ,definePartsStyle:FF}=$n(JZ.keys),mA=$i("number-input-stepper-width"),NF=$i("number-input-input-padding"),xJ=mc(mA).add("0.5rem").toString(),PT=$i("number-input-bg"),IT=$i("number-input-color"),zT=$i("number-input-border-color"),bJ={[mA.variable]:"sizes.6",[NF.variable]:xJ},wJ=e=>{var n,o;return(o=(n=Bo(yn.baseStyle,e))==null?void 0:n.field)!=null?o:{}},SJ={width:mA.reference},TJ={borderStart:"1px solid",borderStartColor:zT.reference,color:IT.reference,bg:PT.reference,[IT.variable]:"colors.chakra-body-text",[zT.variable]:"colors.chakra-border-color",_dark:{[IT.variable]:"colors.whiteAlpha.800",[zT.variable]:"colors.whiteAlpha.300"},_active:{[PT.variable]:"colors.gray.200",_dark:{[PT.variable]:"colors.whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed"}},EJ=FF(e=>{var n;return{root:bJ,field:(n=Bo(wJ,e))!=null?n:{},stepperGroup:SJ,stepper:TJ}});function Ev(e){var n,o,c;const p=(n=yn.sizes)==null?void 0:n[e],y={lg:"md",md:"md",sm:"sm",xs:"sm"},w=(c=(o=p.field)==null?void 0:o.fontSize)!=null?c:"md",E=zF.fontSizes[w];return FF({field:{...p.field,paddingInlineEnd:NF.reference,verticalAlign:"top"},stepper:{fontSize:mc(E).multiply(.75).toString(),_first:{borderTopEndRadius:y[e]},_last:{borderBottomEndRadius:y[e],mt:"-1px",borderTopWidth:1}}})}var CJ={xs:Ev("xs"),sm:Ev("sm"),md:Ev("md"),lg:Ev("lg")},MJ=vJ({baseStyle:EJ,sizes:CJ,variants:yn.variants,defaultProps:yn.defaultProps}),hD,AJ={...(hD=yn.baseStyle)==null?void 0:hD.field,textAlign:"center"},kJ={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},dD,fD,PJ={outline:e=>{var n,o,c;return(c=(o=Bo((n=yn.variants)==null?void 0:n.outline,e))==null?void 0:o.field)!=null?c:{}},flushed:e=>{var n,o,c;return(c=(o=Bo((n=yn.variants)==null?void 0:n.flushed,e))==null?void 0:o.field)!=null?c:{}},filled:e=>{var n,o,c;return(c=(o=Bo((n=yn.variants)==null?void 0:n.filled,e))==null?void 0:o.field)!=null?c:{}},unstyled:(fD=(dD=yn.variants)==null?void 0:dD.unstyled.field)!=null?fD:{}},IJ={baseStyle:AJ,sizes:kJ,variants:PJ,defaultProps:yn.defaultProps},{defineMultiStyleConfig:zJ,definePartsStyle:RJ}=$n(QZ.keys),Cv=$i("popper-bg"),DJ=$i("popper-arrow-bg"),pD=$i("popper-arrow-shadow-color"),LJ={zIndex:10},OJ={[Cv.variable]:"colors.white",bg:Cv.reference,[DJ.variable]:Cv.reference,[pD.variable]:"colors.gray.200",_dark:{[Cv.variable]:"colors.gray.700",[pD.variable]:"colors.whiteAlpha.300"},width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focusVisible:{outline:0,boxShadow:"outline"}},BJ={px:3,py:2,borderBottomWidth:"1px"},FJ={px:3,py:2},NJ={px:3,py:2,borderTopWidth:"1px"},jJ={position:"absolute",borderRadius:"md",top:1,insetEnd:2,padding:2},VJ=RJ({popper:LJ,content:OJ,header:BJ,body:FJ,footer:NJ,closeButton:jJ}),$J=zJ({baseStyle:VJ}),{definePartsStyle:_C,defineMultiStyleConfig:UJ}=$n(GZ.keys),RT=fr("drawer-bg"),DT=fr("drawer-box-shadow");function vf(e){return _C(e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}})}var GJ={bg:"blackAlpha.600",zIndex:"modal"},WJ={display:"flex",zIndex:"modal",justifyContent:"center"},qJ=e=>{const{isFullHeight:n}=e;return{...n&&{height:"100vh"},zIndex:"modal",maxH:"100vh",color:"inherit",[RT.variable]:"colors.white",[DT.variable]:"shadows.lg",_dark:{[RT.variable]:"colors.gray.700",[DT.variable]:"shadows.dark-lg"},bg:RT.reference,boxShadow:DT.reference}},HJ={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},ZJ={position:"absolute",top:"2",insetEnd:"3"},XJ={px:"6",py:"2",flex:"1",overflow:"auto"},YJ={px:"6",py:"4"},KJ=_C(e=>({overlay:GJ,dialogContainer:WJ,dialog:Bo(qJ,e),header:HJ,closeButton:ZJ,body:XJ,footer:YJ})),JJ={xs:vf("xs"),sm:vf("md"),md:vf("lg"),lg:vf("2xl"),xl:vf("4xl"),full:vf("full")},QJ=UJ({baseStyle:KJ,sizes:JJ,defaultProps:{size:"xs"}}),{definePartsStyle:eQ,defineMultiStyleConfig:tQ}=$n(WZ.keys),rQ={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal"},nQ={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},iQ={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},oQ=eQ({preview:rQ,input:nQ,textarea:iQ}),sQ=tQ({baseStyle:oQ}),{definePartsStyle:aQ,defineMultiStyleConfig:lQ}=$n(qZ.keys),sp=fr("form-control-color"),cQ={marginStart:"1",[sp.variable]:"colors.red.500",_dark:{[sp.variable]:"colors.red.300"},color:sp.reference},uQ={mt:"2",[sp.variable]:"colors.gray.600",_dark:{[sp.variable]:"colors.whiteAlpha.600"},color:sp.reference,lineHeight:"normal",fontSize:"sm"},hQ=aQ({container:{width:"100%",position:"relative"},requiredIndicator:cQ,helperText:uQ}),dQ=lQ({baseStyle:hQ}),{definePartsStyle:fQ,defineMultiStyleConfig:pQ}=$n(HZ.keys),ap=fr("form-error-color"),mQ={[ap.variable]:"colors.red.500",_dark:{[ap.variable]:"colors.red.300"},color:ap.reference,mt:"2",fontSize:"sm",lineHeight:"normal"},gQ={marginEnd:"0.5em",[ap.variable]:"colors.red.500",_dark:{[ap.variable]:"colors.red.300"},color:ap.reference},_Q=fQ({text:mQ,icon:gQ}),yQ=pQ({baseStyle:_Q}),vQ={fontSize:"md",marginEnd:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},xQ={baseStyle:vQ},bQ={fontFamily:"heading",fontWeight:"bold"},wQ={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},SQ={baseStyle:bQ,sizes:wQ,defaultProps:{size:"xl"}},{defineMultiStyleConfig:TQ,definePartsStyle:EQ}=$n($Z.keys),LT=fr("breadcrumb-link-decor"),CQ={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",outline:"none",color:"inherit",textDecoration:LT.reference,[LT.variable]:"none","&:not([aria-current=page])":{cursor:"pointer",_hover:{[LT.variable]:"underline"},_focusVisible:{boxShadow:"outline"}}},MQ=EQ({link:CQ}),AQ=TQ({baseStyle:MQ}),kQ={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},jF=e=>{const{colorScheme:n,theme:o}=e;if(n==="gray")return{color:dr("gray.800","whiteAlpha.900")(e),_hover:{bg:dr("gray.100","whiteAlpha.200")(e)},_active:{bg:dr("gray.200","whiteAlpha.300")(e)}};const c=xp(`${n}.200`,.12)(o),p=xp(`${n}.200`,.24)(o);return{color:dr(`${n}.600`,`${n}.200`)(e),bg:"transparent",_hover:{bg:dr(`${n}.50`,c)(e)},_active:{bg:dr(`${n}.100`,p)(e)}}},PQ=e=>{const{colorScheme:n}=e,o=dr("gray.200","whiteAlpha.300")(e);return{border:"1px solid",borderColor:n==="gray"?o:"currentColor",".chakra-button__group[data-attached][data-orientation=horizontal] > &:not(:last-of-type)":{marginEnd:"-1px"},".chakra-button__group[data-attached][data-orientation=vertical] > &:not(:last-of-type)":{marginBottom:"-1px"},...Bo(jF,e)}},IQ={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},zQ=e=>{var n;const{colorScheme:o}=e;if(o==="gray"){const a=dr("gray.100","whiteAlpha.200")(e);return{bg:a,color:dr("gray.800","whiteAlpha.900")(e),_hover:{bg:dr("gray.200","whiteAlpha.300")(e),_disabled:{bg:a}},_active:{bg:dr("gray.300","whiteAlpha.400")(e)}}}const{bg:c=`${o}.500`,color:p="white",hoverBg:y=`${o}.600`,activeBg:w=`${o}.700`}=(n=IQ[o])!=null?n:{},E=dr(c,`${o}.200`)(e);return{bg:E,color:dr(p,"gray.800")(e),_hover:{bg:dr(y,`${o}.300`)(e),_disabled:{bg:E}},_active:{bg:dr(w,`${o}.400`)(e)}}},RQ=e=>{const{colorScheme:n}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:dr(`${n}.500`,`${n}.200`)(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:dr(`${n}.700`,`${n}.500`)(e)}}},DQ={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:"0",p:"0"},LQ={ghost:jF,outline:PQ,solid:zQ,link:RQ,unstyled:DQ},OQ={lg:{h:"12",minW:"12",fontSize:"lg",px:"6"},md:{h:"10",minW:"10",fontSize:"md",px:"4"},sm:{h:"8",minW:"8",fontSize:"sm",px:"3"},xs:{h:"6",minW:"6",fontSize:"xs",px:"2"}},BQ={baseStyle:kQ,variants:LQ,sizes:OQ,defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},{definePartsStyle:Zh,defineMultiStyleConfig:FQ}=$n(cX.keys),t1=fr("card-bg"),bc=fr("card-padding"),VF=fr("card-shadow"),hx=fr("card-radius"),$F=fr("card-border-width","0"),UF=fr("card-border-color"),NQ=Zh({container:{[t1.variable]:"colors.chakra-body-bg",backgroundColor:t1.reference,boxShadow:VF.reference,borderRadius:hx.reference,color:"chakra-body-text",borderWidth:$F.reference,borderColor:UF.reference},body:{padding:bc.reference,flex:"1 1 0%"},header:{padding:bc.reference},footer:{padding:bc.reference}}),jQ={sm:Zh({container:{[hx.variable]:"radii.base",[bc.variable]:"space.3"}}),md:Zh({container:{[hx.variable]:"radii.md",[bc.variable]:"space.5"}}),lg:Zh({container:{[hx.variable]:"radii.xl",[bc.variable]:"space.7"}})},VQ={elevated:Zh({container:{[VF.variable]:"shadows.base",_dark:{[t1.variable]:"colors.gray.700"}}}),outline:Zh({container:{[$F.variable]:"1px",[UF.variable]:"colors.chakra-border-color"}}),filled:Zh({container:{[t1.variable]:"colors.chakra-subtle-bg"}}),unstyled:{body:{[bc.variable]:0},header:{[bc.variable]:0},footer:{[bc.variable]:0}}},$Q=FQ({baseStyle:NQ,variants:VQ,sizes:jQ,defaultProps:{variant:"elevated",size:"md"}}),e_=$i("close-button-size"),yg=$i("close-button-bg"),UQ={w:[e_.reference],h:[e_.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{[yg.variable]:"colors.blackAlpha.100",_dark:{[yg.variable]:"colors.whiteAlpha.100"}},_active:{[yg.variable]:"colors.blackAlpha.200",_dark:{[yg.variable]:"colors.whiteAlpha.200"}},_focusVisible:{boxShadow:"outline"},bg:yg.reference},GQ={lg:{[e_.variable]:"sizes.10",fontSize:"md"},md:{[e_.variable]:"sizes.8",fontSize:"xs"},sm:{[e_.variable]:"sizes.6",fontSize:"2xs"}},WQ={baseStyle:UQ,sizes:GQ,defaultProps:{size:"md"}},{variants:qQ,defaultProps:HQ}=Jg,ZQ={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm",bg:bi.bg.reference,color:bi.color.reference,boxShadow:bi.shadow.reference},XQ={baseStyle:ZQ,variants:qQ,defaultProps:HQ},YQ={w:"100%",mx:"auto",maxW:"prose",px:"4"},KQ={baseStyle:YQ},JQ={opacity:.6,borderColor:"inherit"},QQ={borderStyle:"solid"},e2={borderStyle:"dashed"},t2={solid:QQ,dashed:e2},r2={baseStyle:JQ,variants:t2,defaultProps:{variant:"solid"}},{definePartsStyle:n2,defineMultiStyleConfig:i2}=$n(NZ.keys),o2={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},s2={transitionProperty:"common",transitionDuration:"normal",fontSize:"md",_focusVisible:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:"4",py:"2"},a2={pt:"2",px:"4",pb:"5"},l2={fontSize:"1.25em"},c2=n2({container:o2,button:s2,panel:a2,icon:l2}),u2=i2({baseStyle:c2}),{definePartsStyle:Q_,defineMultiStyleConfig:h2}=$n(jZ.keys),Ps=fr("alert-fg"),Pc=fr("alert-bg"),d2=Q_({container:{bg:Pc.reference,px:"4",py:"3"},title:{fontWeight:"bold",lineHeight:"6",marginEnd:"2"},description:{lineHeight:"6"},icon:{color:Ps.reference,flexShrink:0,marginEnd:"3",w:"5",h:"6"},spinner:{color:Ps.reference,flexShrink:0,marginEnd:"3",w:"5",h:"5"}});function gA(e){const{theme:n,colorScheme:o}=e,c=xp(`${o}.200`,.16)(n);return{light:`colors.${o}.100`,dark:c}}var f2=Q_(e=>{const{colorScheme:n}=e,o=gA(e);return{container:{[Ps.variable]:`colors.${n}.600`,[Pc.variable]:o.light,_dark:{[Ps.variable]:`colors.${n}.200`,[Pc.variable]:o.dark}}}}),p2=Q_(e=>{const{colorScheme:n}=e,o=gA(e);return{container:{[Ps.variable]:`colors.${n}.600`,[Pc.variable]:o.light,_dark:{[Ps.variable]:`colors.${n}.200`,[Pc.variable]:o.dark},paddingStart:"3",borderStartWidth:"4px",borderStartColor:Ps.reference}}}),m2=Q_(e=>{const{colorScheme:n}=e,o=gA(e);return{container:{[Ps.variable]:`colors.${n}.600`,[Pc.variable]:o.light,_dark:{[Ps.variable]:`colors.${n}.200`,[Pc.variable]:o.dark},pt:"2",borderTopWidth:"4px",borderTopColor:Ps.reference}}}),g2=Q_(e=>{const{colorScheme:n}=e;return{container:{[Ps.variable]:"colors.white",[Pc.variable]:`colors.${n}.600`,_dark:{[Ps.variable]:"colors.gray.900",[Pc.variable]:`colors.${n}.200`},color:Ps.reference}}}),_2={subtle:f2,"left-accent":p2,"top-accent":m2,solid:g2},y2=h2({baseStyle:d2,variants:_2,defaultProps:{variant:"subtle",colorScheme:"blue"}}),{definePartsStyle:GF,defineMultiStyleConfig:v2}=$n(VZ.keys),lp=fr("avatar-border-color"),t_=fr("avatar-bg"),D_=fr("avatar-font-size"),bp=fr("avatar-size"),x2={borderRadius:"full",border:"0.2em solid",borderColor:lp.reference,[lp.variable]:"white",_dark:{[lp.variable]:"colors.gray.800"}},b2={bg:t_.reference,fontSize:D_.reference,width:bp.reference,height:bp.reference,lineHeight:"1",[t_.variable]:"colors.gray.200",_dark:{[t_.variable]:"colors.whiteAlpha.400"}},w2=e=>{const{name:n,theme:o}=e,c=n?kX({string:n}):"colors.gray.400",p=MX(c)(o);let y="white";return p||(y="gray.800"),{bg:t_.reference,fontSize:D_.reference,color:y,borderColor:lp.reference,verticalAlign:"top",width:bp.reference,height:bp.reference,"&:not([data-loaded])":{[t_.variable]:c},[lp.variable]:"colors.white",_dark:{[lp.variable]:"colors.gray.800"}}},S2={fontSize:D_.reference,lineHeight:"1"},T2=GF(e=>({badge:Bo(x2,e),excessLabel:Bo(b2,e),container:Bo(w2,e),label:S2}));function pu(e){const n=e!=="100%"?DF[e]:void 0;return GF({container:{[bp.variable]:n??e,[D_.variable]:`calc(${n??e} / 2.5)`},excessLabel:{[bp.variable]:n??e,[D_.variable]:`calc(${n??e} / 2.5)`}})}var E2={"2xs":pu(4),xs:pu(6),sm:pu(8),md:pu(12),lg:pu(16),xl:pu(24),"2xl":pu(32),full:pu("100%")},C2=v2({baseStyle:T2,sizes:E2,defaultProps:{size:"md"}}),M2={Accordion:u2,Alert:y2,Avatar:C2,Badge:Jg,Breadcrumb:AQ,Button:BQ,Checkbox:e1,CloseButton:WQ,Code:XQ,Container:KQ,Divider:r2,Drawer:QJ,Editable:sQ,Form:dQ,FormError:yQ,FormLabel:xQ,Heading:SQ,Input:yn,Kbd:UK,Link:WK,List:YK,Menu:aJ,Modal:yJ,NumberInput:MJ,PinInput:IJ,Popover:$J,Progress:XY,Radio:lK,Select:mK,Skeleton:_K,SkipLink:vK,Slider:PK,Spinner:RK,Stat:VK,Switch:WX,Table:JX,Tabs:fY,Tag:CY,Textarea:FY,Tooltip:VY,Card:$Q,Stepper:FZ},A2={colors:{"chakra-body-text":{_light:"gray.800",_dark:"whiteAlpha.900"},"chakra-body-bg":{_light:"white",_dark:"gray.800"},"chakra-border-color":{_light:"gray.200",_dark:"whiteAlpha.300"},"chakra-inverse-text":{_light:"white",_dark:"gray.800"},"chakra-subtle-bg":{_light:"gray.100",_dark:"gray.700"},"chakra-subtle-text":{_light:"gray.600",_dark:"gray.400"},"chakra-placeholder-color":{_light:"gray.500",_dark:"whiteAlpha.400"}}},k2={global:{body:{fontFamily:"body",color:"chakra-body-text",bg:"chakra-body-bg",transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:"chakra-placeholder-color"},"*, *::before, &::after":{borderColor:"chakra-border-color"}}},P2="ltr",I2={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},z2={semanticTokens:A2,direction:P2,...LZ,components:M2,styles:k2,config:I2};function R2(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var D2=R2();function L2(e,n){const o={};return Object.keys(e).forEach(c=>{n.includes(c)||(o[c]=e[c])}),o}function O2(e,n,o,c){const p=typeof n=="string"?n.split("."):[n];for(c=0;c<p.length&&e;c+=1)e=e[p[c]];return e===void 0?o:e}var B2=e=>{const n=new WeakMap;return(c,p,y,w)=>{if(typeof c>"u")return e(c,p,y);n.has(c)||n.set(c,new Map);const E=n.get(c);if(E.has(p))return E.get(p);const a=e(c,p,y,w);return E.set(p,a),a}},WF=B2(O2);function qF(e,n){const o={};return Object.keys(e).forEach(c=>{const p=e[c];n(p,c,e)&&(o[c]=p)}),o}var HF=e=>qF(e,n=>n!=null);function F2(e){return typeof e=="function"}function ZF(e,...n){return F2(e)?e(...n):e}function N2(...e){return function(o){e.some(c=>(c==null||c(o),o==null?void 0:o.defaultPrevented))}}var j2=typeof Element<"u",V2=typeof Map=="function",$2=typeof Set=="function",U2=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function dx(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,c,p;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(c=o;c--!==0;)if(!dx(e[c],n[c]))return!1;return!0}var y;if(V2&&e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(y=e.entries();!(c=y.next()).done;)if(!n.has(c.value[0]))return!1;for(y=e.entries();!(c=y.next()).done;)if(!dx(c.value[1],n.get(c.value[0])))return!1;return!0}if($2&&e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(y=e.entries();!(c=y.next()).done;)if(!n.has(c.value[0]))return!1;return!0}if(U2&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(o=e.length,o!=n.length)return!1;for(c=o;c--!==0;)if(e[c]!==n[c])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof n.valueOf=="function")return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof n.toString=="function")return e.toString()===n.toString();if(p=Object.keys(e),o=p.length,o!==Object.keys(n).length)return!1;for(c=o;c--!==0;)if(!Object.prototype.hasOwnProperty.call(n,p[c]))return!1;if(j2&&e instanceof Element)return!1;for(c=o;c--!==0;)if(!((p[c]==="_owner"||p[c]==="__v"||p[c]==="__o")&&e.$$typeof)&&!dx(e[p[c]],n[p[c]]))return!1;return!0}return e!==e&&n!==n}var G2=function(n,o){try{return dx(n,o)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}};const W2=P1(G2);function XF(e,n={}){var o;const{styleConfig:c,...p}=n,{theme:y,colorMode:w}=qq(),E=e?WF(y,`components.${e}`):void 0,a=c||E,P=Tl({theme:y,colorMode:w},(o=a==null?void 0:a.defaultProps)!=null?o:{},HF(L2(p,["children"]))),D=re.useRef({});if(a){const F=hZ(a)(P);W2(D.current,F)||(D.current=F)}return D.current}function md(e,n={}){return XF(e,n)}function Lc(e,n={}){return XF(e,n)}var q2=new Set([...QH,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),H2=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function Z2(e){return H2.has(e)||!q2.has(e)}function X2(e,...n){if(e==null)throw new TypeError("Cannot convert undefined or null to object");const o={...e};for(const c of n)if(c!=null)for(const p in c)Object.prototype.hasOwnProperty.call(c,p)&&(p in o&&delete o[p],o[p]=c[p]);return o}function YF(e){const n=Object.assign({},e);for(let o in n)n[o]===void 0&&delete n[o];return n}var Y2=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,K2=aF(function(e){return Y2.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),J2=K2,Q2=function(n){return n!=="theme"},mD=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?J2:Q2},gD=function(n,o,c){var p;if(o){var y=o.shouldForwardProp;p=n.__emotion_forwardProp&&y?function(w){return n.__emotion_forwardProp(w)&&y(w)}:y}return typeof p!="function"&&c&&(p=n.__emotion_forwardProp),p},eee=function(n){var o=n.cache,c=n.serialized,p=n.isStringTag;return fF(o,c,p),Eq(function(){return pF(o,c,p)}),null},tee=function e(n,o){var c=n.__emotion_real===n,p=c&&n.__emotion_base||n,y,w;o!==void 0&&(y=o.label,w=o.target);var E=gD(n,o,c),a=E||mD(p),P=!a("as");return function(){var D=arguments,L=c&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(y!==void 0&&L.push("label:"+y+";"),D[0]==null||D[0].raw===void 0)L.push.apply(L,D);else{L.push(D[0][0]);for(var F=D.length,$=1;$<F;$++)L.push(D[$],D[0][$])}var H=yF(function(q,le,ie){var te=P&&q.as||p,se="",be=[],Ee=q;if(q.theme==null){Ee={};for(var je in q)Ee[je]=q[je];Ee.theme=re.useContext(k_)}typeof q.className=="string"?se=yq(le.registered,be,q.className):q.className!=null&&(se=q.className+" ");var Be=sA(L.concat(be),le.registered,Ee);se+=le.key+"-"+Be.name,w!==void 0&&(se+=" "+w);var Ze=P&&E===void 0?mD(te):a,ht={};for(var Pe in q)P&&Pe==="as"||Ze(Pe)&&(ht[Pe]=q[Pe]);return ht.className=se,ht.ref=ie,re.createElement(re.Fragment,null,re.createElement(eee,{cache:le,serialized:Be,isStringTag:typeof te=="string"}),re.createElement(te,ht))});return H.displayName=y!==void 0?y:"Styled("+(typeof p=="string"?p:p.displayName||p.name||"Component")+")",H.defaultProps=n.defaultProps,H.__emotion_real=H,H.__emotion_base=p,H.__emotion_styles=L,H.__emotion_forwardProp=E,Object.defineProperty(H,"toString",{value:function(){return"."+w}}),H.withComponent=function(q,le){return e(q,od({},o,le,{shouldForwardProp:gD(H,le,!0)})).apply(void 0,L)},H}},ree=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],r1=tee.bind();ree.forEach(function(e){r1[e]=r1(e)});var _D,nee=(_D=r1.default)!=null?_D:r1,iee=({baseStyle:e})=>n=>{const{theme:o,css:c,__css:p,sx:y,...w}=n,E=qF(w,(L,F)=>tZ(F)),a=ZF(e,n),P=X2({},p,a,HF(E),y),D=IF(P)(n.theme);return c?[D,c]:D};function OT(e,n){const{baseStyle:o,...c}=n??{};c.shouldForwardProp||(c.shouldForwardProp=Z2);const p=iee({baseStyle:o}),y=nee(e,c)(p);return Cs.forwardRef(function(a,P){const{colorMode:D,forced:L}=cb();return Cs.createElement(y,{ref:P,"data-theme":L?D:void 0,...a})})}function oee(){const e=new Map;return new Proxy(OT,{apply(n,o,c){return OT(...c)},get(n,o){return e.has(o)||e.set(o,OT(o)),e.get(o)}})}var br=oee();function $r(e){return re.forwardRef(e)}function see(e={}){const{strict:n=!0,errorMessage:o="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:c}=e,p=re.createContext(void 0);p.displayName=c;function y(){var w;const E=re.useContext(p);if(!E&&n){const a=new Error(o);throw a.name="ContextError",(w=Error.captureStackTrace)==null||w.call(Error,a,y),a}return E}return[p.Provider,y,p]}function aee(e){const{cssVarsRoot:n,theme:o,children:c}=e,p=re.useMemo(()=>KH(o),[o]);return Q.jsxs(Aq,{theme:p,children:[Q.jsx(lee,{root:n}),c]})}function lee({root:e=":host, :root"}){const n=[e,"[data-theme]"].join(",");return Q.jsx(lb,{styles:o=>({[n]:o.__cssVars})})}see({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "});function cee(){const{colorMode:e}=cb();return Q.jsx(lb,{styles:n=>{const o=WF(n,"styles.global"),c=ZF(o,{theme:n,colorMode:e});return c?IF(c)(n):void 0}})}var KF=re.createContext({getDocument(){return document},getWindow(){return window}});KF.displayName="EnvironmentContext";function JF(e){const{children:n,environment:o,disabled:c}=e,p=re.useRef(null),y=re.useMemo(()=>o||{getDocument:()=>{var E,a;return(a=(E=p.current)==null?void 0:E.ownerDocument)!=null?a:document},getWindow:()=>{var E,a;return(a=(E=p.current)==null?void 0:E.ownerDocument.defaultView)!=null?a:window}},[o]),w=!c||!o;return Q.jsxs(KF.Provider,{value:y,children:[n,w&&Q.jsx("span",{id:"__chakra_env",hidden:!0,ref:p})]})}JF.displayName="EnvironmentProvider";var uee=e=>{const{children:n,colorModeManager:o,portalZIndex:c,resetScope:p,resetCSS:y=!0,theme:w={},environment:E,cssVarsRoot:a,disableEnvironment:P,disableGlobalStyle:D}=e,L=Q.jsx(JF,{environment:E,disabled:P,children:n});return Q.jsx(aee,{theme:w,cssVarsRoot:a,children:Q.jsxs(SF,{colorModeManager:o,options:w.config,children:[y?Q.jsx(zq,{scope:p}):Q.jsx(Iq,{}),!D&&Q.jsx(cee,{}),c?Q.jsx(bF,{zIndex:c,children:L}):L]})})},hee=(e,n)=>e.find(o=>o.id===n);function yD(e,n){const o=QF(e,n),c=o?e[o].findIndex(p=>p.id===n):-1;return{position:o,index:c}}function QF(e,n){for(const[o,c]of Object.entries(e))if(hee(c,n))return o}function dee(e){const n=e.includes("right"),o=e.includes("left");let c="center";return n&&(c="flex-end"),o&&(c="flex-start"),{display:"flex",flexDirection:"column",alignItems:c}}function fee(e){const o=e==="top"||e==="bottom"?"0 auto":void 0,c=e.includes("top")?"env(safe-area-inset-top, 0px)":void 0,p=e.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,y=e.includes("left")?void 0:"env(safe-area-inset-right, 0px)",w=e.includes("right")?void 0:"env(safe-area-inset-left, 0px)";return{position:"fixed",zIndex:"var(--toast-z-index, 5500)",pointerEvents:"none",display:"flex",flexDirection:"column",margin:o,top:c,bottom:p,right:y,left:w}}function fx(e,n=[]){const o=re.useRef(e);return re.useEffect(()=>{o.current=e}),re.useCallback((...c)=>{var p;return(p=o.current)==null?void 0:p.call(o,...c)},n)}function pee(e,n){const o=fx(e);re.useEffect(()=>{if(n==null)return;let c=null;return c=window.setTimeout(()=>{o()},n),()=>{c&&window.clearTimeout(c)}},[n,o])}function vD(e,n){const o=re.useRef(!1),c=re.useRef(!1);re.useEffect(()=>{if(o.current&&c.current)return e();c.current=!0},n),re.useEffect(()=>(o.current=!0,()=>{o.current=!1}),[])}const e6=re.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),pb=re.createContext({}),ey=re.createContext(null),mb=typeof document<"u",_A=mb?re.useLayoutEffect:re.useEffect,t6=re.createContext({strict:!1}),yA=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),mee="framerAppearId",r6="data-"+yA(mee),n6={skipAnimations:!1,useManualTiming:!1};class xD{constructor(){this.order=[],this.scheduled=new Set}add(n){if(!this.scheduled.has(n))return this.scheduled.add(n),this.order.push(n),!0}remove(n){const o=this.order.indexOf(n);o!==-1&&(this.order.splice(o,1),this.scheduled.delete(n))}clear(){this.order.length=0,this.scheduled.clear()}}function gee(e){let n=new xD,o=new xD,c=0,p=!1,y=!1;const w=new WeakSet,E={schedule:(a,P=!1,D=!1)=>{const L=D&&p,F=L?n:o;return P&&w.add(a),F.add(a)&&L&&p&&(c=n.order.length),a},cancel:a=>{o.remove(a),w.delete(a)},process:a=>{if(p){y=!0;return}if(p=!0,[n,o]=[o,n],o.clear(),c=n.order.length,c)for(let P=0;P<c;P++){const D=n.order[P];w.has(D)&&(E.schedule(D),e()),D(a)}p=!1,y&&(y=!1,E.process(a))}};return E}const Mv=["prepare","read","update","preRender","render","postRender"],_ee=40;function i6(e,n){let o=!1,c=!0;const p={delta:0,timestamp:0,isProcessing:!1},y=Mv.reduce((L,F)=>(L[F]=gee(()=>o=!0),L),{}),w=L=>{y[L].process(p)},E=()=>{const L=performance.now();o=!1,p.delta=c?1e3/60:Math.max(Math.min(L-p.timestamp,_ee),1),p.timestamp=L,p.isProcessing=!0,Mv.forEach(w),p.isProcessing=!1,o&&n&&(c=!1,e(E))},a=()=>{o=!0,c=!0,p.isProcessing||e(E)};return{schedule:Mv.reduce((L,F)=>{const $=y[F];return L[F]=(H,q=!1,le=!1)=>(o||a(),$.schedule(H,q,le)),L},{}),cancel:L=>Mv.forEach(F=>y[F].cancel(L)),state:p,steps:y}}const{schedule:vA,cancel:Mpe}=i6(queueMicrotask,!1);function yee(e,n,o,c){const{visualElement:p}=re.useContext(pb),y=re.useContext(t6),w=re.useContext(ey),E=re.useContext(e6).reducedMotion,a=re.useRef();c=c||y.renderer,!a.current&&c&&(a.current=c(e,{visualState:n,parent:p,props:o,presenceContext:w,blockInitialAnimation:w?w.initial===!1:!1,reducedMotionConfig:E}));const P=a.current;re.useInsertionEffect(()=>{P&&P.update(o,w)});const D=re.useRef(!!(o[r6]&&!window.HandoffComplete));return _A(()=>{P&&(vA.postRender(P.render),D.current&&P.animationState&&P.animationState.animateChanges())}),re.useEffect(()=>{P&&(P.updateFeatures(),!D.current&&P.animationState&&P.animationState.animateChanges(),D.current&&(D.current=!1,window.HandoffComplete=!0))}),P}function Gf(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function vee(e,n,o){return re.useCallback(c=>{c&&e.mount&&e.mount(c),n&&(c?n.mount(c):n.unmount()),o&&(typeof o=="function"?o(c):Gf(o)&&(o.current=c))},[n])}function L_(e){return typeof e=="string"||Array.isArray(e)}function gb(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const xA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bA=["initial",...xA];function _b(e){return gb(e.animate)||bA.some(n=>L_(e[n]))}function o6(e){return!!(_b(e)||e.variants)}function xee(e,n){if(_b(e)){const{initial:o,animate:c}=e;return{initial:o===!1||L_(o)?o:void 0,animate:L_(c)?c:void 0}}return e.inherit!==!1?n:{}}function bee(e){const{initial:n,animate:o}=xee(e,re.useContext(pb));return re.useMemo(()=>({initial:n,animate:o}),[bD(n),bD(o)])}function bD(e){return Array.isArray(e)?e.join(" "):e}const wD={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},O_={};for(const e in wD)O_[e]={isEnabled:n=>wD[e].some(o=>!!n[o])};function wee(e){for(const n in e)O_[n]={...O_[n],...e[n]}}const wA=re.createContext({}),s6=re.createContext({}),See=Symbol.for("motionComponentSymbol");function Tee({preloadedFeatures:e,createVisualElement:n,useRender:o,useVisualState:c,Component:p}){e&&wee(e);function y(E,a){let P;const D={...re.useContext(e6),...E,layoutId:Eee(E)},{isStatic:L}=D,F=bee(E),$=c(E,L);if(!L&&mb){F.visualElement=yee(p,$,D,n);const H=re.useContext(s6),q=re.useContext(t6).strict;F.visualElement&&(P=F.visualElement.loadFeatures(D,q,e,H))}return re.createElement(pb.Provider,{value:F},P&&F.visualElement?re.createElement(P,{visualElement:F.visualElement,...D}):null,o(p,E,vee($,F.visualElement,a),$,L,F.visualElement))}const w=re.forwardRef(y);return w[See]=p,w}function Eee({layoutId:e}){const n=re.useContext(wA).id;return n&&e!==void 0?n+"-"+e:e}function Cee(e){function n(c,p={}){return Tee(e(c,p))}if(typeof Proxy>"u")return n;const o=new Map;return new Proxy(n,{get:(c,p)=>(o.has(p)||o.set(p,n(p)),o.get(p))})}const Mee=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function SA(e){return typeof e!="string"||e.includes("-")?!1:!!(Mee.indexOf(e)>-1||/[A-Z]/.test(e))}const n1={};function Aee(e){Object.assign(n1,e)}const ty=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],gd=new Set(ty);function a6(e,{layout:n,layoutId:o}){return gd.has(e)||e.startsWith("origin")||(n||o!==void 0)&&(!!n1[e]||e==="opacity")}const as=e=>!!(e&&e.getVelocity),kee={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Pee=ty.length;function Iee(e,{enableHardwareAcceleration:n=!0,allowTransformNone:o=!0},c,p){let y="";for(let w=0;w<Pee;w++){const E=ty[w];if(e[E]!==void 0){const a=kee[E]||E;y+=`${a}(${e[E]}) `}}return n&&!e.z&&(y+="translateZ(0)"),y=y.trim(),p?y=p(e,c?"":y):o&&c&&(y="none"),y}const l6=e=>n=>typeof n=="string"&&n.startsWith(e),c6=l6("--"),zee=l6("var(--"),i1=e=>zee(e)?Ree.test(e.split("/*")[0].trim()):!1,Ree=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)$/i,Dee=(e,n)=>n&&typeof e=="number"?n.transform(e):e,Bu=(e,n,o)=>o>n?n:o<e?e:o,Rp={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},r_={...Rp,transform:e=>Bu(0,1,e)},Av={...Rp,default:1},n_=e=>Math.round(e*1e5)/1e5,TA=/(-)?([\d]*\.?[\d])+/g,Lee=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Oee=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function ry(e){return typeof e=="string"}const ny=e=>({test:n=>ry(n)&&n.endsWith(e)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${e}`}),mu=ny("deg"),Pl=ny("%"),xr=ny("px"),Bee=ny("vh"),Fee=ny("vw"),SD={...Pl,parse:e=>Pl.parse(e)/100,transform:e=>Pl.transform(e*100)},TD={...Rp,transform:Math.round},u6={borderWidth:xr,borderTopWidth:xr,borderRightWidth:xr,borderBottomWidth:xr,borderLeftWidth:xr,borderRadius:xr,radius:xr,borderTopLeftRadius:xr,borderTopRightRadius:xr,borderBottomRightRadius:xr,borderBottomLeftRadius:xr,width:xr,maxWidth:xr,height:xr,maxHeight:xr,size:xr,top:xr,right:xr,bottom:xr,left:xr,padding:xr,paddingTop:xr,paddingRight:xr,paddingBottom:xr,paddingLeft:xr,margin:xr,marginTop:xr,marginRight:xr,marginBottom:xr,marginLeft:xr,rotate:mu,rotateX:mu,rotateY:mu,rotateZ:mu,scale:Av,scaleX:Av,scaleY:Av,scaleZ:Av,skew:mu,skewX:mu,skewY:mu,distance:xr,translateX:xr,translateY:xr,translateZ:xr,x:xr,y:xr,z:xr,perspective:xr,transformPerspective:xr,opacity:r_,originX:SD,originY:SD,originZ:xr,zIndex:TD,fillOpacity:r_,strokeOpacity:r_,numOctaves:TD};function EA(e,n,o,c){const{style:p,vars:y,transform:w,transformOrigin:E}=e;let a=!1,P=!1,D=!0;for(const L in n){const F=n[L];if(c6(L)){y[L]=F;continue}const $=u6[L],H=Dee(F,$);if(gd.has(L)){if(a=!0,w[L]=H,!D)continue;F!==($.default||0)&&(D=!1)}else L.startsWith("origin")?(P=!0,E[L]=H):p[L]=H}if(n.transform||(a||c?p.transform=Iee(e.transform,o,D,c):p.transform&&(p.transform="none")),P){const{originX:L="50%",originY:F="50%",originZ:$=0}=E;p.transformOrigin=`${L} ${F} ${$}`}}const CA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function h6(e,n,o){for(const c in n)!as(n[c])&&!a6(c,o)&&(e[c]=n[c])}function Nee({transformTemplate:e},n,o){return re.useMemo(()=>{const c=CA();return EA(c,n,{enableHardwareAcceleration:!o},e),Object.assign({},c.vars,c.style)},[n])}function jee(e,n,o){const c=e.style||{},p={};return h6(p,c,e),Object.assign(p,Nee(e,n,o)),p}function Vee(e,n,o){const c={},p=jee(e,n,o);return e.drag&&e.dragListener!==!1&&(c.draggable=!1,p.userSelect=p.WebkitUserSelect=p.WebkitTouchCallout="none",p.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(c.tabIndex=0),c.style=p,c}const $ee=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function o1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||$ee.has(e)}let d6=e=>!o1(e);function Uee(e){e&&(d6=n=>n.startsWith("on")?!o1(n):e(n))}try{Uee(require("@emotion/is-prop-valid").default)}catch{}function Gee(e,n,o){const c={};for(const p in e)p==="values"&&typeof e.values=="object"||(d6(p)||o===!0&&o1(p)||!n&&!o1(p)||e.draggable&&p.startsWith("onDrag"))&&(c[p]=e[p]);return c}function ED(e,n,o){return typeof e=="string"?e:xr.transform(n+o*e)}function Wee(e,n,o){const c=ED(n,e.x,e.width),p=ED(o,e.y,e.height);return`${c} ${p}`}const qee={offset:"stroke-dashoffset",array:"stroke-dasharray"},Hee={offset:"strokeDashoffset",array:"strokeDasharray"};function Zee(e,n,o=1,c=0,p=!0){e.pathLength=1;const y=p?qee:Hee;e[y.offset]=xr.transform(-c);const w=xr.transform(n),E=xr.transform(o);e[y.array]=`${w} ${E}`}function MA(e,{attrX:n,attrY:o,attrScale:c,originX:p,originY:y,pathLength:w,pathSpacing:E=1,pathOffset:a=0,...P},D,L,F){if(EA(e,P,D,F),L){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:$,style:H,dimensions:q}=e;$.transform&&(q&&(H.transform=$.transform),delete $.transform),q&&(p!==void 0||y!==void 0||H.transform)&&(H.transformOrigin=Wee(q,p!==void 0?p:.5,y!==void 0?y:.5)),n!==void 0&&($.x=n),o!==void 0&&($.y=o),c!==void 0&&($.scale=c),w!==void 0&&Zee($,w,E,a,!1)}const f6=()=>({...CA(),attrs:{}}),AA=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Xee(e,n,o,c){const p=re.useMemo(()=>{const y=f6();return MA(y,n,{enableHardwareAcceleration:!1},AA(c),e.transformTemplate),{...y.attrs,style:{...y.style}}},[n]);if(e.style){const y={};h6(y,e.style,e),p.style={...y,...p.style}}return p}function Yee(e=!1){return(o,c,p,{latestValues:y},w)=>{const a=(SA(o)?Xee:Vee)(c,y,w,o),P=Gee(c,typeof o=="string",e),D=o!==re.Fragment?{...P,...a,ref:p}:{},{children:L}=c,F=re.useMemo(()=>as(L)?L.get():L,[L]);return re.createElement(o,{...D,children:F})}}function p6(e,{style:n,vars:o},c,p){Object.assign(e.style,n,p&&p.getProjectionStyles(c));for(const y in o)e.style.setProperty(y,o[y])}const m6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function g6(e,n,o,c){p6(e,n,void 0,c);for(const p in n.attrs)e.setAttribute(m6.has(p)?p:yA(p),n.attrs[p])}function kA(e,n){const{style:o}=e,c={};for(const p in o)(as(o[p])||n.style&&as(n.style[p])||a6(p,e))&&(c[p]=o[p]);return c}function _6(e,n){const o=kA(e,n);for(const c in e)if(as(e[c])||as(n[c])){const p=ty.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;o[p]=e[c]}return o}function PA(e,n,o,c={},p={}){return typeof n=="function"&&(n=n(o!==void 0?o:e.custom,c,p)),typeof n=="string"&&(n=e.variants&&e.variants[n]),typeof n=="function"&&(n=n(o!==void 0?o:e.custom,c,p)),n}function y6(e){const n=re.useRef(null);return n.current===null&&(n.current=e()),n.current}const s1=e=>Array.isArray(e),Kee=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Jee=e=>s1(e)?e[e.length-1]||0:e;function px(e){const n=as(e)?e.get():e;return Kee(n)?n.toValue():n}function Qee({scrapeMotionValuesFromProps:e,createRenderState:n,onMount:o},c,p,y){const w={latestValues:ete(c,p,y,e),renderState:n()};return o&&(w.mount=E=>o(c,E,w)),w}const v6=e=>(n,o)=>{const c=re.useContext(pb),p=re.useContext(ey),y=()=>Qee(e,n,c,p);return o?y():y6(y)};function ete(e,n,o,c){const p={},y=c(e,{});for(const F in y)p[F]=px(y[F]);let{initial:w,animate:E}=e;const a=_b(e),P=o6(e);n&&P&&!a&&e.inherit!==!1&&(w===void 0&&(w=n.initial),E===void 0&&(E=n.animate));let D=o?o.initial===!1:!1;D=D||w===!1;const L=D?E:w;return L&&typeof L!="boolean"&&!gb(L)&&(Array.isArray(L)?L:[L]).forEach($=>{const H=PA(e,$);if(!H)return;const{transitionEnd:q,transition:le,...ie}=H;for(const te in ie){let se=ie[te];if(Array.isArray(se)){const be=D?se.length-1:0;se=se[be]}se!==null&&(p[te]=se)}for(const te in q)p[te]=q[te]}),p}const Pi=e=>e,{schedule:Kn,cancel:Ic,state:no,steps:BT}=i6(typeof requestAnimationFrame<"u"?requestAnimationFrame:Pi,!0),tte={useVisualState:v6({scrapeMotionValuesFromProps:_6,createRenderState:f6,onMount:(e,n,{renderState:o,latestValues:c})=>{Kn.read(()=>{try{o.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{o.dimensions={x:0,y:0,width:0,height:0}}}),Kn.render(()=>{MA(o,c,{enableHardwareAcceleration:!1},AA(n.tagName),e.transformTemplate),g6(n,o)})}})},rte={useVisualState:v6({scrapeMotionValuesFromProps:kA,createRenderState:CA})};function nte(e,{forwardMotionProps:n=!1},o,c){return{...SA(e)?tte:rte,preloadedFeatures:o,useRender:Yee(n),createVisualElement:c,Component:e}}function vc(e,n,o,c={passive:!0}){return e.addEventListener(n,o,c),()=>e.removeEventListener(n,o)}const x6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function yb(e,n="page"){return{point:{x:e[n+"X"],y:e[n+"Y"]}}}const ite=e=>n=>x6(n)&&e(n,yb(n));function wc(e,n,o,c){return vc(e,n,ite(o),c)}const ote=(e,n)=>o=>n(e(o)),Sc=(...e)=>e.reduce(ote);function b6(e){let n=null;return()=>{const o=()=>{n=null};return n===null?(n=e,o):!1}}const CD=b6("dragHorizontal"),MD=b6("dragVertical");function w6(e){let n=!1;if(e==="y")n=MD();else if(e==="x")n=CD();else{const o=CD(),c=MD();o&&c?n=()=>{o(),c()}:(o&&o(),c&&c())}return n}function S6(){const e=w6(!0);return e?(e(),!1):!0}class Uu{constructor(n){this.isMounted=!1,this.node=n}update(){}}function AD(e,n){const o="pointer"+(n?"enter":"leave"),c="onHover"+(n?"Start":"End"),p=(y,w)=>{if(y.pointerType==="touch"||S6())return;const E=e.getProps();e.animationState&&E.whileHover&&e.animationState.setActive("whileHover",n),E[c]&&Kn.update(()=>E[c](y,w))};return wc(e.current,o,p,{passive:!e.getProps()[c]})}class ste extends Uu{mount(){this.unmount=Sc(AD(this.node,!0),AD(this.node,!1))}unmount(){}}class ate extends Uu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Sc(vc(this.node.current,"focus",()=>this.onFocus()),vc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const T6=(e,n)=>n?e===n?!0:T6(e,n.parentElement):!1;function FT(e,n){if(!n)return;const o=new PointerEvent("pointer"+e);n(o,yb(o))}class lte extends Uu{constructor(){super(...arguments),this.removeStartListeners=Pi,this.removeEndListeners=Pi,this.removeAccessibleListeners=Pi,this.startPointerPress=(n,o)=>{if(this.isPressing)return;this.removeEndListeners();const c=this.node.getProps(),y=wc(window,"pointerup",(E,a)=>{if(!this.checkPressEnd())return;const{onTap:P,onTapCancel:D,globalTapTarget:L}=this.node.getProps();Kn.update(()=>{!L&&!T6(this.node.current,E.target)?D&&D(E,a):P&&P(E,a)})},{passive:!(c.onTap||c.onPointerUp)}),w=wc(window,"pointercancel",(E,a)=>this.cancelPress(E,a),{passive:!(c.onTapCancel||c.onPointerCancel)});this.removeEndListeners=Sc(y,w),this.startPress(n,o)},this.startAccessiblePress=()=>{const n=y=>{if(y.key!=="Enter"||this.isPressing)return;const w=E=>{E.key!=="Enter"||!this.checkPressEnd()||FT("up",(a,P)=>{const{onTap:D}=this.node.getProps();D&&Kn.update(()=>D(a,P))})};this.removeEndListeners(),this.removeEndListeners=vc(this.node.current,"keyup",w),FT("down",(E,a)=>{this.startPress(E,a)})},o=vc(this.node.current,"keydown",n),c=()=>{this.isPressing&&FT("cancel",(y,w)=>this.cancelPress(y,w))},p=vc(this.node.current,"blur",c);this.removeAccessibleListeners=Sc(o,p)}}startPress(n,o){this.isPressing=!0;const{onTapStart:c,whileTap:p}=this.node.getProps();p&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),c&&Kn.update(()=>c(n,o))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!S6()}cancelPress(n,o){if(!this.checkPressEnd())return;const{onTapCancel:c}=this.node.getProps();c&&Kn.update(()=>c(n,o))}mount(){const n=this.node.getProps(),o=wc(n.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(n.onTapStart||n.onPointerStart)}),c=vc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Sc(o,c)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const yC=new WeakMap,NT=new WeakMap,cte=e=>{const n=yC.get(e.target);n&&n(e)},ute=e=>{e.forEach(cte)};function hte({root:e,...n}){const o=e||document;NT.has(o)||NT.set(o,{});const c=NT.get(o),p=JSON.stringify(n);return c[p]||(c[p]=new IntersectionObserver(ute,{root:e,...n})),c[p]}function dte(e,n,o){const c=hte(n);return yC.set(e,o),c.observe(e),()=>{yC.delete(e),c.unobserve(e)}}const fte={some:0,all:1};class pte extends Uu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:o,margin:c,amount:p="some",once:y}=n,w={root:o?o.current:void 0,rootMargin:c,threshold:typeof p=="number"?p:fte[p]},E=a=>{const{isIntersecting:P}=a;if(this.isInView===P||(this.isInView=P,y&&!P&&this.hasEnteredView))return;P&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",P);const{onViewportEnter:D,onViewportLeave:L}=this.node.getProps(),F=P?D:L;F&&F(a)};return dte(this.node.current,w,E)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:o}=this.node;["amount","margin","root"].some(mte(n,o))&&this.startObserver()}unmount(){}}function mte({viewport:e={}},{viewport:n={}}={}){return o=>e[o]!==n[o]}const gte={inView:{Feature:pte},tap:{Feature:lte},focus:{Feature:ate},hover:{Feature:ste}};function E6(e,n){if(!Array.isArray(n))return!1;const o=n.length;if(o!==e.length)return!1;for(let c=0;c<o;c++)if(n[c]!==e[c])return!1;return!0}function _te(e){const n={};return e.values.forEach((o,c)=>n[c]=o.get()),n}function yte(e){const n={};return e.values.forEach((o,c)=>n[c]=o.getVelocity()),n}function vb(e,n,o){const c=e.getProps();return PA(c,n,o!==void 0?o:c.custom,_te(e),yte(e))}let IA=Pi;const Xh=e=>e*1e3,Tc=e=>e/1e3,vte={current:!1},C6=e=>Array.isArray(e)&&typeof e[0]=="number";function M6(e){return!!(!e||typeof e=="string"&&A6[e]||C6(e)||Array.isArray(e)&&e.every(M6))}const Rg=([e,n,o,c])=>`cubic-bezier(${e}, ${n}, ${o}, ${c})`,A6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Rg([0,.65,.55,1]),circOut:Rg([.55,0,1,.45]),backIn:Rg([.31,.01,.66,-.59]),backOut:Rg([.33,1.53,.69,.99])};function k6(e){if(e)return C6(e)?Rg(e):Array.isArray(e)?e.map(k6):A6[e]}function xte(e,n,o,{delay:c=0,duration:p,repeat:y=0,repeatType:w="loop",ease:E,times:a}={}){const P={[n]:o};a&&(P.offset=a);const D=k6(E);return Array.isArray(D)&&(P.easing=D),e.animate(P,{delay:c,duration:p,easing:Array.isArray(D)?"linear":D,fill:"both",iterations:y+1,direction:w==="reverse"?"alternate":"normal"})}function bte(e,{repeat:n,repeatType:o="loop"}){const c=n&&o!=="loop"&&n%2===1?0:e.length-1;return e[c]}const P6=(e,n,o)=>(((1-3*o+3*n)*e+(3*o-6*n))*e+3*n)*e,wte=1e-7,Ste=12;function Tte(e,n,o,c,p){let y,w,E=0;do w=n+(o-n)/2,y=P6(w,c,p)-e,y>0?o=w:n=w;while(Math.abs(y)>wte&&++E<Ste);return w}function iy(e,n,o,c){if(e===n&&o===c)return Pi;const p=y=>Tte(y,0,1,e,o);return y=>y===0||y===1?y:P6(p(y),n,c)}const Ete=iy(.42,0,1,1),Cte=iy(0,0,.58,1),I6=iy(.42,0,.58,1),Mte=e=>Array.isArray(e)&&typeof e[0]!="number",z6=e=>n=>n<=.5?e(2*n)/2:(2-e(2*(1-n)))/2,R6=e=>n=>1-e(1-n),zA=e=>1-Math.sin(Math.acos(e)),D6=R6(zA),Ate=z6(zA),L6=iy(.33,1.53,.69,.99),RA=R6(L6),kte=z6(RA),Pte=e=>(e*=2)<1?.5*RA(e):.5*(2-Math.pow(2,-10*(e-1))),Ite={linear:Pi,easeIn:Ete,easeInOut:I6,easeOut:Cte,circIn:zA,circInOut:Ate,circOut:D6,backIn:RA,backInOut:kte,backOut:L6,anticipate:Pte},kD=e=>{if(Array.isArray(e)){IA(e.length===4);const[n,o,c,p]=e;return iy(n,o,c,p)}else if(typeof e=="string")return Ite[e];return e},B_=(e,n,o)=>{const c=n-e;return c===0?1:(o-e)/c},ri=(e,n,o)=>e+(n-e)*o;function jT(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}function zte({hue:e,saturation:n,lightness:o,alpha:c}){e/=360,n/=100,o/=100;let p=0,y=0,w=0;if(!n)p=y=w=o;else{const E=o<.5?o*(1+n):o+n-o*n,a=2*o-E;p=jT(a,E,e+1/3),y=jT(a,E,e),w=jT(a,E,e-1/3)}return{red:Math.round(p*255),green:Math.round(y*255),blue:Math.round(w*255),alpha:c}}const DA=(e,n)=>o=>!!(ry(o)&&Oee.test(o)&&o.startsWith(e)||n&&Object.prototype.hasOwnProperty.call(o,n)),O6=(e,n,o)=>c=>{if(!ry(c))return c;const[p,y,w,E]=c.match(TA);return{[e]:parseFloat(p),[n]:parseFloat(y),[o]:parseFloat(w),alpha:E!==void 0?parseFloat(E):1}},Rte=e=>Bu(0,255,e),VT={...Rp,transform:e=>Math.round(Rte(e))},$h={test:DA("rgb","red"),parse:O6("red","green","blue"),transform:({red:e,green:n,blue:o,alpha:c=1})=>"rgba("+VT.transform(e)+", "+VT.transform(n)+", "+VT.transform(o)+", "+n_(r_.transform(c))+")"};function Dte(e){let n="",o="",c="",p="";return e.length>5?(n=e.substring(1,3),o=e.substring(3,5),c=e.substring(5,7),p=e.substring(7,9)):(n=e.substring(1,2),o=e.substring(2,3),c=e.substring(3,4),p=e.substring(4,5),n+=n,o+=o,c+=c,p+=p),{red:parseInt(n,16),green:parseInt(o,16),blue:parseInt(c,16),alpha:p?parseInt(p,16)/255:1}}const vC={test:DA("#"),parse:Dte,transform:$h.transform},Wf={test:DA("hsl","hue"),parse:O6("hue","saturation","lightness"),transform:({hue:e,saturation:n,lightness:o,alpha:c=1})=>"hsla("+Math.round(e)+", "+Pl.transform(n_(n))+", "+Pl.transform(n_(o))+", "+n_(r_.transform(c))+")"},$T=(e,n,o)=>{const c=e*e,p=o*(n*n-c)+c;return p<0?0:Math.sqrt(p)},Lte=[vC,$h,Wf],Ote=e=>Lte.find(n=>n.test(e));function PD(e){const n=Ote(e);let o=n.parse(e);return n===Wf&&(o=zte(o)),o}const ID=(e,n)=>{const o=PD(e),c=PD(n),p={...o};return y=>(p.red=$T(o.red,c.red,y),p.green=$T(o.green,c.green,y),p.blue=$T(o.blue,c.blue,y),p.alpha=ri(o.alpha,c.alpha,y),$h.transform(p))},Mo={test:e=>$h.test(e)||vC.test(e)||Wf.test(e),parse:e=>$h.test(e)?$h.parse(e):Wf.test(e)?Wf.parse(e):vC.parse(e),transform:e=>ry(e)?e:e.hasOwnProperty("red")?$h.transform(e):Wf.transform(e)};function Bte(e){var n,o;return isNaN(e)&&ry(e)&&(((n=e.match(TA))===null||n===void 0?void 0:n.length)||0)+(((o=e.match(Lee))===null||o===void 0?void 0:o.length)||0)>0}const B6="number",F6="color",Fte="var",Nte="var(",zD="${}",RD=/(var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\))|(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))|((-)?([\d]*\.?[\d])+)/gi;function a1(e){const n=e.toString(),o=n.match(RD)||[],c=[],p={color:[],number:[],var:[]},y=[];for(let a=0;a<o.length;a++){const P=o[a];Mo.test(P)?(p.color.push(a),y.push(F6),c.push(Mo.parse(P))):P.startsWith(Nte)?(p.var.push(a),y.push(Fte),c.push(P)):(p.number.push(a),y.push(B6),c.push(parseFloat(P)))}const E=n.replace(RD,zD).split(zD);return{values:c,split:E,indexes:p,types:y}}function N6(e){return a1(e).values}function j6(e){const{split:n,types:o}=a1(e),c=n.length;return p=>{let y="";for(let w=0;w<c;w++)if(y+=n[w],p[w]!==void 0){const E=o[w];E===B6?y+=n_(p[w]):E===F6?y+=Mo.transform(p[w]):y+=p[w]}return y}}const jte=e=>typeof e=="number"?0:e;function Vte(e){const n=N6(e);return j6(e)(n.map(jte))}const Fu={test:Bte,parse:N6,createTransformer:j6,getAnimatableNone:Vte};function xC(e,n){return o=>o>0?n:e}function $te(e,n){return o=>ri(e,n,o)}function LA(e){return typeof e=="number"?$te:typeof e=="string"?i1(e)?xC:Mo.test(e)?ID:Wte:Array.isArray(e)?V6:typeof e=="object"?Mo.test(e)?ID:Ute:xC}function V6(e,n){const o=[...e],c=o.length,p=e.map((y,w)=>LA(y)(y,n[w]));return y=>{for(let w=0;w<c;w++)o[w]=p[w](y);return o}}function Ute(e,n){const o={...e,...n},c={};for(const p in o)e[p]!==void 0&&n[p]!==void 0&&(c[p]=LA(e[p])(e[p],n[p]));return p=>{for(const y in c)o[y]=c[y](p);return o}}function Gte(e,n){var o;const c=[],p={color:0,var:0,number:0};for(let y=0;y<n.values.length;y++){const w=n.types[y],E=e.indexes[w][p[w]],a=(o=e.values[E])!==null&&o!==void 0?o:0;c[y]=a,p[w]++}return c}const Wte=(e,n)=>{const o=Fu.createTransformer(n),c=a1(e),p=a1(n);return c.indexes.var.length===p.indexes.var.length&&c.indexes.color.length===p.indexes.color.length&&c.indexes.number.length>=p.indexes.number.length?Sc(V6(Gte(c,p),p.values),o):xC(e,n)};function $6(e,n,o){return typeof e=="number"&&typeof n=="number"&&typeof o=="number"?ri(e,n,o):LA(e)(e,n)}function qte(e,n,o){const c=[],p=o||$6,y=e.length-1;for(let w=0;w<y;w++){let E=p(e[w],e[w+1]);if(n){const a=Array.isArray(n)?n[w]||Pi:n;E=Sc(a,E)}c.push(E)}return c}function Hte(e,n,{clamp:o=!0,ease:c,mixer:p}={}){const y=e.length;if(IA(y===n.length),y===1)return()=>n[0];e[0]>e[y-1]&&(e=[...e].reverse(),n=[...n].reverse());const w=qte(n,c,p),E=w.length,a=P=>{let D=0;if(E>1)for(;D<e.length-2&&!(P<e[D+1]);D++);const L=B_(e[D],e[D+1],P);return w[D](L)};return o?P=>a(Bu(e[0],e[y-1],P)):a}function Zte(e,n){const o=e[e.length-1];for(let c=1;c<=n;c++){const p=B_(0,n,c);e.push(ri(o,1,p))}}function Xte(e){const n=[0];return Zte(n,e.length-1),n}function Yte(e,n){return e.map(o=>o*n)}function Kte(e,n){return e.map(()=>n||I6).splice(0,e.length-1)}function l1({duration:e=300,keyframes:n,times:o,ease:c="easeInOut"}){const p=Mte(c)?c.map(kD):kD(c),y={done:!1,value:n[0]},w=Yte(o&&o.length===n.length?o:Xte(n),e),E=Hte(w,n,{ease:Array.isArray(p)?p:Kte(n,p)});return{calculatedDuration:e,next:a=>(y.value=E(a),y.done=a>=e,y)}}function U6(e,n){return n?e*(1e3/n):0}const Jte=5;function G6(e,n,o){const c=Math.max(n-Jte,0);return U6(o-e(c),n-c)}const UT=.001,Qte=.01,ere=10,tre=.05,rre=1;function nre({duration:e=800,bounce:n=.25,velocity:o=0,mass:c=1}){let p,y,w=1-n;w=Bu(tre,rre,w),e=Bu(Qte,ere,Tc(e)),w<1?(p=P=>{const D=P*w,L=D*e,F=D-o,$=bC(P,w),H=Math.exp(-L);return UT-F/$*H},y=P=>{const L=P*w*e,F=L*o+o,$=Math.pow(w,2)*Math.pow(P,2)*e,H=Math.exp(-L),q=bC(Math.pow(P,2),w);return(-p(P)+UT>0?-1:1)*((F-$)*H)/q}):(p=P=>{const D=Math.exp(-P*e),L=(P-o)*e+1;return-UT+D*L},y=P=>{const D=Math.exp(-P*e),L=(o-P)*(e*e);return D*L});const E=5/e,a=ore(p,y,E);if(e=Xh(e),isNaN(a))return{stiffness:100,damping:10,duration:e};{const P=Math.pow(a,2)*c;return{stiffness:P,damping:w*2*Math.sqrt(c*P),duration:e}}}const ire=12;function ore(e,n,o){let c=o;for(let p=1;p<ire;p++)c=c-e(c)/n(c);return c}function bC(e,n){return e*Math.sqrt(1-n*n)}const sre=["duration","bounce"],are=["stiffness","damping","mass"];function DD(e,n){return n.some(o=>e[o]!==void 0)}function lre(e){let n={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!DD(e,are)&&DD(e,sre)){const o=nre(e);n={...n,...o,mass:1},n.isResolvedFromDuration=!0}return n}function W6({keyframes:e,restDelta:n,restSpeed:o,...c}){const p=e[0],y=e[e.length-1],w={done:!1,value:p},{stiffness:E,damping:a,mass:P,duration:D,velocity:L,isResolvedFromDuration:F}=lre({...c,velocity:-Tc(c.velocity||0)}),$=L||0,H=a/(2*Math.sqrt(E*P)),q=y-p,le=Tc(Math.sqrt(E/P)),ie=Math.abs(q)<5;o||(o=ie?.01:2),n||(n=ie?.005:.5);let te;if(H<1){const se=bC(le,H);te=be=>{const Ee=Math.exp(-H*le*be);return y-Ee*(($+H*le*q)/se*Math.sin(se*be)+q*Math.cos(se*be))}}else if(H===1)te=se=>y-Math.exp(-le*se)*(q+($+le*q)*se);else{const se=le*Math.sqrt(H*H-1);te=be=>{const Ee=Math.exp(-H*le*be),je=Math.min(se*be,300);return y-Ee*(($+H*le*q)*Math.sinh(je)+se*q*Math.cosh(je))/se}}return{calculatedDuration:F&&D||null,next:se=>{const be=te(se);if(F)w.done=se>=D;else{let Ee=$;se!==0&&(H<1?Ee=G6(te,se,be):Ee=0);const je=Math.abs(Ee)<=o,Be=Math.abs(y-be)<=n;w.done=je&&Be}return w.value=w.done?y:be,w}}}function LD({keyframes:e,velocity:n=0,power:o=.8,timeConstant:c=325,bounceDamping:p=10,bounceStiffness:y=500,modifyTarget:w,min:E,max:a,restDelta:P=.5,restSpeed:D}){const L=e[0],F={done:!1,value:L},$=Ze=>E!==void 0&&Ze<E||a!==void 0&&Ze>a,H=Ze=>E===void 0?a:a===void 0||Math.abs(E-Ze)<Math.abs(a-Ze)?E:a;let q=o*n;const le=L+q,ie=w===void 0?le:w(le);ie!==le&&(q=ie-L);const te=Ze=>-q*Math.exp(-Ze/c),se=Ze=>ie+te(Ze),be=Ze=>{const ht=te(Ze),Pe=se(Ze);F.done=Math.abs(ht)<=P,F.value=F.done?ie:Pe};let Ee,je;const Be=Ze=>{$(F.value)&&(Ee=Ze,je=W6({keyframes:[F.value,H(F.value)],velocity:G6(se,Ze,F.value),damping:p,stiffness:y,restDelta:P,restSpeed:D}))};return Be(0),{calculatedDuration:null,next:Ze=>{let ht=!1;return!je&&Ee===void 0&&(ht=!0,be(Ze),Be(Ze)),Ee!==void 0&&Ze>Ee?je.next(Ze-Ee):(!ht&&be(Ze),F)}}}let mx;function cre(){mx=void 0}const Yh={now:()=>(mx===void 0&&Yh.set(no.isProcessing||n6.useManualTiming?no.timestamp:performance.now()),mx),set:e=>{mx=e,queueMicrotask(cre)}},ure=e=>{const n=({timestamp:o})=>e(o);return{start:()=>Kn.update(n,!0),stop:()=>Ic(n),now:()=>no.isProcessing?no.timestamp:Yh.now()}},OD=2e4;function BD(e){let n=0;const o=50;let c=e.next(n);for(;!c.done&&n<OD;)n+=o,c=e.next(n);return n>=OD?1/0:n}const hre={decay:LD,inertia:LD,tween:l1,keyframes:l1,spring:W6},dre=e=>e/100;function c1({autoplay:e=!0,delay:n=0,driver:o=ure,keyframes:c,type:p="keyframes",repeat:y=0,repeatDelay:w=0,repeatType:E="loop",onPlay:a,onStop:P,onComplete:D,onUpdate:L,...F}){let $=1,H=!1,q,le;const ie=()=>{le=new Promise(qt=>{q=qt})};ie();let te;const se=hre[p]||l1;let be;se!==l1&&typeof c[0]!="number"&&(be=Sc(dre,$6(c[0],c[1])),c=[0,100]);const Ee=se({...F,keyframes:c});let je;E==="mirror"&&(je=se({...F,keyframes:[...c].reverse(),velocity:-(F.velocity||0)}));let Be="idle",Ze=null,ht=null,Pe=null;Ee.calculatedDuration===null&&y&&(Ee.calculatedDuration=BD(Ee));const{calculatedDuration:Et}=Ee;let or=1/0,st=1/0;Et!==null&&(or=Et+w,st=or*(y+1)-w);let ar=0;const Bn=qt=>{if(ht===null)return;$>0&&(ht=Math.min(ht,qt)),$<0&&(ht=Math.min(qt-st/$,ht)),Ze!==null?ar=Ze:ar=Math.round(qt-ht)*$;const _r=ar-n*($>=0?1:-1),wr=$>=0?_r<0:_r>st;ar=Math.max(_r,0),Be==="finished"&&Ze===null&&(ar=st);let Lr=ar,wi=Ee;if(y){const uo=Math.min(ar,st)/or;let Ti=Math.floor(uo),Tr=uo%1;!Tr&&uo>=1&&(Tr=1),Tr===1&&Ti--,Ti=Math.min(Ti,y+1),!!(Ti%2)&&(E==="reverse"?(Tr=1-Tr,w&&(Tr-=w/or)):E==="mirror"&&(wi=je)),Lr=Bu(0,1,Tr)*or}const sn=wr?{done:!1,value:c[0]}:wi.next(Lr);be&&(sn.value=be(sn.value));let{done:Xn}=sn;!wr&&Et!==null&&(Xn=$>=0?ar>=st:ar<=0);const Si=Ze===null&&(Be==="finished"||Be==="running"&&Xn);return L&&L(sn.value),Si&&Ot(),sn},Mr=()=>{te&&te.stop(),te=void 0},xn=()=>{Be="idle",Mr(),q(),ie(),ht=Pe=null},Ot=()=>{Be="finished",D&&D(),Mr(),q()},ct=()=>{if(H)return;te||(te=o(Bn));const qt=te.now();a&&a(),Ze!==null?ht=qt-Ze:(!ht||Be==="finished")&&(ht=qt),Be==="finished"&&ie(),Pe=ht,Ze=null,Be="running",te.start()};e&&ct();const Jt={then(qt,_r){return le.then(qt,_r)},get time(){return Tc(ar)},set time(qt){qt=Xh(qt),ar=qt,Ze!==null||!te||$===0?Ze=qt:ht=te.now()-qt/$},get duration(){const qt=Ee.calculatedDuration===null?BD(Ee):Ee.calculatedDuration;return Tc(qt)},get speed(){return $},set speed(qt){qt===$||!te||($=qt,Jt.time=Tc(ar))},get state(){return Be},play:ct,pause:()=>{Be="paused",Ze=ar},stop:()=>{H=!0,Be!=="idle"&&(Be="idle",P&&P(),xn())},cancel:()=>{Pe!==null&&Bn(Pe),xn()},complete:()=>{Be="finished"},sample:qt=>(ht=0,Bn(qt))};return Jt}function fre(e){let n;return()=>(n===void 0&&(n=e()),n)}const pre=fre(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),mre=new Set(["opacity","clipPath","filter","transform"]),kv=10,gre=2e4,_re=(e,n)=>n.type==="spring"||e==="backgroundColor"||!M6(n.ease);function yre(e,n,{onUpdate:o,onComplete:c,...p}){if(!(pre()&&mre.has(n)&&!p.repeatDelay&&p.repeatType!=="mirror"&&p.damping!==0&&p.type!=="inertia"))return!1;let w=!1,E,a,P=!1;const D=()=>{a=new Promise(se=>{E=se})};D();let{keyframes:L,duration:F=300,ease:$,times:H}=p;if(_re(n,p)){const se=c1({...p,repeat:0,delay:0});let be={done:!1,value:L[0]};const Ee=[];let je=0;for(;!be.done&&je<gre;)be=se.sample(je),Ee.push(be.value),je+=kv;H=void 0,L=Ee,F=je-kv,$="linear"}const q=xte(e.owner.current,n,L,{...p,duration:F,ease:$,times:H}),le=()=>{P=!1,q.cancel()},ie=()=>{P=!0,Kn.update(le),E(),D()};return q.onfinish=()=>{P||(e.set(bte(L,p)),c&&c(),ie())},{then(se,be){return a.then(se,be)},attachTimeline(se){return q.timeline=se,q.onfinish=null,Pi},get time(){return Tc(q.currentTime||0)},set time(se){q.currentTime=Xh(se)},get speed(){return q.playbackRate},set speed(se){q.playbackRate=se},get duration(){return Tc(F)},play:()=>{w||(q.play(),Ic(le))},pause:()=>q.pause(),stop:()=>{if(w=!0,q.playState==="idle")return;const{currentTime:se}=q;if(se){const be=c1({...p,autoplay:!1});e.setWithVelocity(be.sample(se-kv).value,be.sample(se).value,kv)}ie()},complete:()=>{P||q.finish()},cancel:ie}}function vre({keyframes:e,delay:n,onUpdate:o,onComplete:c}){const p=()=>(o&&o(e[e.length-1]),c&&c(),{time:0,speed:1,duration:0,play:Pi,pause:Pi,stop:Pi,then:y=>(y(),Promise.resolve()),cancel:Pi,complete:Pi});return n?c1({keyframes:[0,1],duration:0,delay:n,onComplete:p}):p()}const xre={type:"spring",stiffness:500,damping:25,restSpeed:10},bre=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),wre={type:"keyframes",duration:.8},Sre={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Tre=(e,{keyframes:n})=>n.length>2?wre:gd.has(e)?e.startsWith("scale")?bre(n[1]):xre:Sre,wC=(e,n)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Fu.test(n)||n==="0")&&!n.startsWith("url(")),Ere=new Set(["brightness","contrast","saturate","opacity"]);function Cre(e){const[n,o]=e.slice(0,-1).split("(");if(n==="drop-shadow")return e;const[c]=o.match(TA)||[];if(!c)return e;const p=o.replace(c,"");let y=Ere.has(n)?1:0;return c!==o&&(y*=100),n+"("+y+p+")"}const Mre=/([a-z-]*)\(.*?\)/g,SC={...Fu,getAnimatableNone:e=>{const n=e.match(Mre);return n?n.map(Cre).join(" "):e}},Are={...u6,color:Mo,backgroundColor:Mo,outlineColor:Mo,fill:Mo,stroke:Mo,borderColor:Mo,borderTopColor:Mo,borderRightColor:Mo,borderBottomColor:Mo,borderLeftColor:Mo,filter:SC,WebkitFilter:SC},OA=e=>Are[e];function q6(e,n){let o=OA(e);return o!==SC&&(o=Fu),o.getAnimatableNone?o.getAnimatableNone(n):void 0}const H6=e=>/^0[^.\s]+$/.test(e);function kre(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||H6(e)}function Pre(e,n,o,c){const p=wC(n,o);let y;Array.isArray(o)?y=[...o]:y=[null,o];const w=c.from!==void 0?c.from:e.get();let E;const a=[];for(let P=0;P<y.length;P++)y[P]===null&&(y[P]=P===0?w:y[P-1]),kre(y[P])&&a.push(P),typeof y[P]=="string"&&y[P]!=="none"&&y[P]!=="0"&&(E=y[P]);if(p&&a.length&&E)for(let P=0;P<a.length;P++){const D=a[P];y[D]=q6(n,E)}return y}function Ire({when:e,delay:n,delayChildren:o,staggerChildren:c,staggerDirection:p,repeat:y,repeatType:w,repeatDelay:E,from:a,elapsed:P,...D}){return!!Object.keys(D).length}function BA(e,n){return e[n]||e.default||e}const FA=(e,n,o,c={})=>p=>{const y=BA(c,e)||{},w=y.delay||c.delay||0;let{elapsed:E=0}=c;E=E-Xh(w);const a=Pre(n,e,o,y),P=a[0],D=a[a.length-1],L=wC(e,P),F=wC(e,D);let $={keyframes:a,velocity:n.getVelocity(),ease:"easeOut",...y,delay:-E,onUpdate:H=>{n.set(H),y.onUpdate&&y.onUpdate(H)},onComplete:()=>{p(),y.onComplete&&y.onComplete()}};if(Ire(y)||($={...$,...Tre(e,$)}),$.duration&&($.duration=Xh($.duration)),$.repeatDelay&&($.repeatDelay=Xh($.repeatDelay)),!L||!F||vte.current||y.type===!1||n6.skipAnimations)return vre($);if(!c.isHandoff&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate){const H=yre(n,e,$);if(H)return H}return c1($)};function u1(e){return!!(as(e)&&e.add)}const Z6=e=>/^\-?\d*\.?\d+$/.test(e);function NA(e,n){e.indexOf(n)===-1&&e.push(n)}function jA(e,n){const o=e.indexOf(n);o>-1&&e.splice(o,1)}class VA{constructor(){this.subscriptions=[]}add(n){return NA(this.subscriptions,n),()=>jA(this.subscriptions,n)}notify(n,o,c){const p=this.subscriptions.length;if(p)if(p===1)this.subscriptions[0](n,o,c);else for(let y=0;y<p;y++){const w=this.subscriptions[y];w&&w(n,o,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const FD=30,zre=e=>!isNaN(parseFloat(e));class Rre{constructor(n,o={}){this.version="11.0.8",this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(c,p=!0)=>{const y=Yh.now();this.updatedAt!==y&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(c),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),p&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(n),this.canTrackVelocity=zre(this.current),this.owner=o.owner}setCurrent(n){this.current=n,this.updatedAt=Yh.now()}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,o){this.events[n]||(this.events[n]=new VA);const c=this.events[n].add(o);return n==="change"?()=>{c(),Kn.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,o){this.passiveEffect=n,this.stopPassiveEffect=o}set(n,o=!0){!o||!this.passiveEffect?this.updateAndNotify(n,o):this.passiveEffect(n,this.updateAndNotify)}setWithVelocity(n,o,c){this.set(o),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-c}jump(n){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=Yh.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>FD)return 0;const o=Math.min(this.updatedAt-this.prevUpdatedAt,FD);return U6(parseFloat(this.current)-parseFloat(this.prevFrameValue),o)}start(n){return this.stop(),new Promise(o=>{this.hasAnimated=!0,this.animation=n(o),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wp(e,n){return new Rre(e,n)}const X6=e=>n=>n.test(e),Dre={test:e=>e==="auto",parse:e=>e},Y6=[Rp,xr,Pl,mu,Fee,Bee,Dre],vg=e=>Y6.find(X6(e)),Lre=[...Y6,Mo,Fu],Ore=e=>Lre.find(X6(e));function Bre(e,n,o){e.hasValue(n)?e.getValue(n).set(o):e.addValue(n,wp(o))}function Fre(e,n){const o=vb(e,n);let{transitionEnd:c={},transition:p={},...y}=o?e.makeTargetAnimatable(o,!1):{};y={...y,...c};for(const w in y){const E=Jee(y[w]);Bre(e,w,E)}}function Nre(e,n,o){var c,p;const y=Object.keys(n).filter(E=>!e.hasValue(E)),w=y.length;if(w)for(let E=0;E<w;E++){const a=y[E],P=n[a];let D=null;Array.isArray(P)&&(D=P[0]),D===null&&(D=(p=(c=o[a])!==null&&c!==void 0?c:e.readValue(a))!==null&&p!==void 0?p:n[a]),D!=null&&(typeof D=="string"&&(Z6(D)||H6(D))?D=parseFloat(D):!Ore(D)&&Fu.test(P)&&(D=q6(a,P)),e.addValue(a,wp(D,{owner:e})),o[a]===void 0&&(o[a]=D),D!==null&&e.setBaseTarget(a,D))}}function jre(e,n){return n?(n[e]||n.default||n).from:void 0}function Vre(e,n,o){const c={};for(const p in e){const y=jre(p,n);if(y!==void 0)c[p]=y;else{const w=o.getValue(p);w&&(c[p]=w.get())}}return c}function $re({protectedKeys:e,needsAnimating:n},o){const c=e.hasOwnProperty(o)&&n[o]!==!0;return n[o]=!1,c}function Ure(e,n){const o=e.get();if(Array.isArray(n)){for(let c=0;c<n.length;c++)if(n[c]!==o)return!0}else return o!==n}function K6(e,n,{delay:o=0,transitionOverride:c,type:p}={}){let{transition:y=e.getDefaultTransition(),transitionEnd:w,...E}=e.makeTargetAnimatable(n);const a=e.getValue("willChange");c&&(y=c);const P=[],D=p&&e.animationState&&e.animationState.getState()[p];for(const L in E){const F=e.getValue(L),$=E[L];if(!F||$===void 0||D&&$re(D,L))continue;const H={delay:o,elapsed:0,...BA(y||{},L)};if(window.HandoffAppearAnimations){const ie=e.getProps()[r6];if(ie){const te=window.HandoffAppearAnimations(ie,L,F,Kn);te!==null&&(H.elapsed=te,H.isHandoff=!0)}}let q=!H.isHandoff&&!Ure(F,$);if(H.type==="spring"&&(F.getVelocity()||H.velocity)&&(q=!1),F.animation&&(q=!1),q)continue;F.start(FA(L,F,$,e.shouldReduceMotion&&gd.has(L)?{type:!1}:H));const le=F.animation;u1(a)&&(a.add(L),le.then(()=>a.remove(L))),P.push(le)}return w&&Promise.all(P).then(()=>{w&&Fre(e,w)}),P}function TC(e,n,o={}){const c=vb(e,n,o.custom);let{transition:p=e.getDefaultTransition()||{}}=c||{};o.transitionOverride&&(p=o.transitionOverride);const y=c?()=>Promise.all(K6(e,c,o)):()=>Promise.resolve(),w=e.variantChildren&&e.variantChildren.size?(a=0)=>{const{delayChildren:P=0,staggerChildren:D,staggerDirection:L}=p;return Gre(e,n,P+a,D,L,o)}:()=>Promise.resolve(),{when:E}=p;if(E){const[a,P]=E==="beforeChildren"?[y,w]:[w,y];return a().then(()=>P())}else return Promise.all([y(),w(o.delay)])}function Gre(e,n,o=0,c=0,p=1,y){const w=[],E=(e.variantChildren.size-1)*c,a=p===1?(P=0)=>P*c:(P=0)=>E-P*c;return Array.from(e.variantChildren).sort(Wre).forEach((P,D)=>{P.notify("AnimationStart",n),w.push(TC(P,n,{...y,delay:o+a(D)}).then(()=>P.notify("AnimationComplete",n)))}),Promise.all(w)}function Wre(e,n){return e.sortNodePosition(n)}function qre(e,n,o={}){e.notify("AnimationStart",n);let c;if(Array.isArray(n)){const p=n.map(y=>TC(e,y,o));c=Promise.all(p)}else if(typeof n=="string")c=TC(e,n,o);else{const p=typeof n=="function"?vb(e,n,o.custom):n;c=Promise.all(K6(e,p,o))}return c.then(()=>e.notify("AnimationComplete",n))}const Hre=[...xA].reverse(),Zre=xA.length;function Xre(e){return n=>Promise.all(n.map(({animation:o,options:c})=>qre(e,o,c)))}function Yre(e){let n=Xre(e);const o=Jre();let c=!0;const p=(a,P)=>{const D=vb(e,P);if(D){const{transition:L,transitionEnd:F,...$}=D;a={...a,...$,...F}}return a};function y(a){n=a(e)}function w(a,P){const D=e.getProps(),L=e.getVariantContext(!0)||{},F=[],$=new Set;let H={},q=1/0;for(let ie=0;ie<Zre;ie++){const te=Hre[ie],se=o[te],be=D[te]!==void 0?D[te]:L[te],Ee=L_(be),je=te===P?se.isActive:null;je===!1&&(q=ie);let Be=be===L[te]&&be!==D[te]&&Ee;if(Be&&c&&e.manuallyAnimateOnMount&&(Be=!1),se.protectedKeys={...H},!se.isActive&&je===null||!be&&!se.prevProp||gb(be)||typeof be=="boolean")continue;let ht=Kre(se.prevProp,be)||te===P&&se.isActive&&!Be&&Ee||ie>q&&Ee,Pe=!1;const Et=Array.isArray(be)?be:[be];let or=Et.reduce(p,{});je===!1&&(or={});const{prevResolvedValues:st={}}=se,ar={...st,...or},Bn=Mr=>{ht=!0,$.has(Mr)&&(Pe=!0,$.delete(Mr)),se.needsAnimating[Mr]=!0};for(const Mr in ar){const xn=or[Mr],Ot=st[Mr];if(H.hasOwnProperty(Mr))continue;let ct=!1;s1(xn)&&s1(Ot)?ct=!E6(xn,Ot):ct=xn!==Ot,ct?xn!==void 0?Bn(Mr):$.add(Mr):xn!==void 0&&$.has(Mr)?Bn(Mr):se.protectedKeys[Mr]=!0}se.prevProp=be,se.prevResolvedValues=or,se.isActive&&(H={...H,...or}),c&&e.blockInitialAnimation&&(ht=!1),ht&&(!Be||Pe)&&F.push(...Et.map(Mr=>({animation:Mr,options:{type:te,...a}})))}if($.size){const ie={};$.forEach(te=>{const se=e.getBaseTarget(te);se!==void 0&&(ie[te]=se)}),F.push({animation:ie})}let le=!!F.length;return c&&(D.initial===!1||D.initial===D.animate)&&!e.manuallyAnimateOnMount&&(le=!1),c=!1,le?n(F):Promise.resolve()}function E(a,P,D){var L;if(o[a].isActive===P)return Promise.resolve();(L=e.variantChildren)===null||L===void 0||L.forEach($=>{var H;return(H=$.animationState)===null||H===void 0?void 0:H.setActive(a,P)}),o[a].isActive=P;const F=w(D,a);for(const $ in o)o[$].protectedKeys={};return F}return{animateChanges:w,setActive:E,setAnimateFunction:y,getState:()=>o}}function Kre(e,n){return typeof n=="string"?n!==e:Array.isArray(n)?!E6(n,e):!1}function kh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Jre(){return{animate:kh(!0),whileInView:kh(),whileHover:kh(),whileTap:kh(),whileDrag:kh(),whileFocus:kh(),exit:kh()}}class Qre extends Uu{constructor(n){super(n),n.animationState||(n.animationState=Yre(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();this.unmount(),gb(n)&&(this.unmount=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:o}=this.node.prevProps||{};n!==o&&this.updateAnimationControlsSubscription()}unmount(){}}let ene=0;class tne extends Uu{constructor(){super(...arguments),this.id=ene++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:o,custom:c}=this.node.presenceContext,{isPresent:p}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===p)return;const y=this.node.animationState.setActive("exit",!n,{custom:c??this.node.getProps().custom});o&&!n&&y.then(()=>o(this.id))}mount(){const{register:n}=this.node.presenceContext||{};n&&(this.unmount=n(this.id))}unmount(){}}const rne={animation:{Feature:Qre},exit:{Feature:tne}},ND=(e,n)=>Math.abs(e-n);function nne(e,n){const o=ND(e.x,n.x),c=ND(e.y,n.y);return Math.sqrt(o**2+c**2)}class J6{constructor(n,o,{transformPagePoint:c,contextWindow:p,dragSnapToOrigin:y=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const L=WT(this.lastMoveEventInfo,this.history),F=this.startEvent!==null,$=nne(L.offset,{x:0,y:0})>=3;if(!F&&!$)return;const{point:H}=L,{timestamp:q}=no;this.history.push({...H,timestamp:q});const{onStart:le,onMove:ie}=this.handlers;F||(le&&le(this.lastMoveEvent,L),this.startEvent=this.lastMoveEvent),ie&&ie(this.lastMoveEvent,L)},this.handlePointerMove=(L,F)=>{this.lastMoveEvent=L,this.lastMoveEventInfo=GT(F,this.transformPagePoint),Kn.update(this.updatePoint,!0)},this.handlePointerUp=(L,F)=>{this.end();const{onEnd:$,onSessionEnd:H,resumeAnimation:q}=this.handlers;if(this.dragSnapToOrigin&&q&&q(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const le=WT(L.type==="pointercancel"?this.lastMoveEventInfo:GT(F,this.transformPagePoint),this.history);this.startEvent&&$&&$(L,le),H&&H(L,le)},!x6(n))return;this.dragSnapToOrigin=y,this.handlers=o,this.transformPagePoint=c,this.contextWindow=p||window;const w=yb(n),E=GT(w,this.transformPagePoint),{point:a}=E,{timestamp:P}=no;this.history=[{...a,timestamp:P}];const{onSessionStart:D}=o;D&&D(n,WT(E,this.history)),this.removeListeners=Sc(wc(this.contextWindow,"pointermove",this.handlePointerMove),wc(this.contextWindow,"pointerup",this.handlePointerUp),wc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),Ic(this.updatePoint)}}function GT(e,n){return n?{point:n(e.point)}:e}function jD(e,n){return{x:e.x-n.x,y:e.y-n.y}}function WT({point:e},n){return{point:e,delta:jD(e,Q6(n)),offset:jD(e,ine(n)),velocity:one(n,.1)}}function ine(e){return e[0]}function Q6(e){return e[e.length-1]}function one(e,n){if(e.length<2)return{x:0,y:0};let o=e.length-1,c=null;const p=Q6(e);for(;o>=0&&(c=e[o],!(p.timestamp-c.timestamp>Xh(n)));)o--;if(!c)return{x:0,y:0};const y=Tc(p.timestamp-c.timestamp);if(y===0)return{x:0,y:0};const w={x:(p.x-c.x)/y,y:(p.y-c.y)/y};return w.x===1/0&&(w.x=0),w.y===1/0&&(w.y=0),w}function zs(e){return e.max-e.min}function EC(e,n=0,o=.01){return Math.abs(e-n)<=o}function VD(e,n,o,c=.5){e.origin=c,e.originPoint=ri(n.min,n.max,e.origin),e.scale=zs(o)/zs(n),(EC(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ri(o.min,o.max,e.origin)-e.originPoint,(EC(e.translate)||isNaN(e.translate))&&(e.translate=0)}function i_(e,n,o,c){VD(e.x,n.x,o.x,c?c.originX:void 0),VD(e.y,n.y,o.y,c?c.originY:void 0)}function $D(e,n,o){e.min=o.min+n.min,e.max=e.min+zs(n)}function sne(e,n,o){$D(e.x,n.x,o.x),$D(e.y,n.y,o.y)}function UD(e,n,o){e.min=n.min-o.min,e.max=e.min+zs(n)}function o_(e,n,o){UD(e.x,n.x,o.x),UD(e.y,n.y,o.y)}function ane(e,{min:n,max:o},c){return n!==void 0&&e<n?e=c?ri(n,e,c.min):Math.max(e,n):o!==void 0&&e>o&&(e=c?ri(o,e,c.max):Math.min(e,o)),e}function GD(e,n,o){return{min:n!==void 0?e.min+n:void 0,max:o!==void 0?e.max+o-(e.max-e.min):void 0}}function lne(e,{top:n,left:o,bottom:c,right:p}){return{x:GD(e.x,o,p),y:GD(e.y,n,c)}}function WD(e,n){let o=n.min-e.min,c=n.max-e.max;return n.max-n.min<e.max-e.min&&([o,c]=[c,o]),{min:o,max:c}}function cne(e,n){return{x:WD(e.x,n.x),y:WD(e.y,n.y)}}function une(e,n){let o=.5;const c=zs(e),p=zs(n);return p>c?o=B_(n.min,n.max-c,e.min):c>p&&(o=B_(e.min,e.max-p,n.min)),Bu(0,1,o)}function hne(e,n){const o={};return n.min!==void 0&&(o.min=n.min-e.min),n.max!==void 0&&(o.max=n.max-e.min),o}const CC=.35;function dne(e=CC){return e===!1?e=0:e===!0&&(e=CC),{x:qD(e,"left","right"),y:qD(e,"top","bottom")}}function qD(e,n,o){return{min:HD(e,n),max:HD(e,o)}}function HD(e,n){return typeof e=="number"?e:e[n]||0}const ZD=()=>({translate:0,scale:1,origin:0,originPoint:0}),qf=()=>({x:ZD(),y:ZD()}),XD=()=>({min:0,max:0}),yi=()=>({x:XD(),y:XD()});function Js(e){return[e("x"),e("y")]}function eN({top:e,left:n,right:o,bottom:c}){return{x:{min:n,max:o},y:{min:e,max:c}}}function fne({x:e,y:n}){return{top:n.min,right:e.max,bottom:n.max,left:e.min}}function pne(e,n){if(!n)return e;const o=n({x:e.left,y:e.top}),c=n({x:e.right,y:e.bottom});return{top:o.y,left:o.x,bottom:c.y,right:c.x}}function qT(e){return e===void 0||e===1}function MC({scale:e,scaleX:n,scaleY:o}){return!qT(e)||!qT(n)||!qT(o)}function zh(e){return MC(e)||tN(e)||e.z||e.rotate||e.rotateX||e.rotateY}function tN(e){return YD(e.x)||YD(e.y)}function YD(e){return e&&e!=="0%"}function h1(e,n,o){const c=e-o,p=n*c;return o+p}function KD(e,n,o,c,p){return p!==void 0&&(e=h1(e,p,c)),h1(e,o,c)+n}function AC(e,n=0,o=1,c,p){e.min=KD(e.min,n,o,c,p),e.max=KD(e.max,n,o,c,p)}function rN(e,{x:n,y:o}){AC(e.x,n.translate,n.scale,n.originPoint),AC(e.y,o.translate,o.scale,o.originPoint)}function mne(e,n,o,c=!1){const p=o.length;if(!p)return;n.x=n.y=1;let y,w;for(let E=0;E<p;E++){y=o[E],w=y.projectionDelta;const a=y.instance;a&&a.style&&a.style.display==="contents"||(c&&y.options.layoutScroll&&y.scroll&&y!==y.root&&Hf(e,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),w&&(n.x*=w.x.scale,n.y*=w.y.scale,rN(e,w)),c&&zh(y.latestValues)&&Hf(e,y.latestValues))}n.x=JD(n.x),n.y=JD(n.y)}function JD(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function yu(e,n){e.min=e.min+n,e.max=e.max+n}function QD(e,n,[o,c,p]){const y=n[p]!==void 0?n[p]:.5,w=ri(e.min,e.max,y);AC(e,n[o],n[c],w,n.scale)}const gne=["x","scaleX","originX"],_ne=["y","scaleY","originY"];function Hf(e,n){QD(e.x,n,gne),QD(e.y,n,_ne)}function nN(e,n){return eN(pne(e.getBoundingClientRect(),n))}function yne(e,n,o){const c=nN(e,o),{scroll:p}=n;return p&&(yu(c.x,p.offset.x),yu(c.y,p.offset.y)),c}const iN=({current:e})=>e?e.ownerDocument.defaultView:null,vne=new WeakMap;class xne{constructor(n){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=yi(),this.visualElement=n}start(n,{snapToCursor:o=!1}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const p=D=>{const{dragSnapToOrigin:L}=this.getProps();L?this.pauseAnimation():this.stopAnimation(),o&&this.snapToCursor(yb(D,"page").point)},y=(D,L)=>{const{drag:F,dragPropagation:$,onDragStart:H}=this.getProps();if(F&&!$&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=w6(F),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Js(le=>{let ie=this.getAxisMotionValue(le).get()||0;if(Pl.test(ie)){const{projection:te}=this.visualElement;if(te&&te.layout){const se=te.layout.layoutBox[le];se&&(ie=zs(se)*(parseFloat(ie)/100))}}this.originPoint[le]=ie}),H&&Kn.update(()=>H(D,L),!1,!0);const{animationState:q}=this.visualElement;q&&q.setActive("whileDrag",!0)},w=(D,L)=>{const{dragPropagation:F,dragDirectionLock:$,onDirectionLock:H,onDrag:q}=this.getProps();if(!F&&!this.openGlobalLock)return;const{offset:le}=L;if($&&this.currentDirection===null){this.currentDirection=bne(le),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",L.point,le),this.updateAxis("y",L.point,le),this.visualElement.render(),q&&q(D,L)},E=(D,L)=>this.stop(D,L),a=()=>Js(D=>{var L;return this.getAnimationState(D)==="paused"&&((L=this.getAxisMotionValue(D).animation)===null||L===void 0?void 0:L.play())}),{dragSnapToOrigin:P}=this.getProps();this.panSession=new J6(n,{onSessionStart:p,onStart:y,onMove:w,onSessionEnd:E,resumeAnimation:a},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:P,contextWindow:iN(this.visualElement)})}stop(n,o){const c=this.isDragging;if(this.cancel(),!c)return;const{velocity:p}=o;this.startAnimation(p);const{onDragEnd:y}=this.getProps();y&&Kn.update(()=>y(n,o))}cancel(){this.isDragging=!1;const{projection:n,animationState:o}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:c}=this.getProps();!c&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),o&&o.setActive("whileDrag",!1)}updateAxis(n,o,c){const{drag:p}=this.getProps();if(!c||!Pv(n,p,this.currentDirection))return;const y=this.getAxisMotionValue(n);let w=this.originPoint[n]+c[n];this.constraints&&this.constraints[n]&&(w=ane(w,this.constraints[n],this.elastic[n])),y.set(w)}resolveConstraints(){var n;const{dragConstraints:o,dragElastic:c}=this.getProps(),p=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(n=this.visualElement.projection)===null||n===void 0?void 0:n.layout,y=this.constraints;o&&Gf(o)?this.constraints||(this.constraints=this.resolveRefConstraints()):o&&p?this.constraints=lne(p.layoutBox,o):this.constraints=!1,this.elastic=dne(c),y!==this.constraints&&p&&this.constraints&&!this.hasMutatedConstraints&&Js(w=>{this.getAxisMotionValue(w)&&(this.constraints[w]=hne(p.layoutBox[w],this.constraints[w]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:o}=this.getProps();if(!n||!Gf(n))return!1;const c=n.current,{projection:p}=this.visualElement;if(!p||!p.layout)return!1;const y=yne(c,p.root,this.visualElement.getTransformPagePoint());let w=cne(p.layout.layoutBox,y);if(o){const E=o(fne(w));this.hasMutatedConstraints=!!E,E&&(w=eN(E))}return w}startAnimation(n){const{drag:o,dragMomentum:c,dragElastic:p,dragTransition:y,dragSnapToOrigin:w,onDragTransitionEnd:E}=this.getProps(),a=this.constraints||{},P=Js(D=>{if(!Pv(D,o,this.currentDirection))return;let L=a&&a[D]||{};w&&(L={min:0,max:0});const F=p?200:1e6,$=p?40:1e7,H={type:"inertia",velocity:c?n[D]:0,bounceStiffness:F,bounceDamping:$,timeConstant:750,restDelta:1,restSpeed:10,...y,...L};return this.startAxisValueAnimation(D,H)});return Promise.all(P).then(E)}startAxisValueAnimation(n,o){const c=this.getAxisMotionValue(n);return c.start(FA(n,c,0,o))}stopAnimation(){Js(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){Js(n=>{var o;return(o=this.getAxisMotionValue(n).animation)===null||o===void 0?void 0:o.pause()})}getAnimationState(n){var o;return(o=this.getAxisMotionValue(n).animation)===null||o===void 0?void 0:o.state}getAxisMotionValue(n){const o="_drag"+n.toUpperCase(),c=this.visualElement.getProps(),p=c[o];return p||this.visualElement.getValue(n,(c.initial?c.initial[n]:void 0)||0)}snapToCursor(n){Js(o=>{const{drag:c}=this.getProps();if(!Pv(o,c,this.currentDirection))return;const{projection:p}=this.visualElement,y=this.getAxisMotionValue(o);if(p&&p.layout){const{min:w,max:E}=p.layout.layoutBox[o];y.set(n[o]-ri(w,E,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:o}=this.getProps(),{projection:c}=this.visualElement;if(!Gf(o)||!c||!this.constraints)return;this.stopAnimation();const p={x:0,y:0};Js(w=>{const E=this.getAxisMotionValue(w);if(E){const a=E.get();p[w]=une({min:a,max:a},this.constraints[w])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),Js(w=>{if(!Pv(w,n,null))return;const E=this.getAxisMotionValue(w),{min:a,max:P}=this.constraints[w];E.set(ri(a,P,p[w]))})}addListeners(){if(!this.visualElement.current)return;vne.set(this.visualElement,this);const n=this.visualElement.current,o=wc(n,"pointerdown",a=>{const{drag:P,dragListener:D=!0}=this.getProps();P&&D&&this.start(a)}),c=()=>{const{dragConstraints:a}=this.getProps();Gf(a)&&(this.constraints=this.resolveRefConstraints())},{projection:p}=this.visualElement,y=p.addEventListener("measure",c);p&&!p.layout&&(p.root&&p.root.updateScroll(),p.updateLayout()),c();const w=vc(window,"resize",()=>this.scalePositionWithinConstraints()),E=p.addEventListener("didUpdate",({delta:a,hasLayoutChanged:P})=>{this.isDragging&&P&&(Js(D=>{const L=this.getAxisMotionValue(D);L&&(this.originPoint[D]+=a[D].translate,L.set(L.get()+a[D].translate))}),this.visualElement.render())});return()=>{w(),o(),y(),E&&E()}}getProps(){const n=this.visualElement.getProps(),{drag:o=!1,dragDirectionLock:c=!1,dragPropagation:p=!1,dragConstraints:y=!1,dragElastic:w=CC,dragMomentum:E=!0}=n;return{...n,drag:o,dragDirectionLock:c,dragPropagation:p,dragConstraints:y,dragElastic:w,dragMomentum:E}}}function Pv(e,n,o){return(n===!0||n===e)&&(o===null||o===e)}function bne(e,n=10){let o=null;return Math.abs(e.y)>n?o="y":Math.abs(e.x)>n&&(o="x"),o}class wne extends Uu{constructor(n){super(n),this.removeGroupControls=Pi,this.removeListeners=Pi,this.controls=new xne(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const e5=e=>(n,o)=>{e&&Kn.update(()=>e(n,o))};class Sne extends Uu{constructor(){super(...arguments),this.removePointerDownListener=Pi}onPointerDown(n){this.session=new J6(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:iN(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:o,onPan:c,onPanEnd:p}=this.node.getProps();return{onSessionStart:e5(n),onStart:e5(o),onMove:c,onEnd:(y,w)=>{delete this.session,p&&Kn.update(()=>p(y,w))}}}mount(){this.removePointerDownListener=wc(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function oN(){const e=re.useContext(ey);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:o,register:c}=e,p=re.useId();return re.useEffect(()=>c(p),[]),!n&&o?[!1,()=>o&&o(p)]:[!0]}function Tne(){return Ene(re.useContext(ey))}function Ene(e){return e===null?!0:e.isPresent}const gx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function t5(e,n){return n.max===n.min?0:e/(n.max-n.min)*100}const xg={correct:(e,n)=>{if(!n.target)return e;if(typeof e=="string")if(xr.test(e))e=parseFloat(e);else return e;const o=t5(e,n.target.x),c=t5(e,n.target.y);return`${o}% ${c}%`}},Cne={correct:(e,{treeScale:n,projectionDelta:o})=>{const c=e,p=Fu.parse(e);if(p.length>5)return c;const y=Fu.createTransformer(e),w=typeof p[0]!="number"?1:0,E=o.x.scale*n.x,a=o.y.scale*n.y;p[0+w]/=E,p[1+w]/=a;const P=ri(E,a,.5);return typeof p[2+w]=="number"&&(p[2+w]/=P),typeof p[3+w]=="number"&&(p[3+w]/=P),y(p)}};class Mne extends Cs.Component{componentDidMount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:c,layoutId:p}=this.props,{projection:y}=n;Aee(Ane),y&&(o.group&&o.group.add(y),c&&c.register&&p&&c.register(y),y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),gx.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:o,visualElement:c,drag:p,isPresent:y}=this.props,w=c.projection;return w&&(w.isPresent=y,p||n.layoutDependency!==o||o===void 0?w.willUpdate():this.safeToRemove(),n.isPresent!==y&&(y?w.promote():w.relegate()||Kn.postRender(()=>{const E=w.getStack();(!E||!E.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),vA.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:c}=this.props,{projection:p}=n;p&&(p.scheduleCheckAfterUnmount(),o&&o.group&&o.group.remove(p),c&&c.deregister&&c.deregister(p))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function sN(e){const[n,o]=oN(),c=re.useContext(wA);return Cs.createElement(Mne,{...e,layoutGroup:c,switchLayoutGroup:re.useContext(s6),isPresent:n,safeToRemove:o})}const Ane={borderRadius:{...xg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xg,borderTopRightRadius:xg,borderBottomLeftRadius:xg,borderBottomRightRadius:xg,boxShadow:Cne},aN=["TopLeft","TopRight","BottomLeft","BottomRight"],kne=aN.length,r5=e=>typeof e=="string"?parseFloat(e):e,n5=e=>typeof e=="number"||xr.test(e);function Pne(e,n,o,c,p,y){p?(e.opacity=ri(0,o.opacity!==void 0?o.opacity:1,Ine(c)),e.opacityExit=ri(n.opacity!==void 0?n.opacity:1,0,zne(c))):y&&(e.opacity=ri(n.opacity!==void 0?n.opacity:1,o.opacity!==void 0?o.opacity:1,c));for(let w=0;w<kne;w++){const E=`border${aN[w]}Radius`;let a=i5(n,E),P=i5(o,E);if(a===void 0&&P===void 0)continue;a||(a=0),P||(P=0),a===0||P===0||n5(a)===n5(P)?(e[E]=Math.max(ri(r5(a),r5(P),c),0),(Pl.test(P)||Pl.test(a))&&(e[E]+="%")):e[E]=P}(n.rotate||o.rotate)&&(e.rotate=ri(n.rotate||0,o.rotate||0,c))}function i5(e,n){return e[n]!==void 0?e[n]:e.borderRadius}const Ine=lN(0,.5,D6),zne=lN(.5,.95,Pi);function lN(e,n,o){return c=>c<e?0:c>n?1:o(B_(e,n,c))}function o5(e,n){e.min=n.min,e.max=n.max}function Ys(e,n){o5(e.x,n.x),o5(e.y,n.y)}function s5(e,n,o,c,p){return e-=n,e=h1(e,1/o,c),p!==void 0&&(e=h1(e,1/p,c)),e}function Rne(e,n=0,o=1,c=.5,p,y=e,w=e){if(Pl.test(n)&&(n=parseFloat(n),n=ri(w.min,w.max,n/100)-w.min),typeof n!="number")return;let E=ri(y.min,y.max,c);e===y&&(E-=n),e.min=s5(e.min,n,o,E,p),e.max=s5(e.max,n,o,E,p)}function a5(e,n,[o,c,p],y,w){Rne(e,n[o],n[c],n[p],n.scale,y,w)}const Dne=["x","scaleX","originX"],Lne=["y","scaleY","originY"];function l5(e,n,o,c){a5(e.x,n,Dne,o?o.x:void 0,c?c.x:void 0),a5(e.y,n,Lne,o?o.y:void 0,c?c.y:void 0)}function c5(e){return e.translate===0&&e.scale===1}function cN(e){return c5(e.x)&&c5(e.y)}function One(e,n){return e.x.min===n.x.min&&e.x.max===n.x.max&&e.y.min===n.y.min&&e.y.max===n.y.max}function uN(e,n){return Math.round(e.x.min)===Math.round(n.x.min)&&Math.round(e.x.max)===Math.round(n.x.max)&&Math.round(e.y.min)===Math.round(n.y.min)&&Math.round(e.y.max)===Math.round(n.y.max)}function u5(e){return zs(e.x)/zs(e.y)}class Bne{constructor(){this.members=[]}add(n){NA(this.members,n),n.scheduleRender()}remove(n){if(jA(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const o=this.members[this.members.length-1];o&&this.promote(o)}}relegate(n){const o=this.members.findIndex(p=>n===p);if(o===0)return!1;let c;for(let p=o;p>=0;p--){const y=this.members[p];if(y.isPresent!==!1){c=y;break}}return c?(this.promote(c),!0):!1}promote(n,o){const c=this.lead;if(n!==c&&(this.prevLead=c,this.lead=n,n.show(),c)){c.instance&&c.scheduleRender(),n.scheduleRender(),n.resumeFrom=c,o&&(n.resumeFrom.preserveOpacity=!0),c.snapshot&&(n.snapshot=c.snapshot,n.snapshot.latestValues=c.animationValues||c.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:p}=n.options;p===!1&&c.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:o,resumingFrom:c}=n;o.onExitComplete&&o.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function h5(e,n,o){let c="";const p=e.x.translate/n.x,y=e.y.translate/n.y;if((p||y)&&(c=`translate3d(${p}px, ${y}px, 0) `),(n.x!==1||n.y!==1)&&(c+=`scale(${1/n.x}, ${1/n.y}) `),o){const{rotate:a,rotateX:P,rotateY:D}=o;a&&(c+=`rotate(${a}deg) `),P&&(c+=`rotateX(${P}deg) `),D&&(c+=`rotateY(${D}deg) `)}const w=e.x.scale*n.x,E=e.y.scale*n.y;return(w!==1||E!==1)&&(c+=`scale(${w}, ${E})`),c||"none"}const Fne=(e,n)=>e.depth-n.depth;class Nne{constructor(){this.children=[],this.isDirty=!1}add(n){NA(this.children,n),this.isDirty=!0}remove(n){jA(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(Fne),this.isDirty=!1,this.children.forEach(n)}}function jne(e,n){const o=Yh.now(),c=({timestamp:p})=>{const y=p-o;y>=n&&(Ic(c),e(y-n))};return Kn.read(c,!0),()=>Ic(c)}function Vne(e){window.MotionDebug&&window.MotionDebug.record(e)}function $ne(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Une(e,n,o){const c=as(e)?e:wp(e);return c.start(FA("",c,n,o)),c.animation}const d5=["","X","Y","Z"],Gne={visibility:"hidden"},f5=1e3;let Wne=0;const Rh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function hN({attachResizeListener:e,defaultParent:n,measureScroll:o,checkIsScrollRoot:c,resetTransform:p}){return class{constructor(w={},E=n==null?void 0:n()){this.id=Wne++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Rh.totalNodes=Rh.resolvedTargetDeltas=Rh.recalculatedProjection=0,this.nodes.forEach(Zne),this.nodes.forEach(Qne),this.nodes.forEach(eie),this.nodes.forEach(Xne),Vne(Rh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=w,this.root=E?E.root||E:this,this.path=E?[...E.path,E]:[],this.parent=E,this.depth=E?E.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new Nne)}addEventListener(w,E){return this.eventHandlers.has(w)||this.eventHandlers.set(w,new VA),this.eventHandlers.get(w).add(E)}notifyListeners(w,...E){const a=this.eventHandlers.get(w);a&&a.notify(...E)}hasListeners(w){return this.eventHandlers.has(w)}mount(w,E=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=$ne(w),this.instance=w;const{layoutId:a,layout:P,visualElement:D}=this.options;if(D&&!D.current&&D.mount(w),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),E&&(P||a)&&(this.isLayoutDirty=!0),e){let L;const F=()=>this.root.updateBlockedByResize=!1;e(w,()=>{this.root.updateBlockedByResize=!0,L&&L(),L=jne(F,250),gx.hasAnimatedSinceResize&&(gx.hasAnimatedSinceResize=!1,this.nodes.forEach(m5))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&D&&(a||P)&&this.addEventListener("didUpdate",({delta:L,hasLayoutChanged:F,hasRelativeTargetChanged:$,layout:H})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const q=this.options.transition||D.getDefaultTransition()||oie,{onLayoutAnimationStart:le,onLayoutAnimationComplete:ie}=D.getProps(),te=!this.targetLayout||!uN(this.targetLayout,H)||$,se=!F&&$;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||se||F&&(te||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(L,se);const be={...BA(q,"layout"),onPlay:le,onComplete:ie};(D.shouldReduceMotion||this.options.layoutRoot)&&(be.delay=0,be.type=!1),this.startAnimation(be)}else F||m5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=H})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const w=this.getStack();w&&w.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ic(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tie),this.animationId++)}getTransformTemplate(){const{visualElement:w}=this.options;return w&&w.getProps().transformTemplate}willUpdate(w=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let D=0;D<this.path.length;D++){const L=this.path[D];L.shouldResetTransform=!0,L.updateScroll("snapshot"),L.options.layoutRoot&&L.willUpdate(!1)}const{layoutId:E,layout:a}=this.options;if(E===void 0&&!a)return;const P=this.getTransformTemplate();this.prevTransformTemplateValue=P?P(this.latestValues,""):void 0,this.updateSnapshot(),w&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(p5);return}this.isUpdating||this.nodes.forEach(Kne),this.isUpdating=!1,window.HandoffCancelAllAnimations&&window.HandoffCancelAllAnimations(),this.nodes.forEach(Jne),this.nodes.forEach(qne),this.nodes.forEach(Hne),this.clearAllSnapshots();const E=Yh.now();no.delta=Bu(0,1e3/60,E-no.timestamp),no.timestamp=E,no.isProcessing=!0,BT.update.process(no),BT.preRender.process(no),BT.render.process(no),no.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,vA.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Yne),this.sharedNodes.forEach(rie)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Kn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Kn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();const w=this.layout;this.layout=this.measure(!1),this.layoutCorrected=yi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:E}=this.options;E&&E.notify("LayoutMeasure",this.layout.layoutBox,w?w.layoutBox:void 0)}updateScroll(w="measure"){let E=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===w&&(E=!1),E&&(this.scroll={animationId:this.root.animationId,phase:w,isRoot:c(this.instance),offset:o(this.instance)})}resetTransform(){if(!p)return;const w=this.isLayoutDirty||this.shouldResetTransform,E=this.projectionDelta&&!cN(this.projectionDelta),a=this.getTransformTemplate(),P=a?a(this.latestValues,""):void 0,D=P!==this.prevTransformTemplateValue;w&&(E||zh(this.latestValues)||D)&&(p(this.instance,P),this.shouldResetTransform=!1,this.scheduleRender())}measure(w=!0){const E=this.measurePageBox();let a=this.removeElementScroll(E);return w&&(a=this.removeTransform(a)),sie(a),{animationId:this.root.animationId,measuredBox:E,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:w}=this.options;if(!w)return yi();const E=w.measureViewportBox(),{scroll:a}=this.root;return a&&(yu(E.x,a.offset.x),yu(E.y,a.offset.y)),E}removeElementScroll(w){const E=yi();Ys(E,w);for(let a=0;a<this.path.length;a++){const P=this.path[a],{scroll:D,options:L}=P;if(P!==this.root&&D&&L.layoutScroll){if(D.isRoot){Ys(E,w);const{scroll:F}=this.root;F&&(yu(E.x,-F.offset.x),yu(E.y,-F.offset.y))}yu(E.x,D.offset.x),yu(E.y,D.offset.y)}}return E}applyTransform(w,E=!1){const a=yi();Ys(a,w);for(let P=0;P<this.path.length;P++){const D=this.path[P];!E&&D.options.layoutScroll&&D.scroll&&D!==D.root&&Hf(a,{x:-D.scroll.offset.x,y:-D.scroll.offset.y}),zh(D.latestValues)&&Hf(a,D.latestValues)}return zh(this.latestValues)&&Hf(a,this.latestValues),a}removeTransform(w){const E=yi();Ys(E,w);for(let a=0;a<this.path.length;a++){const P=this.path[a];if(!P.instance||!zh(P.latestValues))continue;MC(P.latestValues)&&P.updateSnapshot();const D=yi(),L=P.measurePageBox();Ys(D,L),l5(E,P.latestValues,P.snapshot?P.snapshot.layoutBox:void 0,D)}return zh(this.latestValues)&&l5(E,this.latestValues),E}setTargetDelta(w){this.targetDelta=w,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(w){this.options={...this.options,...w,crossfade:w.crossfade!==void 0?w.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==no.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(w=!1){var E;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const P=!!this.resumingFrom||this!==a;if(!(w||P&&this.isSharedProjectionDirty||this.isProjectionDirty||!((E=this.parent)===null||E===void 0)&&E.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:L,layoutId:F}=this.options;if(!(!this.layout||!(L||F))){if(this.resolvedRelativeTargetAt=no.timestamp,!this.targetDelta&&!this.relativeTarget){const $=this.getClosestProjectingParent();$&&$.layout&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yi(),this.relativeTargetOrigin=yi(),o_(this.relativeTargetOrigin,this.layout.layoutBox,$.layout.layoutBox),Ys(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=yi(),this.targetWithTransforms=yi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),sne(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ys(this.target,this.layout.layoutBox),rN(this.target,this.targetDelta)):Ys(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const $=this.getClosestProjectingParent();$&&!!$.resumingFrom==!!this.resumingFrom&&!$.options.layoutScroll&&$.target&&this.animationProgress!==1?(this.relativeParent=$,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yi(),this.relativeTargetOrigin=yi(),o_(this.relativeTargetOrigin,this.target,$.target),Ys(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Rh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||MC(this.parent.latestValues)||tN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var w;const E=this.getLead(),a=!!this.resumingFrom||this!==E;let P=!0;if((this.isProjectionDirty||!((w=this.parent)===null||w===void 0)&&w.isProjectionDirty)&&(P=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(P=!1),this.resolvedRelativeTargetAt===no.timestamp&&(P=!1),P)return;const{layout:D,layoutId:L}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(D||L))return;Ys(this.layoutCorrected,this.layout.layoutBox);const F=this.treeScale.x,$=this.treeScale.y;mne(this.layoutCorrected,this.treeScale,this.path,a),E.layout&&!E.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(E.target=E.layout.layoutBox,E.targetWithTransforms=yi());const{target:H}=E;if(!H){this.projectionTransform&&(this.projectionDelta=qf(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=qf(),this.projectionDeltaWithTransform=qf());const q=this.projectionTransform;i_(this.projectionDelta,this.layoutCorrected,H,this.latestValues),this.projectionTransform=h5(this.projectionDelta,this.treeScale),(this.projectionTransform!==q||this.treeScale.x!==F||this.treeScale.y!==$)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",H)),Rh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(w=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),w){const E=this.getStack();E&&E.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(w,E=!1){const a=this.snapshot,P=a?a.latestValues:{},D={...this.latestValues},L=qf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!E;const F=yi(),$=a?a.source:void 0,H=this.layout?this.layout.source:void 0,q=$!==H,le=this.getStack(),ie=!le||le.members.length<=1,te=!!(q&&!ie&&this.options.crossfade===!0&&!this.path.some(iie));this.animationProgress=0;let se;this.mixTargetDelta=be=>{const Ee=be/1e3;g5(L.x,w.x,Ee),g5(L.y,w.y,Ee),this.setTargetDelta(L),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(o_(F,this.layout.layoutBox,this.relativeParent.layout.layoutBox),nie(this.relativeTarget,this.relativeTargetOrigin,F,Ee),se&&One(this.relativeTarget,se)&&(this.isProjectionDirty=!1),se||(se=yi()),Ys(se,this.relativeTarget)),q&&(this.animationValues=D,Pne(D,P,this.latestValues,Ee,te,ie)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(w){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ic(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Kn.update(()=>{gx.hasAnimatedSinceResize=!0,this.currentAnimation=Une(0,f5,{...w,onUpdate:E=>{this.mixTargetDelta(E),w.onUpdate&&w.onUpdate(E)},onComplete:()=>{w.onComplete&&w.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const w=this.getStack();w&&w.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(f5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const w=this.getLead();let{targetWithTransforms:E,target:a,layout:P,latestValues:D}=w;if(!(!E||!a||!P)){if(this!==w&&this.layout&&P&&dN(this.options.animationType,this.layout.layoutBox,P.layoutBox)){a=this.target||yi();const L=zs(this.layout.layoutBox.x);a.x.min=w.target.x.min,a.x.max=a.x.min+L;const F=zs(this.layout.layoutBox.y);a.y.min=w.target.y.min,a.y.max=a.y.min+F}Ys(E,a),Hf(E,D),i_(this.projectionDeltaWithTransform,this.layoutCorrected,E,D)}}registerSharedNode(w,E){this.sharedNodes.has(w)||this.sharedNodes.set(w,new Bne),this.sharedNodes.get(w).add(E);const P=E.options.initialPromotionConfig;E.promote({transition:P?P.transition:void 0,preserveFollowOpacity:P&&P.shouldPreserveFollowOpacity?P.shouldPreserveFollowOpacity(E):void 0})}isLead(){const w=this.getStack();return w?w.lead===this:!0}getLead(){var w;const{layoutId:E}=this.options;return E?((w=this.getStack())===null||w===void 0?void 0:w.lead)||this:this}getPrevLead(){var w;const{layoutId:E}=this.options;return E?(w=this.getStack())===null||w===void 0?void 0:w.prevLead:void 0}getStack(){const{layoutId:w}=this.options;if(w)return this.root.sharedNodes.get(w)}promote({needsReset:w,transition:E,preserveFollowOpacity:a}={}){const P=this.getStack();P&&P.promote(this,a),w&&(this.projectionDelta=void 0,this.needsReset=!0),E&&this.setOptions({transition:E})}relegate(){const w=this.getStack();return w?w.relegate(this):!1}resetRotation(){const{visualElement:w}=this.options;if(!w)return;let E=!1;const{latestValues:a}=w;if((a.rotate||a.rotateX||a.rotateY||a.rotateZ)&&(E=!0),!E)return;const P={};for(let D=0;D<d5.length;D++){const L="rotate"+d5[D];a[L]&&(P[L]=a[L],w.setStaticValue(L,0))}w.render();for(const D in P)w.setStaticValue(D,P[D]);w.scheduleRender()}getProjectionStyles(w){var E,a;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Gne;const P={visibility:""},D=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,P.opacity="",P.pointerEvents=px(w==null?void 0:w.pointerEvents)||"",P.transform=D?D(this.latestValues,""):"none",P;const L=this.getLead();if(!this.projectionDelta||!this.layout||!L.target){const q={};return this.options.layoutId&&(q.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,q.pointerEvents=px(w==null?void 0:w.pointerEvents)||""),this.hasProjected&&!zh(this.latestValues)&&(q.transform=D?D({},""):"none",this.hasProjected=!1),q}const F=L.animationValues||L.latestValues;this.applyTransformsToTarget(),P.transform=h5(this.projectionDeltaWithTransform,this.treeScale,F),D&&(P.transform=D(F,P.transform));const{x:$,y:H}=this.projectionDelta;P.transformOrigin=`${$.origin*100}% ${H.origin*100}% 0`,L.animationValues?P.opacity=L===this?(a=(E=F.opacity)!==null&&E!==void 0?E:this.latestValues.opacity)!==null&&a!==void 0?a:1:this.preserveOpacity?this.latestValues.opacity:F.opacityExit:P.opacity=L===this?F.opacity!==void 0?F.opacity:"":F.opacityExit!==void 0?F.opacityExit:0;for(const q in n1){if(F[q]===void 0)continue;const{correct:le,applyTo:ie}=n1[q],te=P.transform==="none"?F[q]:le(F[q],L);if(ie){const se=ie.length;for(let be=0;be<se;be++)P[ie[be]]=te}else P[q]=te}return this.options.layoutId&&(P.pointerEvents=L===this?px(w==null?void 0:w.pointerEvents)||"":"none"),P}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(w=>{var E;return(E=w.currentAnimation)===null||E===void 0?void 0:E.stop()}),this.root.nodes.forEach(p5),this.root.sharedNodes.clear()}}}function qne(e){e.updateLayout()}function Hne(e){var n;const o=((n=e.resumeFrom)===null||n===void 0?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&o&&e.hasListeners("didUpdate")){const{layoutBox:c,measuredBox:p}=e.layout,{animationType:y}=e.options,w=o.source!==e.layout.source;y==="size"?Js(L=>{const F=w?o.measuredBox[L]:o.layoutBox[L],$=zs(F);F.min=c[L].min,F.max=F.min+$}):dN(y,o.layoutBox,c)&&Js(L=>{const F=w?o.measuredBox[L]:o.layoutBox[L],$=zs(c[L]);F.max=F.min+$,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[L].max=e.relativeTarget[L].min+$)});const E=qf();i_(E,c,o.layoutBox);const a=qf();w?i_(a,e.applyTransform(p,!0),o.measuredBox):i_(a,c,o.layoutBox);const P=!cN(E);let D=!1;if(!e.resumeFrom){const L=e.getClosestProjectingParent();if(L&&!L.resumeFrom){const{snapshot:F,layout:$}=L;if(F&&$){const H=yi();o_(H,o.layoutBox,F.layoutBox);const q=yi();o_(q,c,$.layoutBox),uN(H,q)||(D=!0),L.options.layoutRoot&&(e.relativeTarget=q,e.relativeTargetOrigin=H,e.relativeParent=L)}}}e.notifyListeners("didUpdate",{layout:c,snapshot:o,delta:a,layoutDelta:E,hasLayoutChanged:P,hasRelativeTargetChanged:D})}else if(e.isLead()){const{onExitComplete:c}=e.options;c&&c()}e.options.transition=void 0}function Zne(e){Rh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Xne(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Yne(e){e.clearSnapshot()}function p5(e){e.clearMeasurements()}function Kne(e){e.isLayoutDirty=!1}function Jne(e){const{visualElement:n}=e.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),e.resetTransform()}function m5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Qne(e){e.resolveTargetDelta()}function eie(e){e.calcProjection()}function tie(e){e.resetRotation()}function rie(e){e.removeLeadSnapshot()}function g5(e,n,o){e.translate=ri(n.translate,0,o),e.scale=ri(n.scale,1,o),e.origin=n.origin,e.originPoint=n.originPoint}function _5(e,n,o,c){e.min=ri(n.min,o.min,c),e.max=ri(n.max,o.max,c)}function nie(e,n,o,c){_5(e.x,n.x,o.x,c),_5(e.y,n.y,o.y,c)}function iie(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const oie={duration:.45,ease:[.4,0,.1,1]},y5=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),v5=y5("applewebkit/")&&!y5("chrome/")?Math.round:Pi;function x5(e){e.min=v5(e.min),e.max=v5(e.max)}function sie(e){x5(e.x),x5(e.y)}function dN(e,n,o){return e==="position"||e==="preserve-aspect"&&!EC(u5(n),u5(o),.2)}const aie=hN({attachResizeListener:(e,n)=>vc(e,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),HT={current:void 0},fN=hN({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!HT.current){const e=new aie({});e.mount(window),e.setOptions({layoutScroll:!0}),HT.current=e}return HT.current},resetTransform:(e,n)=>{e.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),lie={pan:{Feature:Sne},drag:{Feature:wne,ProjectionNode:fN,MeasureLayout:sN}},cie=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function uie(e){const n=cie.exec(e);if(!n)return[,];const[,o,c]=n;return[o,c]}function kC(e,n,o=1){const[c,p]=uie(e);if(!c)return;const y=window.getComputedStyle(n).getPropertyValue(c);if(y){const w=y.trim();return Z6(w)?parseFloat(w):w}else return i1(p)?kC(p,n,o+1):p}function hie(e,{...n},o){const c=e.current;if(!(c instanceof Element))return{target:n,transitionEnd:o};o&&(o={...o}),e.values.forEach(p=>{const y=p.get();if(!i1(y))return;const w=kC(y,c);w&&p.set(w)});for(const p in n){const y=n[p];if(!i1(y))continue;const w=kC(y,c);w&&(n[p]=w,o||(o={}),o[p]===void 0&&(o[p]=y))}return{target:n,transitionEnd:o}}const die=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),pN=e=>die.has(e),fie=e=>Object.keys(e).some(pN),b5=e=>e===Rp||e===xr,w5=(e,n)=>parseFloat(e.split(", ")[n]),S5=(e,n)=>(o,{transform:c})=>{if(c==="none"||!c)return 0;const p=c.match(/^matrix3d\((.+)\)$/);if(p)return w5(p[1],n);{const y=c.match(/^matrix\((.+)\)$/);return y?w5(y[1],e):0}},pie=new Set(["x","y","z"]),mie=ty.filter(e=>!pie.has(e));function gie(e){const n=[];return mie.forEach(o=>{const c=e.getValue(o);c!==void 0&&(n.push([o,c.get()]),c.set(o.startsWith("scale")?1:0))}),n.length&&e.render(),n}const Sp={width:({x:e},{paddingLeft:n="0",paddingRight:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),height:({y:e},{paddingTop:n="0",paddingBottom:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),top:(e,{top:n})=>parseFloat(n),left:(e,{left:n})=>parseFloat(n),bottom:({y:e},{top:n})=>parseFloat(n)+(e.max-e.min),right:({x:e},{left:n})=>parseFloat(n)+(e.max-e.min),x:S5(4,13),y:S5(5,14)};Sp.translateX=Sp.x;Sp.translateY=Sp.y;const _ie=(e,n,o)=>{const c=n.measureViewportBox(),p=n.current,y=getComputedStyle(p),{display:w}=y,E={};w==="none"&&n.setStaticValue("display",e.display||"block"),o.forEach(P=>{E[P]=Sp[P](c,y)}),n.render();const a=n.measureViewportBox();return o.forEach(P=>{const D=n.getValue(P);D&&D.jump(E[P]),e[P]=Sp[P](a,y)}),e},yie=(e,n,o={},c={})=>{n={...n},c={...c};const p=Object.keys(n).filter(pN);let y=[],w=!1;const E=[];if(p.forEach(a=>{const P=e.getValue(a);if(!e.hasValue(a))return;let D=o[a],L=vg(D);const F=n[a];let $;if(s1(F)){const H=F.length,q=F[0]===null?1:0;D=F[q],L=vg(D);for(let le=q;le<H&&F[le]!==null;le++)$?IA(vg(F[le])===$):$=vg(F[le])}else $=vg(F);if(L!==$)if(b5(L)&&b5($)){const H=P.get();typeof H=="string"&&P.set(parseFloat(H)),typeof F=="string"?n[a]=parseFloat(F):Array.isArray(F)&&$===xr&&(n[a]=F.map(parseFloat))}else L!=null&&L.transform&&($!=null&&$.transform)&&(D===0||F===0)?D===0?P.set($.transform(D)):n[a]=L.transform(F):(w||(y=gie(e),w=!0),E.push(a),c[a]=c[a]!==void 0?c[a]:n[a],P.jump(F))}),E.length){const a=E.indexOf("height")>=0?window.pageYOffset:null,P=_ie(n,e,E);return y.length&&y.forEach(([D,L])=>{e.getValue(D).set(L)}),e.render(),mb&&a!==null&&window.scrollTo({top:a}),{target:P,transitionEnd:c}}else return{target:n,transitionEnd:c}};function vie(e,n,o,c){return fie(n)?yie(e,n,o,c):{target:n,transitionEnd:c}}const xie=(e,n,o,c)=>{const p=hie(e,n,c);return n=p.target,c=p.transitionEnd,vie(e,n,o,c)},PC={current:null},mN={current:!1};function bie(){if(mN.current=!0,!!mb)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),n=()=>PC.current=e.matches;e.addListener(n),n()}else PC.current=!1}function wie(e,n,o){const{willChange:c}=n;for(const p in n){const y=n[p],w=o[p];if(as(y))e.addValue(p,y),u1(c)&&c.add(p);else if(as(w))e.addValue(p,wp(y,{owner:e})),u1(c)&&c.remove(p);else if(w!==y)if(e.hasValue(p)){const E=e.getValue(p);!E.hasAnimated&&E.set(y)}else{const E=e.getStaticValue(p);e.addValue(p,wp(E!==void 0?E:y,{owner:e}))}}for(const p in o)n[p]===void 0&&e.removeValue(p);return n}const T5=new WeakMap,gN=Object.keys(O_),Sie=gN.length,E5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Tie=bA.length;class Eie{constructor({parent:n,props:o,presenceContext:c,reducedMotionConfig:p,visualState:y},w={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Kn.render(this.render,!1,!0);const{latestValues:E,renderState:a}=y;this.latestValues=E,this.baseTarget={...E},this.initialValues=o.initial?{...E}:{},this.renderState=a,this.parent=n,this.props=o,this.presenceContext=c,this.depth=n?n.depth+1:0,this.reducedMotionConfig=p,this.options=w,this.isControllingVariants=_b(o),this.isVariantNode=o6(o),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:P,...D}=this.scrapeMotionValuesFromProps(o,{});for(const L in D){const F=D[L];E[L]!==void 0&&as(F)&&(F.set(E[L],!1),u1(P)&&P.add(L))}}scrapeMotionValuesFromProps(n,o){return{}}mount(n){this.current=n,T5.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((o,c)=>this.bindToMotionValue(c,o)),mN.current||bie(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:PC.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){T5.delete(this.current),this.projection&&this.projection.unmount(),Ic(this.notifyUpdate),Ic(this.render),this.valueSubscriptions.forEach(n=>n()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features)this.features[n].unmount();this.current=null}bindToMotionValue(n,o){const c=gd.has(n),p=o.on("change",w=>{this.latestValues[n]=w,this.props.onUpdate&&Kn.update(this.notifyUpdate,!1,!0),c&&this.projection&&(this.projection.isTransformDirty=!0)}),y=o.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(n,()=>{p(),y()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}loadFeatures({children:n,...o},c,p,y){let w,E;for(let a=0;a<Sie;a++){const P=gN[a],{isEnabled:D,Feature:L,ProjectionNode:F,MeasureLayout:$}=O_[P];F&&(w=F),D(o)&&(!this.features[P]&&L&&(this.features[P]=new L(this)),$&&(E=$))}if((this.type==="html"||this.type==="svg")&&!this.projection&&w){this.projection=new w(this.latestValues,this.parent&&this.parent.projection);const{layoutId:a,layout:P,drag:D,dragConstraints:L,layoutScroll:F,layoutRoot:$}=o;this.projection.setOptions({layoutId:a,layout:P,alwaysMeasureLayout:!!D||L&&Gf(L),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof P=="string"?P:"both",initialPromotionConfig:y,layoutScroll:F,layoutRoot:$})}return E}updateFeatures(){for(const n in this.features){const o=this.features[n];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):yi()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,o){this.latestValues[n]=o}makeTargetAnimatable(n,o=!0){return this.makeTargetAnimatableFromInstance(n,o)}update(n,o){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=o;for(let c=0;c<E5.length;c++){const p=E5[c];this.propEventSubscriptions[p]&&(this.propEventSubscriptions[p](),delete this.propEventSubscriptions[p]);const y=n["on"+p];y&&(this.propEventSubscriptions[p]=this.on(p,y))}this.prevMotionValues=wie(this,this.scrapeMotionValuesFromProps(n,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(n=!1){if(n)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const c=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(c.initial=this.props.initial),c}const o={};for(let c=0;c<Tie;c++){const p=bA[c],y=this.props[p];(L_(y)||y===!1)&&(o[p]=y)}return o}addVariantChild(n){const o=this.getClosestVariantNode();if(o)return o.variantChildren&&o.variantChildren.add(n),()=>o.variantChildren.delete(n)}addValue(n,o){o!==this.values.get(n)&&(this.removeValue(n),this.bindToMotionValue(n,o)),this.values.set(n,o),this.latestValues[n]=o.get()}removeValue(n){this.values.delete(n);const o=this.valueSubscriptions.get(n);o&&(o(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,o){if(this.props.values&&this.props.values[n])return this.props.values[n];let c=this.values.get(n);return c===void 0&&o!==void 0&&(c=wp(o,{owner:this}),this.addValue(n,c)),c}readValue(n){var o;return this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:(o=this.getBaseTargetFromProps(this.props,n))!==null&&o!==void 0?o:this.readValueFromInstance(this.current,n,this.options)}setBaseTarget(n,o){this.baseTarget[n]=o}getBaseTarget(n){var o;const{initial:c}=this.props,p=typeof c=="string"||typeof c=="object"?(o=PA(this.props,c))===null||o===void 0?void 0:o[n]:void 0;if(c&&p!==void 0)return p;const y=this.getBaseTargetFromProps(this.props,n);return y!==void 0&&!as(y)?y:this.initialValues[n]!==void 0&&p===void 0?void 0:this.baseTarget[n]}on(n,o){return this.events[n]||(this.events[n]=new VA),this.events[n].add(o)}notify(n,...o){this.events[n]&&this.events[n].notify(...o)}}class _N extends Eie{sortInstanceNodePosition(n,o){return n.compareDocumentPosition(o)&2?1:-1}getBaseTargetFromProps(n,o){return n.style?n.style[o]:void 0}removeValueFromRenderState(n,{vars:o,style:c}){delete o[n],delete c[n]}makeTargetAnimatableFromInstance({transition:n,transitionEnd:o,...c},p){const y=Vre(c,n||{},this);if(p){Nre(this,c,y);const w=xie(this,c,y,o);o=w.transitionEnd,c=w.target}return{transition:n,transitionEnd:o,...c}}}function Cie(e){return window.getComputedStyle(e)}class Mie extends _N{constructor(){super(...arguments),this.type="html"}readValueFromInstance(n,o){if(gd.has(o)){const c=OA(o);return c&&c.default||0}else{const c=Cie(n),p=(c6(o)?c.getPropertyValue(o):c[o])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(n,{transformPagePoint:o}){return nN(n,o)}build(n,o,c,p){EA(n,o,c,p.transformTemplate)}scrapeMotionValuesFromProps(n,o){return kA(n,o)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;as(n)&&(this.childSubscription=n.on("change",o=>{this.current&&(this.current.textContent=`${o}`)}))}renderInstance(n,o,c,p){p6(n,o,c,p)}}class Aie extends _N{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(n,o){return n[o]}readValueFromInstance(n,o){if(gd.has(o)){const c=OA(o);return c&&c.default||0}return o=m6.has(o)?o:yA(o),n.getAttribute(o)}measureInstanceViewportBox(){return yi()}scrapeMotionValuesFromProps(n,o){return _6(n,o)}build(n,o,c,p){MA(n,o,c,this.isSVGTag,p.transformTemplate)}renderInstance(n,o,c,p){g6(n,o,c,p)}mount(n){this.isSVGTag=AA(n.tagName),super.mount(n)}}const kie=(e,n)=>SA(e)?new Aie(n,{enableHardwareAcceleration:!1}):new Mie(n,{enableHardwareAcceleration:!0}),Pie={layout:{ProjectionNode:fN,MeasureLayout:sN}},Iie={...rne,...gte,...lie,...Pie},_d=Cee((e,n)=>nte(e,n,Iie,kie));function yN(){const e=re.useRef(!1);return _A(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function zie(){const e=yN(),[n,o]=re.useState(0),c=re.useCallback(()=>{e.current&&o(n+1)},[n]);return[re.useCallback(()=>Kn.postRender(c),[c]),n]}class Rie extends re.Component{getSnapshotBeforeUpdate(n){const o=this.props.childRef.current;if(o&&n.isPresent&&!this.props.isPresent){const c=this.props.sizeRef.current;c.height=o.offsetHeight||0,c.width=o.offsetWidth||0,c.top=o.offsetTop,c.left=o.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Die({children:e,isPresent:n}){const o=re.useId(),c=re.useRef(null),p=re.useRef({width:0,height:0,top:0,left:0});return re.useInsertionEffect(()=>{const{width:y,height:w,top:E,left:a}=p.current;if(n||!c.current||!y||!w)return;c.current.dataset.motionPopId=o;const P=document.createElement("style");return document.head.appendChild(P),P.sheet&&P.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${y}px !important;
            height: ${w}px !important;
            top: ${E}px !important;
            left: ${a}px !important;
          }
        `),()=>{document.head.removeChild(P)}},[n]),re.createElement(Rie,{isPresent:n,childRef:c,sizeRef:p},re.cloneElement(e,{ref:c}))}const ZT=({children:e,initial:n,isPresent:o,onExitComplete:c,custom:p,presenceAffectsLayout:y,mode:w})=>{const E=y6(Lie),a=re.useId(),P=re.useMemo(()=>({id:a,initial:n,isPresent:o,custom:p,onExitComplete:D=>{E.set(D,!0);for(const L of E.values())if(!L)return;c&&c()},register:D=>(E.set(D,!1),()=>E.delete(D))}),y?void 0:[o]);return re.useMemo(()=>{E.forEach((D,L)=>E.set(L,!1))},[o]),re.useEffect(()=>{!o&&!E.size&&c&&c()},[o]),w==="popLayout"&&(e=re.createElement(Die,{isPresent:o},e)),re.createElement(ey.Provider,{value:P},e)};function Lie(){return new Map}function Oie(e){return re.useEffect(()=>()=>e(),[])}const Dh=e=>e.key||"";function Bie(e,n){e.forEach(o=>{const c=Dh(o);n.set(c,o)})}function Fie(e){const n=[];return re.Children.forEach(e,o=>{re.isValidElement(o)&&n.push(o)}),n}const Dp=({children:e,custom:n,initial:o=!0,onExitComplete:c,exitBeforeEnter:p,presenceAffectsLayout:y=!0,mode:w="sync"})=>{const E=re.useContext(wA).forceRender||zie()[0],a=yN(),P=Fie(e);let D=P;const L=re.useRef(new Map).current,F=re.useRef(D),$=re.useRef(new Map).current,H=re.useRef(!0);if(_A(()=>{H.current=!1,Bie(P,$),F.current=D}),Oie(()=>{H.current=!0,$.clear(),L.clear()}),H.current)return re.createElement(re.Fragment,null,D.map(te=>re.createElement(ZT,{key:Dh(te),isPresent:!0,initial:o?void 0:!1,presenceAffectsLayout:y,mode:w},te)));D=[...D];const q=F.current.map(Dh),le=P.map(Dh),ie=q.length;for(let te=0;te<ie;te++){const se=q[te];le.indexOf(se)===-1&&!L.has(se)&&L.set(se,void 0)}return w==="wait"&&L.size&&(D=[]),L.forEach((te,se)=>{if(le.indexOf(se)!==-1)return;const be=$.get(se);if(!be)return;const Ee=q.indexOf(se);let je=te;if(!je){const Be=()=>{L.delete(se);const Ze=Array.from($.keys()).filter(ht=>!le.includes(ht));if(Ze.forEach(ht=>$.delete(ht)),F.current=P.filter(ht=>{const Pe=Dh(ht);return Pe===se||Ze.includes(Pe)}),!L.size){if(a.current===!1)return;E(),c&&c()}};je=re.createElement(ZT,{key:Dh(be),isPresent:!1,onExitComplete:Be,custom:n,presenceAffectsLayout:y,mode:w},be),L.set(se,je)}D.splice(Ee,0,je)}),D=D.map(te=>{const se=te.key;return L.has(se)?te:re.createElement(ZT,{key:Dh(te),isPresent:!0,presenceAffectsLayout:y,mode:w},te)}),re.createElement(re.Fragment,null,L.size?D:D.map(te=>re.cloneElement(te)))};var Nie={initial:e=>{const{position:n}=e,o=["top","bottom"].includes(n)?"y":"x";let c=["top-right","bottom-right"].includes(n)?1:-1;return n==="bottom"&&(c=1),{opacity:0,[o]:c*24}},animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.85,transition:{duration:.2,ease:[.4,0,1,1]}}},vN=re.memo(e=>{const{id:n,message:o,onCloseComplete:c,onRequestRemove:p,requestClose:y=!1,position:w="bottom",duration:E=5e3,containerStyle:a,motionVariants:P=Nie,toastSpacing:D="0.5rem"}=e,[L,F]=re.useState(E),$=Tne();vD(()=>{$||c==null||c()},[$]),vD(()=>{F(E)},[E]);const H=()=>F(null),q=()=>F(E),le=()=>{$&&p()};re.useEffect(()=>{$&&y&&p()},[$,y,p]),pee(le,L);const ie=re.useMemo(()=>({pointerEvents:"auto",maxWidth:560,minWidth:300,margin:D,...a}),[a,D]),te=re.useMemo(()=>dee(w),[w]);return Q.jsx(_d.div,{layout:!0,className:"chakra-toast",variants:P,initial:"initial",animate:"animate",exit:"exit",onHoverStart:H,onHoverEnd:q,custom:{position:w},style:te,children:Q.jsx(br.div,{role:"status","aria-atomic":"true",className:"chakra-toast__inner",__css:ie,children:Eu(o,{id:n,onClose:le})})})});vN.displayName="ToastComponent";var C5={path:Q.jsxs("g",{stroke:"currentColor",strokeWidth:"1.5",children:[Q.jsx("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),Q.jsx("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),Q.jsx("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},zc=$r((e,n)=>{const{as:o,viewBox:c,color:p="currentColor",focusable:y=!1,children:w,className:E,__css:a,...P}=e,D=Kr("chakra-icon",E),L=md("Icon",e),F={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:p,...a,...L},$={ref:n,focusable:y,className:D,__css:F},H=c??C5.viewBox;if(o&&typeof o!="string")return Q.jsx(br.svg,{as:o,...$,...P});const q=w??C5.path;return Q.jsx(br.svg,{verticalAlign:"middle",viewBox:H,...$,...P,children:q})});zc.displayName="Icon";function jie(e){const{viewBox:n="0 0 24 24",d:o,displayName:c,defaultProps:p={}}=e,y=re.Children.toArray(e.path),w=$r((E,a)=>Q.jsx(zc,{ref:a,viewBox:n,...p,...E,children:y.length?y:Q.jsx("path",{fill:"currentColor",d:o})}));return w.displayName=c,w}function Vie(e){return Q.jsx(zc,{viewBox:"0 0 24 24",...e,children:Q.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})})}function $ie(e){return Q.jsx(zc,{viewBox:"0 0 24 24",...e,children:Q.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})})}function M5(e){return Q.jsx(zc,{viewBox:"0 0 24 24",...e,children:Q.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})}var Uie=Pq({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),$A=$r((e,n)=>{const o=md("Spinner",e),{label:c="Loading...",thickness:p="2px",speed:y="0.45s",emptyColor:w="transparent",className:E,...a}=ls(e),P=Kr("chakra-spinner",E),D={display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:p,borderBottomColor:w,borderLeftColor:w,animation:`${Uie} ${y} linear infinite`,...o};return Q.jsx(br.div,{ref:n,__css:D,className:P,...a,children:c&&Q.jsx(br.span,{srOnly:!0,children:c})})});$A.displayName="Spinner";var[Gie,UA]=co({name:"AlertContext",hookName:"useAlertContext",providerName:"<Alert />"}),[Wie,GA]=co({name:"AlertStylesContext",hookName:"useAlertStyles",providerName:"<Alert />"}),xN={info:{icon:$ie,colorScheme:"blue"},warning:{icon:M5,colorScheme:"orange"},success:{icon:Vie,colorScheme:"green"},error:{icon:M5,colorScheme:"red"},loading:{icon:$A,colorScheme:"blue"}};function qie(e){return xN[e].colorScheme}function Hie(e){return xN[e].icon}var bN=$r(function(n,o){const c=GA(),{status:p}=UA(),y={display:"inline",...c.description};return Q.jsx(br.div,{ref:o,"data-status":p,...n,className:Kr("chakra-alert__desc",n.className),__css:y})});bN.displayName="AlertDescription";function wN(e){const{status:n}=UA(),o=Hie(n),c=GA(),p=n==="loading"?c.spinner:c.icon;return Q.jsx(br.span,{display:"inherit","data-status":n,...e,className:Kr("chakra-alert__icon",e.className),__css:p,children:e.children||Q.jsx(o,{h:"100%",w:"100%"})})}wN.displayName="AlertIcon";var SN=$r(function(n,o){const c=GA(),{status:p}=UA();return Q.jsx(br.div,{ref:o,"data-status":p,...n,className:Kr("chakra-alert__title",n.className),__css:c.title})});SN.displayName="AlertTitle";var TN=$r(function(n,o){var c;const{status:p="info",addRole:y=!0,...w}=ls(n),E=(c=n.colorScheme)!=null?c:qie(p),a=Lc("Alert",{...n,colorScheme:E}),P={width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...a.container};return Q.jsx(Gie,{value:{status:p},children:Q.jsx(Wie,{value:a,children:Q.jsx(br.div,{"data-status":p,role:y?"alert":void 0,ref:o,...w,className:Kr("chakra-alert",n.className),__css:P})})})});TN.displayName="Alert";function Zie(e){return Q.jsx(zc,{focusable:"false","aria-hidden":!0,...e,children:Q.jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})})}var WA=$r(function(n,o){const c=md("CloseButton",n),{children:p,isDisabled:y,__css:w,...E}=ls(n),a={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return Q.jsx(br.button,{type:"button","aria-label":"Close",ref:o,disabled:y,__css:{...a,...c,...w},...E,children:p||Q.jsx(Zie,{width:"1em",height:"1em"})})});WA.displayName="CloseButton";var Xie={top:[],"top-left":[],"top-right":[],"bottom-left":[],bottom:[],"bottom-right":[]},s_=Yie(Xie);function Yie(e){let n=e;const o=new Set,c=p=>{n=p(n),o.forEach(y=>y())};return{getState:()=>n,subscribe:p=>(o.add(p),()=>{c(()=>e),o.delete(p)}),removeToast:(p,y)=>{c(w=>({...w,[y]:w[y].filter(E=>E.id!=p)}))},notify:(p,y)=>{const w=Kie(p,y),{position:E,id:a}=w;return c(P=>{var D,L;const $=E.includes("top")?[w,...(D=P[E])!=null?D:[]]:[...(L=P[E])!=null?L:[],w];return{...P,[E]:$}}),a},update:(p,y)=>{p&&c(w=>{const E={...w},{position:a,index:P}=yD(E,p);return a&&P!==-1&&(E[a][P]={...E[a][P],...y,message:Qie(y)}),E})},closeAll:({positions:p}={})=>{c(y=>(p??["bottom","bottom-right","bottom-left","top","top-left","top-right"]).reduce((a,P)=>(a[P]=y[P].map(D=>({...D,requestClose:!0})),a),{...y}))},close:p=>{c(y=>{const w=QF(y,p);return w?{...y,[w]:y[w].map(E=>E.id==p?{...E,requestClose:!0}:E)}:y})},isActive:p=>!!yD(s_.getState(),p).position}}var A5=0;function Kie(e,n={}){var o,c;A5+=1;const p=(o=n.id)!=null?o:A5,y=(c=n.position)!=null?c:"bottom";return{id:p,message:e,position:y,duration:n.duration,onCloseComplete:n.onCloseComplete,onRequestRemove:()=>s_.removeToast(String(p),y),status:n.status,requestClose:!1,containerStyle:n.containerStyle}}var Jie=e=>{const{status:n,variant:o="solid",id:c,title:p,isClosable:y,onClose:w,description:E,colorScheme:a,icon:P}=e,D=c?{root:`toast-${c}`,title:`toast-${c}-title`,description:`toast-${c}-description`}:void 0;return Q.jsxs(TN,{addRole:!1,status:n,variant:o,id:D==null?void 0:D.root,alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",colorScheme:a,children:[Q.jsx(wN,{children:P}),Q.jsxs(br.div,{flex:"1",maxWidth:"100%",children:[p&&Q.jsx(SN,{id:D==null?void 0:D.title,children:p}),E&&Q.jsx(bN,{id:D==null?void 0:D.description,display:"block",children:E})]}),y&&Q.jsx(WA,{size:"sm",onClick:w,position:"absolute",insetEnd:1,top:1})]})};function Qie(e={}){const{render:n,toastComponent:o=Jie}=e;return p=>typeof n=="function"?n({...p,...e}):Q.jsx(o,{...p,...e})}var[eoe,kpe]=co({name:"ToastOptionsContext",strict:!1}),toe=e=>{const n=re.useSyncExternalStore(s_.subscribe,s_.getState,s_.getState),{motionVariants:o,component:c=vN,portalProps:p}=e,w=Object.keys(n).map(E=>{const a=n[E];return Q.jsx("div",{role:"region","aria-live":"polite","aria-label":`Notifications-${E}`,id:`chakra-toast-manager-${E}`,style:fee(E),children:Q.jsx(Dp,{initial:!1,children:a.map(P=>Q.jsx(c,{motionVariants:o,...P},P.id))})},E)});return Q.jsx(K_,{...p,children:w})},roe=e=>function({children:o,theme:c=e,toastOptions:p,...y}){return Q.jsxs(uee,{theme:c,...y,children:[Q.jsx(eoe,{value:p==null?void 0:p.defaultOptions,children:o}),Q.jsx(toe,{...p})]})},noe=roe(z2),ioe=Object.defineProperty,ooe=(e,n,o)=>n in e?ioe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,ci=(e,n,o)=>(ooe(e,typeof n!="symbol"?n+"":n,o),o);function k5(e){return e.sort((n,o)=>{const c=n.compareDocumentPosition(o);if(c&Node.DOCUMENT_POSITION_FOLLOWING||c&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(c&Node.DOCUMENT_POSITION_PRECEDING||c&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(c&Node.DOCUMENT_POSITION_DISCONNECTED||c&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var soe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function P5(e,n,o){let c=e+1;return o&&c>=n&&(c=0),c}function I5(e,n,o){let c=e-1;return o&&c<0&&(c=n),c}var IC=typeof window<"u"?re.useLayoutEffect:re.useEffect,d1=e=>e,aoe=class{constructor(){ci(this,"descendants",new Map),ci(this,"register",e=>{if(e!=null)return soe(e)?this.registerNode(e):n=>{this.registerNode(n,e)}}),ci(this,"unregister",e=>{this.descendants.delete(e);const n=k5(Array.from(this.descendants.keys()));this.assignIndex(n)}),ci(this,"destroy",()=>{this.descendants.clear()}),ci(this,"assignIndex",e=>{this.descendants.forEach(n=>{const o=e.indexOf(n.node);n.index=o,n.node.dataset.index=n.index.toString()})}),ci(this,"count",()=>this.descendants.size),ci(this,"enabledCount",()=>this.enabledValues().length),ci(this,"values",()=>Array.from(this.descendants.values()).sort((n,o)=>n.index-o.index)),ci(this,"enabledValues",()=>this.values().filter(e=>!e.disabled)),ci(this,"item",e=>{if(this.count()!==0)return this.values()[e]}),ci(this,"enabledItem",e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]}),ci(this,"first",()=>this.item(0)),ci(this,"firstEnabled",()=>this.enabledItem(0)),ci(this,"last",()=>this.item(this.descendants.size-1)),ci(this,"lastEnabled",()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)}),ci(this,"indexOf",e=>{var n,o;return e&&(o=(n=this.descendants.get(e))==null?void 0:n.index)!=null?o:-1}),ci(this,"enabledIndexOf",e=>e==null?-1:this.enabledValues().findIndex(n=>n.node.isSameNode(e))),ci(this,"next",(e,n=!0)=>{const o=P5(e,this.count(),n);return this.item(o)}),ci(this,"nextEnabled",(e,n=!0)=>{const o=this.item(e);if(!o)return;const c=this.enabledIndexOf(o.node),p=P5(c,this.enabledCount(),n);return this.enabledItem(p)}),ci(this,"prev",(e,n=!0)=>{const o=I5(e,this.count()-1,n);return this.item(o)}),ci(this,"prevEnabled",(e,n=!0)=>{const o=this.item(e);if(!o)return;const c=this.enabledIndexOf(o.node),p=I5(c,this.enabledCount()-1,n);return this.enabledItem(p)}),ci(this,"registerNode",(e,n)=>{if(!e||this.descendants.has(e))return;const o=Array.from(this.descendants.keys()).concat(e),c=k5(o);n!=null&&n.disabled&&(n.disabled=!!n.disabled);const p={node:e,index:-1,...n};this.descendants.set(e,p),this.assignIndex(c)})}};function loe(e,n){if(e!=null){if(typeof e=="function"){e(n);return}try{e.current=n}catch{throw new Error(`Cannot assign value '${n}' to ref '${e}'`)}}}function Nu(...e){return n=>{e.forEach(o=>{loe(o,n)})}}function coe(...e){return re.useMemo(()=>Nu(...e),e)}function uoe(){const e=re.useRef(new aoe);return IC(()=>()=>e.current.destroy()),e.current}var[hoe,EN]=co({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function doe(e){const n=EN(),[o,c]=re.useState(-1),p=re.useRef(null);IC(()=>()=>{p.current&&n.unregister(p.current)},[]),IC(()=>{if(!p.current)return;const w=Number(p.current.dataset.index);o!=w&&!Number.isNaN(w)&&c(w)});const y=d1(e?n.register(e):n.register);return{descendants:n,index:o,enabledIndex:n.enabledIndexOf(p.current),register:Nu(y,p)}}function foe(){return[d1(hoe),()=>d1(EN()),()=>uoe(),p=>doe(p)]}var[poe,xb]=co({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[moe,qA]=co({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[goe,Ppe,_oe,yoe]=foe(),ta=$r(function(n,o){const{getButtonProps:c}=qA(),p=c(n,o),w={display:"flex",alignItems:"center",width:"100%",outline:0,...xb().button};return Q.jsx(br.button,{...p,className:Kr("chakra-accordion__button",n.className),__css:w})});ta.displayName="AccordionButton";function voe(e){const{value:n,defaultValue:o,onChange:c,shouldUpdate:p=(F,$)=>F!==$}=e,y=fx(c),w=fx(p),[E,a]=re.useState(o),P=n!==void 0,D=P?n:E,L=fx(F=>{const H=typeof F=="function"?F(D):F;w(D,H)&&(P||a(H),y(H))},[P,y,D,w]);return[D,L]}function xoe(e){const{onChange:n,defaultIndex:o,index:c,allowMultiple:p,allowToggle:y,...w}=e;Soe(e),Toe(e);const E=_oe(),[a,P]=re.useState(-1);re.useEffect(()=>()=>{P(-1)},[]);const[D,L]=voe({value:c,defaultValue(){return p?o??[]:o??-1},onChange:n});return{index:D,setIndex:L,htmlProps:w,getAccordionItemProps:$=>{let H=!1;return $!==null&&(H=Array.isArray(D)?D.includes($):D===$),{isOpen:H,onChange:le=>{if($!==null)if(p&&Array.isArray(D)){const ie=le?D.concat($):D.filter(te=>te!==$);L(ie)}else le?L($):y&&L(-1)}}},focusedIndex:a,setFocusedIndex:P,descendants:E}}var[boe,HA]=co({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function woe(e){const{isDisabled:n,isFocusable:o,id:c,...p}=e,{getAccordionItemProps:y,setFocusedIndex:w}=HA(),E=re.useRef(null),a=re.useId(),P=c??a,D=`accordion-button-${P}`,L=`accordion-panel-${P}`;Eoe(e);const{register:F,index:$,descendants:H}=yoe({disabled:n&&!o}),{isOpen:q,onChange:le}=y($===-1?null:$);Coe({isOpen:q,isDisabled:n});const ie=()=>{le==null||le(!0)},te=()=>{le==null||le(!1)},se=re.useCallback(()=>{le==null||le(!q),w($)},[$,w,q,le]),be=re.useCallback(Ze=>{const Pe={ArrowDown:()=>{const Et=H.nextEnabled($);Et==null||Et.node.focus()},ArrowUp:()=>{const Et=H.prevEnabled($);Et==null||Et.node.focus()},Home:()=>{const Et=H.firstEnabled();Et==null||Et.node.focus()},End:()=>{const Et=H.lastEnabled();Et==null||Et.node.focus()}}[Ze.key];Pe&&(Ze.preventDefault(),Pe(Ze))},[H,$]),Ee=re.useCallback(()=>{w($)},[w,$]),je=re.useCallback(function(ht={},Pe=null){return{...ht,type:"button",ref:Nu(F,E,Pe),id:D,disabled:!!n,"aria-expanded":!!q,"aria-controls":L,onClick:vi(ht.onClick,se),onFocus:vi(ht.onFocus,Ee),onKeyDown:vi(ht.onKeyDown,be)}},[D,n,q,se,Ee,be,L,F]),Be=re.useCallback(function(ht={},Pe=null){return{...ht,ref:Pe,role:"region",id:L,"aria-labelledby":D,hidden:!q}},[D,q,L]);return{isOpen:q,isDisabled:n,isFocusable:o,onOpen:ie,onClose:te,getButtonProps:je,getPanelProps:Be,htmlProps:p}}function Soe(e){const n=e.index||e.defaultIndex,o=n!=null&&!Array.isArray(n)&&e.allowMultiple;J_({condition:!!o,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof n},`})}function Toe(e){J_({condition:!!(e.allowMultiple&&e.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"})}function Eoe(e){J_({condition:!!(e.isFocusable&&!e.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `})}function Coe(e){J_({condition:e.isOpen&&!!e.isDisabled,message:"Cannot open a disabled accordion item"})}function ra(e){const{isOpen:n,isDisabled:o}=qA(),{reduceMotion:c}=HA(),p=Kr("chakra-accordion__icon",e.className),y=xb(),w={opacity:o?.4:1,transform:n?"rotate(-180deg)":void 0,transition:c?void 0:"transform 0.2s",transformOrigin:"center",...y.icon};return Q.jsx(zc,{viewBox:"0 0 24 24","aria-hidden":!0,className:p,__css:w,...e,children:Q.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}ra.displayName="AccordionIcon";var na=$r(function(n,o){const{children:c,className:p}=n,{htmlProps:y,...w}=woe(n),a={...xb().container,overflowAnchor:"none"},P=re.useMemo(()=>w,[w]);return Q.jsx(moe,{value:P,children:Q.jsx(br.div,{ref:o,...y,className:Kr("chakra-accordion__item",p),__css:a,children:typeof c=="function"?c({isExpanded:!!w.isOpen,isDisabled:!!w.isDisabled}):c})})});na.displayName="AccordionItem";var Zf={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},Kh={enter:{duration:.2,ease:Zf.easeOut},exit:{duration:.1,ease:Zf.easeIn}},Ec={enter:(e,n)=>({...e,delay:typeof n=="number"?n:n==null?void 0:n.enter}),exit:(e,n)=>({...e,delay:typeof n=="number"?n:n==null?void 0:n.exit})},Moe=e=>e!=null&&parseInt(e.toString(),10)>0,z5={exit:{height:{duration:.2,ease:Zf.ease},opacity:{duration:.3,ease:Zf.ease}},enter:{height:{duration:.3,ease:Zf.ease},opacity:{duration:.4,ease:Zf.ease}}},Aoe={exit:({animateOpacity:e,startingHeight:n,transition:o,transitionEnd:c,delay:p})=>{var y;return{...e&&{opacity:Moe(n)?1:0},height:n,transitionEnd:c==null?void 0:c.exit,transition:(y=o==null?void 0:o.exit)!=null?y:Ec.exit(z5.exit,p)}},enter:({animateOpacity:e,endingHeight:n,transition:o,transitionEnd:c,delay:p})=>{var y;return{...e&&{opacity:1},height:n,transitionEnd:c==null?void 0:c.enter,transition:(y=o==null?void 0:o.enter)!=null?y:Ec.enter(z5.enter,p)}}},CN=re.forwardRef((e,n)=>{const{in:o,unmountOnExit:c,animateOpacity:p=!0,startingHeight:y=0,endingHeight:w="auto",style:E,className:a,transition:P,transitionEnd:D,...L}=e,[F,$]=re.useState(!1);re.useEffect(()=>{const te=setTimeout(()=>{$(!0)});return()=>clearTimeout(te)},[]),J_({condition:Number(y)>0&&!!c,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const H=parseFloat(y.toString())>0,q={startingHeight:y,endingHeight:w,animateOpacity:p,transition:F?P:{enter:{duration:0}},transitionEnd:{enter:D==null?void 0:D.enter,exit:c?D==null?void 0:D.exit:{...D==null?void 0:D.exit,display:H?"block":"none"}}},le=c?o:!0,ie=o||c?"enter":"exit";return Q.jsx(Dp,{initial:!1,custom:q,children:le&&Q.jsx(_d.div,{ref:n,...L,className:Kr("chakra-collapse",a),style:{overflow:"hidden",display:"block",...E},custom:q,variants:Aoe,initial:c?"exit":!1,animate:ie,exit:"exit"})})});CN.displayName="Collapse";var koe={enter:({transition:e,transitionEnd:n,delay:o}={})=>{var c;return{opacity:1,transition:(c=e==null?void 0:e.enter)!=null?c:Ec.enter(Kh.enter,o),transitionEnd:n==null?void 0:n.enter}},exit:({transition:e,transitionEnd:n,delay:o}={})=>{var c;return{opacity:0,transition:(c=e==null?void 0:e.exit)!=null?c:Ec.exit(Kh.exit,o),transitionEnd:n==null?void 0:n.exit}}},MN={initial:"exit",animate:"enter",exit:"exit",variants:koe},Poe=re.forwardRef(function(n,o){const{unmountOnExit:c,in:p,className:y,transition:w,transitionEnd:E,delay:a,...P}=n,D=p||c?"enter":"exit",L=c?p&&c:!0,F={transition:w,transitionEnd:E,delay:a};return Q.jsx(Dp,{custom:F,children:L&&Q.jsx(_d.div,{ref:o,className:Kr("chakra-fade",y),custom:F,...MN,animate:D,...P})})});Poe.displayName="Fade";var Ioe={exit:({reverse:e,initialScale:n,transition:o,transitionEnd:c,delay:p})=>{var y;return{opacity:0,...e?{scale:n,transitionEnd:c==null?void 0:c.exit}:{transitionEnd:{scale:n,...c==null?void 0:c.exit}},transition:(y=o==null?void 0:o.exit)!=null?y:Ec.exit(Kh.exit,p)}},enter:({transitionEnd:e,transition:n,delay:o})=>{var c;return{opacity:1,scale:1,transition:(c=n==null?void 0:n.enter)!=null?c:Ec.enter(Kh.enter,o),transitionEnd:e==null?void 0:e.enter}}},AN={initial:"exit",animate:"enter",exit:"exit",variants:Ioe},zoe=re.forwardRef(function(n,o){const{unmountOnExit:c,in:p,reverse:y=!0,initialScale:w=.95,className:E,transition:a,transitionEnd:P,delay:D,...L}=n,F=c?p&&c:!0,$=p||c?"enter":"exit",H={initialScale:w,reverse:y,transition:a,transitionEnd:P,delay:D};return Q.jsx(Dp,{custom:H,children:F&&Q.jsx(_d.div,{ref:o,className:Kr("chakra-offset-slide",E),...AN,animate:$,custom:H,...L})})});zoe.displayName="ScaleFade";var Roe={initial:({offsetX:e,offsetY:n,transition:o,transitionEnd:c,delay:p})=>{var y;return{opacity:0,x:e,y:n,transition:(y=o==null?void 0:o.exit)!=null?y:Ec.exit(Kh.exit,p),transitionEnd:c==null?void 0:c.exit}},enter:({transition:e,transitionEnd:n,delay:o})=>{var c;return{opacity:1,x:0,y:0,transition:(c=e==null?void 0:e.enter)!=null?c:Ec.enter(Kh.enter,o),transitionEnd:n==null?void 0:n.enter}},exit:({offsetY:e,offsetX:n,transition:o,transitionEnd:c,reverse:p,delay:y})=>{var w;const E={x:n,y:e};return{opacity:0,transition:(w=o==null?void 0:o.exit)!=null?w:Ec.exit(Kh.exit,y),...p?{...E,transitionEnd:c==null?void 0:c.exit}:{transitionEnd:{...E,...c==null?void 0:c.exit}}}}},Dg={initial:"initial",animate:"enter",exit:"exit",variants:Roe},Doe=re.forwardRef(function(n,o){const{unmountOnExit:c,in:p,reverse:y=!0,className:w,offsetX:E=0,offsetY:a=8,transition:P,transitionEnd:D,delay:L,...F}=n,$=c?p&&c:!0,H=p||c?"enter":"exit",q={offsetX:E,offsetY:a,reverse:y,transition:P,transitionEnd:D,delay:L};return Q.jsx(Dp,{custom:q,children:$&&Q.jsx(_d.div,{ref:o,className:Kr("chakra-offset-slide",w),custom:q,...Dg,animate:H,...F})})});Doe.displayName="SlideFade";var ia=$r(function(n,o){const{className:c,motionProps:p,...y}=n,{reduceMotion:w}=HA(),{getPanelProps:E,isOpen:a}=qA(),P=E(y,o),D=Kr("chakra-accordion__panel",c),L=xb();w||delete P.hidden;const F=Q.jsx(br.div,{...P,__css:L.panel,className:D});return w?F:Q.jsx(CN,{in:a,...p,children:F})});ia.displayName="AccordionPanel";var bb=$r(function({children:n,reduceMotion:o,...c},p){const y=Lc("Accordion",c),w=ls(c),{htmlProps:E,descendants:a,...P}=xoe(w),D=re.useMemo(()=>({...P,reduceMotion:!!o}),[P,o]);return Q.jsx(goe,{value:a,children:Q.jsx(boe,{value:D,children:Q.jsx(poe,{value:y,children:Q.jsx(br.div,{ref:p,...E,className:Kr("chakra-accordion",c.className),__css:y.root,children:n})})})})});bb.displayName="Accordion";var[Loe,Ooe]=co({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"});function Boe(e){var n;const o=e.split(" "),c=(n=o[0])!=null?n:"",p=o.length>1?o[o.length-1]:"";return c&&p?`${c.charAt(0)}${p.charAt(0)}`:c.charAt(0)}function kN(e){const{name:n,getInitials:o,...c}=e,p=Ooe();return Q.jsx(br.div,{role:"img","aria-label":n,...c,__css:p.label,children:n?o==null?void 0:o(n):null})}kN.displayName="AvatarName";var PN=e=>Q.jsxs(br.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",...e,children:[Q.jsx("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),Q.jsx("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]}),zC=$r(function(n,o){const{htmlWidth:c,htmlHeight:p,alt:y,...w}=n;return Q.jsx("img",{width:c,height:p,ref:o,alt:y,...w})});zC.displayName="NativeImage";function IN(e){const{loading:n,src:o,srcSet:c,onLoad:p,onError:y,crossOrigin:w,sizes:E,ignoreFallback:a}=e,[P,D]=re.useState("pending");re.useEffect(()=>{D(o?"loading":"pending")},[o]);const L=re.useRef(),F=re.useCallback(()=>{if(!o)return;$();const H=new Image;H.src=o,w&&(H.crossOrigin=w),c&&(H.srcset=c),E&&(H.sizes=E),n&&(H.loading=n),H.onload=q=>{$(),D("loaded"),p==null||p(q)},H.onerror=q=>{$(),D("failed"),y==null||y(q)},L.current=H},[o,w,c,E,p,y,n]),$=()=>{L.current&&(L.current.onload=null,L.current.onerror=null,L.current=null)};return P_(()=>{if(!a)return P==="loading"&&F(),()=>{$()}},[P,F,a]),a?"loaded":P}var Foe=(e,n)=>e!=="loaded"&&n==="beforeLoadOrError"||e==="failed"&&n==="onError";function Noe(e,n=[]){const o=Object.assign({},e);for(const c of n)c in o&&delete o[c];return o}var _x=$r(function(n,o){const{fallbackSrc:c,fallback:p,src:y,srcSet:w,align:E,fit:a,loading:P,ignoreFallback:D,crossOrigin:L,fallbackStrategy:F="beforeLoadOrError",referrerPolicy:$,...H}=n,q=c!==void 0||p!==void 0,le=P!=null||D||!q,ie=IN({...n,crossOrigin:L,ignoreFallback:le}),te=Foe(ie,F),se={ref:o,objectFit:a,objectPosition:E,...le?H:Noe(H,["onError","onLoad"])};return te?p||Q.jsx(br.img,{as:zC,className:"chakra-image__placeholder",src:c,...se}):Q.jsx(br.img,{as:zC,src:y,srcSet:w,crossOrigin:L,loading:P,referrerPolicy:$,className:"chakra-image",...se})});_x.displayName="Image";function zN(e){const{src:n,srcSet:o,onError:c,onLoad:p,getInitials:y,name:w,borderRadius:E,loading:a,iconLabel:P,icon:D=Q.jsx(PN,{}),ignoreFallback:L,referrerPolicy:F,crossOrigin:$}=e,q=IN({src:n,onError:c,crossOrigin:$,ignoreFallback:L})==="loaded";return!n||!q?w?Q.jsx(kN,{className:"chakra-avatar__initials",getInitials:y,name:w}):re.cloneElement(D,{role:"img","aria-label":P}):Q.jsx(br.img,{src:n,srcSet:o,alt:w,onLoad:p,referrerPolicy:F,crossOrigin:$??void 0,className:"chakra-avatar__img",loading:a,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:E}})}zN.displayName="AvatarImage";var joe={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},Ef=$r((e,n)=>{const o=Lc("Avatar",e),[c,p]=re.useState(!1),{src:y,srcSet:w,name:E,showBorder:a,borderRadius:P="full",onError:D,onLoad:L,getInitials:F=Boe,icon:$=Q.jsx(PN,{}),iconLabel:H=" avatar",loading:q,children:le,borderColor:ie,ignoreFallback:te,crossOrigin:se,referrerPolicy:be,...Ee}=ls(e),je={borderRadius:P,borderWidth:a?"2px":void 0,...joe,...o.container};return ie&&(je.borderColor=ie),Q.jsx(br.span,{ref:n,...Ee,className:Kr("chakra-avatar",e.className),"data-loaded":On(c),__css:je,children:Q.jsxs(Loe,{value:o,children:[Q.jsx(zN,{src:y,srcSet:w,loading:q,onLoad:vi(L,()=>{p(!0)}),onError:D,getInitials:F,name:E,borderRadius:P,icon:$,iconLabel:H,ignoreFallback:te,crossOrigin:se,referrerPolicy:be}),le]})})});Ef.displayName="Avatar";function RN(e){return re.Children.toArray(e).filter(n=>re.isValidElement(n))}var[Ipe,Voe]=co({strict:!1,name:"ButtonGroupContext"});function $oe(e){const[n,o]=re.useState(!e);return{ref:re.useCallback(y=>{y&&o(y.tagName==="BUTTON")},[]),type:n?"button":void 0}}function RC(e){const{children:n,className:o,...c}=e,p=re.isValidElement(n)?re.cloneElement(n,{"aria-hidden":!0,focusable:!1}):n,y=Kr("chakra-button__icon",o);return Q.jsx(br.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...c,className:y,children:p})}RC.displayName="ButtonIcon";function DC(e){const{label:n,placement:o,spacing:c="0.5rem",children:p=Q.jsx($A,{color:"currentColor",width:"1em",height:"1em"}),className:y,__css:w,...E}=e,a=Kr("chakra-button__spinner",y),P=o==="start"?"marginEnd":"marginStart",D=re.useMemo(()=>({display:"flex",alignItems:"center",position:n?"relative":"absolute",[P]:n?c:0,fontSize:"1em",lineHeight:"normal",...w}),[w,n,P,c]);return Q.jsx(br.div,{className:a,...E,__css:D,children:p})}DC.displayName="ButtonSpinner";var f1=$r((e,n)=>{const o=Voe(),c=md("Button",{...o,...e}),{isDisabled:p=o==null?void 0:o.isDisabled,isLoading:y,isActive:w,children:E,leftIcon:a,rightIcon:P,loadingText:D,iconSpacing:L="0.5rem",type:F,spinner:$,spinnerPlacement:H="start",className:q,as:le,...ie}=ls(e),te=re.useMemo(()=>{const je={...c==null?void 0:c._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...c,...!!o&&{_focus:je}}},[c,o]),{ref:se,type:be}=$oe(le),Ee={rightIcon:P,leftIcon:a,iconSpacing:L,children:E};return Q.jsxs(br.button,{ref:coe(n,se),as:le,type:F??be,"data-active":On(w),"data-loading":On(y),__css:te,className:Kr("chakra-button",q),...ie,disabled:p||y,children:[y&&H==="start"&&Q.jsx(DC,{className:"chakra-button__spinner--start",label:D,placement:"start",spacing:L,children:$}),y?D||Q.jsx(br.span,{opacity:0,children:Q.jsx(R5,{...Ee})}):Q.jsx(R5,{...Ee}),y&&H==="end"&&Q.jsx(DC,{className:"chakra-button__spinner--end",label:D,placement:"end",spacing:L,children:$})]})});f1.displayName="Button";function R5(e){const{leftIcon:n,rightIcon:o,children:c,iconSpacing:p}=e;return Q.jsxs(Q.Fragment,{children:[n&&Q.jsx(RC,{marginEnd:p,children:n}),c,o&&Q.jsx(RC,{marginStart:p,children:o})]})}var[Uoe,Goe]=co({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[Woe,ZA]=co({strict:!1,name:"FormControlContext"});function qoe(e){const{id:n,isRequired:o,isInvalid:c,isDisabled:p,isReadOnly:y,...w}=e,E=re.useId(),a=n||`field-${E}`,P=`${a}-label`,D=`${a}-feedback`,L=`${a}-helptext`,[F,$]=re.useState(!1),[H,q]=re.useState(!1),[le,ie]=re.useState(!1),te=re.useCallback((Be={},Ze=null)=>({id:L,...Be,ref:Nu(Ze,ht=>{ht&&q(!0)})}),[L]),se=re.useCallback((Be={},Ze=null)=>({...Be,ref:Ze,"data-focus":On(le),"data-disabled":On(p),"data-invalid":On(c),"data-readonly":On(y),id:Be.id!==void 0?Be.id:P,htmlFor:Be.htmlFor!==void 0?Be.htmlFor:a}),[a,p,le,c,y,P]),be=re.useCallback((Be={},Ze=null)=>({id:D,...Be,ref:Nu(Ze,ht=>{ht&&$(!0)}),"aria-live":"polite"}),[D]),Ee=re.useCallback((Be={},Ze=null)=>({...Be,...w,ref:Ze,role:"group","data-focus":On(le),"data-disabled":On(p),"data-invalid":On(c),"data-readonly":On(y)}),[w,p,le,c,y]),je=re.useCallback((Be={},Ze=null)=>({...Be,ref:Ze,role:"presentation","aria-hidden":!0,children:Be.children||"*"}),[]);return{isRequired:!!o,isInvalid:!!c,isReadOnly:!!y,isDisabled:!!p,isFocused:!!le,onFocus:()=>ie(!0),onBlur:()=>ie(!1),hasFeedbackText:F,setHasFeedbackText:$,hasHelpText:H,setHasHelpText:q,id:a,labelId:P,feedbackId:D,helpTextId:L,htmlProps:w,getHelpTextProps:te,getErrorMessageProps:be,getRootProps:Ee,getLabelProps:se,getRequiredIndicatorProps:je}}var Hoe=$r(function(n,o){const c=Lc("Form",n),p=ls(n),{getRootProps:y,htmlProps:w,...E}=qoe(p),a=Kr("chakra-form-control",n.className);return Q.jsx(Woe,{value:E,children:Q.jsx(Uoe,{value:c,children:Q.jsx(br.div,{...y({},o),className:a,__css:c.container})})})});Hoe.displayName="FormControl";var Zoe=$r(function(n,o){const c=ZA(),p=Goe(),y=Kr("chakra-form__helper-text",n.className);return Q.jsx(br.div,{...c==null?void 0:c.getHelpTextProps(n,o),__css:p.helperText,className:y})});Zoe.displayName="FormHelperText";function DN(e){const{isDisabled:n,isInvalid:o,isReadOnly:c,isRequired:p,...y}=Xoe(e);return{...y,disabled:n,readOnly:c,required:p,"aria-invalid":ip(o),"aria-required":ip(p),"aria-readonly":ip(c)}}function Xoe(e){var n,o,c;const p=ZA(),{id:y,disabled:w,readOnly:E,required:a,isRequired:P,isInvalid:D,isReadOnly:L,isDisabled:F,onFocus:$,onBlur:H,...q}=e,le=e["aria-describedby"]?[e["aria-describedby"]]:[];return p!=null&&p.hasFeedbackText&&(p!=null&&p.isInvalid)&&le.push(p.feedbackId),p!=null&&p.hasHelpText&&le.push(p.helpTextId),{...q,"aria-describedby":le.join(" ")||void 0,id:y??(p==null?void 0:p.id),isDisabled:(n=w??F)!=null?n:p==null?void 0:p.isDisabled,isReadOnly:(o=E??L)!=null?o:p==null?void 0:p.isReadOnly,isRequired:(c=a??P)!=null?c:p==null?void 0:p.isRequired,isInvalid:D??(p==null?void 0:p.isInvalid),onFocus:vi(p==null?void 0:p.onFocus,$),onBlur:vi(p==null?void 0:p.onBlur,H)}}var Yoe=()=>typeof document<"u",D5=!1,oy=null,sd=!1,LC=!1,OC=new Set;function XA(e,n){OC.forEach(o=>o(e,n))}var Koe=typeof window<"u"&&window.navigator!=null?/^Mac/.test(window.navigator.platform):!1;function Joe(e){return!(e.metaKey||!Koe&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function L5(e){sd=!0,Joe(e)&&(oy="keyboard",XA("keyboard",e))}function xf(e){if(oy="pointer",e.type==="mousedown"||e.type==="pointerdown"){sd=!0;const n=e.composedPath?e.composedPath()[0]:e.target;let o=!1;try{o=n.matches(":focus-visible")}catch{}if(o)return;XA("pointer",e)}}function Qoe(e){return e.mozInputSource===0&&e.isTrusted?!0:e.detail===0&&!e.pointerType}function ese(e){Qoe(e)&&(sd=!0,oy="virtual")}function tse(e){e.target===window||e.target===document||(!sd&&!LC&&(oy="virtual",XA("virtual",e)),sd=!1,LC=!1)}function rse(){sd=!1,LC=!0}function O5(){return oy!=="pointer"}function nse(){if(!Yoe()||D5)return;const{focus:e}=HTMLElement.prototype;HTMLElement.prototype.focus=function(...o){sd=!0,e.apply(this,o)},document.addEventListener("keydown",L5,!0),document.addEventListener("keyup",L5,!0),document.addEventListener("click",ese,!0),window.addEventListener("focus",tse,!0),window.addEventListener("blur",rse,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",xf,!0),document.addEventListener("pointermove",xf,!0),document.addEventListener("pointerup",xf,!0)):(document.addEventListener("mousedown",xf,!0),document.addEventListener("mousemove",xf,!0),document.addEventListener("mouseup",xf,!0)),D5=!0}function ise(e){nse(),e(O5());const n=()=>e(O5());return OC.add(n),()=>{OC.delete(n)}}function ose(e,n){if(e==null)return{};var o={},c=Object.keys(e),p,y;for(y=0;y<c.length;y++)p=c[y],!(n.indexOf(p)>=0)&&(o[p]=e[p]);return o}var BC="data-focus-lock",LN="data-focus-lock-disabled",sse="data-no-focus-lock",ase="data-autofocus-inside",lse="data-no-autofocus";function XT(e,n){return typeof e=="function"?e(n):e&&(e.current=n),e}function cse(e,n){var o=re.useState(function(){return{value:e,callback:n,facade:{get current(){return o.value},set current(c){var p=o.value;p!==c&&(o.value=c,o.callback(c,p))}}}})[0];return o.callback=n,o.facade}var B5=new WeakMap;function ON(e,n){var o=cse(n||null,function(c){return e.forEach(function(p){return XT(p,c)})});return re.useLayoutEffect(function(){var c=B5.get(o);if(c){var p=new Set(c),y=new Set(e),w=o.current;p.forEach(function(E){y.has(E)||XT(E,null)}),y.forEach(function(E){p.has(E)||XT(E,w)})}B5.set(o,e)},[e]),o}var YT={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Sl=function(){return Sl=Object.assign||function(n){for(var o,c=1,p=arguments.length;c<p;c++){o=arguments[c];for(var y in o)Object.prototype.hasOwnProperty.call(o,y)&&(n[y]=o[y])}return n},Sl.apply(this,arguments)};function BN(e,n){var o={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&n.indexOf(c)<0&&(o[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,c=Object.getOwnPropertySymbols(e);p<c.length;p++)n.indexOf(c[p])<0&&Object.prototype.propertyIsEnumerable.call(e,c[p])&&(o[c[p]]=e[c[p]]);return o}function use(e,n,o){if(o||arguments.length===2)for(var c=0,p=n.length,y;c<p;c++)(y||!(c in n))&&(y||(y=Array.prototype.slice.call(n,0,c)),y[c]=n[c]);return e.concat(y||Array.prototype.slice.call(n))}function FN(e){return e}function NN(e,n){n===void 0&&(n=FN);var o=[],c=!1,p={read:function(){if(c)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return o.length?o[o.length-1]:e},useMedium:function(y){var w=n(y,c);return o.push(w),function(){o=o.filter(function(E){return E!==w})}},assignSyncMedium:function(y){for(c=!0;o.length;){var w=o;o=[],w.forEach(y)}o={push:function(E){return y(E)},filter:function(){return o}}},assignMedium:function(y){c=!0;var w=[];if(o.length){var E=o;o=[],E.forEach(y),w=o}var a=function(){var D=w;w=[],D.forEach(y)},P=function(){return Promise.resolve().then(a)};P(),o={push:function(D){w.push(D),P()},filter:function(D){return w=w.filter(D),o}}}};return p}function YA(e,n){return n===void 0&&(n=FN),NN(e,n)}function jN(e){e===void 0&&(e={});var n=NN(null);return n.options=Sl({async:!0,ssr:!1},e),n}var VN=function(e){var n=e.sideCar,o=BN(e,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var c=n.read();if(!c)throw new Error("Sidecar medium not found");return re.createElement(c,Sl({},o))};VN.isSideCarExport=!0;function hse(e,n){return e.useMedium(n),VN}var $N=YA({},function(e){var n=e.target,o=e.currentTarget;return{target:n,currentTarget:o}}),UN=YA(),dse=YA(),fse=jN({async:!0,ssr:typeof document<"u"}),pse=re.createContext(void 0),mse=[],GN=re.forwardRef(function(n,o){var c,p=re.useState(),y=p[0],w=p[1],E=re.useRef(),a=re.useRef(!1),P=re.useRef(null),D=re.useState({}),L=D[1],F=n.children,$=n.disabled,H=$===void 0?!1:$,q=n.noFocusGuards,le=q===void 0?!1:q,ie=n.persistentFocus,te=ie===void 0?!1:ie,se=n.crossFrame,be=se===void 0?!0:se,Ee=n.autoFocus,je=Ee===void 0?!0:Ee;n.allowTextSelection;var Be=n.group,Ze=n.className,ht=n.whiteList,Pe=n.hasPositiveIndices,Et=n.shards,or=Et===void 0?mse:Et,st=n.as,ar=st===void 0?"div":st,Bn=n.lockProps,Mr=Bn===void 0?{}:Bn,xn=n.sideCar,Ot=n.returnFocus,ct=Ot===void 0?!1:Ot,Jt=n.focusOptions,qt=n.onActivation,_r=n.onDeactivation,wr=re.useState({}),Lr=wr[0],wi=re.useCallback(function(kr){var tt=kr.captureFocusRestore;if(!P.current){var de,me=(de=document)==null?void 0:de.activeElement;P.current=me,me!==document.body&&(P.current=tt(me))}E.current&&qt&&qt(E.current),a.current=!0,L()},[qt]),sn=re.useCallback(function(){a.current=!1,_r&&_r(E.current),L()},[_r]),Xn=re.useCallback(function(kr){var tt=P.current;if(tt){var de=(typeof tt=="function"?tt():tt)||document.body,me=typeof ct=="function"?ct(de):ct;if(me){var Ce=typeof me=="object"?me:void 0;P.current=null,kr?Promise.resolve().then(function(){return de.focus(Ce)}):de.focus(Ce)}}},[ct]),Si=re.useCallback(function(kr){a.current&&$N.useMedium(kr)},[]),uo=UN.useMedium,Ti=re.useCallback(function(kr){E.current!==kr&&(E.current=kr,w(kr))},[]),Tr=od((c={},c[LN]=H&&"disabled",c[BC]=Be,c),Mr),oi=le!==!0,cs=oi&&le!=="tail",Zi=ON([o,Ti]),ja=re.useMemo(function(){return{observed:E,shards:or,enabled:!H,active:a.current}},[H,a.current,or,y]);return re.createElement(re.Fragment,null,oi&&[re.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:H?-1:0,style:YT}),Pe?re.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:H?-1:1,style:YT}):null],!H&&re.createElement(xn,{id:Lr,sideCar:fse,observed:y,disabled:H,persistentFocus:te,crossFrame:be,autoFocus:je,whiteList:ht,shards:or,onActivation:wi,onDeactivation:sn,returnFocus:Xn,focusOptions:Jt}),re.createElement(ar,od({ref:Zi},Tr,{className:Ze,onBlur:uo,onFocus:Si}),re.createElement(pse.Provider,{value:ja},F)),cs&&re.createElement("div",{"data-focus-guard":!0,tabIndex:H?-1:0,style:YT}))});GN.propTypes={};const WN=GN;function FC(e,n){return FC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,p){return c.__proto__=p,c},FC(e,n)}function gse(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,FC(e,n)}function F_(e){"@babel/helpers - typeof";return F_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},F_(e)}function _se(e,n){if(F_(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n||"default");if(F_(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function yse(e){var n=_se(e,"string");return F_(n)=="symbol"?n:String(n)}function vse(e,n,o){return n=yse(n),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function xse(e,n){function o(c){return c.displayName||c.name||"Component"}return function(p){var y=[],w;function E(){w=e(y.map(function(P){return P.props})),n(w)}var a=function(P){gse(D,P);function D(){return P.apply(this,arguments)||this}D.peek=function(){return w};var L=D.prototype;return L.componentDidMount=function(){y.push(this),E()},L.componentDidUpdate=function(){E()},L.componentWillUnmount=function(){var $=y.indexOf(this);y.splice($,1),E()},L.render=function(){return Cs.createElement(p,this.props)},D}(re.PureComponent);return vse(a,"displayName","SideEffect("+o(p)+")"),a}}var zl=function(e){for(var n=Array(e.length),o=0;o<e.length;++o)n[o]=e[o];return n},ad=function(e){return Array.isArray(e)?e:[e]},qN=function(e){return Array.isArray(e)?e[0]:e},bse=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var n=window.getComputedStyle(e,null);return!n||!n.getPropertyValue?!1:n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"},HN=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},ZN=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},wse=function(e){return e.hasAttribute("inert")},Sse=function(e,n){return!e||ZN(e)||!bse(e)&&!wse(e)&&n(HN(e))},XN=function(e,n){var o=e.get(n);if(o!==void 0)return o;var c=Sse(n,XN.bind(void 0,e));return e.set(n,c),c},Tse=function(e,n){return e&&!ZN(e)?Mse(e)?n(HN(e)):!1:!0},YN=function(e,n){var o=e.get(n);if(o!==void 0)return o;var c=Tse(n,YN.bind(void 0,e));return e.set(n,c),c},KN=function(e){return e.dataset},Ese=function(e){return e.tagName==="BUTTON"},JN=function(e){return e.tagName==="INPUT"},QN=function(e){return JN(e)&&e.type==="radio"},Cse=function(e){return!((JN(e)||Ese(e))&&(e.type==="hidden"||e.disabled))},Mse=function(e){var n=e.getAttribute(lse);return![!0,"true",""].includes(n)},KA=function(e){var n;return!!(e&&(!((n=KN(e))===null||n===void 0)&&n.focusGuard))},NC=function(e){return!KA(e)},Ase=function(e){return!!e},kse=function(e,n){var o=Math.max(0,e.tabIndex),c=Math.max(0,n.tabIndex),p=o-c,y=e.index-n.index;if(p){if(!o)return 1;if(!c)return-1}return p||y},Pse=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},JA=function(e,n,o){return zl(e).map(function(c,p){var y=Pse(c);return{node:c,index:p,tabIndex:o&&y===-1?(c.dataset||{}).focusGuard?0:-1:y}}).filter(function(c){return!n||c.tabIndex>=0}).sort(kse)},Ise=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],QA=Ise.join(","),zse="".concat(QA,", [data-focus-guard]"),ej=function(e,n){return zl((e.shadowRoot||e).children).reduce(function(o,c){return o.concat(c.matches(n?zse:QA)?[c]:[],ej(c))},[])},Rse=function(e,n){var o;return e instanceof HTMLIFrameElement&&(!((o=e.contentDocument)===null||o===void 0)&&o.body)?Tp([e.contentDocument.body],n):[e]},Tp=function(e,n){return e.reduce(function(o,c){var p,y=ej(c,n),w=(p=[]).concat.apply(p,y.map(function(E){return Rse(E,n)}));return o.concat(w,c.parentNode?zl(c.parentNode.querySelectorAll(QA)).filter(function(E){return E===c}):[])},[])},Dse=function(e){var n=e.querySelectorAll("[".concat(ase,"]"));return zl(n).map(function(o){return Tp([o])}).reduce(function(o,c){return o.concat(c)},[])},ek=function(e,n){return zl(e).filter(function(o){return XN(n,o)}).filter(function(o){return Cse(o)})},F5=function(e,n){return n===void 0&&(n=new Map),zl(e).filter(function(o){return YN(n,o)})},tk=function(e,n,o){return JA(ek(Tp(e,o),n),!0,o)},p1=function(e,n){return JA(ek(Tp(e),n),!1)},Lse=function(e,n){return ek(Dse(e),n)},Jh=function(e,n){return e.shadowRoot?Jh(e.shadowRoot,n):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,n)?!0:zl(e.children).some(function(o){var c;if(o instanceof HTMLIFrameElement){var p=(c=o.contentDocument)===null||c===void 0?void 0:c.body;return p?Jh(p,n):!1}return Jh(o,n)})},Ose=function(e){for(var n=new Set,o=e.length,c=0;c<o;c+=1)for(var p=c+1;p<o;p+=1){var y=e[c].compareDocumentPosition(e[p]);(y&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&n.add(p),(y&Node.DOCUMENT_POSITION_CONTAINS)>0&&n.add(c)}return e.filter(function(w,E){return!n.has(E)})},tj=function(e){return e.parentNode?tj(e.parentNode):e},rk=function(e){var n=ad(e);return n.filter(Boolean).reduce(function(o,c){var p=c.getAttribute(BC);return o.push.apply(o,p?Ose(zl(tj(c).querySelectorAll("[".concat(BC,'="').concat(p,'"]:not([').concat(LN,'="disabled"])')))):[c]),o},[])},Bse=function(e){try{return e()}catch{return}},N_=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var n=e.activeElement;return n.shadowRoot?N_(n.shadowRoot):n instanceof HTMLIFrameElement&&Bse(function(){return n.contentWindow.document})?N_(n.contentWindow.document):n}},Fse=function(e,n){return e===n},Nse=function(e,n){return!!zl(e.querySelectorAll("iframe")).some(function(o){return Fse(o,n)})},rj=function(e,n){return n===void 0&&(n=N_(qN(e).ownerDocument)),!n||n.dataset&&n.dataset.focusGuard?!1:rk(e).some(function(o){return Jh(o,n)||Nse(o,n)})},jse=function(e){e===void 0&&(e=document);var n=N_(e);return n?zl(e.querySelectorAll("[".concat(sse,"]"))).some(function(o){return Jh(o,n)}):!1},Vse=function(e,n){return n.filter(QN).filter(function(o){return o.name===e.name}).filter(function(o){return o.checked})[0]||e},nk=function(e,n){return QN(e)&&e.name?Vse(e,n):e},$se=function(e){var n=new Set;return e.forEach(function(o){return n.add(nk(o,e))}),e.filter(function(o){return n.has(o)})},N5=function(e){return e[0]&&e.length>1?nk(e[0],e):e[0]},j5=function(e,n){return e.indexOf(nk(n,e))},jC="NEW_FOCUS",Use=function(e,n,o,c,p){var y=e.length,w=e[0],E=e[y-1],a=KA(c);if(!(c&&e.indexOf(c)>=0)){var P=c!==void 0?o.indexOf(c):-1,D=p?o.indexOf(p):P,L=p?e.indexOf(p):-1;if(P===-1)return L!==-1?L:jC;if(L===-1)return jC;var F=P-D,$=o.indexOf(w),H=o.indexOf(E),q=$se(o),le=c!==void 0?q.indexOf(c):-1,ie=le-(p?q.indexOf(p):P);if(!F&&L>=0||n.length===0)return L;var te=j5(e,n[0]),se=j5(e,n[n.length-1]);if(P<=$&&a&&Math.abs(F)>1)return se;if(P>=H&&a&&Math.abs(F)>1)return te;if(F&&Math.abs(ie)>1)return L;if(P<=$)return se;if(P>H)return te;if(F)return Math.abs(F)>1?L:(y+L+F)%y}},Gse=function(e){return function(n){var o,c=(o=KN(n))===null||o===void 0?void 0:o.autofocus;return n.autofocus||c!==void 0&&c!=="false"||e.indexOf(n)>=0}},V5=function(e,n,o){var c=e.map(function(y){var w=y.node;return w}),p=F5(c.filter(Gse(o)));return p&&p.length?N5(p):N5(F5(n))},VC=function(e,n){return n===void 0&&(n=[]),n.push(e),e.parentNode&&VC(e.parentNode.host||e.parentNode,n),n},KT=function(e,n){for(var o=VC(e),c=VC(n),p=0;p<o.length;p+=1){var y=o[p];if(c.indexOf(y)>=0)return y}return!1},nj=function(e,n,o){var c=ad(e),p=ad(n),y=c[0],w=!1;return p.filter(Boolean).forEach(function(E){w=KT(w||E,E)||w,o.filter(Boolean).forEach(function(a){var P=KT(y,a);P&&(!w||Jh(P,w)?w=P:w=KT(P,w))})}),w},$5=function(e,n){return e.reduce(function(o,c){return o.concat(Lse(c,n))},[])},Wse=function(e,n){var o=new Map;return n.forEach(function(c){return o.set(c.node,c)}),e.map(function(c){return o.get(c)}).filter(Ase)},qse=function(e,n){var o=N_(ad(e).length>0?document:qN(e).ownerDocument),c=rk(e).filter(NC),p=nj(o||e,e,c),y=new Map,w=p1(c,y),E=w.filter(function(H){var q=H.node;return NC(q)});if(E[0]){var a=p1([p],y).map(function(H){var q=H.node;return q}),P=Wse(a,E),D=P.map(function(H){var q=H.node;return q}),L=P.filter(function(H){var q=H.tabIndex;return q>=0}).map(function(H){var q=H.node;return q}),F=Use(D,L,a,o,n);if(F===jC){var $=V5(w,L,$5(c,y))||V5(w,D,$5(c,y));if($)return{node:$};console.warn("focus-lock: cannot find any node to move focus into");return}return F===void 0?F:P[F]}},Hse=function(e){var n=rk(e).filter(NC),o=nj(e,e,n),c=JA(Tp([o],!0),!0,!0),p=Tp(n,!1);return c.map(function(y){var w=y.node,E=y.index;return{node:w,index:E,lockItem:p.indexOf(w)>=0,guard:KA(w)}})},ik=function(e,n){e&&("focus"in e&&e.focus(n),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},JT=0,QT=!1,ij=function(e,n,o){o===void 0&&(o={});var c=qse(e,n);if(!QT&&c){if(JT>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),QT=!0,setTimeout(function(){QT=!1},1);return}JT++,ik(c.node,o.focusOptions),JT--}};function bg(e){if(!e)return null;var n=e?new WeakRef(e):null;return function(){return(n==null?void 0:n.deref())||null}}var Zse=function(e){if(!e)return null;for(var n=[],o=e;o&&o!==document.body;)n.push({current:bg(o),parent:bg(o.parentElement),left:bg(o.previousElementSibling),right:bg(o.nextElementSibling)}),o=o.parentElement;return{element:bg(e),stack:n,ownerDocument:e.ownerDocument}},Xse=function(e){var n,o,c,p,y;if(e)for(var w=e.stack,E=e.ownerDocument,a=new Map,P=0,D=w;P<D.length;P++){var L=D[P],F=(n=L.parent)===null||n===void 0?void 0:n.call(L);if(F&&E.contains(F)){for(var $=(o=L.left)===null||o===void 0?void 0:o.call(L),H=(c=L.right)===null||c===void 0?void 0:c.call(L),q=tk([F],a),le=(y=(p=$==null?void 0:$.nextElementSibling)!==null&&p!==void 0?p:H)!==null&&y!==void 0?y:$;le;){for(var ie=0,te=q;ie<te.length;ie++){var se=te[ie];if(le!=null&&le.contains(se.node))return se.node}le=le.nextElementSibling}if(q.length)return q[0].node}}},Yse=function(e){var n=Zse(e);return function(){return Xse(n)}},Kse=function(e,n,o){if(!e||!n)return console.error("no element or scope given"),{};var c=ad(n);if(c.every(function(w){return!Jh(w,e)}))return console.error("Active element is not contained in the scope"),{};var p=o?tk(c,new Map):p1(c,new Map),y=p.findIndex(function(w){var E=w.node;return E===e});if(y!==-1)return{prev:p[y-1],next:p[y+1],first:p[0],last:p[p.length-1]}},Jse=function(e,n){var o=n?tk(ad(e),new Map):p1(ad(e),new Map);return{first:o[0],last:o[o.length-1]}},Qse=function(e){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},e)},oj=function(e,n,o){n===void 0&&(n={});var c=Qse(n),p=Kse(e,c.scope,c.onlyTabbable);if(p){var y=o(p,c.cycle);y&&ik(y.node,c.focusOptions)}},eae=function(e,n){n===void 0&&(n={}),oj(e,n,function(o,c){var p=o.next,y=o.first;return p||c&&y})},tae=function(e,n){n===void 0&&(n={}),oj(e,n,function(o,c){var p=o.prev,y=o.last;return p||c&&y})},sj=function(e,n,o){var c,p=Jse(e,(c=n.onlyTabbable)!==null&&c!==void 0?c:!0),y=p[o];y&&ik(y.node,n.focusOptions)},rae=function(e,n){n===void 0&&(n={}),sj(e,n,"first")},nae=function(e,n){n===void 0&&(n={}),sj(e,n,"last")};function ok(e){setTimeout(e,1)}var iae=function(n){return n&&"current"in n?n.current:n},oae=function(){return document&&document.activeElement===document.body},sae=function(){return oae()||jse()},cp=null,Xf=null,up=null,j_=!1,aae=function(){return!0},lae=function(n){return(cp.whiteList||aae)(n)},cae=function(n,o){up={observerNode:n,portaledElement:o}},uae=function(n){return up&&up.portaledElement===n};function U5(e,n,o,c){var p=null,y=e;do{var w=c[y];if(w.guard)w.node.dataset.focusAutoGuard&&(p=w);else if(w.lockItem){if(y!==e)return;p=null}else break}while((y+=o)!==n);p&&(p.node.tabIndex=0)}var hae=function(n){return n?!!j_:j_==="meanwhile"},dae=function e(n,o,c){return o&&(o.host===n&&(!o.activeElement||c.contains(o.activeElement))||o.parentNode&&e(n,o.parentNode,c))},fae=function(n,o){return o.some(function(c){return dae(n,c,c)})},m1=function(){var n=!1;if(cp){var o=cp,c=o.observed,p=o.persistentFocus,y=o.autoFocus,w=o.shards,E=o.crossFrame,a=o.focusOptions,P=c||up&&up.portaledElement,D=document&&document.activeElement;if(P){var L=[P].concat(w.map(iae).filter(Boolean));if((!D||lae(D))&&(p||hae(E)||!sae()||!Xf&&y)&&(P&&!(rj(L)||D&&fae(D,L)||uae(D))&&(document&&!Xf&&D&&!y?(D.blur&&D.blur(),document.body.focus()):(n=ij(L,Xf,{focusOptions:a}),up={})),j_=!1,Xf=document&&document.activeElement),document&&D!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var F=document&&document.activeElement,$=Hse(L),H=$.map(function(q){var le=q.node;return le}).indexOf(F);H>-1&&($.filter(function(q){var le=q.guard,ie=q.node;return le&&ie.dataset.focusAutoGuard}).forEach(function(q){var le=q.node;return le.removeAttribute("tabIndex")}),U5(H,$.length,1,$),U5(H,-1,-1,$))}}}return n},aj=function(n){m1()&&n&&(n.stopPropagation(),n.preventDefault())},sk=function(){return ok(m1)},pae=function(n){var o=n.target,c=n.currentTarget;c.contains(o)||cae(c,o)},mae=function(){return null},lj=function(){j_="just",ok(function(){j_="meanwhile"})},gae=function(){document.addEventListener("focusin",aj),document.addEventListener("focusout",sk),window.addEventListener("blur",lj)},_ae=function(){document.removeEventListener("focusin",aj),document.removeEventListener("focusout",sk),window.removeEventListener("blur",lj)};function yae(e){return e.filter(function(n){var o=n.disabled;return!o})}var cj={moveFocusInside:ij,focusInside:rj,focusNextElement:eae,focusPrevElement:tae,focusFirstElement:rae,focusLastElement:nae,captureFocusRestore:Yse};function vae(e){var n=e.slice(-1)[0];n&&!cp&&gae();var o=cp,c=o&&n&&n.id===o.id;cp=n,o&&!c&&(o.onDeactivation(),e.filter(function(p){var y=p.id;return y===o.id}).length||o.returnFocus(!n)),n?(Xf=null,(!c||o.observed!==n.observed)&&n.onActivation(cj),m1(),ok(m1)):(_ae(),Xf=null)}$N.assignSyncMedium(pae);UN.assignMedium(sk);dse.assignMedium(function(e){return e(cj)});const xae=xse(yae,vae)(mae);var $C=re.forwardRef(function(n,o){return re.createElement(WN,od({sideCar:xae,ref:o},n))}),uj=WN.propTypes||{};uj.sideCar;ose(uj,["sideCar"]);$C.propTypes={};function bae(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function wae(e){var n;if(!bae(e))return!1;const o=(n=e.ownerDocument.defaultView)!=null?n:window;return e instanceof o.HTMLElement}var Sae=e=>e.hasAttribute("tabindex");function Tae(e){return!!e.getAttribute("disabled")||!!e.getAttribute("aria-disabled")}function hj(e){return e.parentElement&&hj(e.parentElement)?!0:e.hidden}function Eae(e){const n=e.getAttribute("contenteditable");return n!=="false"&&n!=null}function Cae(e){if(!wae(e)||hj(e)||Tae(e))return!1;const{localName:n}=e;if(["input","select","textarea","button"].indexOf(n)>=0)return!0;const c={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return n in c?c[n]():Eae(e)?!0:Sae(e)}var Mae=["input:not(:disabled):not([disabled])","select:not(:disabled):not([disabled])","textarea:not(:disabled):not([disabled])","embed","iframe","object","a[href]","area[href]","button:not(:disabled):not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],Aae=Mae.join(),kae=e=>e.offsetWidth>0&&e.offsetHeight>0;function Pae(e){const n=Array.from(e.querySelectorAll(Aae));return n.unshift(e),n.filter(o=>Cae(o)&&kae(o))}var G5,Iae=(G5=$C.default)!=null?G5:$C,dj=e=>{const{initialFocusRef:n,finalFocusRef:o,contentRef:c,restoreFocus:p,children:y,isDisabled:w,autoFocus:E,persistentFocus:a,lockFocusAcrossFrames:P}=e,D=re.useCallback(()=>{n!=null&&n.current?n.current.focus():c!=null&&c.current&&Pae(c.current).length===0&&requestAnimationFrame(()=>{var H;(H=c.current)==null||H.focus()})},[n,c]),L=re.useCallback(()=>{var $;($=o==null?void 0:o.current)==null||$.focus()},[o]),F=p&&!o;return Q.jsx(Iae,{crossFrame:P,persistentFocus:a,autoFocus:E,disabled:w,onActivation:D,onDeactivation:L,returnFocus:F,children:y})};dj.displayName="FocusLock";var zae=D2?re.useLayoutEffect:re.useEffect;function W5(e,n=[]){const o=re.useRef(e);return zae(()=>{o.current=e}),re.useCallback((...c)=>{var p;return(p=o.current)==null?void 0:p.call(o,...c)},n)}function Rae(e,n){const o=re.useId();return re.useMemo(()=>e||[n,o].filter(Boolean).join("-"),[e,n,o])}function Dae(e,n){const o=e!==void 0;return[o,o&&typeof e<"u"?e:n]}function Lae(e={}){const{onClose:n,onOpen:o,isOpen:c,id:p}=e,y=W5(o),w=W5(n),[E,a]=re.useState(e.defaultIsOpen||!1),[P,D]=Dae(c,E),L=Rae(p,"disclosure"),F=re.useCallback(()=>{P||a(!1),w==null||w()},[P,w]),$=re.useCallback(()=>{P||a(!0),y==null||y()},[P,y]),H=re.useCallback(()=>{(D?F:$)()},[D,$,F]);return{isOpen:!!D,onOpen:$,onClose:F,onToggle:H,isControlled:P,getButtonProps:(q={})=>({...q,"aria-expanded":D,"aria-controls":L,onClick:N2(q.onClick,H)}),getDisclosureProps:(q={})=>({...q,hidden:!D,id:L})}}var[Oae,Bae]=co({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),fj=$r(function(n,o){const c=Lc("Input",n),{children:p,className:y,...w}=ls(n),E=Kr("chakra-input__group",y),a={},P=RN(p),D=c.field;P.forEach(F=>{var $,H;c&&(D&&F.type.id==="InputLeftElement"&&(a.paddingStart=($=D.height)!=null?$:D.h),D&&F.type.id==="InputRightElement"&&(a.paddingEnd=(H=D.height)!=null?H:D.h),F.type.id==="InputRightAddon"&&(a.borderEndRadius=0),F.type.id==="InputLeftAddon"&&(a.borderStartRadius=0))});const L=P.map(F=>{var $,H;const q=YF({size:(($=F.props)==null?void 0:$.size)||n.size,variant:((H=F.props)==null?void 0:H.variant)||n.variant});return F.type.id!=="Input"?re.cloneElement(F,q):re.cloneElement(F,Object.assign(q,a,F.props))});return Q.jsx(br.div,{className:E,ref:o,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...c.group},"data-group":!0,...w,children:Q.jsx(Oae,{value:c,children:L})})});fj.displayName="InputGroup";var Fae=br("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),wb=$r(function(n,o){var c,p;const{placement:y="left",...w}=n,E=Bae(),a=E.field,D={[y==="left"?"insetStart":"insetEnd"]:"0",width:(c=a==null?void 0:a.height)!=null?c:a==null?void 0:a.h,height:(p=a==null?void 0:a.height)!=null?p:a==null?void 0:a.h,fontSize:a==null?void 0:a.fontSize,...E.element};return Q.jsx(Fae,{ref:o,__css:D,...w})});wb.id="InputElement";wb.displayName="InputElement";var pj=$r(function(n,o){const{className:c,...p}=n,y=Kr("chakra-input__left-element",c);return Q.jsx(wb,{ref:o,placement:"left",className:y,...p})});pj.id="InputLeftElement";pj.displayName="InputLeftElement";var ak=$r(function(n,o){const{className:c,...p}=n,y=Kr("chakra-input__right-element",c);return Q.jsx(wb,{ref:o,placement:"right",className:y,...p})});ak.id="InputRightElement";ak.displayName="InputRightElement";var lk=$r(function(n,o){const{htmlSize:c,...p}=n,y=Lc("Input",p),w=ls(p),E=DN(w),a=Kr("chakra-input",n.className);return Q.jsx(br.input,{size:c,...E,__css:y.field,ref:o,className:a})});lk.displayName="Input";lk.id="Input";var mj=$r(function(n,o){const c=md("Link",n),{className:p,isExternal:y,...w}=ls(n);return Q.jsx(br.a,{target:y?"_blank":void 0,rel:y?"noopener":void 0,ref:o,className:Kr("chakra-link",p),...w,__css:c})});mj.displayName="Link";function Nae(e,n){return Array.isArray(e)?e.map(o=>o===null?null:n(o)):ks(e)?Object.keys(e).reduce((o,c)=>(o[c]=n(e[c]),o),{}):e!=null?n(e):null}var io=$r(function(n,o){const c=md("Text",n),{className:p,align:y,decoration:w,casing:E,...a}=ls(n),P=YF({textAlign:n.align,textDecoration:n.decoration,textTransform:n.casing});return Q.jsx(br.p,{ref:o,className:Kr("chakra-text",n.className),...P,...a,__css:c})});io.displayName="Text";var gj=e=>Q.jsx(br.div,{className:"chakra-stack__item",...e,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...e.__css}});gj.displayName="StackItem";function jae(e){const{spacing:n,direction:o}=e,c={column:{my:n,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:n,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:n,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:n,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Nae(o,p=>c[p])}}var Sb=$r((e,n)=>{const{isInline:o,direction:c,align:p,justify:y,spacing:w="0.5rem",wrap:E,children:a,divider:P,className:D,shouldWrapChildren:L,...F}=e,$=o?"row":c??"column",H=re.useMemo(()=>jae({spacing:w,direction:$}),[w,$]),q=!!P,le=!L&&!q,ie=re.useMemo(()=>{const se=RN(a);return le?se:se.map((be,Ee)=>{const je=typeof be.key<"u"?be.key:Ee,Be=Ee+1===se.length,ht=L?Q.jsx(gj,{children:be},je):be;if(!q)return ht;const Pe=re.cloneElement(P,{__css:H}),Et=Be?null:Pe;return Q.jsxs(re.Fragment,{children:[ht,Et]},je)})},[P,H,q,le,L,a]),te=Kr("chakra-stack",D);return Q.jsx(br.div,{ref:n,display:"flex",alignItems:p,justifyContent:y,flexDirection:$,flexWrap:E,gap:q?void 0:w,className:te,...F,children:ie})});Sb.displayName="Stack";var _j=$r((e,n)=>Q.jsx(Sb,{align:"center",...e,direction:"column",ref:n}));_j.displayName="VStack";var so=$r(function(n,o){const c=md("Heading",n),{className:p,...y}=ls(n);return Q.jsx(br.h2,{ref:o,className:Kr("chakra-heading",n.className),...y,__css:c})});so.displayName="Heading";var Cn=br("div");Cn.displayName="Box";var yj=$r(function(n,o){const{size:c,centerContent:p=!0,...y}=n,w=p?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return Q.jsx(Cn,{ref:o,boxSize:c,__css:{...w,flexShrink:0,flexGrow:0},...y})});yj.displayName="Square";var Vae=$r(function(n,o){const{size:c,...p}=n;return Q.jsx(yj,{size:c,ref:o,borderRadius:"9999px",...p})});Vae.displayName="Circle";var El=$r(function(n,o){const{direction:c,align:p,justify:y,wrap:w,basis:E,grow:a,shrink:P,...D}=n,L={display:"flex",flexDirection:c,alignItems:p,justifyContent:y,flexWrap:w,flexBasis:E,flexGrow:a,flexShrink:P};return Q.jsx(br.div,{ref:o,__css:L,...D})});El.displayName="Flex";var $ae={slideInBottom:{...Dg,custom:{offsetY:16,reverse:!0}},slideInRight:{...Dg,custom:{offsetX:16,reverse:!0}},slideInTop:{...Dg,custom:{offsetY:-16,reverse:!0}},slideInLeft:{...Dg,custom:{offsetX:-16,reverse:!0}},scale:{...AN,custom:{initialScale:.95,reverse:!0}},none:{}},Uae=br(_d.section),Gae=e=>$ae[e||"none"],vj=re.forwardRef((e,n)=>{const{preset:o,motionProps:c=Gae(o),...p}=e;return Q.jsx(Uae,{ref:n,...c,...p})});vj.displayName="ModalTransition";var Wae=Object.defineProperty,qae=(e,n,o)=>n in e?Wae(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,Hae=(e,n,o)=>(qae(e,typeof n!="symbol"?n+"":n,o),o),Zae=class{constructor(){Hae(this,"modals"),this.modals=new Map}add(e){return this.modals.set(e,this.modals.size+1),this.modals.size}remove(e){this.modals.delete(e)}isTopModal(e){return e?this.modals.get(e)===this.modals.size:!1}},UC=new Zae;function xj(e,n){const[o,c]=re.useState(0);return re.useEffect(()=>{const p=e.current;if(p){if(n){const y=UC.add(p);c(y)}return()=>{UC.remove(p),c(0)}}},[n,e]),o}var Xae=function(e){if(typeof document>"u")return null;var n=Array.isArray(e)?e[0]:e;return n.ownerDocument.body},bf=new WeakMap,Iv=new WeakMap,zv={},eE=0,bj=function(e){return e&&(e.host||bj(e.parentNode))},Yae=function(e,n){return n.map(function(o){if(e.contains(o))return o;var c=bj(o);return c&&e.contains(c)?c:(console.error("aria-hidden",o,"in not contained inside",e,". Doing nothing"),null)}).filter(function(o){return!!o})},Kae=function(e,n,o,c){var p=Yae(n,Array.isArray(e)?e:[e]);zv[o]||(zv[o]=new WeakMap);var y=zv[o],w=[],E=new Set,a=new Set(p),P=function(L){!L||E.has(L)||(E.add(L),P(L.parentNode))};p.forEach(P);var D=function(L){!L||a.has(L)||Array.prototype.forEach.call(L.children,function(F){if(E.has(F))D(F);else{var $=F.getAttribute(c),H=$!==null&&$!=="false",q=(bf.get(F)||0)+1,le=(y.get(F)||0)+1;bf.set(F,q),y.set(F,le),w.push(F),q===1&&H&&Iv.set(F,!0),le===1&&F.setAttribute(o,"true"),H||F.setAttribute(c,"true")}})};return D(n),E.clear(),eE++,function(){w.forEach(function(L){var F=bf.get(L)-1,$=y.get(L)-1;bf.set(L,F),y.set(L,$),F||(Iv.has(L)||L.removeAttribute(c),Iv.delete(L)),$||L.removeAttribute(o)}),eE--,eE||(bf=new WeakMap,bf=new WeakMap,Iv=new WeakMap,zv={})}},Jae=function(e,n,o){o===void 0&&(o="data-aria-hidden");var c=Array.from(Array.isArray(e)?e:[e]),p=n||Xae(e);return p?(c.push.apply(c,Array.from(p.querySelectorAll("[aria-live]"))),Kae(c,p,o,"aria-hidden")):function(){return null}};function Qae(e){const{isOpen:n,onClose:o,id:c,closeOnOverlayClick:p=!0,closeOnEsc:y=!0,useInert:w=!0,onOverlayClick:E,onEsc:a}=e,P=re.useRef(null),D=re.useRef(null),[L,F,$]=tle(c,"chakra-modal","chakra-modal--header","chakra-modal--body");ele(P,n&&w);const H=xj(P,n),q=re.useRef(null),le=re.useCallback(ht=>{q.current=ht.target},[]),ie=re.useCallback(ht=>{ht.key==="Escape"&&(ht.stopPropagation(),y&&(o==null||o()),a==null||a())},[y,o,a]),[te,se]=re.useState(!1),[be,Ee]=re.useState(!1),je=re.useCallback((ht={},Pe=null)=>({role:"dialog",...ht,ref:Nu(Pe,P),id:L,tabIndex:-1,"aria-modal":!0,"aria-labelledby":te?F:void 0,"aria-describedby":be?$:void 0,onClick:vi(ht.onClick,Et=>Et.stopPropagation())}),[$,be,L,F,te]),Be=re.useCallback(ht=>{ht.stopPropagation(),q.current===ht.target&&UC.isTopModal(P.current)&&(p&&(o==null||o()),E==null||E())},[o,p,E]),Ze=re.useCallback((ht={},Pe=null)=>({...ht,ref:Nu(Pe,D),onClick:vi(ht.onClick,Be),onKeyDown:vi(ht.onKeyDown,ie),onMouseDown:vi(ht.onMouseDown,le)}),[ie,le,Be]);return{isOpen:n,onClose:o,headerId:F,bodyId:$,setBodyMounted:Ee,setHeaderMounted:se,dialogRef:P,overlayRef:D,getDialogProps:je,getDialogContainerProps:Ze,index:H}}function ele(e,n){const o=e.current;re.useEffect(()=>{if(!(!e.current||!n))return Jae(e.current)},[n,e,o])}function tle(e,...n){const o=re.useId(),c=e||o;return re.useMemo(()=>n.map(p=>`${p}-${c}`),[c,n])}var[rle,sy]=co({name:"ModalStylesContext",errorMessage:`useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Modal />" `}),[nle,ld]=co({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),wj=e=>{const n={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale",lockFocusAcrossFrames:!0,...e},{portalProps:o,children:c,autoFocus:p,trapFocus:y,initialFocusRef:w,finalFocusRef:E,returnFocusOnClose:a,blockScrollOnMount:P,allowPinchZoom:D,preserveScrollBarGap:L,motionPreset:F,lockFocusAcrossFrames:$,onCloseComplete:H}=n,q=Lc("Modal",n),ie={...Qae(n),autoFocus:p,trapFocus:y,initialFocusRef:w,finalFocusRef:E,returnFocusOnClose:a,blockScrollOnMount:P,allowPinchZoom:D,preserveScrollBarGap:L,motionPreset:F,lockFocusAcrossFrames:$};return Q.jsx(nle,{value:ie,children:Q.jsx(rle,{value:q,children:Q.jsx(Dp,{onExitComplete:H,children:ie.isOpen&&Q.jsx(K_,{...o,children:c})})})})};wj.displayName="Modal";var yx="right-scroll-bar-position",vx="width-before-scroll-bar",ile="with-scroll-bars-hidden",ole="--removed-body-scroll-bar-size",Sj=jN(),tE=function(){},Tb=re.forwardRef(function(e,n){var o=re.useRef(null),c=re.useState({onScrollCapture:tE,onWheelCapture:tE,onTouchMoveCapture:tE}),p=c[0],y=c[1],w=e.forwardProps,E=e.children,a=e.className,P=e.removeScrollBar,D=e.enabled,L=e.shards,F=e.sideCar,$=e.noIsolation,H=e.inert,q=e.allowPinchZoom,le=e.as,ie=le===void 0?"div":le,te=e.gapMode,se=BN(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),be=F,Ee=ON([o,n]),je=Sl(Sl({},se),p);return re.createElement(re.Fragment,null,D&&re.createElement(be,{sideCar:Sj,removeScrollBar:P,shards:L,noIsolation:$,inert:H,setCallbacks:y,allowPinchZoom:!!q,lockRef:o,gapMode:te}),w?re.cloneElement(re.Children.only(E),Sl(Sl({},je),{ref:Ee})):re.createElement(ie,Sl({},je,{className:a,ref:Ee}),E))});Tb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Tb.classNames={fullWidth:vx,zeroRight:yx};var sle=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ale(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var n=sle();return n&&e.setAttribute("nonce",n),e}function lle(e,n){e.styleSheet?e.styleSheet.cssText=n:e.appendChild(document.createTextNode(n))}function cle(e){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(e)}var ule=function(){var e=0,n=null;return{add:function(o){e==0&&(n=ale())&&(lle(n,o),cle(n)),e++},remove:function(){e--,!e&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},hle=function(){var e=ule();return function(n,o){re.useEffect(function(){return e.add(n),function(){e.remove()}},[n&&o])}},Tj=function(){var e=hle(),n=function(o){var c=o.styles,p=o.dynamic;return e(c,p),null};return n},dle={left:0,top:0,right:0,gap:0},rE=function(e){return parseInt(e||"",10)||0},fle=function(e){var n=window.getComputedStyle(document.body),o=n[e==="padding"?"paddingLeft":"marginLeft"],c=n[e==="padding"?"paddingTop":"marginTop"],p=n[e==="padding"?"paddingRight":"marginRight"];return[rE(o),rE(c),rE(p)]},ple=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return dle;var n=fle(e),o=document.documentElement.clientWidth,c=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,c-o+n[2]-n[0])}},mle=Tj(),g1="data-scroll-locked",gle=function(e,n,o,c){var p=e.left,y=e.top,w=e.right,E=e.gap;return o===void 0&&(o="margin"),`
  .`.concat(ile,` {
   overflow: hidden `).concat(c,`;
   padding-right: `).concat(E,"px ").concat(c,`;
  }
  body[`).concat(g1,`] {
    overflow: hidden `).concat(c,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(c,";"),o==="margin"&&`
    padding-left: `.concat(p,`px;
    padding-top: `).concat(y,`px;
    padding-right: `).concat(w,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(E,"px ").concat(c,`;
    `),o==="padding"&&"padding-right: ".concat(E,"px ").concat(c,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(yx,` {
    right: `).concat(E,"px ").concat(c,`;
  }
  
  .`).concat(vx,` {
    margin-right: `).concat(E,"px ").concat(c,`;
  }
  
  .`).concat(yx," .").concat(yx,` {
    right: 0 `).concat(c,`;
  }
  
  .`).concat(vx," .").concat(vx,` {
    margin-right: 0 `).concat(c,`;
  }
  
  body[`).concat(g1,`] {
    `).concat(ole,": ").concat(E,`px;
  }
`)},_le=function(e){var n=e.noRelative,o=e.noImportant,c=e.gapMode,p=c===void 0?"margin":c,y=re.useMemo(function(){return ple(p)},[p]);return re.useEffect(function(){return document.body.setAttribute(g1,""),function(){document.body.removeAttribute(g1)}},[]),re.createElement(mle,{styles:gle(y,!n,p,o?"":"!important")})},GC=!1;if(typeof window<"u")try{var Rv=Object.defineProperty({},"passive",{get:function(){return GC=!0,!0}});window.addEventListener("test",Rv,Rv),window.removeEventListener("test",Rv,Rv)}catch{GC=!1}var wf=GC?{passive:!1}:!1,yle=function(e){return e.tagName==="TEXTAREA"},Ej=function(e,n){var o=window.getComputedStyle(e);return o[n]!=="hidden"&&!(o.overflowY===o.overflowX&&!yle(e)&&o[n]==="visible")},vle=function(e){return Ej(e,"overflowY")},xle=function(e){return Ej(e,"overflowX")},q5=function(e,n){var o=n.ownerDocument,c=n;do{typeof ShadowRoot<"u"&&c instanceof ShadowRoot&&(c=c.host);var p=Cj(e,c);if(p){var y=Mj(e,c),w=y[1],E=y[2];if(w>E)return!0}c=c.parentNode}while(c&&c!==o.body);return!1},ble=function(e){var n=e.scrollTop,o=e.scrollHeight,c=e.clientHeight;return[n,o,c]},wle=function(e){var n=e.scrollLeft,o=e.scrollWidth,c=e.clientWidth;return[n,o,c]},Cj=function(e,n){return e==="v"?vle(n):xle(n)},Mj=function(e,n){return e==="v"?ble(n):wle(n)},Sle=function(e,n){return e==="h"&&n==="rtl"?-1:1},Tle=function(e,n,o,c,p){var y=Sle(e,window.getComputedStyle(n).direction),w=y*c,E=o.target,a=n.contains(E),P=!1,D=w>0,L=0,F=0;do{var $=Mj(e,E),H=$[0],q=$[1],le=$[2],ie=q-le-y*H;(H||ie)&&Cj(e,E)&&(L+=ie,F+=H),E instanceof ShadowRoot?E=E.host:E=E.parentNode}while(!a&&E!==document.body||a&&(n.contains(E)||n===E));return(D&&(p&&Math.abs(L)<1||!p&&w>L)||!D&&(p&&Math.abs(F)<1||!p&&-w>F))&&(P=!0),P},Dv=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},H5=function(e){return[e.deltaX,e.deltaY]},Z5=function(e){return e&&"current"in e?e.current:e},Ele=function(e,n){return e[0]===n[0]&&e[1]===n[1]},Cle=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Mle=0,Sf=[];function Ale(e){var n=re.useRef([]),o=re.useRef([0,0]),c=re.useRef(),p=re.useState(Mle++)[0],y=re.useState(Tj)[0],w=re.useRef(e);re.useEffect(function(){w.current=e},[e]),re.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(p));var q=use([e.lockRef.current],(e.shards||[]).map(Z5),!0).filter(Boolean);return q.forEach(function(le){return le.classList.add("allow-interactivity-".concat(p))}),function(){document.body.classList.remove("block-interactivity-".concat(p)),q.forEach(function(le){return le.classList.remove("allow-interactivity-".concat(p))})}}},[e.inert,e.lockRef.current,e.shards]);var E=re.useCallback(function(q,le){if("touches"in q&&q.touches.length===2)return!w.current.allowPinchZoom;var ie=Dv(q),te=o.current,se="deltaX"in q?q.deltaX:te[0]-ie[0],be="deltaY"in q?q.deltaY:te[1]-ie[1],Ee,je=q.target,Be=Math.abs(se)>Math.abs(be)?"h":"v";if("touches"in q&&Be==="h"&&je.type==="range")return!1;var Ze=q5(Be,je);if(!Ze)return!0;if(Ze?Ee=Be:(Ee=Be==="v"?"h":"v",Ze=q5(Be,je)),!Ze)return!1;if(!c.current&&"changedTouches"in q&&(se||be)&&(c.current=Ee),!Ee)return!0;var ht=c.current||Ee;return Tle(ht,le,q,ht==="h"?se:be,!0)},[]),a=re.useCallback(function(q){var le=q;if(!(!Sf.length||Sf[Sf.length-1]!==y)){var ie="deltaY"in le?H5(le):Dv(le),te=n.current.filter(function(Ee){return Ee.name===le.type&&(Ee.target===le.target||le.target===Ee.shadowParent)&&Ele(Ee.delta,ie)})[0];if(te&&te.should){le.cancelable&&le.preventDefault();return}if(!te){var se=(w.current.shards||[]).map(Z5).filter(Boolean).filter(function(Ee){return Ee.contains(le.target)}),be=se.length>0?E(le,se[0]):!w.current.noIsolation;be&&le.cancelable&&le.preventDefault()}}},[]),P=re.useCallback(function(q,le,ie,te){var se={name:q,delta:le,target:ie,should:te,shadowParent:kle(ie)};n.current.push(se),setTimeout(function(){n.current=n.current.filter(function(be){return be!==se})},1)},[]),D=re.useCallback(function(q){o.current=Dv(q),c.current=void 0},[]),L=re.useCallback(function(q){P(q.type,H5(q),q.target,E(q,e.lockRef.current))},[]),F=re.useCallback(function(q){P(q.type,Dv(q),q.target,E(q,e.lockRef.current))},[]);re.useEffect(function(){return Sf.push(y),e.setCallbacks({onScrollCapture:L,onWheelCapture:L,onTouchMoveCapture:F}),document.addEventListener("wheel",a,wf),document.addEventListener("touchmove",a,wf),document.addEventListener("touchstart",D,wf),function(){Sf=Sf.filter(function(q){return q!==y}),document.removeEventListener("wheel",a,wf),document.removeEventListener("touchmove",a,wf),document.removeEventListener("touchstart",D,wf)}},[]);var $=e.removeScrollBar,H=e.inert;return re.createElement(re.Fragment,null,H?re.createElement(y,{styles:Cle(p)}):null,$?re.createElement(_le,{gapMode:e.gapMode}):null)}function kle(e){for(var n=null;e!==null;)e instanceof ShadowRoot&&(n=e.host,e=e.host),e=e.parentNode;return n}const Ple=hse(Sj,Ale);var Aj=re.forwardRef(function(e,n){return re.createElement(Tb,Sl({},e,{ref:n,sideCar:Ple}))});Aj.classNames=Tb.classNames;const Ile=Aj;function zle(e){const{autoFocus:n,trapFocus:o,dialogRef:c,initialFocusRef:p,blockScrollOnMount:y,allowPinchZoom:w,finalFocusRef:E,returnFocusOnClose:a,preserveScrollBarGap:P,lockFocusAcrossFrames:D,isOpen:L}=ld(),[F,$]=oN();re.useEffect(()=>{!F&&$&&setTimeout($)},[F,$]);const H=xj(c,L);return Q.jsx(dj,{autoFocus:n,isDisabled:!o,initialFocusRef:p,finalFocusRef:E,restoreFocus:a,contentRef:c,lockFocusAcrossFrames:D,children:Q.jsx(Ile,{removeScrollBar:!P,allowPinchZoom:w,enabled:H===1&&y,forwardProps:!0,children:e.children})})}var kj=$r((e,n)=>{const{className:o,children:c,containerProps:p,motionProps:y,...w}=e,{getDialogProps:E,getDialogContainerProps:a}=ld(),P=E(w,n),D=a(p),L=Kr("chakra-modal__content",o),F=sy(),$={display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...F.dialog},H={display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...F.dialogContainer},{motionPreset:q}=ld();return Q.jsx(zle,{children:Q.jsx(br.div,{...D,className:"chakra-modal__content-container",tabIndex:-1,__css:H,children:Q.jsx(vj,{preset:q,motionProps:y,className:L,...P,__css:$,children:c})})})});kj.displayName="ModalContent";var Pj=$r((e,n)=>{const{className:o,...c}=e,{headerId:p,setHeaderMounted:y}=ld();re.useEffect(()=>(y(!0),()=>y(!1)),[y]);const w=Kr("chakra-modal__header",o),a={flex:0,...sy().header};return Q.jsx(br.header,{ref:n,className:w,id:p,...c,__css:a})});Pj.displayName="ModalHeader";var Rle=br(_d.div),Ij=$r((e,n)=>{const{className:o,transition:c,motionProps:p,...y}=e,w=Kr("chakra-modal__overlay",o),a={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",...sy().overlay},{motionPreset:P}=ld(),L=p||(P==="none"?{}:MN);return Q.jsx(Rle,{...L,__css:a,ref:n,className:w,...y})});Ij.displayName="ModalOverlay";var zj=$r((e,n)=>{const{className:o,...c}=e,{bodyId:p,setBodyMounted:y}=ld();re.useEffect(()=>(y(!0),()=>y(!1)),[y]);const w=Kr("chakra-modal__body",o),E=sy();return Q.jsx(br.div,{ref:n,className:w,id:p,...c,__css:E.body})});zj.displayName="ModalBody";var Rj=$r((e,n)=>{const{onClick:o,className:c,...p}=e,{onClose:y}=ld(),w=Kr("chakra-modal__close-btn",c),E=sy();return Q.jsx(WA,{ref:n,__css:E.closeButton,className:w,onClick:vi(o,a=>{a.stopPropagation(),y()}),...p})});Rj.displayName="ModalCloseButton";function Dle(e){return e&&ks(e)&&ks(e.target)}function Lle(e={}){const{onChange:n,value:o,defaultValue:c,name:p,isDisabled:y,isFocusable:w,isNative:E,...a}=e,[P,D]=re.useState(c||""),L=typeof o<"u",F=L?o:P,$=re.useRef(null),H=re.useCallback(()=>{const Ee=$.current;if(!Ee)return;let je="input:not(:disabled):checked";const Be=Ee.querySelector(je);if(Be){Be.focus();return}je="input:not(:disabled)";const Ze=Ee.querySelector(je);Ze==null||Ze.focus()},[]),le=`radio-${re.useId()}`,ie=p||le,te=re.useCallback(Ee=>{const je=Dle(Ee)?Ee.target.value:Ee;L||D(je),n==null||n(String(je))},[n,L]),se=re.useCallback((Ee={},je=null)=>({...Ee,ref:Nu(je,$),role:"radiogroup"}),[]),be=re.useCallback((Ee={},je=null)=>({...Ee,ref:je,name:ie,[E?"checked":"isChecked"]:F!=null?Ee.value===F:void 0,onChange(Ze){te(Ze)},"data-radiogroup":!0}),[E,ie,te,F]);return{getRootProps:se,getRadioProps:be,name:ie,ref:$,focus:H,setValue:D,value:F,onChange:te,isDisabled:y,isFocusable:w,htmlProps:a}}var[Ole,Dj]=co({name:"RadioGroupContext",strict:!1}),Lj=$r((e,n)=>{const{colorScheme:o,size:c,variant:p,children:y,className:w,isDisabled:E,isFocusable:a,...P}=e,{value:D,onChange:L,getRootProps:F,name:$,htmlProps:H}=Lle(P),q=re.useMemo(()=>({name:$,size:c,onChange:L,colorScheme:o,value:D,variant:p,isDisabled:E,isFocusable:a}),[$,c,L,o,D,p,E,a]);return Q.jsx(Ole,{value:q,children:Q.jsx(br.div,{...F(H,n),className:Kr("chakra-radio-group",w),children:y})})});Lj.displayName="RadioGroup";var Ble={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function Fle(e={}){const{defaultChecked:n,isChecked:o,isFocusable:c,isDisabled:p,isReadOnly:y,isRequired:w,onChange:E,isInvalid:a,name:P,value:D,id:L,"data-radiogroup":F,"aria-describedby":$,...H}=e,q=`radio-${re.useId()}`,le=ZA(),te=!!Dj()||!!F;let be=!!le&&!te?le.id:q;be=L??be;const Ee=p??(le==null?void 0:le.isDisabled),je=y??(le==null?void 0:le.isReadOnly),Be=w??(le==null?void 0:le.isRequired),Ze=a??(le==null?void 0:le.isInvalid),[ht,Pe]=re.useState(!1),[Et,or]=re.useState(!1),[st,ar]=re.useState(!1),[Bn,Mr]=re.useState(!1),[xn,Ot]=re.useState(!!n),ct=typeof o<"u",Jt=ct?o:xn;re.useEffect(()=>ise(Pe),[]);const qt=re.useCallback(Tr=>{if(je||Ee){Tr.preventDefault();return}ct||Ot(Tr.target.checked),E==null||E(Tr)},[ct,Ee,je,E]),_r=re.useCallback(Tr=>{Tr.key===" "&&Mr(!0)},[Mr]),wr=re.useCallback(Tr=>{Tr.key===" "&&Mr(!1)},[Mr]),Lr=re.useCallback((Tr={},oi=null)=>({...Tr,ref:oi,"data-active":On(Bn),"data-hover":On(st),"data-disabled":On(Ee),"data-invalid":On(Ze),"data-checked":On(Jt),"data-focus":On(Et),"data-focus-visible":On(Et&&ht),"data-readonly":On(je),"aria-hidden":!0,onMouseDown:vi(Tr.onMouseDown,()=>Mr(!0)),onMouseUp:vi(Tr.onMouseUp,()=>Mr(!1)),onMouseEnter:vi(Tr.onMouseEnter,()=>ar(!0)),onMouseLeave:vi(Tr.onMouseLeave,()=>ar(!1))}),[Bn,st,Ee,Ze,Jt,Et,je,ht]),{onFocus:wi,onBlur:sn}=le??{},Xn=re.useCallback((Tr={},oi=null)=>{const cs=Ee&&!c;return{...Tr,id:be,ref:oi,type:"radio",name:P,value:D,onChange:vi(Tr.onChange,qt),onBlur:vi(sn,Tr.onBlur,()=>or(!1)),onFocus:vi(wi,Tr.onFocus,()=>or(!0)),onKeyDown:vi(Tr.onKeyDown,_r),onKeyUp:vi(Tr.onKeyUp,wr),checked:Jt,disabled:cs,readOnly:je,required:Be,"aria-invalid":ip(Ze),"aria-disabled":ip(cs),"aria-required":ip(Be),"data-readonly":On(je),"aria-describedby":$,style:Ble}},[Ee,c,be,P,D,qt,sn,wi,_r,wr,Jt,je,Be,Ze,$]);return{state:{isInvalid:Ze,isFocused:Et,isChecked:Jt,isActive:Bn,isHovered:st,isDisabled:Ee,isReadOnly:je,isRequired:Be},getCheckboxProps:Lr,getRadioProps:Lr,getInputProps:Xn,getLabelProps:(Tr={},oi=null)=>({...Tr,ref:oi,onMouseDown:vi(Tr.onMouseDown,Nle),"data-disabled":On(Ee),"data-checked":On(Jt),"data-invalid":On(Ze)}),getRootProps:(Tr,oi=null)=>({...Tr,ref:oi,"data-disabled":On(Ee),"data-checked":On(Jt),"data-invalid":On(Ze)}),htmlProps:H}}function Nle(e){e.preventDefault(),e.stopPropagation()}function jle(e,n){const o={},c={};for(const[p,y]of Object.entries(e))n.includes(p)?o[p]=y:c[p]=y;return[o,c]}var Lg=$r((e,n)=>{var o;const c=Dj(),{onChange:p,value:y}=e,w=Lc("Radio",{...c,...e}),E=ls(e),{spacing:a="0.5rem",children:P,isDisabled:D=c==null?void 0:c.isDisabled,isFocusable:L=c==null?void 0:c.isFocusable,inputProps:F,...$}=E;let H=e.isChecked;(c==null?void 0:c.value)!=null&&y!=null&&(H=c.value===y);let q=p;c!=null&&c.onChange&&y!=null&&(q=Xq(c.onChange,p));const le=(o=e==null?void 0:e.name)!=null?o:c==null?void 0:c.name,{getInputProps:ie,getCheckboxProps:te,getLabelProps:se,getRootProps:be,htmlProps:Ee}=Fle({...$,isChecked:H,isFocusable:L,isDisabled:D,onChange:q,name:le}),[je,Be]=jle(Ee,PF),Ze=te(Be),ht=ie(F,n),Pe=se(),Et=Object.assign({},je,be()),or={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...w.container},st={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...w.control},ar={userSelect:"none",marginStart:a,...w.label};return Q.jsxs(br.label,{className:"chakra-radio",...Et,__css:or,children:[Q.jsx("input",{className:"chakra-radio__input",...ht}),Q.jsx(br.span,{className:"chakra-radio__control",...Ze,__css:st}),P&&Q.jsx(br.span,{className:"chakra-radio__label",...Pe,__css:ar,children:P})]})});Lg.displayName="Radio";var Oj=$r(function(n,o){const{children:c,placeholder:p,className:y,...w}=n;return Q.jsxs(br.select,{...w,ref:o,className:Kr("chakra-select",y),children:[p&&Q.jsx("option",{value:"",children:p}),c]})});Oj.displayName="SelectField";function Vle(e,n){const o={},c={};for(const[p,y]of Object.entries(e))n.includes(p)?o[p]=y:c[p]=y;return[o,c]}var ck=$r((e,n)=>{var o;const c=Lc("Select",e),{rootProps:p,placeholder:y,icon:w,color:E,height:a,h:P,minH:D,minHeight:L,iconColor:F,iconSize:$,...H}=ls(e),[q,le]=Vle(H,PF),ie=DN(le),te={width:"100%",height:"fit-content",position:"relative",color:E},se={paddingEnd:"2rem",...c.field,_focus:{zIndex:"unset",...(o=c.field)==null?void 0:o._focus}};return Q.jsxs(br.div,{className:"chakra-select__wrapper",__css:te,...q,...p,children:[Q.jsx(Oj,{ref:n,height:P??a,minH:D??L,placeholder:y,...ie,__css:se,children:e.children}),Q.jsx(Bj,{"data-disabled":On(ie.disabled),...(F||E)&&{color:F||E},__css:c.icon,...$&&{fontSize:$},children:w})]})});ck.displayName="Select";var $le=e=>Q.jsx("svg",{viewBox:"0 0 24 24",...e,children:Q.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Ule=br("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),Bj=e=>{const{children:n=Q.jsx($le,{}),...o}=e,c=re.cloneElement(n,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return Q.jsx(Ule,{...o,className:"chakra-select__icon-wrapper",children:re.isValidElement(n)?c:null})};Bj.displayName="SelectIcon";var Fj={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},X5=Cs.createContext&&Cs.createContext(Fj),Gle=["attr","size","title"];function Wle(e,n){if(e==null)return{};var o=qle(e,n),c,p;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(p=0;p<y.length;p++)c=y[p],!(n.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(o[c]=e[c])}return o}function qle(e,n){if(e==null)return{};var o={},c=Object.keys(e),p,y;for(y=0;y<c.length;y++)p=c[y],!(n.indexOf(p)>=0)&&(o[p]=e[p]);return o}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},_1.apply(this,arguments)}function Y5(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);n&&(c=c.filter(function(p){return Object.getOwnPropertyDescriptor(e,p).enumerable})),o.push.apply(o,c)}return o}function y1(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?Y5(Object(o),!0).forEach(function(c){Hle(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Y5(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function Hle(e,n,o){return n=Zle(n),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function Zle(e){var n=Xle(e,"string");return typeof n=="symbol"?n:String(n)}function Xle(e,n){if(typeof e!="object"||e===null)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Nj(e){return e&&e.map((n,o)=>Cs.createElement(n.tag,y1({key:o},n.attr),Nj(n.child)))}function Eb(e){return n=>Cs.createElement(Yle,_1({attr:y1({},e.attr)},n),Nj(e.child))}function Yle(e){var n=o=>{var{attr:c,size:p,title:y}=e,w=Wle(e,Gle),E=p||o.size||"1em",a;return o.className&&(a=o.className),e.className&&(a=(a?a+" ":"")+e.className),Cs.createElement("svg",_1({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},o.attr,c,w,{className:a,style:y1(y1({color:e.color||o.color},o.style),e.style),height:E,width:E,xmlns:"http://www.w3.org/2000/svg"}),y&&Cs.createElement("title",null,y),e.children)};return X5!==void 0?Cs.createElement(X5.Consumer,null,o=>n(o)):n(Fj)}function Kle(e){return Eb({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 16C123.45 16 16 123.45 16 256s107.45 240 240 240 240-107.45 240-240S388.55 16 256 16zm0 60c99.41 0 180 80.59 180 180s-80.59 180-180 180S76 355.41 76 256 156.59 76 256 76zm-80.625 60c-.97-.005-2.006.112-3.063.313v-.032c-18.297 3.436-45.264 34.743-33.375 46.626l73.157 73.125-73.156 73.126c-14.63 14.625 29.275 58.534 43.906 43.906L256 299.906l73.156 73.156c14.63 14.628 58.537-29.28 43.906-43.906l-73.156-73.125 73.156-73.124c14.63-14.625-29.275-58.5-43.906-43.875L256 212.157l-73.156-73.125c-2.06-2.046-4.56-3.015-7.47-3.03z"},child:[]}]})(e)}function Jle(e){return Eb({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M32 96v64h448V96H32zm0 128v64h448v-64H32zm0 128v64h448v-64H32z"},child:[]}]})(e)}const jj=({containerStyle:e})=>{const n=[{label:"No Data",color:"#2792C6"},{label:"Good",color:"#C0E49A"},{label:"Moderate",color:"#FFFFB5"},{label:"Unhealthy for sensitive groups",color:"#FCCF5C"},{label:"Unhealthy",color:"#FD8C3C"},{label:"Very unhealthy",color:"#B3840E"},{label:"Hazardous",color:"#E31C23"}];return Q.jsx("div",{className:"legend-container style={containerStyle}",children:n.map((o,c)=>Q.jsx("div",{className:"legend-item",style:{backgroundColor:o.color},children:Q.jsx("span",{className:"legend-text",children:o.label})},c))})},Qle=()=>{const[e,n]=re.useState(!1),o=()=>{n(!e)};return Q.jsxs("nav",{className:"navbar",children:[Q.jsx("button",{className:"toggle-nav-button",onClick:o,children:e?Q.jsx(zc,{as:Kle}):Q.jsx(zc,{as:Jle})}),Q.jsxs("div",{className:`nav-sidebar ${e?"show":""}`,children:[Q.jsx(_T,{to:"/home",className:"menu-item",children:Q.jsx(so,{className:"nav-heading",mr:"6",children:"CitizAir"})}),Q.jsx("div",{className:"mobile-nav-content",children:"visualize the air pollution of Stockholm"}),Q.jsxs("div",{className:"menu",children:[Q.jsx(_T,{to:"/about-air-pollution",className:"menu-item",children:"About Air Pollution"}),Q.jsx(_T,{to:"/about-us",className:"menu-item",children:"About Us"})]}),Q.jsx("div",{className:"map-legend",containerStyle:{position:"relative",marginBottom:"20px"},children:Q.jsx(jj,{})})]})]})};function xx(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function ece(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function Vj(e){let n,o,c;e.length!==2?(n=xx,o=(E,a)=>xx(e(E),a),c=(E,a)=>e(E)-a):(n=e===xx||e===ece?e:tce,o=e,c=e);function p(E,a,P=0,D=E.length){if(P<D){if(n(a,a)!==0)return D;do{const L=P+D>>>1;o(E[L],a)<0?P=L+1:D=L}while(P<D)}return P}function y(E,a,P=0,D=E.length){if(P<D){if(n(a,a)!==0)return D;do{const L=P+D>>>1;o(E[L],a)<=0?P=L+1:D=L}while(P<D)}return P}function w(E,a,P=0,D=E.length){const L=p(E,a,P,D-1);return L>P&&c(E[L-1],a)>-c(E[L],a)?L-1:L}return{left:p,center:w,right:y}}function tce(){return 0}function rce(e){return e===null?NaN:+e}const nce=Vj(xx),ice=nce.right;Vj(rce).center;class K5 extends Map{constructor(n,o=ace){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:o}}),n!=null)for(const[c,p]of n)this.set(c,p)}get(n){return super.get(J5(this,n))}has(n){return super.has(J5(this,n))}set(n,o){return super.set(oce(this,n),o)}delete(n){return super.delete(sce(this,n))}}function J5({_intern:e,_key:n},o){const c=n(o);return e.has(c)?e.get(c):o}function oce({_intern:e,_key:n},o){const c=n(o);return e.has(c)?e.get(c):(e.set(c,o),o)}function sce({_intern:e,_key:n},o){const c=n(o);return e.has(c)&&(o=e.get(c),e.delete(c)),o}function ace(e){return e!==null&&typeof e=="object"?e.valueOf():e}const lce=Math.sqrt(50),cce=Math.sqrt(10),uce=Math.sqrt(2);function v1(e,n,o){const c=(n-e)/Math.max(0,o),p=Math.floor(Math.log10(c)),y=c/Math.pow(10,p),w=y>=lce?10:y>=cce?5:y>=uce?2:1;let E,a,P;return p<0?(P=Math.pow(10,-p)/w,E=Math.round(e*P),a=Math.round(n*P),E/P<e&&++E,a/P>n&&--a,P=-P):(P=Math.pow(10,p)*w,E=Math.round(e/P),a=Math.round(n/P),E*P<e&&++E,a*P>n&&--a),a<E&&.5<=o&&o<2?v1(e,n,o*2):[E,a,P]}function hce(e,n,o){if(n=+n,e=+e,o=+o,!(o>0))return[];if(e===n)return[e];const c=n<e,[p,y,w]=c?v1(n,e,o):v1(e,n,o);if(!(y>=p))return[];const E=y-p+1,a=new Array(E);if(c)if(w<0)for(let P=0;P<E;++P)a[P]=(y-P)/-w;else for(let P=0;P<E;++P)a[P]=(y-P)*w;else if(w<0)for(let P=0;P<E;++P)a[P]=(p+P)/-w;else for(let P=0;P<E;++P)a[P]=(p+P)*w;return a}function WC(e,n,o){return n=+n,e=+e,o=+o,v1(e,n,o)[2]}function dce(e,n,o){n=+n,e=+e,o=+o;const c=n<e,p=c?WC(n,e,o):WC(e,n,o);return(c?-1:1)*(p<0?1/-p:p)}function $j(e,n){let o;if(n===void 0)for(const c of e)c!=null&&(o<c||o===void 0&&c>=c)&&(o=c);else{let c=-1;for(let p of e)(p=n(p,++c,e))!=null&&(o<p||o===void 0&&p>=p)&&(o=p)}return o}function fce(e,n){let o;if(n===void 0)for(const c of e)c!=null&&(o>c||o===void 0&&c>=c)&&(o=c);else{let c=-1;for(let p of e)(p=n(p,++c,e))!=null&&(o>p||o===void 0&&p>=p)&&(o=p)}return o}function pce(e,n,o){e=+e,n=+n,o=(p=arguments.length)<2?(n=e,e=0,1):p<3?1:+o;for(var c=-1,p=Math.max(0,Math.ceil((n-e)/o))|0,y=new Array(p);++c<p;)y[c]=e+c*o;return y}function mce(e){return e}var nE=1,iE=2,qC=3,Og=4,Q5=1e-6;function gce(e){return"translate("+e+",0)"}function _ce(e){return"translate(0,"+e+")"}function yce(e){return n=>+e(n)}function vce(e,n){return n=Math.max(0,e.bandwidth()-n*2)/2,e.round()&&(n=Math.round(n)),o=>+e(o)+n}function xce(){return!this.__axis}function Uj(e,n){var o=[],c=null,p=null,y=6,w=6,E=3,a=typeof window<"u"&&window.devicePixelRatio>1?0:.5,P=e===nE||e===Og?-1:1,D=e===Og||e===iE?"x":"y",L=e===nE||e===qC?gce:_ce;function F($){var H=c??(n.ticks?n.ticks.apply(n,o):n.domain()),q=p??(n.tickFormat?n.tickFormat.apply(n,o):mce),le=Math.max(y,0)+E,ie=n.range(),te=+ie[0]+a,se=+ie[ie.length-1]+a,be=(n.bandwidth?vce:yce)(n.copy(),a),Ee=$.selection?$.selection():$,je=Ee.selectAll(".domain").data([null]),Be=Ee.selectAll(".tick").data(H,n).order(),Ze=Be.exit(),ht=Be.enter().append("g").attr("class","tick"),Pe=Be.select("line"),Et=Be.select("text");je=je.merge(je.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Be=Be.merge(ht),Pe=Pe.merge(ht.append("line").attr("stroke","currentColor").attr(D+"2",P*y)),Et=Et.merge(ht.append("text").attr("fill","currentColor").attr(D,P*le).attr("dy",e===nE?"0em":e===qC?"0.71em":"0.32em")),$!==Ee&&(je=je.transition($),Be=Be.transition($),Pe=Pe.transition($),Et=Et.transition($),Ze=Ze.transition($).attr("opacity",Q5).attr("transform",function(or){return isFinite(or=be(or))?L(or+a):this.getAttribute("transform")}),ht.attr("opacity",Q5).attr("transform",function(or){var st=this.parentNode.__axis;return L((st&&isFinite(st=st(or))?st:be(or))+a)})),Ze.remove(),je.attr("d",e===Og||e===iE?w?"M"+P*w+","+te+"H"+a+"V"+se+"H"+P*w:"M"+a+","+te+"V"+se:w?"M"+te+","+P*w+"V"+a+"H"+se+"V"+P*w:"M"+te+","+a+"H"+se),Be.attr("opacity",1).attr("transform",function(or){return L(be(or)+a)}),Pe.attr(D+"2",P*y),Et.attr(D,P*le).text(q),Ee.filter(xce).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===iE?"start":e===Og?"end":"middle"),Ee.each(function(){this.__axis=be})}return F.scale=function($){return arguments.length?(n=$,F):n},F.ticks=function(){return o=Array.from(arguments),F},F.tickArguments=function($){return arguments.length?(o=$==null?[]:Array.from($),F):o.slice()},F.tickValues=function($){return arguments.length?(c=$==null?null:Array.from($),F):c&&c.slice()},F.tickFormat=function($){return arguments.length?(p=$,F):p},F.tickSize=function($){return arguments.length?(y=w=+$,F):y},F.tickSizeInner=function($){return arguments.length?(y=+$,F):y},F.tickSizeOuter=function($){return arguments.length?(w=+$,F):w},F.tickPadding=function($){return arguments.length?(E=+$,F):E},F.offset=function($){return arguments.length?(a=+$,F):a},F}function Gj(e){return Uj(qC,e)}function bce(e){return Uj(Og,e)}var wce={value:()=>{}};function Wj(){for(var e=0,n=arguments.length,o={},c;e<n;++e){if(!(c=arguments[e]+"")||c in o||/[\s.]/.test(c))throw new Error("illegal type: "+c);o[c]=[]}return new bx(o)}function bx(e){this._=e}function Sce(e,n){return e.trim().split(/^|\s+/).map(function(o){var c="",p=o.indexOf(".");if(p>=0&&(c=o.slice(p+1),o=o.slice(0,p)),o&&!n.hasOwnProperty(o))throw new Error("unknown type: "+o);return{type:o,name:c}})}bx.prototype=Wj.prototype={constructor:bx,on:function(e,n){var o=this._,c=Sce(e+"",o),p,y=-1,w=c.length;if(arguments.length<2){for(;++y<w;)if((p=(e=c[y]).type)&&(p=Tce(o[p],e.name)))return p;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++y<w;)if(p=(e=c[y]).type)o[p]=eL(o[p],e.name,n);else if(n==null)for(p in o)o[p]=eL(o[p],e.name,null);return this},copy:function(){var e={},n=this._;for(var o in n)e[o]=n[o].slice();return new bx(e)},call:function(e,n){if((p=arguments.length-2)>0)for(var o=new Array(p),c=0,p,y;c<p;++c)o[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(y=this._[e],c=0,p=y.length;c<p;++c)y[c].value.apply(n,o)},apply:function(e,n,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var c=this._[e],p=0,y=c.length;p<y;++p)c[p].value.apply(n,o)}};function Tce(e,n){for(var o=0,c=e.length,p;o<c;++o)if((p=e[o]).name===n)return p.value}function eL(e,n,o){for(var c=0,p=e.length;c<p;++c)if(e[c].name===n){e[c]=wce,e=e.slice(0,c).concat(e.slice(c+1));break}return o!=null&&e.push({name:n,value:o}),e}var HC="http://www.w3.org/1999/xhtml";const tL={svg:"http://www.w3.org/2000/svg",xhtml:HC,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Cb(e){var n=e+="",o=n.indexOf(":");return o>=0&&(n=e.slice(0,o))!=="xmlns"&&(e=e.slice(o+1)),tL.hasOwnProperty(n)?{space:tL[n],local:e}:e}function Ece(e){return function(){var n=this.ownerDocument,o=this.namespaceURI;return o===HC&&n.documentElement.namespaceURI===HC?n.createElement(e):n.createElementNS(o,e)}}function Cce(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function qj(e){var n=Cb(e);return(n.local?Cce:Ece)(n)}function Mce(){}function uk(e){return e==null?Mce:function(){return this.querySelector(e)}}function Ace(e){typeof e!="function"&&(e=uk(e));for(var n=this._groups,o=n.length,c=new Array(o),p=0;p<o;++p)for(var y=n[p],w=y.length,E=c[p]=new Array(w),a,P,D=0;D<w;++D)(a=y[D])&&(P=e.call(a,a.__data__,D,y))&&("__data__"in a&&(P.__data__=a.__data__),E[D]=P);return new Rs(c,this._parents)}function kce(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Pce(){return[]}function Hj(e){return e==null?Pce:function(){return this.querySelectorAll(e)}}function Ice(e){return function(){return kce(e.apply(this,arguments))}}function zce(e){typeof e=="function"?e=Ice(e):e=Hj(e);for(var n=this._groups,o=n.length,c=[],p=[],y=0;y<o;++y)for(var w=n[y],E=w.length,a,P=0;P<E;++P)(a=w[P])&&(c.push(e.call(a,a.__data__,P,w)),p.push(a));return new Rs(c,p)}function Zj(e){return function(){return this.matches(e)}}function Xj(e){return function(n){return n.matches(e)}}var Rce=Array.prototype.find;function Dce(e){return function(){return Rce.call(this.children,e)}}function Lce(){return this.firstElementChild}function Oce(e){return this.select(e==null?Lce:Dce(typeof e=="function"?e:Xj(e)))}var Bce=Array.prototype.filter;function Fce(){return Array.from(this.children)}function Nce(e){return function(){return Bce.call(this.children,e)}}function jce(e){return this.selectAll(e==null?Fce:Nce(typeof e=="function"?e:Xj(e)))}function Vce(e){typeof e!="function"&&(e=Zj(e));for(var n=this._groups,o=n.length,c=new Array(o),p=0;p<o;++p)for(var y=n[p],w=y.length,E=c[p]=[],a,P=0;P<w;++P)(a=y[P])&&e.call(a,a.__data__,P,y)&&E.push(a);return new Rs(c,this._parents)}function Yj(e){return new Array(e.length)}function $ce(){return new Rs(this._enter||this._groups.map(Yj),this._parents)}function x1(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}x1.prototype={constructor:x1,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Uce(e){return function(){return e}}function Gce(e,n,o,c,p,y){for(var w=0,E,a=n.length,P=y.length;w<P;++w)(E=n[w])?(E.__data__=y[w],c[w]=E):o[w]=new x1(e,y[w]);for(;w<a;++w)(E=n[w])&&(p[w]=E)}function Wce(e,n,o,c,p,y,w){var E,a,P=new Map,D=n.length,L=y.length,F=new Array(D),$;for(E=0;E<D;++E)(a=n[E])&&(F[E]=$=w.call(a,a.__data__,E,n)+"",P.has($)?p[E]=a:P.set($,a));for(E=0;E<L;++E)$=w.call(e,y[E],E,y)+"",(a=P.get($))?(c[E]=a,a.__data__=y[E],P.delete($)):o[E]=new x1(e,y[E]);for(E=0;E<D;++E)(a=n[E])&&P.get(F[E])===a&&(p[E]=a)}function qce(e){return e.__data__}function Hce(e,n){if(!arguments.length)return Array.from(this,qce);var o=n?Wce:Gce,c=this._parents,p=this._groups;typeof e!="function"&&(e=Uce(e));for(var y=p.length,w=new Array(y),E=new Array(y),a=new Array(y),P=0;P<y;++P){var D=c[P],L=p[P],F=L.length,$=Zce(e.call(D,D&&D.__data__,P,c)),H=$.length,q=E[P]=new Array(H),le=w[P]=new Array(H),ie=a[P]=new Array(F);o(D,L,q,le,ie,$,n);for(var te=0,se=0,be,Ee;te<H;++te)if(be=q[te]){for(te>=se&&(se=te+1);!(Ee=le[se])&&++se<H;);be._next=Ee||null}}return w=new Rs(w,c),w._enter=E,w._exit=a,w}function Zce(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xce(){return new Rs(this._exit||this._groups.map(Yj),this._parents)}function Yce(e,n,o){var c=this.enter(),p=this,y=this.exit();return typeof e=="function"?(c=e(c),c&&(c=c.selection())):c=c.append(e+""),n!=null&&(p=n(p),p&&(p=p.selection())),o==null?y.remove():o(y),c&&p?c.merge(p).order():p}function Kce(e){for(var n=e.selection?e.selection():e,o=this._groups,c=n._groups,p=o.length,y=c.length,w=Math.min(p,y),E=new Array(p),a=0;a<w;++a)for(var P=o[a],D=c[a],L=P.length,F=E[a]=new Array(L),$,H=0;H<L;++H)($=P[H]||D[H])&&(F[H]=$);for(;a<p;++a)E[a]=o[a];return new Rs(E,this._parents)}function Jce(){for(var e=this._groups,n=-1,o=e.length;++n<o;)for(var c=e[n],p=c.length-1,y=c[p],w;--p>=0;)(w=c[p])&&(y&&w.compareDocumentPosition(y)^4&&y.parentNode.insertBefore(w,y),y=w);return this}function Qce(e){e||(e=eue);function n(L,F){return L&&F?e(L.__data__,F.__data__):!L-!F}for(var o=this._groups,c=o.length,p=new Array(c),y=0;y<c;++y){for(var w=o[y],E=w.length,a=p[y]=new Array(E),P,D=0;D<E;++D)(P=w[D])&&(a[D]=P);a.sort(n)}return new Rs(p,this._parents).order()}function eue(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function tue(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function rue(){return Array.from(this)}function nue(){for(var e=this._groups,n=0,o=e.length;n<o;++n)for(var c=e[n],p=0,y=c.length;p<y;++p){var w=c[p];if(w)return w}return null}function iue(){let e=0;for(const n of this)++e;return e}function oue(){return!this.node()}function sue(e){for(var n=this._groups,o=0,c=n.length;o<c;++o)for(var p=n[o],y=0,w=p.length,E;y<w;++y)(E=p[y])&&e.call(E,E.__data__,y,p);return this}function aue(e){return function(){this.removeAttribute(e)}}function lue(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cue(e,n){return function(){this.setAttribute(e,n)}}function uue(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function hue(e,n){return function(){var o=n.apply(this,arguments);o==null?this.removeAttribute(e):this.setAttribute(e,o)}}function due(e,n){return function(){var o=n.apply(this,arguments);o==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,o)}}function fue(e,n){var o=Cb(e);if(arguments.length<2){var c=this.node();return o.local?c.getAttributeNS(o.space,o.local):c.getAttribute(o)}return this.each((n==null?o.local?lue:aue:typeof n=="function"?o.local?due:hue:o.local?uue:cue)(o,n))}function Kj(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pue(e){return function(){this.style.removeProperty(e)}}function mue(e,n,o){return function(){this.style.setProperty(e,n,o)}}function gue(e,n,o){return function(){var c=n.apply(this,arguments);c==null?this.style.removeProperty(e):this.style.setProperty(e,c,o)}}function _ue(e,n,o){return arguments.length>1?this.each((n==null?pue:typeof n=="function"?gue:mue)(e,n,o??"")):Ep(this.node(),e)}function Ep(e,n){return e.style.getPropertyValue(n)||Kj(e).getComputedStyle(e,null).getPropertyValue(n)}function yue(e){return function(){delete this[e]}}function vue(e,n){return function(){this[e]=n}}function xue(e,n){return function(){var o=n.apply(this,arguments);o==null?delete this[e]:this[e]=o}}function bue(e,n){return arguments.length>1?this.each((n==null?yue:typeof n=="function"?xue:vue)(e,n)):this.node()[e]}function Jj(e){return e.trim().split(/^|\s+/)}function hk(e){return e.classList||new Qj(e)}function Qj(e){this._node=e,this._names=Jj(e.getAttribute("class")||"")}Qj.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function e8(e,n){for(var o=hk(e),c=-1,p=n.length;++c<p;)o.add(n[c])}function t8(e,n){for(var o=hk(e),c=-1,p=n.length;++c<p;)o.remove(n[c])}function wue(e){return function(){e8(this,e)}}function Sue(e){return function(){t8(this,e)}}function Tue(e,n){return function(){(n.apply(this,arguments)?e8:t8)(this,e)}}function Eue(e,n){var o=Jj(e+"");if(arguments.length<2){for(var c=hk(this.node()),p=-1,y=o.length;++p<y;)if(!c.contains(o[p]))return!1;return!0}return this.each((typeof n=="function"?Tue:n?wue:Sue)(o,n))}function Cue(){this.textContent=""}function Mue(e){return function(){this.textContent=e}}function Aue(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function kue(e){return arguments.length?this.each(e==null?Cue:(typeof e=="function"?Aue:Mue)(e)):this.node().textContent}function Pue(){this.innerHTML=""}function Iue(e){return function(){this.innerHTML=e}}function zue(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function Rue(e){return arguments.length?this.each(e==null?Pue:(typeof e=="function"?zue:Iue)(e)):this.node().innerHTML}function Due(){this.nextSibling&&this.parentNode.appendChild(this)}function Lue(){return this.each(Due)}function Oue(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bue(){return this.each(Oue)}function Fue(e){var n=typeof e=="function"?e:qj(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Nue(){return null}function jue(e,n){var o=typeof e=="function"?e:qj(e),c=n==null?Nue:typeof n=="function"?n:uk(n);return this.select(function(){return this.insertBefore(o.apply(this,arguments),c.apply(this,arguments)||null)})}function Vue(){var e=this.parentNode;e&&e.removeChild(this)}function $ue(){return this.each(Vue)}function Uue(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Gue(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Wue(e){return this.select(e?Gue:Uue)}function que(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Hue(e){return function(n){e.call(this,n,this.__data__)}}function Zue(e){return e.trim().split(/^|\s+/).map(function(n){var o="",c=n.indexOf(".");return c>=0&&(o=n.slice(c+1),n=n.slice(0,c)),{type:n,name:o}})}function Xue(e){return function(){var n=this.__on;if(n){for(var o=0,c=-1,p=n.length,y;o<p;++o)y=n[o],(!e.type||y.type===e.type)&&y.name===e.name?this.removeEventListener(y.type,y.listener,y.options):n[++c]=y;++c?n.length=c:delete this.__on}}}function Yue(e,n,o){return function(){var c=this.__on,p,y=Hue(n);if(c){for(var w=0,E=c.length;w<E;++w)if((p=c[w]).type===e.type&&p.name===e.name){this.removeEventListener(p.type,p.listener,p.options),this.addEventListener(p.type,p.listener=y,p.options=o),p.value=n;return}}this.addEventListener(e.type,y,o),p={type:e.type,name:e.name,value:n,listener:y,options:o},c?c.push(p):this.__on=[p]}}function Kue(e,n,o){var c=Zue(e+""),p,y=c.length,w;if(arguments.length<2){var E=this.node().__on;if(E){for(var a=0,P=E.length,D;a<P;++a)for(p=0,D=E[a];p<y;++p)if((w=c[p]).type===D.type&&w.name===D.name)return D.value}return}for(E=n?Yue:Xue,p=0;p<y;++p)this.each(E(c[p],n,o));return this}function r8(e,n,o){var c=Kj(e),p=c.CustomEvent;typeof p=="function"?p=new p(n,o):(p=c.document.createEvent("Event"),o?(p.initEvent(n,o.bubbles,o.cancelable),p.detail=o.detail):p.initEvent(n,!1,!1)),e.dispatchEvent(p)}function Jue(e,n){return function(){return r8(this,e,n)}}function Que(e,n){return function(){return r8(this,e,n.apply(this,arguments))}}function ehe(e,n){return this.each((typeof n=="function"?Que:Jue)(e,n))}function*the(){for(var e=this._groups,n=0,o=e.length;n<o;++n)for(var c=e[n],p=0,y=c.length,w;p<y;++p)(w=c[p])&&(yield w)}var n8=[null];function Rs(e,n){this._groups=e,this._parents=n}function ay(){return new Rs([[document.documentElement]],n8)}function rhe(){return this}Rs.prototype=ay.prototype={constructor:Rs,select:Ace,selectAll:zce,selectChild:Oce,selectChildren:jce,filter:Vce,data:Hce,enter:$ce,exit:Xce,join:Yce,merge:Kce,selection:rhe,order:Jce,sort:Qce,call:tue,nodes:rue,node:nue,size:iue,empty:oue,each:sue,attr:fue,style:_ue,property:bue,classed:Eue,text:kue,html:Rue,raise:Lue,lower:Bue,append:Fue,insert:jue,remove:$ue,clone:Wue,datum:que,on:Kue,dispatch:ehe,[Symbol.iterator]:the};function Da(e){return typeof e=="string"?new Rs([[document.querySelector(e)]],[document.documentElement]):new Rs([[e]],n8)}function dk(e,n,o){e.prototype=n.prototype=o,o.constructor=e}function i8(e,n){var o=Object.create(e.prototype);for(var c in n)o[c]=n[c];return o}function ly(){}var V_=.7,b1=1/V_,hp="\\s*([+-]?\\d+)\\s*",$_="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Il="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nhe=/^#([0-9a-f]{3,8})$/,ihe=new RegExp(`^rgb\\(${hp},${hp},${hp}\\)$`),ohe=new RegExp(`^rgb\\(${Il},${Il},${Il}\\)$`),she=new RegExp(`^rgba\\(${hp},${hp},${hp},${$_}\\)$`),ahe=new RegExp(`^rgba\\(${Il},${Il},${Il},${$_}\\)$`),lhe=new RegExp(`^hsl\\(${$_},${Il},${Il}\\)$`),che=new RegExp(`^hsla\\(${$_},${Il},${Il},${$_}\\)$`),rL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dk(ly,cd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:nL,formatHex:nL,formatHex8:uhe,formatHsl:hhe,formatRgb:iL,toString:iL});function nL(){return this.rgb().formatHex()}function uhe(){return this.rgb().formatHex8()}function hhe(){return o8(this).formatHsl()}function iL(){return this.rgb().formatRgb()}function cd(e){var n,o;return e=(e+"").trim().toLowerCase(),(n=nhe.exec(e))?(o=n[1].length,n=parseInt(n[1],16),o===6?oL(n):o===3?new rs(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):o===8?Lv(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):o===4?Lv(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=ihe.exec(e))?new rs(n[1],n[2],n[3],1):(n=ohe.exec(e))?new rs(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=she.exec(e))?Lv(n[1],n[2],n[3],n[4]):(n=ahe.exec(e))?Lv(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=lhe.exec(e))?lL(n[1],n[2]/100,n[3]/100,1):(n=che.exec(e))?lL(n[1],n[2]/100,n[3]/100,n[4]):rL.hasOwnProperty(e)?oL(rL[e]):e==="transparent"?new rs(NaN,NaN,NaN,0):null}function oL(e){return new rs(e>>16&255,e>>8&255,e&255,1)}function Lv(e,n,o,c){return c<=0&&(e=n=o=NaN),new rs(e,n,o,c)}function dhe(e){return e instanceof ly||(e=cd(e)),e?(e=e.rgb(),new rs(e.r,e.g,e.b,e.opacity)):new rs}function ZC(e,n,o,c){return arguments.length===1?dhe(e):new rs(e,n,o,c??1)}function rs(e,n,o,c){this.r=+e,this.g=+n,this.b=+o,this.opacity=+c}dk(rs,ZC,i8(ly,{brighter(e){return e=e==null?b1:Math.pow(b1,e),new rs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?V_:Math.pow(V_,e),new rs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new rs(Qh(this.r),Qh(this.g),Qh(this.b),w1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sL,formatHex:sL,formatHex8:fhe,formatRgb:aL,toString:aL}));function sL(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}`}function fhe(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}${Uh((isNaN(this.opacity)?1:this.opacity)*255)}`}function aL(){const e=w1(this.opacity);return`${e===1?"rgb(":"rgba("}${Qh(this.r)}, ${Qh(this.g)}, ${Qh(this.b)}${e===1?")":`, ${e})`}`}function w1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Uh(e){return e=Qh(e),(e<16?"0":"")+e.toString(16)}function lL(e,n,o,c){return c<=0?e=n=o=NaN:o<=0||o>=1?e=n=NaN:n<=0&&(e=NaN),new La(e,n,o,c)}function o8(e){if(e instanceof La)return new La(e.h,e.s,e.l,e.opacity);if(e instanceof ly||(e=cd(e)),!e)return new La;if(e instanceof La)return e;e=e.rgb();var n=e.r/255,o=e.g/255,c=e.b/255,p=Math.min(n,o,c),y=Math.max(n,o,c),w=NaN,E=y-p,a=(y+p)/2;return E?(n===y?w=(o-c)/E+(o<c)*6:o===y?w=(c-n)/E+2:w=(n-o)/E+4,E/=a<.5?y+p:2-y-p,w*=60):E=a>0&&a<1?0:w,new La(w,E,a,e.opacity)}function phe(e,n,o,c){return arguments.length===1?o8(e):new La(e,n,o,c??1)}function La(e,n,o,c){this.h=+e,this.s=+n,this.l=+o,this.opacity=+c}dk(La,phe,i8(ly,{brighter(e){return e=e==null?b1:Math.pow(b1,e),new La(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?V_:Math.pow(V_,e),new La(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,o=this.l,c=o+(o<.5?o:1-o)*n,p=2*o-c;return new rs(oE(e>=240?e-240:e+120,p,c),oE(e,p,c),oE(e<120?e+240:e-120,p,c),this.opacity)},clamp(){return new La(cL(this.h),Ov(this.s),Ov(this.l),w1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=w1(this.opacity);return`${e===1?"hsl(":"hsla("}${cL(this.h)}, ${Ov(this.s)*100}%, ${Ov(this.l)*100}%${e===1?")":`, ${e})`}`}}));function cL(e){return e=(e||0)%360,e<0?e+360:e}function Ov(e){return Math.max(0,Math.min(1,e||0))}function oE(e,n,o){return(e<60?n+(o-n)*e/60:e<180?o:e<240?n+(o-n)*(240-e)/60:n)*255}const fk=e=>()=>e;function mhe(e,n){return function(o){return e+o*n}}function ghe(e,n,o){return e=Math.pow(e,o),n=Math.pow(n,o)-e,o=1/o,function(c){return Math.pow(e+c*n,o)}}function _he(e){return(e=+e)==1?s8:function(n,o){return o-n?ghe(n,o,e):fk(isNaN(n)?o:n)}}function s8(e,n){var o=n-e;return o?mhe(e,o):fk(isNaN(e)?n:e)}const S1=function e(n){var o=_he(n);function c(p,y){var w=o((p=ZC(p)).r,(y=ZC(y)).r),E=o(p.g,y.g),a=o(p.b,y.b),P=s8(p.opacity,y.opacity);return function(D){return p.r=w(D),p.g=E(D),p.b=a(D),p.opacity=P(D),p+""}}return c.gamma=e,c}(1);function yhe(e,n){n||(n=[]);var o=e?Math.min(n.length,e.length):0,c=n.slice(),p;return function(y){for(p=0;p<o;++p)c[p]=e[p]*(1-y)+n[p]*y;return c}}function vhe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xhe(e,n){var o=n?n.length:0,c=e?Math.min(o,e.length):0,p=new Array(c),y=new Array(o),w;for(w=0;w<c;++w)p[w]=pk(e[w],n[w]);for(;w<o;++w)y[w]=n[w];return function(E){for(w=0;w<c;++w)y[w]=p[w](E);return y}}function bhe(e,n){var o=new Date;return e=+e,n=+n,function(c){return o.setTime(e*(1-c)+n*c),o}}function za(e,n){return e=+e,n=+n,function(o){return e*(1-o)+n*o}}function whe(e,n){var o={},c={},p;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(p in n)p in e?o[p]=pk(e[p],n[p]):c[p]=n[p];return function(y){for(p in o)c[p]=o[p](y);return c}}var XC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sE=new RegExp(XC.source,"g");function She(e){return function(){return e}}function The(e){return function(n){return e(n)+""}}function a8(e,n){var o=XC.lastIndex=sE.lastIndex=0,c,p,y,w=-1,E=[],a=[];for(e=e+"",n=n+"";(c=XC.exec(e))&&(p=sE.exec(n));)(y=p.index)>o&&(y=n.slice(o,y),E[w]?E[w]+=y:E[++w]=y),(c=c[0])===(p=p[0])?E[w]?E[w]+=p:E[++w]=p:(E[++w]=null,a.push({i:w,x:za(c,p)})),o=sE.lastIndex;return o<n.length&&(y=n.slice(o),E[w]?E[w]+=y:E[++w]=y),E.length<2?a[0]?The(a[0].x):She(n):(n=a.length,function(P){for(var D=0,L;D<n;++D)E[(L=a[D]).i]=L.x(P);return E.join("")})}function pk(e,n){var o=typeof n,c;return n==null||o==="boolean"?fk(n):(o==="number"?za:o==="string"?(c=cd(n))?(n=c,S1):a8:n instanceof cd?S1:n instanceof Date?bhe:vhe(n)?yhe:Array.isArray(n)?xhe:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?whe:za)(e,n)}function Ehe(e,n){return e=+e,n=+n,function(o){return Math.round(e*(1-o)+n*o)}}var uL=180/Math.PI,YC={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function l8(e,n,o,c,p,y){var w,E,a;return(w=Math.sqrt(e*e+n*n))&&(e/=w,n/=w),(a=e*o+n*c)&&(o-=e*a,c-=n*a),(E=Math.sqrt(o*o+c*c))&&(o/=E,c/=E,a/=E),e*c<n*o&&(e=-e,n=-n,a=-a,w=-w),{translateX:p,translateY:y,rotate:Math.atan2(n,e)*uL,skewX:Math.atan(a)*uL,scaleX:w,scaleY:E}}var Bv;function Che(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?YC:l8(n.a,n.b,n.c,n.d,n.e,n.f)}function Mhe(e){return e==null||(Bv||(Bv=document.createElementNS("http://www.w3.org/2000/svg","g")),Bv.setAttribute("transform",e),!(e=Bv.transform.baseVal.consolidate()))?YC:(e=e.matrix,l8(e.a,e.b,e.c,e.d,e.e,e.f))}function c8(e,n,o,c){function p(P){return P.length?P.pop()+" ":""}function y(P,D,L,F,$,H){if(P!==L||D!==F){var q=$.push("translate(",null,n,null,o);H.push({i:q-4,x:za(P,L)},{i:q-2,x:za(D,F)})}else(L||F)&&$.push("translate("+L+n+F+o)}function w(P,D,L,F){P!==D?(P-D>180?D+=360:D-P>180&&(P+=360),F.push({i:L.push(p(L)+"rotate(",null,c)-2,x:za(P,D)})):D&&L.push(p(L)+"rotate("+D+c)}function E(P,D,L,F){P!==D?F.push({i:L.push(p(L)+"skewX(",null,c)-2,x:za(P,D)}):D&&L.push(p(L)+"skewX("+D+c)}function a(P,D,L,F,$,H){if(P!==L||D!==F){var q=$.push(p($)+"scale(",null,",",null,")");H.push({i:q-4,x:za(P,L)},{i:q-2,x:za(D,F)})}else(L!==1||F!==1)&&$.push(p($)+"scale("+L+","+F+")")}return function(P,D){var L=[],F=[];return P=e(P),D=e(D),y(P.translateX,P.translateY,D.translateX,D.translateY,L,F),w(P.rotate,D.rotate,L,F),E(P.skewX,D.skewX,L,F),a(P.scaleX,P.scaleY,D.scaleX,D.scaleY,L,F),P=D=null,function($){for(var H=-1,q=F.length,le;++H<q;)L[(le=F[H]).i]=le.x($);return L.join("")}}}var Ahe=c8(Che,"px, ","px)","deg)"),khe=c8(Mhe,", ",")",")"),Cp=0,Bg=0,wg=0,u8=1e3,T1,Fg,E1=0,ud=0,Mb=0,U_=typeof performance=="object"&&performance.now?performance:Date,h8=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function mk(){return ud||(h8(Phe),ud=U_.now()+Mb)}function Phe(){ud=0}function C1(){this._call=this._time=this._next=null}C1.prototype=d8.prototype={constructor:C1,restart:function(e,n,o){if(typeof e!="function")throw new TypeError("callback is not a function");o=(o==null?mk():+o)+(n==null?0:+n),!this._next&&Fg!==this&&(Fg?Fg._next=this:T1=this,Fg=this),this._call=e,this._time=o,KC()},stop:function(){this._call&&(this._call=null,this._time=1/0,KC())}};function d8(e,n,o){var c=new C1;return c.restart(e,n,o),c}function Ihe(){mk(),++Cp;for(var e=T1,n;e;)(n=ud-e._time)>=0&&e._call.call(void 0,n),e=e._next;--Cp}function hL(){ud=(E1=U_.now())+Mb,Cp=Bg=0;try{Ihe()}finally{Cp=0,Rhe(),ud=0}}function zhe(){var e=U_.now(),n=e-E1;n>u8&&(Mb-=n,E1=e)}function Rhe(){for(var e,n=T1,o,c=1/0;n;)n._call?(c>n._time&&(c=n._time),e=n,n=n._next):(o=n._next,n._next=null,n=e?e._next=o:T1=o);Fg=e,KC(c)}function KC(e){if(!Cp){Bg&&(Bg=clearTimeout(Bg));var n=e-ud;n>24?(e<1/0&&(Bg=setTimeout(hL,e-U_.now()-Mb)),wg&&(wg=clearInterval(wg))):(wg||(E1=U_.now(),wg=setInterval(zhe,u8)),Cp=1,h8(hL))}}function dL(e,n,o){var c=new C1;return n=n==null?0:+n,c.restart(p=>{c.stop(),e(p+n)},n,o),c}var Dhe=Wj("start","end","cancel","interrupt"),Lhe=[],f8=0,fL=1,JC=2,wx=3,pL=4,QC=5,Sx=6;function Ab(e,n,o,c,p,y){var w=e.__transition;if(!w)e.__transition={};else if(o in w)return;Ohe(e,o,{name:n,index:c,group:p,on:Dhe,tween:Lhe,time:y.time,delay:y.delay,duration:y.duration,ease:y.ease,timer:null,state:f8})}function gk(e,n){var o=Na(e,n);if(o.state>f8)throw new Error("too late; already scheduled");return o}function Rl(e,n){var o=Na(e,n);if(o.state>wx)throw new Error("too late; already running");return o}function Na(e,n){var o=e.__transition;if(!o||!(o=o[n]))throw new Error("transition not found");return o}function Ohe(e,n,o){var c=e.__transition,p;c[n]=o,o.timer=d8(y,0,o.time);function y(P){o.state=fL,o.timer.restart(w,o.delay,o.time),o.delay<=P&&w(P-o.delay)}function w(P){var D,L,F,$;if(o.state!==fL)return a();for(D in c)if($=c[D],$.name===o.name){if($.state===wx)return dL(w);$.state===pL?($.state=Sx,$.timer.stop(),$.on.call("interrupt",e,e.__data__,$.index,$.group),delete c[D]):+D<n&&($.state=Sx,$.timer.stop(),$.on.call("cancel",e,e.__data__,$.index,$.group),delete c[D])}if(dL(function(){o.state===wx&&(o.state=pL,o.timer.restart(E,o.delay,o.time),E(P))}),o.state=JC,o.on.call("start",e,e.__data__,o.index,o.group),o.state===JC){for(o.state=wx,p=new Array(F=o.tween.length),D=0,L=-1;D<F;++D)($=o.tween[D].value.call(e,e.__data__,o.index,o.group))&&(p[++L]=$);p.length=L+1}}function E(P){for(var D=P<o.duration?o.ease.call(null,P/o.duration):(o.timer.restart(a),o.state=QC,1),L=-1,F=p.length;++L<F;)p[L].call(e,D);o.state===QC&&(o.on.call("end",e,e.__data__,o.index,o.group),a())}function a(){o.state=Sx,o.timer.stop(),delete c[n];for(var P in c)return;delete e.__transition}}function Bhe(e,n){var o=e.__transition,c,p,y=!0,w;if(o){n=n==null?null:n+"";for(w in o){if((c=o[w]).name!==n){y=!1;continue}p=c.state>JC&&c.state<QC,c.state=Sx,c.timer.stop(),c.on.call(p?"interrupt":"cancel",e,e.__data__,c.index,c.group),delete o[w]}y&&delete e.__transition}}function Fhe(e){return this.each(function(){Bhe(this,e)})}function Nhe(e,n){var o,c;return function(){var p=Rl(this,e),y=p.tween;if(y!==o){c=o=y;for(var w=0,E=c.length;w<E;++w)if(c[w].name===n){c=c.slice(),c.splice(w,1);break}}p.tween=c}}function jhe(e,n,o){var c,p;if(typeof o!="function")throw new Error;return function(){var y=Rl(this,e),w=y.tween;if(w!==c){p=(c=w).slice();for(var E={name:n,value:o},a=0,P=p.length;a<P;++a)if(p[a].name===n){p[a]=E;break}a===P&&p.push(E)}y.tween=p}}function Vhe(e,n){var o=this._id;if(e+="",arguments.length<2){for(var c=Na(this.node(),o).tween,p=0,y=c.length,w;p<y;++p)if((w=c[p]).name===e)return w.value;return null}return this.each((n==null?Nhe:jhe)(o,e,n))}function _k(e,n,o){var c=e._id;return e.each(function(){var p=Rl(this,c);(p.value||(p.value={}))[n]=o.apply(this,arguments)}),function(p){return Na(p,c).value[n]}}function p8(e,n){var o;return(typeof n=="number"?za:n instanceof cd?S1:(o=cd(n))?(n=o,S1):a8)(e,n)}function $he(e){return function(){this.removeAttribute(e)}}function Uhe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ghe(e,n,o){var c,p=o+"",y;return function(){var w=this.getAttribute(e);return w===p?null:w===c?y:y=n(c=w,o)}}function Whe(e,n,o){var c,p=o+"",y;return function(){var w=this.getAttributeNS(e.space,e.local);return w===p?null:w===c?y:y=n(c=w,o)}}function qhe(e,n,o){var c,p,y;return function(){var w,E=o(this),a;return E==null?void this.removeAttribute(e):(w=this.getAttribute(e),a=E+"",w===a?null:w===c&&a===p?y:(p=a,y=n(c=w,E)))}}function Hhe(e,n,o){var c,p,y;return function(){var w,E=o(this),a;return E==null?void this.removeAttributeNS(e.space,e.local):(w=this.getAttributeNS(e.space,e.local),a=E+"",w===a?null:w===c&&a===p?y:(p=a,y=n(c=w,E)))}}function Zhe(e,n){var o=Cb(e),c=o==="transform"?khe:p8;return this.attrTween(e,typeof n=="function"?(o.local?Hhe:qhe)(o,c,_k(this,"attr."+e,n)):n==null?(o.local?Uhe:$he)(o):(o.local?Whe:Ghe)(o,c,n))}function Xhe(e,n){return function(o){this.setAttribute(e,n.call(this,o))}}function Yhe(e,n){return function(o){this.setAttributeNS(e.space,e.local,n.call(this,o))}}function Khe(e,n){var o,c;function p(){var y=n.apply(this,arguments);return y!==c&&(o=(c=y)&&Yhe(e,y)),o}return p._value=n,p}function Jhe(e,n){var o,c;function p(){var y=n.apply(this,arguments);return y!==c&&(o=(c=y)&&Xhe(e,y)),o}return p._value=n,p}function Qhe(e,n){var o="attr."+e;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;var c=Cb(e);return this.tween(o,(c.local?Khe:Jhe)(c,n))}function ede(e,n){return function(){gk(this,e).delay=+n.apply(this,arguments)}}function tde(e,n){return n=+n,function(){gk(this,e).delay=n}}function rde(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?ede:tde)(n,e)):Na(this.node(),n).delay}function nde(e,n){return function(){Rl(this,e).duration=+n.apply(this,arguments)}}function ide(e,n){return n=+n,function(){Rl(this,e).duration=n}}function ode(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?nde:ide)(n,e)):Na(this.node(),n).duration}function sde(e,n){if(typeof n!="function")throw new Error;return function(){Rl(this,e).ease=n}}function ade(e){var n=this._id;return arguments.length?this.each(sde(n,e)):Na(this.node(),n).ease}function lde(e,n){return function(){var o=n.apply(this,arguments);if(typeof o!="function")throw new Error;Rl(this,e).ease=o}}function cde(e){if(typeof e!="function")throw new Error;return this.each(lde(this._id,e))}function ude(e){typeof e!="function"&&(e=Zj(e));for(var n=this._groups,o=n.length,c=new Array(o),p=0;p<o;++p)for(var y=n[p],w=y.length,E=c[p]=[],a,P=0;P<w;++P)(a=y[P])&&e.call(a,a.__data__,P,y)&&E.push(a);return new Rc(c,this._parents,this._name,this._id)}function hde(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,o=e._groups,c=n.length,p=o.length,y=Math.min(c,p),w=new Array(c),E=0;E<y;++E)for(var a=n[E],P=o[E],D=a.length,L=w[E]=new Array(D),F,$=0;$<D;++$)(F=a[$]||P[$])&&(L[$]=F);for(;E<c;++E)w[E]=n[E];return new Rc(w,this._parents,this._name,this._id)}function dde(e){return(e+"").trim().split(/^|\s+/).every(function(n){var o=n.indexOf(".");return o>=0&&(n=n.slice(0,o)),!n||n==="start"})}function fde(e,n,o){var c,p,y=dde(n)?gk:Rl;return function(){var w=y(this,e),E=w.on;E!==c&&(p=(c=E).copy()).on(n,o),w.on=p}}function pde(e,n){var o=this._id;return arguments.length<2?Na(this.node(),o).on.on(e):this.each(fde(o,e,n))}function mde(e){return function(){var n=this.parentNode;for(var o in this.__transition)if(+o!==e)return;n&&n.removeChild(this)}}function gde(){return this.on("end.remove",mde(this._id))}function _de(e){var n=this._name,o=this._id;typeof e!="function"&&(e=uk(e));for(var c=this._groups,p=c.length,y=new Array(p),w=0;w<p;++w)for(var E=c[w],a=E.length,P=y[w]=new Array(a),D,L,F=0;F<a;++F)(D=E[F])&&(L=e.call(D,D.__data__,F,E))&&("__data__"in D&&(L.__data__=D.__data__),P[F]=L,Ab(P[F],n,o,F,P,Na(D,o)));return new Rc(y,this._parents,n,o)}function yde(e){var n=this._name,o=this._id;typeof e!="function"&&(e=Hj(e));for(var c=this._groups,p=c.length,y=[],w=[],E=0;E<p;++E)for(var a=c[E],P=a.length,D,L=0;L<P;++L)if(D=a[L]){for(var F=e.call(D,D.__data__,L,a),$,H=Na(D,o),q=0,le=F.length;q<le;++q)($=F[q])&&Ab($,n,o,q,F,H);y.push(F),w.push(D)}return new Rc(y,w,n,o)}var vde=ay.prototype.constructor;function xde(){return new vde(this._groups,this._parents)}function bde(e,n){var o,c,p;return function(){var y=Ep(this,e),w=(this.style.removeProperty(e),Ep(this,e));return y===w?null:y===o&&w===c?p:p=n(o=y,c=w)}}function m8(e){return function(){this.style.removeProperty(e)}}function wde(e,n,o){var c,p=o+"",y;return function(){var w=Ep(this,e);return w===p?null:w===c?y:y=n(c=w,o)}}function Sde(e,n,o){var c,p,y;return function(){var w=Ep(this,e),E=o(this),a=E+"";return E==null&&(a=E=(this.style.removeProperty(e),Ep(this,e))),w===a?null:w===c&&a===p?y:(p=a,y=n(c=w,E))}}function Tde(e,n){var o,c,p,y="style."+n,w="end."+y,E;return function(){var a=Rl(this,e),P=a.on,D=a.value[y]==null?E||(E=m8(n)):void 0;(P!==o||p!==D)&&(c=(o=P).copy()).on(w,p=D),a.on=c}}function Ede(e,n,o){var c=(e+="")=="transform"?Ahe:p8;return n==null?this.styleTween(e,bde(e,c)).on("end.style."+e,m8(e)):typeof n=="function"?this.styleTween(e,Sde(e,c,_k(this,"style."+e,n))).each(Tde(this._id,e)):this.styleTween(e,wde(e,c,n),o).on("end.style."+e,null)}function Cde(e,n,o){return function(c){this.style.setProperty(e,n.call(this,c),o)}}function Mde(e,n,o){var c,p;function y(){var w=n.apply(this,arguments);return w!==p&&(c=(p=w)&&Cde(e,w,o)),c}return y._value=n,y}function Ade(e,n,o){var c="style."+(e+="");if(arguments.length<2)return(c=this.tween(c))&&c._value;if(n==null)return this.tween(c,null);if(typeof n!="function")throw new Error;return this.tween(c,Mde(e,n,o??""))}function kde(e){return function(){this.textContent=e}}function Pde(e){return function(){var n=e(this);this.textContent=n??""}}function Ide(e){return this.tween("text",typeof e=="function"?Pde(_k(this,"text",e)):kde(e==null?"":e+""))}function zde(e){return function(n){this.textContent=e.call(this,n)}}function Rde(e){var n,o;function c(){var p=e.apply(this,arguments);return p!==o&&(n=(o=p)&&zde(p)),n}return c._value=e,c}function Dde(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,Rde(e))}function Lde(){for(var e=this._name,n=this._id,o=g8(),c=this._groups,p=c.length,y=0;y<p;++y)for(var w=c[y],E=w.length,a,P=0;P<E;++P)if(a=w[P]){var D=Na(a,n);Ab(a,e,o,P,w,{time:D.time+D.delay+D.duration,delay:0,duration:D.duration,ease:D.ease})}return new Rc(c,this._parents,e,o)}function Ode(){var e,n,o=this,c=o._id,p=o.size();return new Promise(function(y,w){var E={value:w},a={value:function(){--p===0&&y()}};o.each(function(){var P=Rl(this,c),D=P.on;D!==e&&(n=(e=D).copy(),n._.cancel.push(E),n._.interrupt.push(E),n._.end.push(a)),P.on=n}),p===0&&y()})}var Bde=0;function Rc(e,n,o,c){this._groups=e,this._parents=n,this._name=o,this._id=c}function g8(){return++Bde}var hc=ay.prototype;Rc.prototype={constructor:Rc,select:_de,selectAll:yde,selectChild:hc.selectChild,selectChildren:hc.selectChildren,filter:ude,merge:hde,selection:xde,transition:Lde,call:hc.call,nodes:hc.nodes,node:hc.node,size:hc.size,empty:hc.empty,each:hc.each,on:pde,attr:Zhe,attrTween:Qhe,style:Ede,styleTween:Ade,text:Ide,textTween:Dde,remove:gde,tween:Vhe,delay:rde,duration:ode,ease:ade,easeVarying:cde,end:Ode,[Symbol.iterator]:hc[Symbol.iterator]};function Fde(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Nde={time:null,delay:0,duration:250,ease:Fde};function jde(e,n){for(var o;!(o=e.__transition)||!(o=o[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return o}function Vde(e){var n,o;e instanceof Rc?(n=e._id,e=e._name):(n=g8(),(o=Nde).time=mk(),e=e==null?null:e+"");for(var c=this._groups,p=c.length,y=0;y<p;++y)for(var w=c[y],E=w.length,a,P=0;P<E;++P)(a=w[P])&&Ab(a,e,n,P,w,o||jde(a,n));return new Rc(c,this._parents,e,n)}ay.prototype.interrupt=Fhe;ay.prototype.transition=Vde;const eM=Math.PI,tM=2*eM,Lh=1e-6,$de=tM-Lh;function _8(e){this._+=e[0];for(let n=1,o=e.length;n<o;++n)this._+=arguments[n]+e[n]}function Ude(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return _8;const o=10**n;return function(c){this._+=c[0];for(let p=1,y=c.length;p<y;++p)this._+=Math.round(arguments[p]*o)/o+c[p]}}class Gde{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?_8:Ude(n)}moveTo(n,o){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+o}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,o){this._append`L${this._x1=+n},${this._y1=+o}`}quadraticCurveTo(n,o,c,p){this._append`Q${+n},${+o},${this._x1=+c},${this._y1=+p}`}bezierCurveTo(n,o,c,p,y,w){this._append`C${+n},${+o},${+c},${+p},${this._x1=+y},${this._y1=+w}`}arcTo(n,o,c,p,y){if(n=+n,o=+o,c=+c,p=+p,y=+y,y<0)throw new Error(`negative radius: ${y}`);let w=this._x1,E=this._y1,a=c-n,P=p-o,D=w-n,L=E-o,F=D*D+L*L;if(this._x1===null)this._append`M${this._x1=n},${this._y1=o}`;else if(F>Lh)if(!(Math.abs(L*a-P*D)>Lh)||!y)this._append`L${this._x1=n},${this._y1=o}`;else{let $=c-w,H=p-E,q=a*a+P*P,le=$*$+H*H,ie=Math.sqrt(q),te=Math.sqrt(F),se=y*Math.tan((eM-Math.acos((q+F-le)/(2*ie*te)))/2),be=se/te,Ee=se/ie;Math.abs(be-1)>Lh&&this._append`L${n+be*D},${o+be*L}`,this._append`A${y},${y},0,0,${+(L*$>D*H)},${this._x1=n+Ee*a},${this._y1=o+Ee*P}`}}arc(n,o,c,p,y,w){if(n=+n,o=+o,c=+c,w=!!w,c<0)throw new Error(`negative radius: ${c}`);let E=c*Math.cos(p),a=c*Math.sin(p),P=n+E,D=o+a,L=1^w,F=w?p-y:y-p;this._x1===null?this._append`M${P},${D}`:(Math.abs(this._x1-P)>Lh||Math.abs(this._y1-D)>Lh)&&this._append`L${P},${D}`,c&&(F<0&&(F=F%tM+tM),F>$de?this._append`A${c},${c},0,1,${L},${n-E},${o-a}A${c},${c},0,1,${L},${this._x1=P},${this._y1=D}`:F>Lh&&this._append`A${c},${c},0,${+(F>=eM)},${L},${this._x1=n+c*Math.cos(y)},${this._y1=o+c*Math.sin(y)}`)}rect(n,o,c,p){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+o}h${c=+c}v${+p}h${-c}Z`}toString(){return this._}}function Wde(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function M1(e,n){if((o=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var o,c=e.slice(0,o);return[c.length>1?c[0]+c.slice(2):c,+e.slice(o+1)]}function Mp(e){return e=M1(Math.abs(e)),e?e[1]:NaN}function qde(e,n){return function(o,c){for(var p=o.length,y=[],w=0,E=e[0],a=0;p>0&&E>0&&(a+E+1>c&&(E=Math.max(1,c-a)),y.push(o.substring(p-=E,p+E)),!((a+=E+1)>c));)E=e[w=(w+1)%e.length];return y.reverse().join(n)}}function Hde(e){return function(n){return n.replace(/[0-9]/g,function(o){return e[+o]})}}var Zde=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function A1(e){if(!(n=Zde.exec(e)))throw new Error("invalid format: "+e);var n;return new yk({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}A1.prototype=yk.prototype;function yk(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Xde(e){e:for(var n=e.length,o=1,c=-1,p;o<n;++o)switch(e[o]){case".":c=p=o;break;case"0":c===0&&(c=o),p=o;break;default:if(!+e[o])break e;c>0&&(c=0);break}return c>0?e.slice(0,c)+e.slice(p+1):e}var y8;function Yde(e,n){var o=M1(e,n);if(!o)return e+"";var c=o[0],p=o[1],y=p-(y8=Math.max(-8,Math.min(8,Math.floor(p/3)))*3)+1,w=c.length;return y===w?c:y>w?c+new Array(y-w+1).join("0"):y>0?c.slice(0,y)+"."+c.slice(y):"0."+new Array(1-y).join("0")+M1(e,Math.max(0,n+y-1))[0]}function mL(e,n){var o=M1(e,n);if(!o)return e+"";var c=o[0],p=o[1];return p<0?"0."+new Array(-p).join("0")+c:c.length>p+1?c.slice(0,p+1)+"."+c.slice(p+1):c+new Array(p-c.length+2).join("0")}const gL={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Wde,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>mL(e*100,n),r:mL,s:Yde,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function _L(e){return e}var yL=Array.prototype.map,vL=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Kde(e){var n=e.grouping===void 0||e.thousands===void 0?_L:qde(yL.call(e.grouping,Number),e.thousands+""),o=e.currency===void 0?"":e.currency[0]+"",c=e.currency===void 0?"":e.currency[1]+"",p=e.decimal===void 0?".":e.decimal+"",y=e.numerals===void 0?_L:Hde(yL.call(e.numerals,String)),w=e.percent===void 0?"%":e.percent+"",E=e.minus===void 0?"":e.minus+"",a=e.nan===void 0?"NaN":e.nan+"";function P(L){L=A1(L);var F=L.fill,$=L.align,H=L.sign,q=L.symbol,le=L.zero,ie=L.width,te=L.comma,se=L.precision,be=L.trim,Ee=L.type;Ee==="n"?(te=!0,Ee="g"):gL[Ee]||(se===void 0&&(se=12),be=!0,Ee="g"),(le||F==="0"&&$==="=")&&(le=!0,F="0",$="=");var je=q==="$"?o:q==="#"&&/[boxX]/.test(Ee)?"0"+Ee.toLowerCase():"",Be=q==="$"?c:/[%p]/.test(Ee)?w:"",Ze=gL[Ee],ht=/[defgprs%]/.test(Ee);se=se===void 0?6:/[gprs]/.test(Ee)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function Pe(Et){var or=je,st=Be,ar,Bn,Mr;if(Ee==="c")st=Ze(Et)+st,Et="";else{Et=+Et;var xn=Et<0||1/Et<0;if(Et=isNaN(Et)?a:Ze(Math.abs(Et),se),be&&(Et=Xde(Et)),xn&&+Et==0&&H!=="+"&&(xn=!1),or=(xn?H==="("?H:E:H==="-"||H==="("?"":H)+or,st=(Ee==="s"?vL[8+y8/3]:"")+st+(xn&&H==="("?")":""),ht){for(ar=-1,Bn=Et.length;++ar<Bn;)if(Mr=Et.charCodeAt(ar),48>Mr||Mr>57){st=(Mr===46?p+Et.slice(ar+1):Et.slice(ar))+st,Et=Et.slice(0,ar);break}}}te&&!le&&(Et=n(Et,1/0));var Ot=or.length+Et.length+st.length,ct=Ot<ie?new Array(ie-Ot+1).join(F):"";switch(te&&le&&(Et=n(ct+Et,ct.length?ie-st.length:1/0),ct=""),$){case"<":Et=or+Et+st+ct;break;case"=":Et=or+ct+Et+st;break;case"^":Et=ct.slice(0,Ot=ct.length>>1)+or+Et+st+ct.slice(Ot);break;default:Et=ct+or+Et+st;break}return y(Et)}return Pe.toString=function(){return L+""},Pe}function D(L,F){var $=P((L=A1(L),L.type="f",L)),H=Math.max(-8,Math.min(8,Math.floor(Mp(F)/3)))*3,q=Math.pow(10,-H),le=vL[8+H/3];return function(ie){return $(q*ie)+le}}return{format:P,formatPrefix:D}}var Fv,v8,x8;Jde({thousands:",",grouping:[3],currency:["$",""]});function Jde(e){return Fv=Kde(e),v8=Fv.format,x8=Fv.formatPrefix,Fv}function Qde(e){return Math.max(0,-Mp(Math.abs(e)))}function efe(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Mp(n)/3)))*3-Mp(Math.abs(e)))}function tfe(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,Mp(n)-Mp(e))+1}function rfe(e){var n=0,o=e.children,c=o&&o.length;if(!c)n=1;else for(;--c>=0;)n+=o[c].value;e.value=n}function nfe(){return this.eachAfter(rfe)}function ife(e,n){let o=-1;for(const c of this)e.call(n,c,++o,this);return this}function ofe(e,n){for(var o=this,c=[o],p,y,w=-1;o=c.pop();)if(e.call(n,o,++w,this),p=o.children)for(y=p.length-1;y>=0;--y)c.push(p[y]);return this}function sfe(e,n){for(var o=this,c=[o],p=[],y,w,E,a=-1;o=c.pop();)if(p.push(o),y=o.children)for(w=0,E=y.length;w<E;++w)c.push(y[w]);for(;o=p.pop();)e.call(n,o,++a,this);return this}function afe(e,n){let o=-1;for(const c of this)if(e.call(n,c,++o,this))return c}function lfe(e){return this.eachAfter(function(n){for(var o=+e(n.data)||0,c=n.children,p=c&&c.length;--p>=0;)o+=c[p].value;n.value=o})}function cfe(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function ufe(e){for(var n=this,o=hfe(n,e),c=[n];n!==o;)n=n.parent,c.push(n);for(var p=c.length;e!==o;)c.splice(p,0,e),e=e.parent;return c}function hfe(e,n){if(e===n)return e;var o=e.ancestors(),c=n.ancestors(),p=null;for(e=o.pop(),n=c.pop();e===n;)p=e,e=o.pop(),n=c.pop();return p}function dfe(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function ffe(){return Array.from(this)}function pfe(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function mfe(){var e=this,n=[];return e.each(function(o){o!==e&&n.push({source:o.parent,target:o})}),n}function*gfe(){var e=this,n,o=[e],c,p,y;do for(n=o.reverse(),o=[];e=n.pop();)if(yield e,c=e.children)for(p=0,y=c.length;p<y;++p)o.push(c[p]);while(o.length)}function vk(e,n){e instanceof Map?(e=[void 0,e],n===void 0&&(n=vfe)):n===void 0&&(n=yfe);for(var o=new k1(e),c,p=[o],y,w,E,a;c=p.pop();)if((w=n(c.data))&&(a=(w=Array.from(w)).length))for(c.children=w,E=a-1;E>=0;--E)p.push(y=w[E]=new k1(w[E])),y.parent=c,y.depth=c.depth+1;return o.eachBefore(bfe)}function _fe(){return vk(this).eachBefore(xfe)}function yfe(e){return e.children}function vfe(e){return Array.isArray(e)?e[1]:null}function xfe(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function bfe(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function k1(e){this.data=e,this.depth=this.height=0,this.parent=null}k1.prototype=vk.prototype={constructor:k1,count:nfe,each:ife,eachAfter:sfe,eachBefore:ofe,find:afe,sum:lfe,sort:cfe,path:ufe,ancestors:dfe,descendants:ffe,leaves:pfe,links:mfe,copy:_fe,[Symbol.iterator]:gfe};function wfe(e){return e==null?null:Sfe(e)}function Sfe(e){if(typeof e!="function")throw new Error;return e}function xL(){return 0}function Tfe(e){return function(){return e}}const Efe=1664525,Cfe=1013904223,bL=4294967296;function Mfe(){let e=1;return()=>(e=(Efe*e+Cfe)%bL)/bL}function Afe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kfe(e,n){let o=e.length,c,p;for(;o;)p=n()*o--|0,c=e[o],e[o]=e[p],e[p]=c;return e}function Pfe(e,n){for(var o=0,c=(e=kfe(Array.from(e),n)).length,p=[],y,w;o<c;)y=e[o],w&&b8(w,y)?++o:(w=zfe(p=Ife(p,y)),o=0);return w}function Ife(e,n){var o,c;if(aE(n,e))return[n];for(o=0;o<e.length;++o)if(Nv(n,e[o])&&aE(Ng(e[o],n),e))return[e[o],n];for(o=0;o<e.length-1;++o)for(c=o+1;c<e.length;++c)if(Nv(Ng(e[o],e[c]),n)&&Nv(Ng(e[o],n),e[c])&&Nv(Ng(e[c],n),e[o])&&aE(w8(e[o],e[c],n),e))return[e[o],e[c],n];throw new Error}function Nv(e,n){var o=e.r-n.r,c=n.x-e.x,p=n.y-e.y;return o<0||o*o<c*c+p*p}function b8(e,n){var o=e.r-n.r+Math.max(e.r,n.r,1)*1e-9,c=n.x-e.x,p=n.y-e.y;return o>0&&o*o>c*c+p*p}function aE(e,n){for(var o=0;o<n.length;++o)if(!b8(e,n[o]))return!1;return!0}function zfe(e){switch(e.length){case 1:return Rfe(e[0]);case 2:return Ng(e[0],e[1]);case 3:return w8(e[0],e[1],e[2])}}function Rfe(e){return{x:e.x,y:e.y,r:e.r}}function Ng(e,n){var o=e.x,c=e.y,p=e.r,y=n.x,w=n.y,E=n.r,a=y-o,P=w-c,D=E-p,L=Math.sqrt(a*a+P*P);return{x:(o+y+a/L*D)/2,y:(c+w+P/L*D)/2,r:(L+p+E)/2}}function w8(e,n,o){var c=e.x,p=e.y,y=e.r,w=n.x,E=n.y,a=n.r,P=o.x,D=o.y,L=o.r,F=c-w,$=c-P,H=p-E,q=p-D,le=a-y,ie=L-y,te=c*c+p*p-y*y,se=te-w*w-E*E+a*a,be=te-P*P-D*D+L*L,Ee=$*H-F*q,je=(H*be-q*se)/(Ee*2)-c,Be=(q*le-H*ie)/Ee,Ze=($*se-F*be)/(Ee*2)-p,ht=(F*ie-$*le)/Ee,Pe=Be*Be+ht*ht-1,Et=2*(y+je*Be+Ze*ht),or=je*je+Ze*Ze-y*y,st=-(Math.abs(Pe)>1e-6?(Et+Math.sqrt(Et*Et-4*Pe*or))/(2*Pe):or/Et);return{x:c+je+Be*st,y:p+Ze+ht*st,r:st}}function wL(e,n,o){var c=e.x-n.x,p,y,w=e.y-n.y,E,a,P=c*c+w*w;P?(y=n.r+o.r,y*=y,a=e.r+o.r,a*=a,y>a?(p=(P+a-y)/(2*P),E=Math.sqrt(Math.max(0,a/P-p*p)),o.x=e.x-p*c-E*w,o.y=e.y-p*w+E*c):(p=(P+y-a)/(2*P),E=Math.sqrt(Math.max(0,y/P-p*p)),o.x=n.x+p*c-E*w,o.y=n.y+p*w+E*c)):(o.x=n.x+o.r,o.y=n.y)}function SL(e,n){var o=e.r+n.r-1e-6,c=n.x-e.x,p=n.y-e.y;return o>0&&o*o>c*c+p*p}function TL(e){var n=e._,o=e.next._,c=n.r+o.r,p=(n.x*o.r+o.x*n.r)/c,y=(n.y*o.r+o.y*n.r)/c;return p*p+y*y}function jv(e){this._=e,this.next=null,this.previous=null}function Dfe(e,n){if(!(y=(e=Afe(e)).length))return 0;var o,c,p,y,w,E,a,P,D,L,F;if(o=e[0],o.x=0,o.y=0,!(y>1))return o.r;if(c=e[1],o.x=-c.r,c.x=o.r,c.y=0,!(y>2))return o.r+c.r;wL(c,o,p=e[2]),o=new jv(o),c=new jv(c),p=new jv(p),o.next=p.previous=c,c.next=o.previous=p,p.next=c.previous=o;e:for(a=3;a<y;++a){wL(o._,c._,p=e[a]),p=new jv(p),P=c.next,D=o.previous,L=c._.r,F=o._.r;do if(L<=F){if(SL(P._,p._)){c=P,o.next=c,c.previous=o,--a;continue e}L+=P._.r,P=P.next}else{if(SL(D._,p._)){o=D,o.next=c,c.previous=o,--a;continue e}F+=D._.r,D=D.previous}while(P!==D.next);for(p.previous=o,p.next=c,o.next=c.previous=c=p,w=TL(o);(p=p.next)!==c;)(E=TL(p))<w&&(o=p,w=E);c=o.next}for(o=[c._],p=c;(p=p.next)!==c;)o.push(p._);for(p=Pfe(o,n),a=0;a<y;++a)o=e[a],o.x-=p.x,o.y-=p.y;return p.r}function Lfe(e){return Math.sqrt(e.value)}function Ofe(){var e=null,n=1,o=1,c=xL;function p(y){const w=Mfe();return y.x=n/2,y.y=o/2,e?y.eachBefore(EL(e)).eachAfter(lE(c,.5,w)).eachBefore(CL(1)):y.eachBefore(EL(Lfe)).eachAfter(lE(xL,1,w)).eachAfter(lE(c,y.r/Math.min(n,o),w)).eachBefore(CL(Math.min(n,o)/(2*y.r))),y}return p.radius=function(y){return arguments.length?(e=wfe(y),p):e},p.size=function(y){return arguments.length?(n=+y[0],o=+y[1],p):[n,o]},p.padding=function(y){return arguments.length?(c=typeof y=="function"?y:Tfe(+y),p):c},p}function EL(e){return function(n){n.children||(n.r=Math.max(0,+e(n)||0))}}function lE(e,n,o){return function(c){if(p=c.children){var p,y,w=p.length,E=e(c)*n||0,a;if(E)for(y=0;y<w;++y)p[y].r+=E;if(a=Dfe(p,o),E)for(y=0;y<w;++y)p[y].r-=E;c.r=a+E}}}function CL(e){return function(n){var o=n.parent;n.r*=e,o&&(n.x=o.x+e*n.x,n.y=o.y+e*n.y)}}function xk(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}const ML=Symbol("implicit");function S8(){var e=new K5,n=[],o=[],c=ML;function p(y){let w=e.get(y);if(w===void 0){if(c!==ML)return c;e.set(y,w=n.push(y)-1)}return o[w%o.length]}return p.domain=function(y){if(!arguments.length)return n.slice();n=[],e=new K5;for(const w of y)e.has(w)||e.set(w,n.push(w)-1);return p},p.range=function(y){return arguments.length?(o=Array.from(y),p):o.slice()},p.unknown=function(y){return arguments.length?(c=y,p):c},p.copy=function(){return S8(n,o).unknown(c)},xk.apply(p,arguments),p}function bk(){var e=S8().unknown(void 0),n=e.domain,o=e.range,c=0,p=1,y,w,E=!1,a=0,P=0,D=.5;delete e.unknown;function L(){var F=n().length,$=p<c,H=$?p:c,q=$?c:p;y=(q-H)/Math.max(1,F-a+P*2),E&&(y=Math.floor(y)),H+=(q-H-y*(F-a))*D,w=y*(1-a),E&&(H=Math.round(H),w=Math.round(w));var le=pce(F).map(function(ie){return H+y*ie});return o($?le.reverse():le)}return e.domain=function(F){return arguments.length?(n(F),L()):n()},e.range=function(F){return arguments.length?([c,p]=F,c=+c,p=+p,L()):[c,p]},e.rangeRound=function(F){return[c,p]=F,c=+c,p=+p,E=!0,L()},e.bandwidth=function(){return w},e.step=function(){return y},e.round=function(F){return arguments.length?(E=!!F,L()):E},e.padding=function(F){return arguments.length?(a=Math.min(1,P=+F),L()):a},e.paddingInner=function(F){return arguments.length?(a=Math.min(1,F),L()):a},e.paddingOuter=function(F){return arguments.length?(P=+F,L()):P},e.align=function(F){return arguments.length?(D=Math.max(0,Math.min(1,F)),L()):D},e.copy=function(){return bk(n(),[c,p]).round(E).paddingInner(a).paddingOuter(P).align(D)},xk.apply(L(),arguments)}function T8(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return T8(n())},e}function Bfe(){return T8(bk.apply(null,arguments).paddingInner(1))}function Ffe(e){return function(){return e}}function Nfe(e){return+e}var AL=[0,1];function Yf(e){return e}function rM(e,n){return(n-=e=+e)?function(o){return(o-e)/n}:Ffe(isNaN(n)?NaN:.5)}function jfe(e,n){var o;return e>n&&(o=e,e=n,n=o),function(c){return Math.max(e,Math.min(n,c))}}function Vfe(e,n,o){var c=e[0],p=e[1],y=n[0],w=n[1];return p<c?(c=rM(p,c),y=o(w,y)):(c=rM(c,p),y=o(y,w)),function(E){return y(c(E))}}function $fe(e,n,o){var c=Math.min(e.length,n.length)-1,p=new Array(c),y=new Array(c),w=-1;for(e[c]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++w<c;)p[w]=rM(e[w],e[w+1]),y[w]=o(n[w],n[w+1]);return function(E){var a=ice(e,E,1,c)-1;return y[a](p[a](E))}}function Ufe(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Gfe(){var e=AL,n=AL,o=pk,c,p,y,w=Yf,E,a,P;function D(){var F=Math.min(e.length,n.length);return w!==Yf&&(w=jfe(e[0],e[F-1])),E=F>2?$fe:Vfe,a=P=null,L}function L(F){return F==null||isNaN(F=+F)?y:(a||(a=E(e.map(c),n,o)))(c(w(F)))}return L.invert=function(F){return w(p((P||(P=E(n,e.map(c),za)))(F)))},L.domain=function(F){return arguments.length?(e=Array.from(F,Nfe),D()):e.slice()},L.range=function(F){return arguments.length?(n=Array.from(F),D()):n.slice()},L.rangeRound=function(F){return n=Array.from(F),o=Ehe,D()},L.clamp=function(F){return arguments.length?(w=F?!0:Yf,D()):w!==Yf},L.interpolate=function(F){return arguments.length?(o=F,D()):o},L.unknown=function(F){return arguments.length?(y=F,L):y},function(F,$){return c=F,p=$,D()}}function Wfe(){return Gfe()(Yf,Yf)}function qfe(e,n,o,c){var p=dce(e,n,o),y;switch(c=A1(c??",f"),c.type){case"s":{var w=Math.max(Math.abs(e),Math.abs(n));return c.precision==null&&!isNaN(y=efe(p,w))&&(c.precision=y),x8(c,w)}case"":case"e":case"g":case"p":case"r":{c.precision==null&&!isNaN(y=tfe(p,Math.max(Math.abs(e),Math.abs(n))))&&(c.precision=y-(c.type==="e"));break}case"f":case"%":{c.precision==null&&!isNaN(y=Qde(p))&&(c.precision=y-(c.type==="%")*2);break}}return v8(c)}function Hfe(e){var n=e.domain;return e.ticks=function(o){var c=n();return hce(c[0],c[c.length-1],o??10)},e.tickFormat=function(o,c){var p=n();return qfe(p[0],p[p.length-1],o??10,c)},e.nice=function(o){o==null&&(o=10);var c=n(),p=0,y=c.length-1,w=c[p],E=c[y],a,P,D=10;for(E<w&&(P=w,w=E,E=P,P=p,p=y,y=P);D-- >0;){if(P=WC(w,E,o),P===a)return c[p]=w,c[y]=E,n(c);if(P>0)w=Math.floor(w/P)*P,E=Math.ceil(E/P)*P;else if(P<0)w=Math.ceil(w*P)/P,E=Math.floor(E*P)/P;else break;a=P}return e},e}function wk(){var e=Wfe();return e.copy=function(){return Ufe(e,wk())},xk.apply(e,arguments),Hfe(e)}function Tf(e){return function(){return e}}function Zfe(e){let n=3;return e.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const c=Math.floor(o);if(!(c>=0))throw new RangeError(`invalid digits: ${o}`);n=c}return e},()=>new Gde(n)}function Xfe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function E8(e){this._context=e}E8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function Yfe(e){return new E8(e)}function Kfe(e){return e[0]}function Jfe(e){return e[1]}function Qfe(e,n){var o=Tf(!0),c=null,p=Yfe,y=null,w=Zfe(E);e=typeof e=="function"?e:e===void 0?Kfe:Tf(e),n=typeof n=="function"?n:n===void 0?Jfe:Tf(n);function E(a){var P,D=(a=Xfe(a)).length,L,F=!1,$;for(c==null&&(y=p($=w())),P=0;P<=D;++P)!(P<D&&o(L=a[P],P,a))===F&&((F=!F)?y.lineStart():y.lineEnd()),F&&y.point(+e(L,P,a),+n(L,P,a));if($)return y=null,$+""||null}return E.x=function(a){return arguments.length?(e=typeof a=="function"?a:Tf(+a),E):e},E.y=function(a){return arguments.length?(n=typeof a=="function"?a:Tf(+a),E):n},E.defined=function(a){return arguments.length?(o=typeof a=="function"?a:Tf(!!a),E):o},E.curve=function(a){return arguments.length?(p=a,c!=null&&(y=p(c)),E):p},E.context=function(a){return arguments.length?(a==null?c=y=null:y=p(c=a),E):c},E}function jg(e,n,o){this.k=e,this.x=n,this.y=o}jg.prototype={constructor:jg,scale:function(e){return e===1?this:new jg(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new jg(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};jg.prototype;function epe(e){return Eb({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function tpe(e){return Eb({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"},child:[]}]})(e)}const rpe=()=>{const e=re.useRef(null),[n,o]=re.useState(0),c=[{name:"Original View",data:{name:"root",children:[{name:"PM10",value:80},{name:"PM2.5",value:10}]},text:"The PM in PM2.5 and PM10 stands for particulate matter and the value refers to the diameter of the particles. PM2.5 is less than 2.5 microns (m) in diameter while PM10 is less than 10 microns (m) in diameter."},{name:"Second View",data:{name:"root",children:[{name:"Human Hair",value:150},{name:"PM10",value:20},{name:"PM2.5",value:6}]},text:"Both particle types are smaller than the width of human hair, which tends to be between 17 and 180 m in diameter."}];re.useEffect(()=>{const a=Da(e.current).attr("width",600).attr("height",300).attr("text-anchor","middle"),P=vk(c[n].data).sum(q=>q.value).sort((q,le)=>le.value-q.value);Ofe().size([600,300]).padding(5)(P);const L=750,F=a.selectAll("g").data(P.descendants().slice(1),q=>q.data.name);F.exit().transition().duration(L).attr("transform","scale(0.5)").remove();const $=F.enter().append("g");$.append("circle").attr("r",0).attr("fill",q=>q.data.name==="Human Hair"?"teal":q.data.name==="PM10"?"orange":q.data.name==="PM2.5"?"cyan":"none"),$.append("text").text(q=>q.data.name).attr("dy",0).style("font-size","0px");const H=$.merge(F);H.transition().duration(L).attr("transform",q=>`translate(${q.x},${q.y})`),H.select("circle").transition().duration(L).attr("r",q=>q.r),H.select("text").transition().duration(L).attr("dy",4).style("font-size",q=>q.data.name==="Human Hair"?"18px":q.data.name==="PM10"||q.data.name==="PM2.5"?"12px":"10px"),H.on("mouseover",function(){Da(this).select("circle").style("fill-opacity",.95)}),H.on("mouseout",function(){Da(this).select("circle").style("fill-opacity",1)})},[n]);const p=()=>{n<c.length-1&&o(w=>w+1)},y=()=>{n>0&&o(w=>w-1)};return Q.jsxs("div",{id:"comparison-chart",style:{display:"flex",flexDirection:"column",alignItems:"flex-start"},children:[Q.jsxs(Cn,{classNam:"top-container",children:[Q.jsxs("div",{className:"button-container",children:[Q.jsx(f1,{onClick:y,size:"xs",leftIcon:Q.jsx(epe,{}),marginRight:"10px"}),Q.jsx(f1,{onClick:p,size:"xs",rightIcon:Q.jsx(tpe,{})})]}),Q.jsx(so,{as:"h3",fontSize:"md",mt:"15px",children:"Pollutant particles have a smaller diameter than human hair"}),Q.jsx(io,{fontSize:"sm",textAlign:"left",marginTop:"5px",children:c[n].text})]}),Q.jsx("svg",{ref:e})]})},npe=()=>{const e=[{name:"Good",color:"#a8e05f",description:"Air quality is considered satisfactory, and air pollution poses little or no risk."},{name:"Moderate",color:"#fdd64b",description:"Air quality is acceptable; however, for some pollutants there may be a moderate health concern for a very small number of people who are unusually sensitive to air pollution."},{name:"Unhealthy for Sensitive Groups",color:"#f99049",description:"Members of sensitive groups may experience health effects. The general public is not likely to be affected."},{name:"Unhealthy",color:"#f65e5f",description:"Everyone may begin to experience health effects; members of sensitive groups may experience more serious health effects."},{name:"Very Unhealthy",color:"#a070b6",description:"Health warnings of emergency conditions. The entire population is likely to be affected."},{name:"Hazardous",color:"#a06a7b",description:"Everyone may experience more serious health effects."}];return Q.jsxs(Sb,{spacing:4,align:"stretch",children:[Q.jsx(so,{as:"h2",size:"lg",p:4,bg:"gray.100",textAlign:"center",children:"How Good is The Weather?"}),e.map((n,o)=>Q.jsxs(Cn,{bg:n.color,p:4,color:"#3b3b3b",children:[Q.jsx(so,{as:"h3",size:"md",children:n.name}),Q.jsx(io,{mt:2,children:n.description})]},o))]})},ipe=()=>{const e=[{title:"Air Pollution: Impact and Prevention",description:"Air pollution is becoming a major health problem affecting millions worldwide. In support of this observation, the World Health Organization estimates that every year, 2.4 million people die because of the effects of air pollution on health.",href:"https://onlinelibrary.wiley.com/doi/full/10.1111/j.1440-1843.2012.02213.x"},{title:"Health Impact of Air Pollution to Children",description:"Health impact of air pollution to children was studied over the last twenty years in heavily polluted parts of the Czech Republic during. The research program (Teplice Program) analyzed these effects in the polluted district Teplice (North Bohemia) and control district Prachatice (Southern Bohemia).",href:"https://www.sciencedirect.com/science/article/pii/S143846391200137X?casa_token=CJJf8x_puj4AAAAA:1eMZAZQKGVYpqDYxnbbT5aoxozcyhJdM1I8bD09gc6aa9bFqgypR67SrhvqVQ3O-61m2PNoiy8Y"},{title:"Public-health Impact of Outdoor and Traffic-related Air Pollution: A European Assessment",description:"Air pollution contributes to mortality and morbidity. We estimated the impact of outdoor (total) and traffic-related air pollution on public health in Austria, France, and Switzerland. Attributable cases of morbidity and mortality were estimated.",href:"https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(00)02653-2/abstract?cc=y%3D%5B%2Fquote%5D"},{title:"Human Health Effects of Air Pollution",description:"Over the past three or four decades, there have been important advances in the understanding of the actions, exposure-response characteristics, and mechanisms of action of many common air pollutants.",href:"https://ehp.niehs.nih.gov/doi/abs/10.1289/ehp.9310045"},{title:"Health Effects of Air Pollution: A Statistical Review",description:"We critically review and compare epidemiological designs and statistical approaches to estimate associations between air pollution and health.",href:"https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1751-5823.2003.tb00195.x?casa_token=CUzraUzgekAAAAAA:DjKITwAXfUWZ-ztmWrbqewc3NUlfIQjhpb0GKGeoksx5QJiN-xcwLzOS9xhQt1CK7hejKU4aahlR6aI"}];return Q.jsxs(_j,{spacing:5,align:"stretch",children:[Q.jsx(so,{as:"h1",size:"lg",paddingBottom:4,children:"Impact on Health"}),e.map((n,o)=>Q.jsxs(Cn,{p:5,shadow:"md",borderWidth:"1px",borderRadius:"md",backgroundColor:"white",children:[Q.jsx(so,{as:"h2",size:"md",paddingBottom:3,children:n.title}),Q.jsx(io,{paddingBottom:3,children:n.description}),Q.jsx(mj,{href:n.href,isExternal:!0,children:Q.jsx(f1,{colorScheme:"blue",children:"Learn More "})})]},o))]})},ope=()=>Q.jsxs("div",{children:[Q.jsx(so,{as:"h3",size:"md",my:"4",children:"Air Pollutants"}),Q.jsxs(bb,{allowToggle:!0,children:[Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"What is PM?"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"PM stands for Particulate Matter, which is a mixture of solid particles and liquid droplets in the air. Particles are defined by their diameter for air quality regulatory purposes. Those with a diameter of 10 microns or less (PM10) are inhalable into the lungs and can induce adverse health effects. Fine particulate matter is defined as particles that are 2.5 microns or less in diameter (PM2.5)."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"What is O3?"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"O3 (Ozone) is a gas molecule composed of three oxygen atoms. Ozone is good up high, bad nearby. The ozone layer found high in the upper atmosphere shields us from much of the sun's ultraviolet radiation. However, ozone air pollution at ground level where we can breathe it causes serious health problems. Ozone aggressively attacks lung tissue by reacting chemically with it."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"What is NOx?"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"NO and NO2 are two kinds of gases and are referred as NOx (Nitrogen Oxides). NO2 (Nitrogen Dioxide) at high concentrations causes inflammation of the airways. Breathing in high levels of NO2 can increase the likelihood of respiratory problems: wheezing, coughing, colds, flu and bronchitis. People with asthma are prone to have more intense attacks. Prolonged exposure to high levels of NO2 can cause irreversible damages to the respiratory system."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"What is Birch Pollen?"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"Birch trees are trees with beige, silvery or white bark that is often flaky. They are part of the order Fagales and the family Betulaceae of trees. Birch pollen allergy is one of the most common seasonal allergies. Between 8-16% of people are sensitized to the allergen. The birch pollen count will typically be highest in the morning. But as you go throughout your day, the pollen may collect on your clothes, skin and hair. You then breathe it in as you go about your day or when you sleep at night."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"What is AQI?"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"AQI stands for Air Quality Index, which serves as a tool to communicate daily air quality by incorporating measurements of five key air pollutants: ground-level ozone, particulate matter, carbon monoxide, sulfur dioxide, and nitrogen dioxide. AQI runs from 0 to 500 where a lower score indicates cleaner air and a higher score denotes poorer air condition."})]})]})]}),spe=()=>Q.jsxs(El,{direction:{base:"column",md:"row"},justify:"space-between",className:"main-container",children:[Q.jsxs(El,{direction:"column",className:"first-col",p:4,flex:"1",children:[Q.jsx(rpe,{}),Q.jsx(ope,{className:"faq-accordion"})]}),Q.jsx(El,{className:"second-col",p:4,flex:"1",children:Q.jsx(npe,{})}),Q.jsx(El,{className:"third-col",p:4,flex:"1",children:Q.jsx(ipe,{})})]}),ape=()=>Q.jsxs(Cn,{className:"aboutus-right-container",py:6,children:[Q.jsxs(El,{justifyContent:"flex-end",mb:6,children:[Q.jsxs(Cn,{mx:"4",maxW:"320px",w:"full",bg:gl("white","gray.900"),boxShadow:"2xl",rounded:"lg",p:6,textAlign:"center",children:[Q.jsx(Ef,{size:"xl",src:"../public/img-jordan.jpg",mb:4}),Q.jsx(so,{fontSize:"2xl",fontFamily:"body",children:"Jordan"}),Q.jsx(io,{fontWeight:600,color:"gray.500",mb:4,children:"jyjchian@kth.se"}),Q.jsx(io,{textAlign:"center",color:gl("gray.700","gray.400"),px:3,children:"User Testing/Development"})]}),Q.jsxs(Cn,{mx:"4",maxW:"320px",w:"full",bg:gl("white","gray.900"),boxShadow:"2xl",rounded:"lg",p:6,textAlign:"center",children:[Q.jsx(Ef,{size:"xl",src:"../public/img-prijun.jpg",mb:4}),Q.jsx(so,{fontSize:"2xl",fontFamily:"body",children:"Prijun Koirala"}),Q.jsx(io,{fontWeight:600,color:"gray.500",mb:4,children:"kprijun@gmail.com"}),Q.jsx(io,{textAlign:"center",color:gl("gray.700","gray.400"),px:3,children:"Main Developer"})]})]}),Q.jsxs(El,{justifyContent:"flex-end",mb:6,children:[Q.jsxs(Cn,{mx:"4",maxW:"320px",w:"full",bg:gl("white","gray.900"),boxShadow:"2xl",rounded:"lg",p:6,textAlign:"center",children:[Q.jsx(Ef,{size:"xl",src:"../public/img-tianyi.jpg",mb:4}),Q.jsx(so,{fontSize:"2xl",fontFamily:"body",children:"Tianyi"}),Q.jsx(io,{fontWeight:600,color:"gray.500",mb:4,children:"tianyini@kth.se"}),Q.jsx(io,{textAlign:"center",color:gl("gray.700","gray.400"),px:3,children:"Data/Development"})]}),Q.jsxs(Cn,{mx:"4",maxW:"320px",w:"full",bg:gl("white","gray.900"),boxShadow:"2xl",rounded:"lg",p:6,textAlign:"center",children:[Q.jsx(Ef,{size:"xl",src:"../public/img-tingting.jpg",mb:4}),Q.jsx(so,{fontSize:"2xl",fontFamily:"body",children:"Tingting"}),Q.jsx(io,{fontWeight:600,color:"gray.500",mb:4,children:"tinl@kth.se"}),Q.jsx(io,{textAlign:"center",color:gl("gray.700","gray.400"),px:3,children:"UI/UX Design/ Development"})]}),Q.jsxs(Cn,{mx:"4",maxW:"320px",w:"full",bg:gl("white","gray.900"),boxShadow:"2xl",rounded:"lg",p:6,textAlign:"center",children:[Q.jsx(Ef,{size:"xl",src:"../public/img-xinyue.jpg",mb:4}),Q.jsx(so,{fontSize:"2xl",fontFamily:"body",children:"Xinyue"}),Q.jsx(io,{fontWeight:600,color:"gray.500",mb:4,children:"xinyhu@kth.se"}),Q.jsx(io,{textAlign:"center",color:gl("gray.700","gray.400"),px:3,children:"UI/UX Design/ Development"})]})]})]}),lpe=()=>Q.jsxs(Cn,{className:"aboutus-left-container",children:[Q.jsx(so,{children:"About Our Project"}),Q.jsx("br",{}),Q.jsxs(bb,{defaultIndex:[0],allowMultiple:!0,children:[Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:Q.jsx("b",{children:"Our Goals"})}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"We aim to allow people to visualize the air pollution of Stockholm on their screens. Our website hopes to help ease commuters in avoiding polluted areas in their daily travels around the city."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:Q.jsx("b",{children:"Future Plans"})}),Q.jsx(ra,{})]})}),Q.jsxs(ia,{pb:4,children:["Currently, we only have a webpage version but we aim to eventually develop a mobile application for this data visualization.",Q.jsx("br",{}),Q.jsx("br",{}),"We will also work towards incorporating other parts of Sweden, not just Stockholm, into the application to enable citizens to better plan their travelling routes if they are heading out of the city."]})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:Q.jsx("b",{children:"Data Resources"})}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"Data for this visualization is obtained from SLB-analys and Stockholms Stad."})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:Q.jsx("b",{children:"Acknowledgements"})}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:"The success of this project is not without the following people; Mario Romero Vega and Joakim Rasmuson. Under their guidance, it enabled the team to develop CitizAir into what it is today."})]})]})]}),cpe=()=>Q.jsxs(El,{w:"40%",display:"flex",alignItems:"center",justifyContent:"space-around",style:{paddingBottom:"20px"},children:[Q.jsx(_x,{boxSize:{base:"80px",md:"100px"},objectFit:"contain",src:"../public/img-slb.png",alt:"Slb"}),Q.jsx(_x,{boxSize:{base:"80px",md:"100px"},objectFit:"contain",src:"../public/img-stockholm.png",alt:"Stockholm Stad"}),Q.jsx(_x,{boxSize:{base:"80px",md:"70px"},objectFit:"contain",src:"../public/img-kth.png",alt:"Kth"})]}),upe=()=>Q.jsxs(Cn,{children:[Q.jsxs(Cn,{className:"main-container",children:[Q.jsx(lpe,{}),Q.jsx(ape,{})]}),Q.jsx(cpe,{className:"partner-logos"})]});var C8={exports:{}};(function(e,n){var o={};(function(c,p){e.exports=p()})(Sg,function(){var c,p,y;function w(a,P){if(!c)c=P;else if(!p)p=P;else{var D="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+c+")(sharedChunk); ("+p+")(sharedChunk); self.onerror = null;",L={};c(L),y=P(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(y.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}w(["exports"],function(a){var P="3.2.0";let D;const L={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(D==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{D=o.API_URL_REGEX!=null?new RegExp(o.API_URL_REGEX):r}catch{D=r}}return D},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!L.API_URL)return null;try{const r=new URL(L.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},F={supported:!1,testSupport:function(r){!q&&H&&(le?te(r):$=r)}};let $,H,q=!1,le=!1;const ie=typeof self<"u"?self:{};function te(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,H),r.isContextLost())return;F.supported=!0}catch{}r.deleteTexture(t),q=!0}ie.document&&(H=ie.document.createElement("img"),H.onload=function(){$&&te($),$=null,le=!0},H.onerror=function(){q=!0,$=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const se="01";function be(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ee=je;function je(r,t,i,s){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=i,this.p2y=s}je.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,s=0;s<8;s++){var u=this.sampleCurveX(i)-r;if(Math.abs(u)<t)return i;var d=this.sampleCurveDerivativeX(i);if(Math.abs(d)<1e-6)break;i-=u/d}var f=0,g=1;for(i=r,s=0;s<20&&(u=this.sampleCurveX(i),!(Math.abs(u-r)<t));s++)r>u?f=i:g=i,i=.5*(g-f)+f;return i},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var Be=be(Ee),Ze=ht;function ht(r,t){this.x=r,this.y=t}ht.prototype={clone:function(){return new ht(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,i=r.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),i=Math.sin(r),s=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=s,this},_rotateAround:function(r,t){var i=Math.cos(r),s=Math.sin(r),u=t.y+s*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-s*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ht.convert=function(r){return r instanceof ht?r:Array.isArray(r)?new ht(r[0],r[1]):r};var Pe=be(Ze);const Et=Math.PI/180,or=180/Math.PI;function st(r){return r*Et}function ar(r){return r*or}const Bn=[[0,0],[1,0],[1,1],[0,1]];function Mr(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,i=t*r;return 4*(r<.5?i:3*(r-t)+i-.75)}function xn(r,t,i,s){const u=new Be(r,t,i,s);return function(d){return u.solve(d)}}const Ot=xn(.25,.1,.25,1);function ct(r,t,i){return Math.min(i,Math.max(t,r))}function Jt(r,t,i){return(i=ct((i-r)/(t-r),0,1))*i*(3-2*i)}function qt(r,t,i){const s=i-t,u=((r-t)%s+s)%s+t;return u===t?i:u}function _r(r,t,i){if(!r.length)return i(null,[]);let s=r.length;const u=new Array(r.length);let d=null;r.forEach((f,g)=>{t(f,(v,b)=>{v&&(d=v),u[g]=b,--s==0&&i(d,u)})})}function wr(r){const t=[];for(const i in r)t.push(r[i]);return t}function Lr(r,...t){for(const i of t)for(const s in i)r[s]=i[s];return r}let wi=1;function sn(){return wi++}function Xn(){return function r(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Si(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function uo(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function Ti(r,t){r.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Tr(r,t){return r.indexOf(t,r.length-t.length)!==-1}function oi(r,t,i){const s={};for(const u in r)s[u]=t.call(i||this,r[u],u,r);return s}function cs(r,t,i){const s={};for(const u in r)t.call(i||this,r[u],u,r)&&(s[u]=r[u]);return s}function Zi(r){return Array.isArray(r)?r.map(Zi):typeof r=="object"&&r?oi(r,Zi):r}const ja={};function kr(r){ja[r]||(typeof console<"u"&&console.warn(r),ja[r]=!0)}function tt(r,t,i){return(i.y-r.y)*(t.x-r.x)>(t.y-r.y)*(i.x-r.x)}function de(r){let t=0;for(let i,s,u=0,d=r.length,f=d-1;u<d;f=u++)i=r[u],s=r[f],t+=(s.x-i.x)*(i.y+s.y);return t}function me([r,t,i]){const s=st(t+90),u=st(i);return{x:r*Math.cos(s)*Math.sin(u),y:r*Math.sin(s)*Math.sin(u),z:r*Math.cos(u),azimuthal:t,polar:i}}function Ce(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function rt(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,u,d)=>{const f=u||d;return t[s]=!f||f.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let Qe=null;function bt(r){try{const t=self[r];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function zt(r,t){return[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]]}function it(r,t,i,s){for(;t<i;){const u=t+i>>1;r[u]<s?t=u+1:i=u}return t}function jt(r,t,i,s){for(;t<i;){const u=t+i>>1;r[u]<=s?t=u+1:i=u}return t}const Ht="mapbox-tiles";let Zt=500,Fr=50,en,In;function Jr(){try{return caches}catch{}}function tn(){const r=Jr();r&&!en&&(en=r.open(Ht))}function Ur(r){const t=r.indexOf("?");if(t<0)return r;const i=function(u){const d=u.indexOf("?");return d>0?u.slice(d+1).split("&"):[]}(r),s=i.filter(u=>{const d=u.split("=");return d[0]==="language"||d[0]==="worldview"});return s.length?`${r.slice(0,t)}?${s.join("&")}`:r.slice(0,t)}let Jn=1/0;const kn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(kn);class zi extends Error{constructor(t,i,s){i===401&&pt(s)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ri=Ce()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,jo=function(r,t){if(!(/^file:/.test(i=r.url)||/^file:/.test(Ri())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(s,u){const d=new AbortController,f=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Ri(),referrerPolicy:s.referrerPolicy,signal:d.signal});let g=!1,v=!1;const b=(T=f.url).indexOf("sku=")>0&&pt(T);var T;s.type==="json"&&f.headers.set("Accept","application/json");const M=(I,R,B)=>{if(v)return;if(I&&I.message!=="SecurityError"&&kr(I.toString()),R&&B)return k(R);const j=Date.now();fetch(f).then(U=>{if(U.ok){const J=b?U.clone():null;return k(U,J,j)}return u(new zi(U.statusText,U.status,s.url))}).catch(U=>{U.name!=="AbortError"&&u(new Error(`${U.message} ${s.url}`))})},k=(I,R,B)=>{(s.type==="arrayBuffer"?I.arrayBuffer():s.type==="json"?I.json():I.text()).then(j=>{v||(R&&B&&function(U,J,ee){if(tn(),!en)return;const oe={status:J.status,statusText:J.statusText,headers:new Headers};J.headers.forEach((xe,Te)=>oe.headers.set(Te,xe));const ue=rt(J.headers.get("Cache-Control")||"");if(ue["no-store"])return;ue["max-age"]&&oe.headers.set("Expires",new Date(ee+1e3*ue["max-age"]).toUTCString());const fe=oe.headers.get("Expires");fe&&(new Date(fe).getTime()-ee<42e4||function(xe,Te){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?Te(xe.body):xe.blob().then(Te)}(J,xe=>{const Te=new Response(xe,oe);tn(),en&&en.then(Ae=>Ae.put(Ur(U.url),Te)).catch(Ae=>kr(Ae.message))}))}(f,R,B),g=!0,u(null,j,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(j=>{v||u(new Error(j.message))})};return b?function(I,R){if(tn(),!en)return R(null);const B=Ur(I.url);en.then(j=>{j.match(B).then(U=>{const J=function(ee){if(!ee)return!1;const oe=new Date(ee.headers.get("Expires")||0),ue=rt(ee.headers.get("Cache-Control")||"");return oe>Date.now()&&!ue["no-cache"]}(U);j.delete(B),J&&j.put(B,U.clone()),R(null,U,J)}).catch(R)}).catch(R)}(f,M):M(null,null),{cancel:()=>{v=!0,g||d.abort()}}}(r,t);if(Ce()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var i;return function(s,u){const d=new XMLHttpRequest;d.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const f in s.headers)d.setRequestHeader(f,s.headers[f]);return s.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=s.credentials==="include",d.onerror=()=>{u(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let f=d.response;if(s.type==="json")try{f=JSON.parse(d.response)}catch(g){return u(g)}u(null,f,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else u(new zi(d.statusText,d.status,s.url))},d.send(s.body),{cancel:()=>d.abort()}}(r,t)},si=function(r,t){return jo(Lr(r,{type:"arrayBuffer"}),t)};function Vo(r){const t=document.createElement("a");return t.href=r,t.protocol===location.protocol&&t.host===location.host}const ho="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ai,$e;ai=[],$e=0;const Ye=function(r,t){if(F.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),$e>=L.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ai.push(d),d}$e++;let i=!1;const s=()=>{if(!i)for(i=!0,$e--;ai.length&&$e<L.MAX_PARALLEL_IMAGE_REQUESTS;){const d=ai.shift(),{requestParameters:f,callback:g,cancelled:v}=d;v||(d.cancel=Ye(f,g).cancel)}},u=si(r,(d,f,g,v)=>{s(),d?t(d):f&&(self.createImageBitmap?function(b,T){const M=new Blob([new Uint8Array(b)],{type:"image/png"});createImageBitmap(M).then(k=>{T(null,k)}).catch(k=>{T(new Error(`Could not load image because of ${k.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(f,(b,T)=>t(b,T,g,v)):function(b,T){const M=new Image;M.onload=()=>{T(null,M),URL.revokeObjectURL(M.src),M.onload=null,requestAnimationFrame(()=>{M.src=ho})},M.onerror=()=>T(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const k=new Blob([new Uint8Array(b)],{type:"image/png"});M.src=b.byteLength?URL.createObjectURL(k):ho}(f,(b,T)=>t(b,T,g,v)))});return{cancel:()=>{u.cancel(),s()}}},at="NO_ACCESS_TOKEN";function ut(r){return r.indexOf("mapbox:")===0}function pt(r){return L.API_URL_REGEX.test(r)}function xt(r){return L.API_CDN_URL_REGEX.test(r)}function mt(r){return L.API_STYLE_REGEX.test(r)&&!gt(r)}function gt(r){return L.API_SPRITE_REGEX.test(r)}const kt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function dt(r){const t=r.match(kt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Qt(r){const t=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${t}`}const Pr="mapbox.eventData";function Bt(r){if(!r)return null;const t=r.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Or{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Bt(L.ACCESS_TOKEN);let s="";return s=i&&i.u?btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,d)=>String.fromCharCode(+("0x"+d)))):L.ACCESS_TOKEN||"",t?`${Pr}.${t}:${s}`:`${Pr}:${s}`}fetchEventData(){const t=bt("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{const u=localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const d=localStorage.getItem(s);d&&(this.anonId=d)}catch{kr("Unable to read from LocalStorage")}}saveEventData(){const t=bt("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid"),u=this.anonId;if(t&&u)try{localStorage.setItem(s,u),Object.keys(this.eventData).length>=1&&localStorage.setItem(i,JSON.stringify(this.eventData))}catch{kr("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,s,u){if(!L.EVENTS_URL)return;const d=dt(L.EVENTS_URL);d.params.push(`access_token=${u||L.ACCESS_TOKEN||""}`);const f={event:this.type,created:new Date(t).toISOString()},g=i?Lr(f,i):f,v={url:Qt(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(b,T){return jo(Lr(b,{method:"POST"}),T)}(v,b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(u)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const bn=new class extends Or{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,t){L.EVENTS_URL&&L.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>ut(i)||pt(i))&&this.queueRequest(Date.now(),t)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Bt(L.ACCESS_TOKEN),i=t?t.u:L.ACCESS_TOKEN;let s=i!==this.eventData.tokenU;uo(this.anonId)||(this.anonId=Xn(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),f=new Date(u),g=(u-this.eventData.lastSuccess)/864e5;s=s||g>=1||g<-1||d.getDate()!==f.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:se,"enabled.telemetry":!1,userId:this.anonId},d=>{d||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},r):this.processRequests()}},Tn=bn.postTurnstileEvent.bind(bn),zn=new class extends Or{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,t,i,s){this.skuToken=t,this.errorCb=s,L.EVENTS_URL&&(i||L.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(at)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),uo(this.anonId)||(this.anonId=Xn()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:se,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},r))}},hi=zn.postMapLoadEvent.bind(zn),li=new class extends Or{constructor(){super("gljs.performance")}postPerformanceEvent(r,t){L.EVENTS_URL&&(r||L.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),s=function(u){const d=performance.getEntriesByType("resource"),f=performance.getEntriesByType("mark"),g=function(I){const R={};if(I){for(const B in I)if(B!=="other")for(const j of I[B]){const U=`${B}ResolveRangeMin`,J=`${B}ResolveRangeMax`,ee=`${B}RequestCount`,oe=`${B}RequestCachedCount`;R[U]=Math.min(R[U]||1/0,j.startTime),R[J]=Math.max(R[J]||-1/0,j.responseEnd);const ue=fe=>{R[fe]===void 0&&(R[fe]=0),++R[fe]};j.transferSize!==void 0&&j.transferSize===0&&ue(oe),ue(ee)}}return R}(function(I,R){const B={};if(I)for(const j of I){const U=R(j);B[U]===void 0&&(B[U]=[]),B[U].push(j)}return B}(d,Va)),v=window.devicePixelRatio,b=navigator.connection||navigator.mozConnection||navigator.webkitConnection,T=b?b.effectiveType:void 0,M={counters:[],metadata:[],attributes:[]},k=(I,R,B)=>{B!=null&&I.push({name:R,value:B.toString()})};for(const I in g)k(M.counters,I,g[I]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(k(M.counters,"interactionRangeMin",u.interactionRange[0]),k(M.counters,"interactionRangeMax",u.interactionRange[1])),f)for(const I of Object.keys(us)){const R=us[I],B=f.find(j=>j.name===R);B&&k(M.counters,R,B.startTime)}return k(M.counters,"visibilityHidden",u.visibilityHidden),k(M.attributes,"style",function(I){if(I)for(const R of I){const B=R.name.split("?")[0];if(mt(B)){const j=B.split("/").slice(-2);if(j.length===2)return`mapbox://styles/${j[0]}/${j[1]}`}}}(d)),k(M.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),k(M.attributes,"fogEnabled",u.fogEnabled?"true":"false"),k(M.attributes,"projection",u.projection),k(M.attributes,"zoom",u.zoom),k(M.metadata,"devicePixelRatio",v),k(M.metadata,"connectionEffectiveType",T),k(M.metadata,"navigatorUserAgent",navigator.userAgent),k(M.metadata,"screenWidth",window.screen.width),k(M.metadata,"screenHeight",window.screen.height),k(M.metadata,"windowWidth",window.innerWidth),k(M.metadata,"windowHeight",window.innerHeight),k(M.metadata,"mapWidth",u.width/v),k(M.metadata,"mapHeight",u.height/v),k(M.metadata,"webglRenderer",u.renderer),k(M.metadata,"webglVendor",u.vendor),k(M.metadata,"sdkVersion",P),k(M.metadata,"sdkIdentifier","mapbox-gl-js"),M}(i);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(t,s,()=>{},r)}},fo=li.postPerformanceEvent.bind(li),Xi=new class extends Or{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,t,i,s){if(!L.API_URL||!L.SESSION_PATH)return;const u=dt(L.API_URL+L.SESSION_PATH);u.params.push(`sku=${t||""}`),u.params.push(`access_token=${s||L.ACCESS_TOKEN||""}`);const d={url:Qt(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(f,g){return jo(Lr(f,{method:"GET"}),g)}(d,f=>{this.pendingRequest=null,i(f),this.saveEventData(),this.processRequests(s)})}getSessionAPI(r,t,i,s){this.skuToken=t,this.errorCb=s,L.SESSION_PATH&&L.API_URL&&(i||L.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(at)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},r)}},di=Xi.getSessionAPI.bind(Xi),Ui=new Set,us={create:"create",load:"load",fullLoad:"fullLoad"};function Va(r){const t=r.name.split("?")[0];return xt(t)&&t.includes("mapbox-gl.js")?"javascript":xt(t)&&t.includes("mapbox-gl.css")?"css":function(i){return L.API_FONTS_REGEX.test(i)}(t)?"fontRange":gt(t)?"sprite":mt(t)?"style":function(i){return L.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}function Dl(r){const t=r?r.url.toString():void 0;return t?performance.getEntriesByName(t):[]}let Oc,ca,Ll,Ol,$o;function Gu(){return Oc==null&&(Oc=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Oc}const Di={now:()=>Ol!==void 0?Ol:performance.now(),setNow(r){Ol=r},restoreNow(){Ol=void 0},frame(r){const t=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(r,t=0){const{width:i,height:s}=r;$o||($o=document.createElement("canvas"));const u=$o.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(i>$o.width||s>$o.height)&&($o.width=i,$o.height=s),u.clearRect(-t,-t,i+2*t,s+2*t),u.drawImage(r,0,0,i,s),u.getImageData(-t,-t,i+2*t,s+2*t)},resolveURL:r=>(ca||(ca=document.createElement("a")),ca.href=r,ca.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ll==null&&(Ll=window.matchMedia("(prefers-reduced-motion: reduce)")),Ll.matches)},hasCanvasFingerprintNoise(){if(!Gu())return!1;const r=new OffscreenCanvas(85,1),t=r.getContext("2d",{willReadFrequently:!0});let i=0;for(let u=0;u<r.width;++u)t.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,t.fillRect(u,0,1,1);const s=t.getImageData(0,0,r.width,r.height);i=0;for(let u=0;u<s.data.length;++u)if(u%4!=3&&i++!==s.data[u])return!0;return!1}};function Bc(r,t,i){i[r]&&i[r].indexOf(t)!==-1||(i[r]=i[r]||[],i[r].push(t))}function ua(r,t,i){if(i&&i[r]){const s=i[r].indexOf(t);s!==-1&&i[r].splice(s,1)}}class po{constructor(t,i={}){Lr(this,i),this.type=t}}class ha extends po{constructor(t,i={}){super("error",Lr({error:t},i))}}class Uo{on(t,i){return this._listeners=this._listeners||{},Bc(t,i,this._listeners),this}off(t,i){return ua(t,i,this._listeners),ua(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Bc(t,i,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,i){typeof t=="string"&&(t=new po(t,i||{}));const s=t.type;if(this.listens(s)){t.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const g of u)g.call(this,t);const d=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const g of d)ua(s,g,this._oneTimeListeners),g.call(this,t);const f=this._eventedParent;f&&(Lr(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),f.fire(t))}else t instanceof ha&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var ze=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Pt{constructor(t,i,s,u){this.message=(t?`${t}: `:"")+s,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}class Go extends Pt{}function Po(r,...t){for(const i of t)for(const s in i)r[s]=i[s];return r}function Rn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function hs(r){if(Array.isArray(r))return r.map(hs);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const i in r)t[i]=hs(r[i]);return t}return Rn(r)}class Lp extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var Io=Lp;class $a{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[s,u]of i)this.bindings[s]=u}concat(t){return new $a(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Wu=$a;const da={kind:"null"},Je={kind:"number"},pr={kind:"string"},Er={kind:"boolean"},mo={kind:"color"},Ua={kind:"object"},cr={kind:"value"},fa={kind:"collator"},Bs={kind:"formatted"},Bl={kind:"resolvedImage"};function fi(r,t){return{kind:"array",itemType:r,N:t}}function qr(r){if(r.kind==="array"){const t=qr(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Op=[da,Je,pr,Er,mo,Bs,Ua,fi(cr),Bl];function pa(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!pa(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const i of Op)if(!pa(i,t))return null}}return`Expected ${qr(r)} but found ${qr(t)} instead.`}function Ga(r,t){return t.some(i=>i.kind===r.kind)}function ds(r,t){return t.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}var Wa,Fs={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function qa(r){return(r=Math.round(r))<0?0:r>255?255:r}function Fc(r){return qa(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function Ha(r){return(t=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:t>1?1:t;var t}function Nc(r,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(t-r)*i*6:2*i<1?t:3*i<2?r+(t-r)*(2/3-i)*6:r}try{Wa={}.parseCSSColor=function(r){var t,i=r.replace(/ /g,"").toLowerCase();if(i in Fs)return Fs[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var s=i.indexOf("("),u=i.indexOf(")");if(s!==-1&&u+1===i.length){var d=i.substr(0,s),f=i.substr(s+1,u-(s+1)).split(","),g=1;switch(d){case"rgba":if(f.length!==4)return null;g=Ha(f.pop());case"rgb":return f.length!==3?null:[Fc(f[0]),Fc(f[1]),Fc(f[2]),g];case"hsla":if(f.length!==4)return null;g=Ha(f.pop());case"hsl":if(f.length!==3)return null;var v=(parseFloat(f[0])%360+360)%360/360,b=Ha(f[1]),T=Ha(f[2]),M=T<=.5?T*(b+1):T+b-T*b,k=2*T-M;return[qa(255*Nc(k,M,v+1/3)),qa(255*Nc(k,M,v)),qa(255*Nc(k,M,v-1/3)),g];default:return null}}return null}}catch{}class Un{constructor(t,i,s,u=1){this.r=t,this.g=i,this.b=s,this.a=u}static parse(t){if(!t)return;if(t instanceof Un)return t;if(typeof t!="string")return;const i=Wa(t);return i?new Un(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,s,u]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(s)},${u})`}toArray(){const{r:t,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[255*t/u,255*i/u,255*s/u,u]}toArray01(){const{r:t,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[t/u,i/u,s/u,u]}toArray01Scaled(t){const{r:i,g:s,b:u,a:d}=this;return d===0?[0,0,0]:[i/d*t,s/d*t,u/d*t]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:s,a:u}=this;return[t,i,s,u]}toArray01Linear(){const{r:t,g:i,b:s,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(t/u,2.2),Math.pow(i/u,2.2),Math.pow(s/u,2.2),u]}}Un.black=new Un(0,0,0,1),Un.white=new Un(1,1,1,1),Un.transparent=new Un(0,0,0,0),Un.red=new Un(1,0,0,1),Un.blue=new Un(0,0,1,1);var Hr=Un;class qu{constructor(t,i,s){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ns{constructor(t,i,s,u,d){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=s,this.fontStack=u,this.textColor=d}}class Li{constructor(t){this.sections=t}static fromString(t){return new Li([new Ns(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof Li?t:Li.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.namePrimary]);continue}t.push(i.text);const s={};i.fontStack&&(s["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(s["font-scale"]=i.scale),i.textColor&&(s["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(s)}return t}}class Yi{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,i){return t?new Yi({namePrimary:t,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function yd(r,t,i,s){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[r,t,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[r,t,i,s]:[r,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Za(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Hr||r instanceof qu||r instanceof Li||r instanceof Yi)return!0;if(Array.isArray(r)){for(const t of r)if(!Za(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Za(r[t]))return!1;return!0}return!1}function Fn(r){if(r===null)return da;if(typeof r=="string")return pr;if(typeof r=="boolean")return Er;if(typeof r=="number")return Je;if(r instanceof Hr)return mo;if(r instanceof qu)return fa;if(r instanceof Li)return Bs;if(r instanceof Yi)return Bl;if(Array.isArray(r)){const t=r.length;let i;for(const s of r){const u=Fn(s);if(i){if(i===u)continue;i=cr;break}i=u}return fi(i||cr,t)}return Ua}function Fl(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Hr||r instanceof Li||r instanceof Yi?r.toString():JSON.stringify(r)}class ye{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Za(t[1]))return i.error("invalid value");const s=t[1];let u=Fn(s);const d=i.expectedType;return u.kind!=="array"||u.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(u=d),new ye(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Hr?["rgba"].concat(this.value.toArray()):this.value instanceof Li?this.value.serialize():this.value}}var Re=ye,Ve=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Wt={string:pr,number:Je,boolean:Er,object:Ua};class Br{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let s,u=1;const d=t[0];if(d==="array"){let g,v;if(t.length>2){const b=t[1];if(typeof b!="string"||!(b in Wt)||b==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);g=Wt[b],u++}else g=cr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);v=t[2],u++}s=fi(g,v)}else s=Wt[d];const f=[];for(;u<t.length;u++){const g=i.parse(t[u],u,cr);if(!g)return null;f.push(g)}return new Br(s,f)}evaluate(t){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(t);if(!pa(this.type,Fn(s)))return s;if(i===this.args.length-1)throw new Ve(`Expected value to be of type ${qr(this.type)}, but found ${qr(Fn(s))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const s=t.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){i.push(s.kind);const u=t.N;(typeof u=="number"||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(s=>s.serialize()))}}var Dr=Br;class cn{constructor(t){this.type=Bs,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return i.error("First argument must be an image or text section.");const u=[];let d=!1;for(let f=1;f<=t.length-1;++f){const g=t[f];if(d&&typeof g=="object"&&!Array.isArray(g)){d=!1;let v=null;if(g["font-scale"]&&(v=i.parse(g["font-scale"],1,Je),!v))return null;let b=null;if(g["text-font"]&&(b=i.parse(g["text-font"],1,fi(pr)),!b))return null;let T=null;if(g["text-color"]&&(T=i.parse(g["text-color"],1,mo),!T))return null;const M=u[u.length-1];M.scale=v,M.font=b,M.textColor=T}else{const v=i.parse(t[f],1,cr);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new cn(u)}evaluate(t){return new Li(this.sections.map(i=>{const s=i.content.evaluate(t);return Fn(s)===Bl?new Ns("",s,null,null,null):new Ns(Fl(s),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const s={};i.scale&&(s["font-scale"]=i.scale.serialize()),i.font&&(s["text-font"]=i.font.serialize()),i.textColor&&(s["text-color"]=i.textColor.serialize()),t.push(s)}return t}}class Ar{constructor(t,i){this.type=Bl,this.inputPrimary=t,this.inputSecondary=i}static parse(t,i){if(t.length<2)return i.error("Expected two or more arguments.");const s=i.parse(t[1],1,pr);if(!s)return i.error("No image name provided.");if(t.length===2)return new Ar(s);const u=i.parse(t[2],1,pr);return u?new Ar(s,u):i.error("Secondary image variant is not a string.")}evaluate(t){const i=Yi.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&t.availableImages&&(i.available=t.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Xt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}const go={"to-boolean":Er,"to-color":mo,"to-number":Je,"to-string":pr};class Ei{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const s=t[0],u=[];let d=da;if(s==="to-array"){if(!Array.isArray(t[1]))return null;const f=t[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);d=fi(i.expectedType.itemType,f)}else{if(!(f>0&&Za(t[1][0])))return null;d=fi(Fn(t[1][0]),f)}for(let g=0;g<f;g++){const v=t[1][g];let b;if(Xt(v)==="array")b=i.parse(v,void 0,d.itemType);else{const T=Xt(v);if(T!==d.itemType.kind)return i.error(`Expected ${d.itemType.kind} but found ${T}.`);b=i.registry.literal.parse(["literal",v===void 0?null:v],i)}if(!b)return null;u.push(b)}}else{if((s==="to-boolean"||s==="to-string")&&t.length!==2)return i.error("Expected one argument.");d=go[s];for(let f=1;f<t.length;f++){const g=i.parse(t[f],f,cr);if(!g)return null;u.push(g)}}return new Ei(d,u)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let i,s;for(const u of this.args){if(i=u.evaluate(t),s=null,i instanceof Hr)return i;if(typeof i=="string"){const d=t.parseColor(i);if(d)return d}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:yd(i[0],i[1],i[2],i[3]),!s))return new Hr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Ve(s||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const s of this.args){if(i=s.evaluate(t),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Ve(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Li.fromString(Fl(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Yi.fromString(Fl(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(i=>i.evaluate(t)):Fl(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new cn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ar(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var _o=Ei;const jc=["Unknown","Point","LineString","Polygon"];var Nl=class{constructor(r,t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=t}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-r[0])+this.featureDistanceData.bearing[1]*(s*t-r[1])}return 0}parseColor(r){let t=this._parseColorCache[r];return t||(t=this._parseColorCache[r]=Hr.parse(r)),t}getConfig(r){return this.options?this.options.get(r):null}};class fs{constructor(t,i,s,u,d){this.name=t,this.type=i,this._evaluate=s,this.args=u,this._overloadIndex=d}evaluate(t){if(!this._evaluate){const i=fs.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const s=t[0],u=fs.definitions[s];if(!u)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(u)?u[0]:u.type,f=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=[];let v=null,b=-1;for(const[T,M]of f){if(Array.isArray(T)&&T.length!==t.length-1)continue;g.push(T),b++,v=new Kp(i.registry,i.path,null,i.scope,void 0,i._scope,i.options);const k=[];let I=!1;for(let R=1;R<t.length;R++){const B=t[R],j=Array.isArray(T)?T[R-1]:T.type,U=v.parse(B,1+k.length,j);if(!U){I=!0;break}k.push(U)}if(!I)if(Array.isArray(T)&&T.length!==k.length)v.error(`Expected ${T.length} arguments, but found ${k.length} instead.`);else{for(let R=0;R<k.length;R++){const B=Array.isArray(T)?T[R]:T.type,j=k[R];v.concat(R+1).checkSubtype(B,j.type)}if(v.errors.length===0)return new fs(s,d,M,k,b)}}if(g.length===1)i.errors.push(...v.errors);else{const T=(g.length?g:f.map(([k])=>k)).map(cy).join(" | "),M=[];for(let k=1;k<t.length;k++){const I=i.parse(t[k],1+M.length);if(!I)return null;M.push(qr(I.type))}i.error(`Expected arguments of type ${T}, but found (${M.join(", ")}) instead.`)}return null}static register(t,i){fs.definitions=i;for(const s in i)t[s]=fs}}function cy(r){return Array.isArray(r)?`(${r.map(qr).join(", ")})`:`(${qr(r.type)}...)`}var ps=fs;class Hu{constructor(t,i,s){this.type=fa,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return i.error("Collator options argument must be an object.");const u=i.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Er);if(!u)return null;const d=i.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Er);if(!d)return null;let f=null;return s.locale&&(f=i.parse(s.locale,1,pr),!f)?null:new Hu(u,d,f)}evaluate(t){return new qu(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var Bp={exports:{}};Bp.exports=function(){function r(s,u,d,f,g){for(;f>d;){if(f-d>600){var v=f-d+1,b=u-d+1,T=Math.log(v),M=.5*Math.exp(2*T/3),k=.5*Math.sqrt(T*M*(v-M)/v)*(b-v/2<0?-1:1);r(s,u,Math.max(d,Math.floor(u-b*M/v+k)),Math.min(f,Math.floor(u+(v-b)*M/v+k)),g)}var I=s[u],R=d,B=f;for(t(s,d,u),g(s[f],I)>0&&t(s,d,f);R<B;){for(t(s,R,B),R++,B--;g(s[R],I)<0;)R++;for(;g(s[B],I)>0;)B--}g(s[d],I)===0?t(s,d,B):t(s,++B,f),B<=u&&(d=B+1),u<=B&&(f=B-1)}}function t(s,u,d){var f=s[u];s[u]=s[d],s[d]=f}function i(s,u){return s<u?-1:s>u?1:0}return function(s,u,d,f,g){r(s,u,d||0,f||s.length-1,g||i)}}();var uy=be(Bp.exports);function vd(r){let t=0;for(let i,s,u=0,d=r.length,f=d-1;u<d;f=u++)i=r[u],s=r[f],t+=(s.x-i.x)*(i.y+s.y);return t}function Xa(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Ya(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function hy(r,t,i){const s=r[0]-t[0],u=r[1]-t[1],d=r[0]-i[0],f=r[1]-i[1];return s*f-d*u==0&&s*d<=0&&u*f<=0}function jl(r,t,i=!1){let s=!1;for(let g=0,v=t.length;g<v;g++){const b=t[g];for(let T=0,M=b.length,k=M-1;T<M;k=T++){const I=b[k],R=b[T];if(hy(r,I,R))return i;(d=I)[1]>(u=r)[1]!=(f=R)[1]>u[1]&&u[0]<(f[0]-d[0])*(u[1]-d[1])/(f[1]-d[1])+d[0]&&(s=!s)}}var u,d,f;return s}function Fp(r,t,i,s){const u=s[0]-i[0],d=s[1]-i[1],f=(r[0]-i[0])*d-u*(r[1]-i[1]),g=(t[0]-i[0])*d-u*(t[1]-i[1]);return f>0&&g<0||f<0&&g>0}function ma(r,t,i,s){return(u=[s[0]-i[0],s[1]-i[1]])[0]*(d=[t[0]-r[0],t[1]-r[1]])[1]-u[1]*d[0]!=0&&!(!Fp(r,t,i,s)||!Fp(i,s,r,t));var u,d}const gr=8192;function kb(r,t){const i=(180+r[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(i*u*gr),Math.round(s*u*gr)]}function Pb(r,t){for(let i=0;i<t.length;i++)if(jl(r,t[i]))return!0;return!1}function Ib(r,t,i){for(const s of i)for(let u=0,d=s.length,f=d-1;u<d;f=u++)if(ma(r,t,s[f],s[u]))return!0;return!1}function Np(r,t){for(let i=0;i<r.length;++i)if(!jl(r[i],t))return!1;for(let i=0;i<r.length-1;++i)if(Ib(r[i],r[i+1],t))return!1;return!0}function zb(r,t){for(let i=0;i<t.length;i++)if(Np(r,t[i]))return!0;return!1}function xd(r,t,i){const s=[];for(let u=0;u<r.length;u++){const d=[];for(let f=0;f<r[u].length;f++){const g=kb(r[u][f],i);Xa(t,g),d.push(g)}s.push(d)}return s}function jp(r,t,i){const s=[];for(let u=0;u<r.length;u++){const d=xd(r[u],t,i);s.push(d)}return s}function Vp(r,t,i,s){if(r[0]<i[0]||r[0]>i[2]){const u=.5*s;let d=r[0]-i[0]>u?-s:i[0]-r[0]>u?s:0;d===0&&(d=r[0]-i[2]>u?-s:i[2]-r[0]>u?s:0),r[0]+=d}Xa(t,r)}function Vl(r,t,i,s){const u=Math.pow(2,s.z)*gr,d=[s.x*gr,s.y*gr],f=[];if(!r)return f;for(const g of r)for(const v of g){const b=[v.x+d[0],v.y+d[1]];Vp(b,t,i,u),f.push(b)}return f}function $p(r,t,i,s){const u=Math.pow(2,s.z)*gr,d=[s.x*gr,s.y*gr],f=[];if(!r)return f;for(const v of r){const b=[];for(const T of v){const M=[T.x+d[0],T.y+d[1]];Xa(t,M),b.push(M)}f.push(b)}if(t[2]-t[0]<=u/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of f)for(const b of v)Vp(b,t,i,u)}var g;return f}class js{constructor(t,i){this.type=Er,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Za(t[1])){const s=t[1];if(s.type==="FeatureCollection")for(let u=0;u<s.features.length;++u){const d=s.features[u].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new js(s,s.features[u].geometry)}else if(s.type==="Feature"){const u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new js(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new js(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=i.canonicalID();if(!f)return!1;if(s.type==="Polygon"){const g=xd(s.coordinates,d,f),v=Vl(i.geometry(),u,d,f);if(!Ya(u,d))return!1;for(const b of v)if(!jl(b,g))return!1}if(s.type==="MultiPolygon"){const g=jp(s.coordinates,d,f),v=Vl(i.geometry(),u,d,f);if(!Ya(u,d))return!1;for(const b of v)if(!Pb(b,g))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,s){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=i.canonicalID();if(!f)return!1;if(s.type==="Polygon"){const g=xd(s.coordinates,d,f),v=$p(i.geometry(),u,d,f);if(!Ya(u,d))return!1;for(const b of v)if(!Np(b,g))return!1}if(s.type==="MultiPolygon"){const g=jp(s.coordinates,d,f),v=$p(i.geometry(),u,d,f);if(!Ya(u,d))return!1;for(const b of v)if(!zb(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var bd=js,Up={exports:{}};Up.exports=function(){var r={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,i=t*(2-t),s=Math.PI/180,u=function(b,T){if(b===void 0)throw new Error("No latitude given.");if(T&&!r[T])throw new Error("Unknown unit "+T+". Use one of: "+Object.keys(r).join(", "));var M=6378.137*s*(T?r[T]:1),k=Math.cos(b*s),I=1/(1-i*(1-k*k)),R=Math.sqrt(I);this.kx=M*R*k,this.ky=M*R*I*(1-i)},d={units:{configurable:!0}};function f(b,T){return b[0]===T[0]&&b[1]===T[1]}function g(b,T,M){var k=v(T[0]-b[0]);return[b[0]+k*M,b[1]+(T[1]-b[1])*M]}function v(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return u.fromTile=function(b,T,M){var k=Math.PI*(1-2*(b+.5)/Math.pow(2,T)),I=Math.atan(.5*(Math.exp(k)-Math.exp(-k)))/s;return new u(I,M)},d.units.get=function(){return r},u.prototype.distance=function(b,T){var M=v(b[0]-T[0])*this.kx,k=(b[1]-T[1])*this.ky;return Math.sqrt(M*M+k*k)},u.prototype.bearing=function(b,T){var M=v(T[0]-b[0])*this.kx;return Math.atan2(M,(T[1]-b[1])*this.ky)/s},u.prototype.destination=function(b,T,M){var k=M*s;return this.offset(b,Math.sin(k)*T,Math.cos(k)*T)},u.prototype.offset=function(b,T,M){return[b[0]+T/this.kx,b[1]+M/this.ky]},u.prototype.lineDistance=function(b){for(var T=0,M=0;M<b.length-1;M++)T+=this.distance(b[M],b[M+1]);return T},u.prototype.area=function(b){for(var T=0,M=0;M<b.length;M++)for(var k=b[M],I=0,R=k.length,B=R-1;I<R;B=I++)T+=v(k[I][0]-k[B][0])*(k[I][1]+k[B][1])*(M?-1:1);return Math.abs(T)/2*this.kx*this.ky},u.prototype.along=function(b,T){var M=0;if(T<=0)return b[0];for(var k=0;k<b.length-1;k++){var I=b[k],R=b[k+1],B=this.distance(I,R);if((M+=B)>T)return g(I,R,(T-(M-B))/B)}return b[b.length-1]},u.prototype.pointToSegmentDistance=function(b,T,M){var k=T[0],I=T[1],R=v(M[0]-k)*this.kx,B=(M[1]-I)*this.ky,j=0;return R===0&&B===0||((j=(v(b[0]-k)*this.kx*R+(b[1]-I)*this.ky*B)/(R*R+B*B))>1?(k=M[0],I=M[1]):j>0&&(k+=R/this.kx*j,I+=B/this.ky*j)),R=v(b[0]-k)*this.kx,B=(b[1]-I)*this.ky,Math.sqrt(R*R+B*B)},u.prototype.pointOnLine=function(b,T){for(var M,k,I,R,B=1/0,j=0;j<b.length-1;j++){var U=b[j][0],J=b[j][1],ee=v(b[j+1][0]-U)*this.kx,oe=(b[j+1][1]-J)*this.ky,ue=0;ee===0&&oe===0||((ue=(v(T[0]-U)*this.kx*ee+(T[1]-J)*this.ky*oe)/(ee*ee+oe*oe))>1?(U=b[j+1][0],J=b[j+1][1]):ue>0&&(U+=ee/this.kx*ue,J+=oe/this.ky*ue));var fe=(ee=v(T[0]-U)*this.kx)*ee+(oe=(T[1]-J)*this.ky)*oe;fe<B&&(B=fe,M=U,k=J,I=j,R=ue)}return{point:[M,k],index:I,t:Math.max(0,Math.min(1,R))}},u.prototype.lineSlice=function(b,T,M){var k=this.pointOnLine(M,b),I=this.pointOnLine(M,T);if(k.index>I.index||k.index===I.index&&k.t>I.t){var R=k;k=I,I=R}var B=[k.point],j=k.index+1,U=I.index;!f(M[j],B[0])&&j<=U&&B.push(M[j]);for(var J=j+1;J<=U;J++)B.push(M[J]);return f(M[U],I.point)||B.push(I.point),B},u.prototype.lineSliceAlong=function(b,T,M){for(var k=0,I=[],R=0;R<M.length-1;R++){var B=M[R],j=M[R+1],U=this.distance(B,j);if((k+=U)>b&&I.length===0&&I.push(g(B,j,(b-(k-U))/U)),k>=T)return I.push(g(B,j,(T-(k-U))/U)),I;k>b&&I.push(j)}return I},u.prototype.bufferPoint=function(b,T){var M=T/this.ky,k=T/this.kx;return[b[0]-k,b[1]-M,b[0]+k,b[1]+M]},u.prototype.bufferBBox=function(b,T){var M=T/this.ky,k=T/this.kx;return[b[0]-k,b[1]-M,b[2]+k,b[3]+M]},u.prototype.insideBBox=function(b,T){return v(b[0]-T[0])>=0&&v(b[0]-T[2])<=0&&b[1]>=T[1]&&b[1]<=T[3]},Object.defineProperties(u,d),u}();var Gp=be(Up.exports),wd={exports:{}};wd.exports=function(){var r=function(i,s){if(i===void 0&&(i=[]),s===void 0&&(s=t),this.data=i,this.length=this.data.length,this.compare=s,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function t(i,s){return i<s?-1:i>s?1:0}return r.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var i=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),i}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(i){for(var s=this.data,u=this.compare,d=s[i];i>0;){var f=i-1>>1,g=s[f];if(u(d,g)>=0)break;s[i]=g,i=f}s[i]=d},r.prototype._down=function(i){for(var s=this.data,u=this.compare,d=this.length>>1,f=s[i];i<d;){var g=1+(i<<1),v=s[g],b=g+1;if(b<this.length&&u(s[b],v)<0&&(g=b,v=s[b]),u(v,f)>=0)break;s[i]=v,i=g}s[i]=f},r}();var Sd=be(wd.exports),_t=8192;function dy(r,t){return t.dist-r.dist}const Td=100,Wp=50;function fy(r){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==r[i])return!1;return!0}function Ed(r){return r[1]-r[0]+1}function ga(r,t){const i=r[1]>=r[0]&&r[1]<t;return i||console.warn("Distance Expression: Index is out of range"),i}function Cd(r,t){if(r[0]>r[1])return[null,null];const i=Ed(r);if(t){if(i===2)return[r,null];const s=Math.floor(i/2);return[[r[0],r[0]+s],[r[0]+s,r[1]]]}{if(i===1)return[r,null];const s=Math.floor(i/2)-1;return[[r[0],r[0]+s],[r[0]+s+1,r[1]]]}}function Ka(r,t){const i=[1/0,1/0,-1/0,-1/0];if(!ga(t,r.length))return i;for(let s=t[0];s<=t[1];++s)Xa(i,r[s]);return i}function Md(r){const t=[1/0,1/0,-1/0,-1/0];for(let i=0;i<r.length;++i)for(let s=0;s<r[i].length;++s)Xa(t,r[i][s]);return t}function $l(r,t,i){if(fy(r)||fy(t))return NaN;let s=0,u=0;return r[2]<t[0]&&(s=t[0]-r[2]),r[0]>t[2]&&(s=r[0]-t[2]),r[1]>t[3]&&(u=r[1]-t[3]),r[3]<t[1]&&(u=t[1]-r[3]),i.distance([0,0],[s,u])}function qp(r,t){const i=Math.pow(2,t.z);return[(u=(r.x/_t+t.x)/i,360*u-180),(s=(r.y/_t+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,u}function Rb(r,t){const i=[];for(let s=0;s<r.length;++s)i.push(qp(r[s],t));return i}function Hp(r,t,i){const s=i.pointOnLine(t,r).point;return i.distance(r,s)}function Zp(r,t,i,s,u){const d=i.slice(s[0],s[1]+1);let f=1/0;for(let g=t[0];g<=t[1];++g)if((f=Math.min(f,Hp(r[g],d,u)))===0)return 0;return f}function Xp(r,t,i,s,u){const d=Math.min(u.pointToSegmentDistance(r,i,s),u.pointToSegmentDistance(t,i,s)),f=Math.min(u.pointToSegmentDistance(i,r,t),u.pointToSegmentDistance(s,r,t));return Math.min(d,f)}function Db(r,t,i,s,u){if(!ga(t,r.length)||!ga(s,i.length))return NaN;let d=1/0;for(let f=t[0];f<t[1];++f)for(let g=s[0];g<s[1];++g){if(ma(r[f],r[f+1],i[g],i[g+1]))return 0;d=Math.min(d,Xp(r[f],r[f+1],i[g],i[g+1],u))}return d}function Lb(r,t,i,s,u){if(!ga(t,r.length)||!ga(s,i.length))return NaN;let d=1/0;for(let f=t[0];f<=t[1];++f)for(let g=s[0];g<=s[1];++g)if((d=Math.min(d,u.distance(r[f],i[g])))===0)return d;return d}function py(r,t,i){if(jl(r,t,!0))return 0;let s=1/0;for(const u of t){const d=u.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[d-1]&&(s=Math.min(s,i.pointToSegmentDistance(r,u[d-1],u[0])))===0||(s=Math.min(s,Hp(r,u,i)))===0)return s}return s}function Ob(r,t,i,s){if(!ga(t,r.length))return NaN;for(let d=t[0];d<=t[1];++d)if(jl(r[d],i,!0))return 0;let u=1/0;for(let d=t[0];d<t[1];++d)for(const f of i)for(let g=0,v=f.length,b=v-1;g<v;b=g++){if(ma(r[d],r[d+1],f[b],f[g]))return 0;u=Math.min(u,Xp(r[d],r[d+1],f[b],f[g],s))}return u}function my(r,t){for(const i of r)for(let s=0;s<=i.length-1;++s)if(jl(i[s],t,!0))return!0;return!1}function gy(r,t,i,s=1/0){const u=Md(r),d=Md(t);if(s!==1/0&&$l(u,d,i)>=s)return s;if(Ya(u,d)){if(my(r,t))return 0}else if(my(t,r))return 0;let f=s;for(const g of r)for(let v=0,b=g.length,T=b-1;v<b;T=v++)for(const M of t)for(let k=0,I=M.length,R=I-1;k<I;R=k++){if(ma(g[T],g[v],M[R],M[k]))return 0;f=Math.min(f,Xp(g[T],g[v],M[R],M[k],i))}return f}function Ad(r,t,i,s,u,d,f){if(d===null||f===null)return;const g=$l(Ka(s,d),Ka(u,f),i);g<t&&r.push({dist:g,range1:d,range2:f})}function Bb(r,t,i,s,u=1/0){let d=Math.min(s.distance(r[0],i[0][0]),u);if(d===0)return d;const f=new Sd([{dist:0,range1:[0,r.length-1],range2:[0,0]}],dy),g=t?Wp:Td,v=Md(i);for(;f.length;){const b=f.pop();if(b.dist>=d)continue;const T=b.range1;if(Ed(T)<=g){if(!ga(T,r.length))return NaN;if(t){const M=Ob(r,T,i,s);if((d=Math.min(d,M))===0)return d}else for(let M=T[0];M<=T[1];++M){const k=py(r[M],i,s);if((d=Math.min(d,k))===0)return d}}else{const M=Cd(T,t);if(M[0]!==null){const k=$l(Ka(r,M[0]),v,s);k<d&&f.push({dist:k,range1:M[0],range2:[0,0]})}if(M[1]!==null){const k=$l(Ka(r,M[1]),v,s);k<d&&f.push({dist:k,range1:M[1],range2:[0,0]})}}}return d}function _y(r,t,i,s,u,d=1/0){let f=Math.min(d,u.distance(r[0],i[0]));if(f===0)return f;const g=new Sd([{dist:0,range1:[0,r.length-1],range2:[0,i.length-1]}],dy),v=t?Wp:Td,b=s?Wp:Td;for(;g.length;){const T=g.pop();if(T.dist>=f)continue;const M=T.range1,k=T.range2;if(Ed(M)<=v&&Ed(k)<=b){if(!ga(M,r.length)||!ga(k,i.length))return NaN;if(t&&s?f=Math.min(f,Db(r,M,i,k,u)):t||s?t&&!s?f=Math.min(f,Zp(i,k,r,M,u)):!t&&s&&(f=Math.min(f,Zp(r,M,i,k,u))):f=Math.min(f,Lb(r,M,i,k,u)),f===0)return f}else{const I=Cd(M,t),R=Cd(k,s);Ad(g,f,u,r,i,I[0],R[0]),Ad(g,f,u,r,i,I[0],R[1]),Ad(g,f,u,r,i,I[1],R[0]),Ad(g,f,u,r,i,I[1],R[1])}}return f}function kd(r,t,i,s,u=1/0){let d=u;const f=Ka(r,[0,r.length-1]);for(const g of i)if(!(d!==1/0&&$l(f,Ka(g,[0,g.length-1]),s)>=d)&&(d=Math.min(d,_y(r,t,g,!0,s,d)),d===0))return d;return d}function Zu(r,t,i,s,u=1/0){let d=u;const f=Ka(r,[0,r.length-1]);for(const g of i){if(d!==1/0&&$l(f,Md(g),s)>=d)continue;const v=Bb(r,t,g,s,d);if(isNaN(v))return v;if((d=Math.min(d,v))===0)return d}return d}function Pd(r){return r==="Point"||r==="MultiPoint"||r==="LineString"||r==="MultiLineString"||r==="Polygon"||r==="MultiPolygon"}class Xu{constructor(t,i){this.type=Je,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Za(t[1])){const s=t[1];if(s.type==="FeatureCollection"){for(let u=0;u<s.features.length;++u)if(Pd(s.features[u].geometry.type))return new Xu(s,s.features[u].geometry)}else if(s.type==="Feature"){if(Pd(s.geometry.type))return new Xu(s,s.geometry)}else if(Pd(s.type))return new Xu(s,s)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const i=t.geometry(),s=t.canonicalID();if(i!=null&&s!=null){if(t.geometryType()==="Point")return function(u,d,f){const g=[];for(const b of u)for(const T of b)g.push(qp(T,d));const v=new Gp(g[0][1],"meters");return f.type==="Point"||f.type==="MultiPoint"||f.type==="LineString"?_y(g,!1,f.type==="Point"?[f.coordinates]:f.coordinates,f.type==="LineString",v):f.type==="MultiLineString"?kd(g,!1,f.coordinates,v):f.type==="Polygon"||f.type==="MultiPolygon"?Zu(g,!1,f.type==="Polygon"?[f.coordinates]:f.coordinates,v):null}(i,s,this.geometries);if(t.geometryType()==="LineString")return function(u,d,f){const g=[];for(const b of u){const T=[];for(const M of b)T.push(qp(M,d));g.push(T)}const v=new Gp(g[0][0][1],"meters");if(f.type==="Point"||f.type==="MultiPoint"||f.type==="LineString")return kd(f.type==="Point"?[f.coordinates]:f.coordinates,f.type==="LineString",g,v);if(f.type==="MultiLineString"){let b=1/0;for(let T=0;T<f.coordinates.length;T++){const M=kd(f.coordinates[T],!0,g,v,b);if(isNaN(M))return M;if((b=Math.min(b,M))===0)return b}return b}if(f.type==="Polygon"||f.type==="MultiPolygon"){let b=1/0;for(let T=0;T<g.length;T++){const M=Zu(g[T],!0,f.type==="Polygon"?[f.coordinates]:f.coordinates,v,b);if(isNaN(M))return M;if((b=Math.min(b,M))===0)return b}return b}return null}(i,s,this.geometries);if(t.geometryType()==="Polygon")return function(u,d,f){const g=[];for(const b of function(T,M){const k=T.length;if(k<=1)return[T];const I=[];let R,B;for(let j=0;j<k;j++){const U=vd(T[j]);U!==0&&(T[j].area=Math.abs(U),B===void 0&&(B=U<0),B===U<0?(R&&I.push(R),R=[T[j]]):R.push(T[j]))}return R&&I.push(R),I}(u)){const T=[];for(let M=0;M<b.length;++M)T.push(Rb(b[M],d));g.push(T)}const v=new Gp(g[0][0][0][1],"meters");if(f.type==="Point"||f.type==="MultiPoint"||f.type==="LineString")return Zu(f.type==="Point"?[f.coordinates]:f.coordinates,f.type==="LineString",g,v);if(f.type==="MultiLineString"){let b=1/0;for(let T=0;T<f.coordinates.length;T++){const M=Zu(f.coordinates[T],!0,g,v,b);if(isNaN(M))return M;if((b=Math.min(b,M))===0)return b}return b}return f.type==="Polygon"||f.type==="MultiPolygon"?function(b,T,M){let k=1/0;for(const I of b)for(const R of T){const B=gy(I,R,M,k);if(isNaN(B))return B;if((k=Math.min(k,B))===0)return k}return k}(f.type==="Polygon"?[f.coordinates]:f.coordinates,g,v):null}(i,s,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Yp=Xu;function Vc(r){if(r instanceof ps&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof bd||r instanceof Yp)return!1;let t=!0;return r.eachChild(i=>{t&&!Vc(i)&&(t=!1)}),t}function Ci(r){if(r instanceof ps&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(i=>{t&&!Ci(i)&&(t=!1)}),t}function Yu(r){if(r instanceof ps&&r.name==="config")return!1;let t=!0;return r.eachChild(i=>{t&&!Yu(i)&&(t=!1)}),t}function Ul(r,t){if(r instanceof ps&&t.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(s=>{i&&!Ul(s,t)&&(i=!1)}),i}class Id{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const s=t[1];return i.scope.has(s)?new Id(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var yy=Id;class $c{constructor(t,i=[],s,u=new Wu,d=[],f,g){this.registry=t,this.path=i,this.key=i.map(v=>`[${v}]`).join(""),this.scope=u,this.errors=d,this.expectedType=s,this._scope=f,this.options=g}parse(t,i,s,u,d={}){return i||s?this.concat(i,s,u)._parse(t,d):this._parse(t,d)}_parse(t,i){function s(u,d,f){return f==="assert"?new Dr(d,[u]):f==="coerce"?new _o(d,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(u){let d=u.parse(t,this);if(!d)return null;if(this.expectedType){const f=this.expectedType,g=d.type;if(f.kind!=="string"&&f.kind!=="number"&&f.kind!=="boolean"&&f.kind!=="object"&&f.kind!=="array"||g.kind!=="value")if(f.kind!=="color"&&f.kind!=="formatted"&&f.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(f,g))return null}else d=s(d,f,i.typeAnnotation||"coerce");else d=s(d,f,i.typeAnnotation||"assert")}if(!(d instanceof Re)&&d.type.kind!=="resolvedImage"&&zd(d)){const f=new Nl(this._scope,this.options);try{d=new Re(d.type,d.evaluate(f))}catch(g){return this.error(g.message),null}}return d}return _o.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,s){const u=typeof t=="number"?this.path.concat(t):this.path,d=s?this.scope.concat(s):this.scope;return new $c(this.registry,u,i||null,d,this.errors,this._scope,this.options)}error(t,...i){const s=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new Io(s,t))}checkSubtype(t,i){const s=pa(t,i);return s&&this.error(s),s}}var Kp=$c;function zd(r){if(r instanceof yy)return zd(r.boundExpression);if(r instanceof ps&&r.name==="error"||r instanceof ps&&r.name==="config"||r instanceof Hu||r instanceof bd||r instanceof Yp)return!1;const t=r instanceof _o||r instanceof Dr;let i=!0;return r.eachChild(s=>{i=t?i&&zd(s):i&&s instanceof Re}),!!i&&Vc(r)&&Ul(r,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Rd(r,t){const i=r.length-1;let s,u,d=0,f=i,g=0;for(;d<=f;)if(g=Math.floor((d+f)/2),s=r[g],u=r[g+1],s<=t){if(g===i||t<u)return g;d=g+1}else{if(!(s>t))throw new Ve("Input is not a number.");f=g-1}return 0}class Jp{constructor(t,i,s){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[u,d]of s)this.labels.push(u),this.outputs.push(d)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(t[1],1,Je);if(!s)return null;const u=[];let d=null;i.expectedType&&i.expectedType.kind!=="value"&&(d=i.expectedType);for(let f=1;f<t.length;f+=2){const g=f===1?-1/0:t[f],v=t[f+1],b=f,T=f+1;if(typeof g!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(u.length&&u[u.length-1][0]>=g)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const M=i.parse(v,T,d);if(!M)return null;d=d||M.type,u.push([g,M])}return new Jp(d,s,u)}evaluate(t){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(t);const u=this.input.evaluate(t);if(u<=i[0])return s[0].evaluate(t);const d=i.length;return u>=i[d-1]?s[d-1].evaluate(t):s[Rd(i,u)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var Qp=Jp;function ur(r,t,i){return r*(1-i)+t*i}function Dd(r,t,i){return r.map((s,u)=>ur(s,t[u],i))}var Ku=Object.freeze({__proto__:null,array:Dd,color:function(r,t,i){return new Hr(ur(r.r,t.r,i),ur(r.g,t.g,i),ur(r.b,t.b,i),ur(r.a,t.a,i))},number:ur});const Ju=.95047,Gl=1.08883,vy=4/29,Uc=6/29,xy=3*Uc*Uc,Fb=Uc*Uc*Uc,Nb=Math.PI/180,jb=180/Math.PI;function em(r){return r>Fb?Math.pow(r,1/3):r/xy+vy}function tm(r){return r>Uc?r*r*r:xy*(r-vy)}function rm(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function nm(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function by(r){const t=nm(r.r),i=nm(r.g),s=nm(r.b),u=em((.4124564*t+.3575761*i+.1804375*s)/Ju),d=em((.2126729*t+.7151522*i+.072175*s)/1);return{l:116*d-16,a:500*(u-d),b:200*(d-em((.0193339*t+.119192*i+.9503041*s)/Gl)),alpha:r.a}}function Wl(r){let t=(r.l+16)/116,i=isNaN(r.a)?t:t+r.a/500,s=isNaN(r.b)?t:t-r.b/200;return t=1*tm(t),i=Ju*tm(i),s=Gl*tm(s),new Hr(rm(3.2404542*i-1.5371385*t-.4985314*s),rm(-.969266*i+1.8760108*t+.041556*s),rm(.0556434*i-.2040259*t+1.0572252*s),r.alpha)}function wy(r,t,i){const s=t-r;return r+i*(s>180||s<-180?s-360*Math.round(s/360):s)}const Gc={forward:by,reverse:Wl,interpolate:function(r,t,i){return{l:ur(r.l,t.l,i),a:ur(r.a,t.a,i),b:ur(r.b,t.b,i),alpha:ur(r.alpha,t.alpha,i)}}},Ja={forward:function(r){const{l:t,a:i,b:s}=by(r),u=Math.atan2(s,i)*jb;return{h:u<0?u+360:u,c:Math.sqrt(i*i+s*s),l:t,alpha:r.a}},reverse:function(r){const t=r.h*Nb,i=r.c;return Wl({l:r.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:r.alpha})},interpolate:function(r,t,i){return{h:wy(r.h,t.h,i),c:ur(r.c,t.c,i),l:ur(r.l,t.l,i),alpha:ur(r.alpha,t.alpha,i)}}};var Sy=Object.freeze({__proto__:null,hcl:Ja,lab:Gc});class Ld{constructor(t,i,s,u,d){this.type=t,this.operator=i,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[f,g]of d)this.labels.push(f),this.outputs.push(g)}static interpolationFactor(t,i,s,u){let d=0;if(t.name==="exponential")d=Vs(i,t.base,s,u);else if(t.name==="linear")d=Vs(i,1,s,u);else if(t.name==="cubic-bezier"){const f=t.controlPoints;d=new Be(f[0],f[1],f[2],f[3]).solve(Vs(i,1,s,u))}return d}static parse(t,i){let[s,u,d,...f]=t;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const b=u[1];if(typeof b!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:b}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const b=u.slice(1);if(b.length!==4||b.some(T=>typeof T!="number"||T<0||T>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(d=i.parse(d,2,Je),!d)return null;const g=[];let v=null;s==="interpolate-hcl"||s==="interpolate-lab"?v=mo:i.expectedType&&i.expectedType.kind!=="value"&&(v=i.expectedType);for(let b=0;b<f.length;b+=2){const T=f[b],M=f[b+1],k=b+3,I=b+4;if(typeof T!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(g.length&&g[g.length-1][0]>=T)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const R=i.parse(M,I,v);if(!R)return null;v=v||R.type,g.push([T,R])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new Ld(v,s,u,d,g):i.error(`Type ${qr(v)} is not interpolatable.`)}evaluate(t){const i=this.labels,s=this.outputs;if(i.length===1)return s[0].evaluate(t);const u=this.input.evaluate(t);if(u<=i[0])return s[0].evaluate(t);const d=i.length;if(u>=i[d-1])return s[d-1].evaluate(t);const f=Rd(i,u),g=Ld.interpolationFactor(this.interpolation,u,i[f],i[f+1]),v=s[f].evaluate(t),b=s[f+1].evaluate(t);return this.operator==="interpolate"?Ku[this.type.kind.toLowerCase()](v,b,g):this.operator==="interpolate-hcl"?Ja.reverse(Ja.interpolate(Ja.forward(v),Ja.forward(b),g)):Gc.reverse(Gc.interpolate(Gc.forward(v),Gc.forward(b),g))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let s=0;s<this.labels.length;s++)i.push(this.labels[s],this.outputs[s].serialize());return i}}function Vs(r,t,i,s){const u=s-i,d=r-i;return u===0?0:t===1?d/u:(Math.pow(t,d)-1)/(Math.pow(t,u)-1)}var ms=Ld;class Qa{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let s=null;const u=i.expectedType;u&&u.kind!=="value"&&(s=u);const d=[];for(const g of t.slice(1)){const v=i.parse(g,1+d.length,s,void 0,{typeAnnotation:"omit"});if(!v)return null;s=s||v.type,d.push(v)}const f=u&&d.some(g=>pa(u,g.type));return new Qa(f?cr:s,d)}evaluate(t){let i,s=null,u=0;for(const d of this.args){if(u++,s=d.evaluate(t),s&&s instanceof Yi&&!s.available&&(i||(i=s),s=null,u===this.args.length))return i;if(s!==null)break}return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ty=Qa;class im{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let d=1;d<t.length-1;d+=2){const f=t[d];if(typeof f!="string")return i.error(`Expected string, but found ${typeof f} instead.`,d);if(/[^a-zA-Z0-9_]/.test(f))return i.error("Variable names must contain only alphanumeric characters or '_'.",d);const g=i.parse(t[d+1],d+1);if(!g)return null;s.push([f,g])}const u=i.parse(t[t.length-1],t.length-1,i.expectedType,s);return u?new im(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,s]of this.bindings)t.push(i,s.serialize());return t.push(this.result.serialize()),t}}var Ey=im;class om{constructor(t,i,s){this.type=t,this.index=i,this.input=s}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,Je),u=i.parse(t[2],2,fi(i.expectedType||cr));return s&&u?new om(u.type.itemType,s,u):null}evaluate(t){const i=this.index.evaluate(t),s=this.input.evaluate(t);if(i<0)throw new Ve(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new Ve(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new Ve(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Vb=om;class Od{constructor(t,i){this.type=Er,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,cr),u=i.parse(t[2],2,cr);return s&&u?Ga(s.type,[Er,pr,Je,da,cr])?new Od(s,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(s.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(s==null)return!1;if(!ds(i,["boolean","string","number","null"]))throw new Ve(`Expected first argument to be of type boolean, string, number or null, but found ${qr(Fn(i))} instead.`);if(!ds(s,["string","array"]))throw new Ve(`Expected second argument to be of type array or string, but found ${qr(Fn(s))} instead.`);return s.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var sm=Od;class ql{constructor(t,i,s){this.type=Je,this.needle=t,this.haystack=i,this.fromIndex=s}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,cr),u=i.parse(t[2],2,cr);if(!s||!u)return null;if(!Ga(s.type,[Er,pr,Je,da,cr]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(s.type)} instead`);if(t.length===4){const d=i.parse(t[3],3,Je);return d?new ql(s,u,d):null}return new ql(s,u)}evaluate(t){const i=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ds(i,["boolean","string","number","null"]))throw new Ve(`Expected first argument to be of type boolean, string, number or null, but found ${qr(Fn(i))} instead.`);if(!ds(s,["string","array"]))throw new Ve(`Expected second argument to be of type array or string, but found ${qr(Fn(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(t);return s.indexOf(i,u)}return s.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Cy=ql;class Qu{constructor(t,i,s,u,d,f){this.inputType=t,this.type=i,this.input=s,this.cases=u,this.outputs=d,this.otherwise=f}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let s,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const d={},f=[];for(let b=2;b<t.length-1;b+=2){let T=t[b];const M=t[b+1];Array.isArray(T)||(T=[T]);const k=i.concat(b);if(T.length===0)return k.error("Expected at least one branch label.");for(const R of T){if(typeof R!="number"&&typeof R!="string")return k.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return k.error("Numeric branch labels must be integer values.");if(s){if(k.checkSubtype(s,Fn(R)))return null}else s=Fn(R);if(d[String(R)]!==void 0)return k.error("Branch labels must be unique.");d[String(R)]=f.length}const I=i.parse(M,b,u);if(!I)return null;u=u||I.type,f.push(I)}const g=i.parse(t[1],1,cr);if(!g)return null;const v=i.parse(t[t.length-1],t.length-1,u);return v?g.type.kind!=="value"&&i.concat(1).checkSubtype(s,g.type)?null:new Qu(s,u,g,d,f,v):null}evaluate(t){const i=this.input.evaluate(t);return(Fn(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),s=[],u={};for(const f of i){const g=u[this.cases[f]];g===void 0?(u[this.cases[f]]=s.length,s.push([this.cases[f],[f]])):s[g][1].push(f)}const d=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,g]of s)t.push(g.length===1?d(g[0]):g.map(d)),t.push(this.outputs[f].serialize());return t.push(this.otherwise.serialize()),t}}var $b=Qu;class Wo{constructor(t,i,s){this.type=t,this.branches=i,this.otherwise=s}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const u=[];for(let f=1;f<t.length-1;f+=2){const g=i.parse(t[f],f,Er);if(!g)return null;const v=i.parse(t[f+1],f+1,s);if(!v)return null;u.push([g,v]),s=s||v.type}const d=i.parse(t[t.length-1],t.length-1,s);return d?new Wo(s,u,d):null}evaluate(t){for(const[i,s]of this.branches)if(i.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,s]of this.branches)t(i),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Ub=Wo;class eh{constructor(t,i,s,u){this.type=t,this.input=i,this.beginIndex=s,this.endIndex=u}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=i.parse(t[1],1,cr),u=i.parse(t[2],2,Je);if(!s||!u)return null;if(!Ga(s.type,[fi(cr),pr,cr]))return i.error(`Expected first argument to be of type array or string, but found ${qr(s.type)} instead`);if(t.length===4){const d=i.parse(t[3],3,Je);return d?new eh(s.type,s,u,d):null}return new eh(s.type,s,u)}evaluate(t){const i=this.input.evaluate(t),s=this.beginIndex.evaluate(t);if(!ds(i,["string","array"]))throw new Ve(`Expected first argument to be of type array or string, but found ${qr(Fn(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(t);return i.slice(s,u)}return i.slice(s)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Gb=eh;function My(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ay(r,t,i,s){return s.compare(t,i)===0}function Wc(r,t,i){const s=r!=="=="&&r!=="!=";return class M8{constructor(d,f,g){this.type=Er,this.lhs=d,this.rhs=f,this.collator=g,this.hasUntypedArgument=d.type.kind==="value"||f.type.kind==="value"}static parse(d,f){if(d.length!==3&&d.length!==4)return f.error("Expected two or three arguments.");const g=d[0];let v=f.parse(d[1],1,cr);if(!v)return null;if(!My(g,v.type))return f.concat(1).error(`"${g}" comparisons are not supported for type '${qr(v.type)}'.`);let b=f.parse(d[2],2,cr);if(!b)return null;if(!My(g,b.type))return f.concat(2).error(`"${g}" comparisons are not supported for type '${qr(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return f.error(`Cannot compare types '${qr(v.type)}' and '${qr(b.type)}'.`);s&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new Dr(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new Dr(v.type,[b])));let T=null;if(d.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(T=f.parse(d[3],3,fa),!T)return null}return new M8(v,b,T)}evaluate(d){const f=this.lhs.evaluate(d),g=this.rhs.evaluate(d);if(s&&this.hasUntypedArgument){const v=Fn(f),b=Fn(g);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new Ve(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const v=Fn(f),b=Fn(g);if(v.kind!=="string"||b.kind!=="string")return t(d,f,g)}return this.collator?i(d,f,g,this.collator.evaluate(d)):t(d,f,g)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[r];return this.eachChild(f=>{d.push(f.serialize())}),d}}}const ky=Wc("==",function(r,t,i){return t===i},Ay),am=Wc("!=",function(r,t,i){return t!==i},function(r,t,i,s){return!Ay(0,t,i,s)}),Py=Wc("<",function(r,t,i){return t<i},function(r,t,i,s){return s.compare(t,i)<0}),Wb=Wc(">",function(r,t,i){return t>i},function(r,t,i,s){return s.compare(t,i)>0}),yo=Wc("<=",function(r,t,i){return t<=i},function(r,t,i,s){return s.compare(t,i)<=0}),qb=Wc(">=",function(r,t,i){return t>=i},function(r,t,i,s){return s.compare(t,i)>=0});class lm{constructor(t,i,s,u,d,f){this.type=pr,this.number=t,this.locale=i,this.currency=s,this.unit=u,this.minFractionDigits=d,this.maxFractionDigits=f}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const s=i.parse(t[1],1,Je);if(!s)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=i.parse(u.locale,1,pr),!d))return null;let f=null;if(u.currency&&(f=i.parse(u.currency,1,pr),!f))return null;let g=null;if(u.unit&&(g=i.parse(u.unit,1,pr),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=i.parse(u["min-fraction-digits"],1,Je),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=i.parse(u["max-fraction-digits"],1,Je),!b)?null:new lm(s,d,f,g,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class cm{constructor(t){this.type=Je,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=i.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${qr(s.type)} instead.`):new cm(s):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Ve(`Expected value to be of type string or array, but found ${qr(Fn(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}function th(r){return function(){r=1831565813+(r|=0)|0;let t=Math.imul(r^r>>>15,1|r);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const um={"==":ky,"!=":am,">":Wb,"<":Py,">=":qb,"<=":yo,array:Dr,at:Vb,boolean:Dr,case:Ub,coalesce:Ty,collator:Hu,format:cn,image:Ar,in:sm,"index-of":Cy,interpolate:ms,"interpolate-hcl":ms,"interpolate-lab":ms,length:cm,let:Ey,literal:Re,match:$b,number:Dr,"number-format":lm,object:Dr,slice:Gb,step:Qp,string:Dr,"to-boolean":_o,"to-color":_o,"to-number":_o,"to-string":_o,var:yy,within:bd,distance:Yp};function Bd(r,[t,i,s,u]){t=t.evaluate(r),i=i.evaluate(r),s=s.evaluate(r);const d=u?u.evaluate(r):1,f=yd(t,i,s,d);if(f)throw new Ve(f);return new Hr(t/255*d,i/255*d,s/255*d,d)}function Iy(r,[t,i,s,u]){t=t.evaluate(r),i=i.evaluate(r),s=s.evaluate(r);const d=u?u.evaluate(r):1,f=function(b,T,M,k){return typeof b=="number"&&b>=0&&b<=360?typeof T=="number"&&T>=0&&T<=100&&typeof M=="number"&&M>=0&&M<=100?k===void 0||typeof k=="number"&&k>=0&&k<=1?null:`Invalid hsla value [${[b,T,M,k].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof k=="number"?[b,T,M,k]:[b,T,M]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof k=="number"?[b,T,M,k]:[b,T,M]).join(", ")}]: 'h' must be between 0 and 360.`}(t,i,s,d);if(f)throw new Ve(f);const g=`hsla(${t}, ${i}%, ${s}%, ${d})`,v=Hr.parse(g);if(!v)throw new Ve(`Failed to parse HSLA color: ${g}`);return v}function zy(r,t){return r in t}function Hl(r,t){const i=t[r];return i===void 0?null:i}function Ry(r,t){switch(r){case"string":return String(t);case"number":return+t;case"boolean":return!!t;case"color":return Hr.parse(t)}return t}function Dy(r,t,i,s){return s!==void 0&&(r=s*Math.round(r/s)),t!==void 0&&r<t&&(r=t),i!==void 0&&r>i&&(r=i),r}function hm(r,t,i){t=[t,i,r.scope].filter(Boolean).join("");const s=r.getConfig(t);if(!s)return null;const{type:u,value:d,values:f,minValue:g,maxValue:v,stepValue:b}=s,T=s.default.evaluate(r);let M=T;if(d){const k=r.scope;r.scope=(k||"").split("").slice(1).join(""),M=d.evaluate(r),r.scope=k}return u&&(M=Ry(u,M)),d!==void 0&&M!==void 0&&f&&!f.includes(M)&&(M=T,u&&(M=Ry(u,M))),M===void 0||g===void 0&&v===void 0&&b===void 0||(typeof M=="number"?M=Dy(M,g,v,b):Array.isArray(M)&&(M=M.map(k=>typeof k=="number"?Dy(k,g,v,b):k))),M}function el(r){return{type:r}}ps.register(um,{error:[{kind:"error"},[pr],(r,[t])=>{throw new Ve(t.evaluate(r))}],typeof:[pr,[cr],(r,[t])=>qr(Fn(t.evaluate(r)))],"to-rgba":[fi(Je,4),[mo],(r,[t])=>t.evaluate(r).toArray()],rgb:[mo,[Je,Je,Je],Bd],rgba:[mo,[Je,Je,Je,Je],Bd],hsl:[mo,[Je,Je,Je],Iy],hsla:[mo,[Je,Je,Je,Je],Iy],has:{type:Er,overloads:[[[pr],(r,[t])=>zy(t.evaluate(r),r.properties())],[[pr,Ua],(r,[t,i])=>zy(t.evaluate(r),i.evaluate(r))]]},get:{type:cr,overloads:[[[pr],(r,[t])=>Hl(t.evaluate(r),r.properties())],[[pr,Ua],(r,[t,i])=>Hl(t.evaluate(r),i.evaluate(r))]]},config:{type:cr,overloads:[[[pr],(r,[t])=>hm(r,t.evaluate(r))],[[pr,pr],(r,[t,i])=>hm(r,t.evaluate(r),i.evaluate(r))]]},"feature-state":[cr,[pr],(r,[t])=>Hl(t.evaluate(r),r.featureState||{})],properties:[Ua,[],r=>r.properties()],"geometry-type":[pr,[],r=>r.geometryType()],id:[cr,[],r=>r.id()],zoom:[Je,[],r=>r.globals.zoom],pitch:[Je,[],r=>r.globals.pitch||0],"distance-from-center":[Je,[],r=>r.distanceFromCenter()],"measure-light":[Je,[pr],(r,[t])=>r.measureLight(t.evaluate(r))],"heatmap-density":[Je,[],r=>r.globals.heatmapDensity||0],"line-progress":[Je,[],r=>r.globals.lineProgress||0],"raster-value":[Je,[],r=>r.globals.rasterValue||0],"sky-radial-progress":[Je,[],r=>r.globals.skyRadialProgress||0],accumulated:[cr,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Je,el(Je),(r,t)=>{let i=0;for(const s of t)i+=s.evaluate(r);return i}],"*":[Je,el(Je),(r,t)=>{let i=1;for(const s of t)i*=s.evaluate(r);return i}],"-":{type:Je,overloads:[[[Je,Je],(r,[t,i])=>t.evaluate(r)-i.evaluate(r)],[[Je],(r,[t])=>-t.evaluate(r)]]},"/":[Je,[Je,Je],(r,[t,i])=>t.evaluate(r)/i.evaluate(r)],"%":[Je,[Je,Je],(r,[t,i])=>t.evaluate(r)%i.evaluate(r)],ln2:[Je,[],()=>Math.LN2],pi:[Je,[],()=>Math.PI],e:[Je,[],()=>Math.E],"^":[Je,[Je,Je],(r,[t,i])=>Math.pow(t.evaluate(r),i.evaluate(r))],sqrt:[Je,[Je],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Je,[Je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Je,[Je],(r,[t])=>Math.log(t.evaluate(r))],log2:[Je,[Je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Je,[Je],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Je,[Je],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Je,[Je],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Je,[Je],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Je,[Je],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Je,[Je],(r,[t])=>Math.atan(t.evaluate(r))],min:[Je,el(Je),(r,t)=>Math.min(...t.map(i=>i.evaluate(r)))],max:[Je,el(Je),(r,t)=>Math.max(...t.map(i=>i.evaluate(r)))],abs:[Je,[Je],(r,[t])=>Math.abs(t.evaluate(r))],round:[Je,[Je],(r,[t])=>{const i=t.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Je,[Je],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Je,[Je],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Er,[pr,cr],(r,[t,i])=>r.properties()[t.value]===i.value],"filter-id-==":[Er,[cr],(r,[t])=>r.id()===t.value],"filter-type-==":[Er,[pr],(r,[t])=>r.geometryType()===t.value],"filter-<":[Er,[pr,cr],(r,[t,i])=>{const s=r.properties()[t.value],u=i.value;return typeof s==typeof u&&s<u}],"filter-id-<":[Er,[cr],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i<s}],"filter->":[Er,[pr,cr],(r,[t,i])=>{const s=r.properties()[t.value],u=i.value;return typeof s==typeof u&&s>u}],"filter-id->":[Er,[cr],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i>s}],"filter-<=":[Er,[pr,cr],(r,[t,i])=>{const s=r.properties()[t.value],u=i.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[Er,[cr],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i<=s}],"filter->=":[Er,[pr,cr],(r,[t,i])=>{const s=r.properties()[t.value],u=i.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[Er,[cr],(r,[t])=>{const i=r.id(),s=t.value;return typeof i==typeof s&&i>=s}],"filter-has":[Er,[cr],(r,[t])=>t.value in r.properties()],"filter-has-id":[Er,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Er,[fi(pr)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Er,[fi(cr)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Er,[pr,fi(cr)],(r,[t,i])=>i.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Er,[pr,fi(cr)],(r,[t,i])=>function(s,u,d,f){for(;d<=f;){const g=d+f>>1;if(u[g]===s)return!0;u[g]>s?f=g-1:d=g+1}return!1}(r.properties()[t.value],i.value,0,i.value.length-1)],all:{type:Er,overloads:[[[Er,Er],(r,[t,i])=>t.evaluate(r)&&i.evaluate(r)],[el(Er),(r,t)=>{for(const i of t)if(!i.evaluate(r))return!1;return!0}]]},any:{type:Er,overloads:[[[Er,Er],(r,[t,i])=>t.evaluate(r)||i.evaluate(r)],[el(Er),(r,t)=>{for(const i of t)if(i.evaluate(r))return!0;return!1}]]},"!":[Er,[Er],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Er,[pr],(r,[t])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(t.evaluate(r))}],upcase:[pr,[pr],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[pr,[pr],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[pr,el(cr),(r,t)=>t.map(i=>Fl(i.evaluate(r))).join("")],"resolved-locale":[pr,[fa],(r,[t])=>t.evaluate(r).resolvedLocale()],random:[Je,[Je,Je,cr],(r,t)=>{const[i,s,u]=t.map(f=>f.evaluate(r));if(i>s||i===s)return i;let d;if(typeof u=="string")d=function(f){let g=0;if(f.length===0)return g;for(let v=0;v<f.length;v++)g=(g<<5)-g+f.charCodeAt(v),g&=g;return g}(u);else{if(typeof u!="number")throw new Ve(`Invalid seed input: ${u}`);d=u}return i+th(d)()*(s-i)}]});var rh=um;function qo(r){return{result:"success",value:r}}function tl(r){return{result:"error",value:r}}function Ly(r,t){return!!r&&!!r.parameters&&r.parameters.indexOf(t)>-1}function rl(r){return r["property-type"]==="data-driven"}function nh(r){return Ly(r.expression,"measure-light")}function dm(r){return Ly(r.expression,"zoom")}function fm(r){return!!r.expression&&r.expression.interpolated}function Fd(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Hb(r){return r}function Oy(r,t){const i=t.type==="color",s=r.stops&&typeof r.stops[0][0]=="object",u=s||!(s||r.property!==void 0),d=r.type||(fm(t)?"exponential":"interval");if(i&&((r=Po({},r)).stops&&(r.stops=r.stops.map(b=>[b[0],Hr.parse(b[1])])),r.default=Hr.parse(r.default?r.default:t.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Sy[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let f,g,v;if(d==="exponential")f=ih;else if(d==="interval")f=zo;else if(d==="categorical"){f=Nd,g=Object.create(null);for(const b of r.stops)g[b[0]]=b[1];v=typeof r.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);f=Zb}if(s){const b={},T=[];for(let I=0;I<r.stops.length;I++){const R=r.stops[I],B=R[0].zoom;b[B]===void 0&&(b[B]={zoom:B,type:r.type,property:r.property,default:r.default,stops:[]},T.push(B)),b[B].stops.push([R[0].value,R[1]])}const M=[];for(const I of T)M.push([b[I].zoom,Oy(b[I],t)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:ms.interpolationFactor.bind(void 0,k),zoomStops:M.map(I=>I[0]),evaluate:({zoom:I},R)=>ih({stops:M,base:r.base},t,I).evaluate(I,R)}}if(u){const b=d==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:ms.interpolationFactor.bind(void 0,b),zoomStops:r.stops.map(T=>T[0]),evaluate:({zoom:T})=>f(r,t,T,g,v)}}return{kind:"source",evaluate(b,T){const M=T&&T.properties?T.properties[r.property]:void 0;return M===void 0?nl(r.default,t.default):f(r,t,M,g,v)}}}function nl(r,t,i){return r!==void 0?r:t!==void 0?t:i!==void 0?i:void 0}function Nd(r,t,i,s,u){return nl(typeof i===u?s[i]:void 0,r.default,t.default)}function zo(r,t,i){if(Xt(i)!=="number")return nl(r.default,t.default);const s=r.stops.length;if(s===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[s-1][0])return r.stops[s-1][1];const u=Rd(r.stops.map(d=>d[0]),i);return r.stops[u][1]}function ih(r,t,i){const s=r.base!==void 0?r.base:1;if(Xt(i)!=="number")return nl(r.default,t.default);const u=r.stops.length;if(u===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[u-1][0])return r.stops[u-1][1];const d=Rd(r.stops.map(T=>T[0]),i),f=function(T,M,k,I){const R=I-k,B=T-k;return R===0?0:M===1?B/R:(Math.pow(M,B)-1)/(Math.pow(M,R)-1)}(i,s,r.stops[d][0],r.stops[d+1][0]),g=r.stops[d][1],v=r.stops[d+1][1];let b=Ku[t.type]||Hb;if(r.colorSpace&&r.colorSpace!=="rgb"){const T=Sy[r.colorSpace];b=(M,k)=>T.reverse(T.interpolate(T.forward(M),T.forward(k),f))}return typeof g.evaluate=="function"?{evaluate(...T){const M=g.evaluate.apply(void 0,T),k=v.evaluate.apply(void 0,T);if(M!==void 0&&k!==void 0)return b(M,k,f)}}:b(g,v,f)}function Zb(r,t,i){return t.type==="color"?i=Hr.parse(i):t.type==="formatted"?i=Li.fromString(i.toString()):t.type==="resolvedImage"?i=Yi.fromString(i.toString()):Xt(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),nl(i,r.default,t.default)}class pm{constructor(t,i,s,u){this.expression=t,this._warningHistory={},this._evaluator=new Nl(s,u),this._defaultValue=i?function(d){return d.type==="color"&&(Fd(d.default)||Array.isArray(d.default))?new Hr(0,0,0,0):d.type==="color"?Hr.parse(d.default)||null:d.default===void 0?null:d.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,s,u,d,f,g,v){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,s,u,d,f,g,v){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Ve(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function jd(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in rh}function oh(r,t,i,s){const u=new Kp(rh,[],t?function(f){const g={color:mo,string:pr,number:Je,enum:pr,boolean:Er,formatted:Bs,resolvedImage:Bl};return f.type==="array"?fi(g[f.value]||cr,f.length):g[f.type]}(t):void 0,void 0,void 0,i,s),d=u.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?qo(new pm(d,t,i,s)):tl(u.errors)}class sh{constructor(t,i,s){this.kind=t,this._styleExpression=i,this.isLightConstant=s,this.isStateDependent=t!=="constant"&&!Ci(i.expression),this.isConfigDependent=!Yu(i.expression)}evaluateWithoutErrorHandling(t,i,s,u,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,i,s,u,d,f)}evaluate(t,i,s,u,d,f){return this._styleExpression.evaluate(t,i,s,u,d,f)}}class ah{constructor(t,i,s,u,d){this.kind=t,this.zoomStops=s,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Ci(i.expression),this.isLightConstant=d,this.isConfigDependent=!Yu(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,i,s,u,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,i,s,u,d,f)}evaluate(t,i,s,u,d,f){return this._styleExpression.evaluate(t,i,s,u,d,f)}interpolationFactor(t,i,s){return this.interpolationType?ms.interpolationFactor(this.interpolationType,t,i,s):0}}function lh(r,t,i,s){if((r=oh(r,t,i,s)).result==="error")return r;const u=r.value.expression,d=Vc(u);if(!d&&!rl(t))return tl([new Io("","data expressions not supported")]);const f=Ul(u,["zoom","pitch","distance-from-center"]);if(!f&&!dm(t))return tl([new Io("","zoom expressions not supported")]);const g=Ul(u,["measure-light"]);if(!g&&!nh(t))return tl([new Io("","measure-light expression not supported")]);const v=t.expression&&t.expression.relaxZoomRestriction,b=$d(u);return b||f||v?b instanceof Io?tl([b]):b instanceof ms&&!fm(t)?tl([new Io("",'"interpolate" expressions cannot be used with this property')]):qo(b?new ah(d?"camera":"composite",r.value,b.labels,b instanceof ms?b.interpolation:void 0,g):new sh(d?"constant":"source",r.value,g)):tl([new Io("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Vd{constructor(t,i){this._parameters=t,this._specification=i,Po(this,Oy(this._parameters,this._specification))}static deserialize(t){return new Vd(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function $d(r){let t=null;if(r instanceof Ey)t=$d(r.result);else if(r instanceof Ty){for(const i of r.args)if(t=$d(i),t)break}else(r instanceof Qp||r instanceof ms)&&r.input instanceof ps&&r.input.name==="zoom"&&(t=r);return t instanceof Io||r.eachChild(i=>{const s=$d(i);s instanceof Io?t=s:t&&s&&t!==s&&(t=new Io("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function vo(r){const t=r.key,i=r.value,s=r.valueSpec||{},u=r.objectElementValidators||{},d=r.style,f=r.styleSpec;let g=[];const v=Xt(i);if(v!=="object")return[new Pt(t,i,`object expected, ${v} found`)];for(const b in i){const T=b.split(".")[0];let M;u[T]?M=u[T]:s[T]?M=Qn:u["*"]?M=u["*"]:s["*"]&&(M=Qn),M?g=g.concat(M({key:(t&&`${t}.`)+b,value:i[b],valueSpec:s[T]||s["*"],style:d,styleSpec:f,object:i,objectKey:b},i)):g.push(new Go(t,i[b],`unknown property "${b}"`))}for(const b in s)u[b]||s[b].required&&s[b].default===void 0&&i[b]===void 0&&g.push(new Pt(t,i,`missing required property "${b}"`));return g}function By(r){const t=r.value,i=r.valueSpec,s=r.style,u=r.styleSpec,d=r.key,f=r.arrayElementValidator||Qn;if(Xt(t)!=="array")return[new Pt(d,t,`array expected, ${Xt(t)} found`)];if(i.length&&t.length!==i.length)return[new Pt(d,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new Pt(d,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let g={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};u.$version<7&&(g.function=i.function),Xt(i.value)==="object"&&(g=i.value);let v=[];for(let b=0;b<t.length;b++)v=v.concat(f({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:s,styleSpec:u,key:`${d}[${b}]`},!0));return v}function mm(r){const t=r.key,i=r.value,s=r.valueSpec;let u=Xt(i);if(u==="number"&&i!=i&&(u="NaN"),u!=="number")return[new Pt(t,i,`number expected, ${u} found`)];if("minimum"in s){let d=s.minimum;if(Xt(s.minimum)==="array"&&(d=s.minimum[r.arrayIndex]),i<d)return[new Pt(t,i,`${i} is less than the minimum value ${d}`)]}if("maximum"in s){let d=s.maximum;if(Xt(s.maximum)==="array"&&(d=s.maximum[r.arrayIndex]),i>d)return[new Pt(t,i,`${i} is greater than the maximum value ${d}`)]}return[]}function gm(r){const t=r.valueSpec,i=Rn(r.value.type);let s,u,d,f={};const g=i!=="categorical"&&r.value.property===void 0,v=!g,b=Xt(r.value.stops)==="array"&&Xt(r.value.stops[0])==="array"&&Xt(r.value.stops[0][0])==="object",T=vo({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(I){if(i==="identity")return[new Pt(I.key,I.value,'identity function may not have a "stops" property')];let R=[];const B=I.value;return R=R.concat(By({key:I.key,value:B,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:M})),Xt(B)==="array"&&B.length===0&&R.push(new Pt(I.key,B,"array must have at least one stop")),R},default:function(I){return Qn({key:I.key,value:I.value,valueSpec:t,style:I.style,styleSpec:I.styleSpec})}}});return i==="identity"&&g&&T.push(new Pt(r.key,r.value,'missing required property "property"')),i==="identity"||r.value.stops||T.push(new Pt(r.key,r.value,'missing required property "stops"')),i==="exponential"&&r.valueSpec.expression&&!fm(r.valueSpec)&&T.push(new Pt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(v&&!rl(r.valueSpec)?T.push(new Pt(r.key,r.value,"property functions not supported")):g&&!dm(r.valueSpec)&&T.push(new Pt(r.key,r.value,"zoom functions not supported"))),i!=="categorical"&&!b||r.value.property!==void 0||T.push(new Pt(r.key,r.value,'"property" property is required')),T;function M(I){let R=[];const B=I.value,j=I.key;if(Xt(B)!=="array")return[new Pt(j,B,`array expected, ${Xt(B)} found`)];if(B.length!==2)return[new Pt(j,B,`array length 2 expected, length ${B.length} found`)];if(b){if(Xt(B[0])!=="object")return[new Pt(j,B,`object expected, ${Xt(B[0])} found`)];if(B[0].zoom===void 0)return[new Pt(j,B,"object stop key must have zoom")];if(B[0].value===void 0)return[new Pt(j,B,"object stop key must have value")];const U=Rn(B[0].zoom);if(typeof U!="number")return[new Pt(j,B[0].zoom,"stop zoom values must be numbers")];if(d&&d>U)return[new Pt(j,B[0].zoom,"stop zoom values must appear in ascending order")];U!==d&&(d=U,u=void 0,f={}),R=R.concat(vo({key:`${j}[0]`,value:B[0],valueSpec:{zoom:{}},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:mm,value:k}}))}else R=R.concat(k({key:`${j}[0]`,value:B[0],valueSpec:{},style:I.style,styleSpec:I.styleSpec},B));return jd(hs(B[1]))?R.concat([new Pt(`${j}[1]`,B[1],"expressions are not allowed in function stops.")]):R.concat(Qn({key:`${j}[1]`,value:B[1],valueSpec:t,style:I.style,styleSpec:I.styleSpec}))}function k(I,R){const B=Xt(I.value),j=Rn(I.value),U=I.value!==null?I.value:R;if(s){if(B!==s)return[new Pt(I.key,U,`${B} stop domain type must match previous stop domain type ${s}`)]}else s=B;if(B!=="number"&&B!=="string"&&B!=="boolean"&&typeof j!="number"&&typeof j!="string"&&typeof j!="boolean")return[new Pt(I.key,U,"stop domain value must be a number, string, or boolean")];if(B!=="number"&&i!=="categorical"){let J=`number expected, ${B} found`;return rl(t)&&i===void 0&&(J+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pt(I.key,U,J)]}return i!=="categorical"||B!=="number"||typeof j=="number"&&isFinite(j)&&Math.floor(j)===j?i!=="categorical"&&B==="number"&&typeof j=="number"&&typeof u=="number"&&u!==void 0&&j<u?[new Pt(I.key,U,"stop domain values must appear in ascending order")]:(u=j,i==="categorical"&&j in f?[new Pt(I.key,U,"stop domain values must be unique")]:(f[j]=!0,[])):[new Pt(I.key,U,`integer expected, found ${String(j)}`)]}}function Zl(r){const t=(r.expressionContext==="property"?lh:oh)(hs(r.value),r.valueSpec);if(t.result==="error")return t.value.map(s=>new Pt(`${r.key}${s.key}`,r.value,s.message));const i=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!i.outputDefined())return[new Pt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Ci(i))return[new Pt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Ud(i,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Ul(i,["zoom","feature-state"]))return[new Pt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Vc(i))return[new Pt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ud(r,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const u of t.valueSpec.expression.parameters)i.delete(u);if(i.size===0)return[];const s=[];return r instanceof ps&&i.has(r.name)?[new Pt(t.key,t.value,`["${r.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(r.eachChild(u=>{s.push(...Ud(u,t))}),s)}function Xl(r){const t=r.key,i=r.value,s=r.valueSpec,u=[];return Array.isArray(s.values)?s.values.indexOf(Rn(i))===-1&&u.push(new Pt(t,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(s.values).indexOf(Rn(i))===-1&&u.push(new Pt(t,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Gd(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Gd(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Wd(r,t="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Gd(r)||(r=qd(r));const i=r;let s=!0;try{s=function(b){if(!il(b))return b;let T=hs(b);return Fy(T),T=_m(T),T}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const u=ze[`filter_${t}`],d=oh(s,u);let f=null;if(d.result==="error")throw new Error(d.value.map(b=>`${b.key}: ${b.message}`).join(", "));f=(b,T,M)=>d.value.evaluate(b,T,{},M);let g=null,v=null;if(s!==i){const b=oh(i,u);if(b.result==="error")throw new Error(b.value.map(T=>`${T.key}: ${T.message}`).join(", "));g=(T,M,k,I,R)=>b.value.evaluate(T,M,{},k,void 0,void 0,I,R),v=!Vc(b.value.expression)}return{filter:f,dynamicFilter:g||void 0,needGeometry:Ny(s),needFeature:!!v}}function _m(r){if(!Array.isArray(r))return r;const t=function(i){if(Xb.has(i[0])){for(let s=1;s<i.length;s++)if(il(i[s]))return!0}return i}(r);return t===!0?t:t.map(i=>_m(i))}function Fy(r){let t=!1;const i=[];if(r[0]==="case"){for(let s=1;s<r.length-1;s+=2)t=t||il(r[s]),i.push(r[s+1]);i.push(r[r.length-1])}else if(r[0]==="match"){t=t||il(r[1]);for(let s=2;s<r.length-1;s+=2)i.push(r[s+1]);i.push(r[r.length-1])}else if(r[0]==="step"){t=t||il(r[1]);for(let s=1;s<r.length-1;s+=2)i.push(r[s+1])}t&&(r.length=0,r.push("any",...i));for(let s=1;s<r.length;s++)Fy(r[s])}function il(r){if(!Array.isArray(r))return!1;if((t=r[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<r.length;i++)if(il(r[i]))return!0;return!1}const Xb=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Yb(r,t){return r<t?-1:r>t?1:0}function Ny(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Ny(r[t]))return!0;return!1}function qd(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?Hd(r[1],r[2],"=="):t==="!="?Zd(Hd(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Hd(r[1],r[2],t):t==="any"?(i=r.slice(1),["any"].concat(i.map(qd))):t==="all"?["all"].concat(r.slice(1).map(qd)):t==="none"?["all"].concat(r.slice(1).map(qd).map(Zd)):t==="in"?jy(r[1],r.slice(2)):t==="!in"?Zd(jy(r[1],r.slice(2))):t==="has"?Vy(r[1]):t!=="!has"||Zd(Vy(r[1]));var i}function Hd(r,t,i){switch(r){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,r,t]}}function jy(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",r,["literal",t.sort(Yb)]]:["filter-in-small",r,["literal",t]]}}function Vy(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Zd(r){return["!",r]}function ym(r){return Gd(hs(r.value))?Zl(Po({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):$y(r)}function $y(r){const t=r.value,i=r.key;if(Xt(t)!=="array")return[new Pt(i,t,`array expected, ${Xt(t)} found`)];const s=r.styleSpec;let u,d=[];if(t.length<1)return[new Pt(i,t,"filter array must have at least 1 element")];switch(d=d.concat(Xl({key:`${i}[0]`,value:t[0],valueSpec:s.filter_operator,style:r.style,styleSpec:r.styleSpec})),Rn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Rn(t[1])==="$type"&&d.push(new Pt(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&d.push(new Pt(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=Xt(t[1]),u!=="string"&&d.push(new Pt(`${i}[1]`,t[1],`string expected, ${u} found`)));for(let f=2;f<t.length;f++)u=Xt(t[f]),Rn(t[1])==="$type"?d=d.concat(Xl({key:`${i}[${f}]`,value:t[f],valueSpec:s.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&d.push(new Pt(`${i}[${f}]`,t[f],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let f=1;f<t.length;f++)d=d.concat($y({key:`${i}[${f}]`,value:t[f],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=Xt(t[1]),t.length!==2?d.push(new Pt(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&d.push(new Pt(`${i}[1]`,t[1],`string expected, ${u} found`))}return d}function Uy(r,t){const i=r.key,s=r.style,u=r.layer,d=r.styleSpec,f=r.value,g=r.objectKey,v=d[`${t}_${r.layerType}`];if(!v)return[];const b=g.match(/^(.*)-transition$/);if(t==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return Qn({key:i,value:f,valueSpec:d.transition,style:s,styleSpec:d});const T=r.valueSpec||v[g];if(!T)return[new Go(i,f,`unknown property "${g}"`)];let M;if(Xt(f)==="string"&&rl(T)&&!T.tokens&&(M=/^{([^}]+)}$/.exec(f))){const I=`\`{ "type": "identity", "property": ${M?JSON.stringify(M[1]):'"_"'} }\``;return[new Pt(i,f,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${I}.`)]}const k=[];if(r.layerType==="symbol")g!=="text-field"||!s||s.glyphs||s.imports||k.push(new Pt(i,f,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Fd(hs(f))&&Rn(f.type)==="identity"&&k.push(new Pt(i,f,'"text-font" does not support identity functions'));else if(r.layerType==="model"&&t==="paint"&&u&&u.layout&&u.layout.hasOwnProperty("model-id")&&rl(T)&&(nh(T)||dm(T))){const I=lh(hs(f),T),R=I.value.expression||I.value._styleExpression.expression;R&&!Ul(R,["measure-light"])&&(g==="model-emissive-strength"&&Vc(R)&&Ci(R)||k.push(new Pt(i,f,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return k.concat(Qn({key:r.key,value:f,valueSpec:T,style:s,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:g}))}function Gy(r){return Uy(r,"paint")}function ch(r){return Uy(r,"layout")}function Wy(r){let t=[];const i=r.value,s=r.key,u=r.style,d=r.styleSpec;i.type||i.ref||t.push(new Pt(s,i,'either "type" or "ref" is required'));let f=Rn(i.type);const g=Rn(i.ref);if(i.id){const v=Rn(i.id);for(let b=0;b<r.arrayIndex;b++){const T=u.layers[b];Rn(T.id)===v&&t.push(new Pt(s,i.id,`duplicate layer id "${i.id}", previously used at line ${T.id.__line__}`))}}if("ref"in i){let v;["type","source","source-layer","filter","layout"].forEach(b=>{b in i&&t.push(new Pt(s,i[b],`"${b}" is prohibited for ref layers`))}),u.layers.forEach(b=>{Rn(b.id)===g&&(v=b)}),v?v.ref?t.push(new Pt(s,i.ref,"ref cannot reference another ref layer")):f=Rn(v.type):typeof g=="string"&&t.push(new Pt(s,i.ref,`ref layer "${g}" not found`))}else if(f!=="background"&&f!=="sky"&&f!=="slot")if(i.source){const v=u.sources&&u.sources[i.source],b=v&&Rn(v.type);v?b==="vector"&&f==="raster"?t.push(new Pt(s,i.source,`layer "${i.id}" requires a raster source`)):b==="raster"&&f!=="raster"?t.push(new Pt(s,i.source,`layer "${i.id}" requires a vector source`)):b!=="vector"||i["source-layer"]?b==="raster-dem"&&f!=="hillshade"?t.push(new Pt(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):f!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||b==="geojson"&&v.lineMetrics||t.push(new Pt(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Pt(s,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new Pt(s,i.source,`source "${i.source}" not found`))}else t.push(new Pt(s,i,'missing required property "source"'));return t=t.concat(vo({key:s,value:i,valueSpec:d.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Qn({key:`${s}.type`,value:i.type,valueSpec:d.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"}),filter:v=>ym(Po({layerType:f},v)),layout:v=>vo({layer:i,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>ch(Po({layerType:f},b))}}),paint:v=>vo({layer:i,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>Gy(Po({layerType:f,layer:i},b))}})}})),t}function qc(r){const t=r.value,i=r.key,s=Xt(t);return s!=="string"?[new Pt(i,t,`string expected, ${s} found`)]:[]}const uh={promoteId:function({key:r,value:t}){if(Xt(t)==="string")return qc({key:r,value:t});{const i=[];for(const s in t)i.push(...qc({key:`${r}.${s}`,value:t[s]}));return i}}};function qy(r){const t=r.value,i=r.key,s=r.styleSpec,u=r.style;if(!t.type)return[new Pt(i,t,'"type" is required')];const d=Rn(t.type);let f=[];switch(["vector","raster","raster-dem"].includes(d)&&(t.url||t.tiles||f.push(new Go(i,t,'Either "url" or "tiles" is required.'))),d){case"vector":case"raster":case"raster-dem":return f=f.concat(vo({key:i,value:t,valueSpec:s[`source_${d.replace("-","_")}`],style:r.style,styleSpec:s,objectElementValidators:uh})),f;case"geojson":if(f=vo({key:i,value:t,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:uh}),t.cluster)for(const g in t.clusterProperties){const[v,b]=t.clusterProperties[g],T=typeof v=="string"?[v,["accumulated"],["get",g]]:v;f.push(...Zl({key:`${i}.${g}.map`,value:b,expressionContext:"cluster-map"})),f.push(...Zl({key:`${i}.${g}.reduce`,value:T,expressionContext:"cluster-reduce"}))}return f;case"video":return vo({key:i,value:t,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return vo({key:i,value:t,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new Pt(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xl({key:`${i}.type`,value:t.type,valueSpec:{values:Hy(s)},style:u,styleSpec:s})}}function Hy(r){return r.source.reduce((t,i)=>{const s=r[i];return s.type.type==="enum"&&(t=t.concat(Object.keys(s.type.values))),t},[])}function Zy(r){const t=r.value;let i=[];if(!t)return i;const s=Xt(t);return s!=="string"?(i=i.concat([new Pt(r.key,t,`string expected, "${s}" found`)]),i):(function(u){const d=u.indexOf("://")===-1;try{return new URL(u,d?"http://example.com":void 0),!0}catch{return!1}}(t)||(i=i.concat([new Pt(r.key,t,`invalid url "${t}"`)])),i)}function vm(r){const t=r.value,i=r.styleSpec,s=i.light,u=r.style;let d=[];const f=Xt(t);if(t===void 0)return d;if(f!=="object")return d=d.concat([new Pt("light",t,`object expected, ${f} found`)]),d;for(const g in t){const v=g.match(/^(.*)-transition$/);d=d.concat(v&&s[v[1]]&&s[v[1]].transition?Qn({key:g,value:t[g],valueSpec:i.transition,style:u,styleSpec:i}):s[g]?Qn({key:g,value:t[g],valueSpec:s[g],style:u,styleSpec:i}):[new Pt(g,t[g],`unknown property "${g}"`)])}return d}function xm(r){const t=r.value;let i=[];if(!t)return i;const s=Xt(t);if(s!=="object")return i=i.concat([new Pt("light-3d",t,`object expected, ${s} found`)]),i;const u=r.styleSpec,d=u["light-3d"],f=r.key,g=r.style,v=r.style.lights;for(const M of["type","id"])if(!(M in t))return i=i.concat([new Pt("light-3d",t,`missing property ${M} on light`)]),i;if(t.type&&v)for(let M=0;M<r.arrayIndex;M++){const k=Rn(t.type),I=v[M];Rn(I.type)===k&&i.push(new Pt(f,t.id,`duplicate light type "${t.type}", previously defined at line ${I.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in u))return i=i.concat([new Pt("light-3d",t,`Invalid light type ${t.type}`)]),i;const T=u[b];for(const M in t)if(M==="properties"){const k=t[M],I=Xt(k);if(I!=="object")return i=i.concat([new Pt("properties",k,`object expected, ${I} found`)]),i;for(const R in k)i=i.concat(T[R]?Qn({key:R,value:k[R],valueSpec:T[R],style:g,styleSpec:u}):[new Go(r.key,k[R],`unknown property "${R}"`)])}else{const k=M.match(/^(.*)-transition$/);i=i.concat(k&&d[k[1]]&&d[k[1]].transition?Qn({key:M,value:t[M],valueSpec:u.transition,style:g,styleSpec:u}):d[M]?Qn({key:M,value:t[M],valueSpec:d[M],style:g,styleSpec:u}):[new Go(M,t[M],`unknown property "${M}"`)])}return i}function bm(r){const t=r.value,i=r.key,s=r.style,u=r.styleSpec,d=u.terrain;let f=[];const g=Xt(t);if(t===void 0||g==="null")return f;if(g!=="object")return f=f.concat([new Pt("terrain",t,`object expected, ${g} found`)]),f;for(const v in t){const b=v.match(/^(.*)-transition$/);f=f.concat(b&&d[b[1]]&&d[b[1]].transition?Qn({key:v,value:t[v],valueSpec:u.transition,style:s,styleSpec:u}):d[v]?Qn({key:v,value:t[v],valueSpec:d[v],style:s,styleSpec:u}):[new Go(v,t[v],`unknown property "${v}"`)])}if(t.source){const v=s.sources&&s.sources[t.source],b=v&&Rn(v.type);v?b!=="raster-dem"&&f.push(new Pt(i,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):f.push(new Pt(i,t.source,`source "${t.source}" not found`))}else f.push(new Pt(i,t,'terrain is missing required property "source"'));return f}function wm(r){const t=r.value,i=r.style,s=r.styleSpec,u=s.fog;let d=[];const f=Xt(t);if(t===void 0)return d;if(f!=="object")return d=d.concat([new Pt("fog",t,`object expected, ${f} found`)]),d;for(const g in t){const v=g.match(/^(.*)-transition$/);d=d.concat(v&&u[v[1]]&&u[v[1]].transition?Qn({key:g,value:t[g],valueSpec:s.transition,style:i,styleSpec:s}):u[g]?Qn({key:g,value:t[g],valueSpec:u[g],style:i,styleSpec:s}):[new Go(g,t[g],`unknown property "${g}"`)])}return d}const Xd={"*":()=>[],array:By,boolean:function(r){const t=r.value,i=r.key,s=Xt(t);return s!=="boolean"?[new Pt(i,t,`boolean expected, ${s} found`)]:[]},number:mm,color:function(r){const t=r.key,i=r.value,s=Xt(i);return s!=="string"?[new Pt(t,i,`color expected, ${s} found`)]:Wa(i)===null?[new Pt(t,i,`color expected, "${i}" found`)]:[]},enum:Xl,filter:ym,function:gm,layer:Wy,object:vo,source:qy,model:Zy,light:vm,"light-3d":xm,terrain:bm,fog:wm,string:qc,formatted:function(r){return qc(r).length===0?[]:Zl(r)},resolvedImage:function(r){return qc(r).length===0?[]:Zl(r)},projection:function(r){const t=r.value,i=r.styleSpec,s=i.projection,u=r.style;let d=[];const f=Xt(t);if(f==="object")for(const g in t)d=d.concat(Qn({key:g,value:t[g],valueSpec:s[g],style:u,styleSpec:i}));else f!=="string"&&(d=d.concat([new Pt("projection",t,`object or string expected, ${f} found`)]));return d},import:function(r){const{value:t,styleSpec:i}=r,{data:s,...u}=t;Object.defineProperty(u,"__line__",{value:t.__line__,enumerable:!1});let d=vo(Po({},r,{value:u,valueSpec:i.import}));return Rn(u.id)===""&&d.push(new Pt(`${r.key}.id`,u,"import id can't be an empty string")),s&&(d=d.concat(Xy(s,i,{key:`${r.key}.data`}))),d}};function Qn(r,t=!1){const i=r.value,s=r.valueSpec,u=r.styleSpec;if(s.expression&&Fd(Rn(i)))return gm(r);if(s.expression&&jd(hs(i)))return Zl(r);if(s.type&&Xd[s.type]){const d=Xd[s.type](r);return t===!0&&d.length>0&&Xt(r.value)==="array"?Zl(r):d}return vo(Po({},r,{valueSpec:s.type?u[s.type]:s}))}function Kb(r){const t=r.value,i=r.key,s=qc(r);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new Pt(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new Pt(i,t,'"glyphs" url must include a "{range}" token'))),s}function Xy(r,t=ze,i={}){return Qn({key:i.key||"",value:r,valueSpec:t.$root,styleSpec:t,style:r,objectElementValidators:{glyphs:Kb,"*":()=>[]}})}function Sm(r,t=ze){return gs(Xy(r,t))}const Jb=r=>gs(Gy(r)),Qb=r=>gs(ch(r));function gs(r){return r.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function Yy(r,t){let i=!1;if(t&&t.length)for(const s of t)s instanceof Go?kr(s.message):(r.fire(new ha(new Error(s.message))),i=!0);return i}var ew=$s,ol=3;function $s(r,t,i){var s=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var u=new Int32Array(this.arrayBuffer);r=u[0],this.d=(t=u[1])+2*(i=u[2]);for(var d=0;d<this.d*this.d;d++){var f=u[ol+d],g=u[ol+d+1];s.push(f===g?null:u.subarray(f,g))}var v=u[ol+s.length+1];this.keys=u.subarray(u[ol+s.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var b=0;b<this.d*this.d;b++)s.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=r,this.padding=i,this.scale=t/r,this.uid=0;var T=i/t*r;this.min=-T,this.max=r+T}$s.prototype.insert=function(r,t,i,s,u){this._forEachCell(t,i,s,u,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(u)},$s.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},$s.prototype._insertCell=function(r,t,i,s,u,d){this.cells[u].push(d)},$s.prototype.query=function(r,t,i,s,u){var d=this.min,f=this.max;if(r<=d&&t<=d&&f<=i&&f<=s&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(r,t,i,s,this._queryCell,g,{},u),g},$s.prototype._queryCell=function(r,t,i,s,u,d,f,g){var v=this.cells[u];if(v!==null)for(var b=this.keys,T=this.bboxes,M=0;M<v.length;M++){var k=v[M];if(f[k]===void 0){var I=4*k;(g?g(T[I+0],T[I+1],T[I+2],T[I+3]):r<=T[I+2]&&t<=T[I+3]&&i>=T[I+0]&&s>=T[I+1])?(f[k]=!0,d.push(b[k])):f[k]=!1}}},$s.prototype._forEachCell=function(r,t,i,s,u,d,f,g){for(var v=this._convertToCellCoord(r),b=this._convertToCellCoord(t),T=this._convertToCellCoord(i),M=this._convertToCellCoord(s),k=v;k<=T;k++)for(var I=b;I<=M;I++){var R=this.d*I+k;if((!g||g(this._convertFromCellCoord(k),this._convertFromCellCoord(I),this._convertFromCellCoord(k+1),this._convertFromCellCoord(I+1)))&&u.call(this,r,t,i,s,R,d,f,g))return}},$s.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},$s.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},$s.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,t=ol+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var u=new Int32Array(t+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var d=t,f=0;f<r.length;f++){var g=r[f];u[ol+f]=d,u.set(g,d),d+=g.length}return u[ol+r.length]=d,u.set(this.keys,d),u[ol+r.length+1]=d+=this.keys.length,u.set(this.bboxes,d),d+=this.bboxes.length,u.buffer};var Hc=be(ew);const Yd={};function Ct(r,t,i={}){Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),Yd[t]={klass:r,omit:i.omit||[]}}Ct(Object,"Object"),Hc.serialize=function(r,t){const i=r.toArrayBuffer();return t&&t.add(i),{buffer:i}},Hc.deserialize=function(r){return new Hc(r.buffer)},Object.defineProperty(Hc,"name",{value:"Grid"}),Ct(Hc,"Grid"),Ct(Hr,"Color"),Ct(Error,"Error"),Ct(Li,"Formatted"),Ct(Ns,"FormattedSection"),Ct(zi,"AJAXError"),Ct(Yi,"ResolvedImage"),Ct(Vd,"StylePropertyFunction"),Ct(pm,"StyleExpression",{omit:["_evaluator"]}),Ct(ah,"ZoomDependentExpression"),Ct(sh,"ZoomConstantExpression"),Ct(ps,"CompoundExpression",{omit:["_evaluate"]});for(const r in rh)Yd[rh[r]._classRegistryKey]||Ct(rh[r],`Expression${r}`);function m(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function l(r){return self.ImageBitmap&&r instanceof ImageBitmap}function h(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(m(r)||l(r))return t&&t.add(r),r;if(ArrayBuffer.isView(r)){const i=r;return t&&t.add(i.buffer),i}if(r instanceof ImageData)return t&&t.add(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const s of r)i.push(h(s,t));return i}if(r instanceof Map){const i={$name:"Map"};for(const[s,u]of r.entries())i[s]=h(u);return i}if(typeof r=="object"){const i=r.constructor,s=i._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=i.serialize?i.serialize(r,t):{};if(!i.serialize){for(const d in r)r.hasOwnProperty(d)&&(Yd[s].omit.indexOf(d)>=0||(u[d]=h(r[d],t)));r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof r)}function _(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||m(r)||l(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(_);if(typeof r=="object"){const t=r.$name||"Object";if(t==="Map"){const u=new Map;for(const d of Object.keys(r))d!=="$name"&&u.set(d,_(r[d]));return u}const{klass:i}=Yd[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(r);const s=Object.create(i.prototype);for(const u of Object.keys(r))u!=="$name"&&(s[u]=_(r[u]));return s}throw new Error("can't deserialize object of type "+typeof r)}const x={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519,"CJK Unified Ideographs Extension B":r=>r>=131072&&r<=173791};function S(r){for(const t of r)if(z(t.charCodeAt(0)))return!0;return!1}function C(r){for(const t of r)if(!A(t.charCodeAt(0)))return!1;return!0}function A(r){return!(x.Arabic(r)||x["Arabic Supplement"](r)||x["Arabic Extended-A"](r)||x["Arabic Presentation Forms-A"](r)||x["Arabic Presentation Forms-B"](r))}function z(r){return!(r!==746&&r!==747&&(r<4352||!(x["Bopomofo Extended"](r)||x.Bopomofo(r)||x["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||x["CJK Compatibility Ideographs"](r)||x["CJK Compatibility"](r)||x["CJK Radicals Supplement"](r)||x["CJK Strokes"](r)||!(!x["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||x["CJK Unified Ideographs Extension A"](r)||x["CJK Unified Ideographs"](r)||x["Enclosed CJK Letters and Months"](r)||x["Hangul Compatibility Jamo"](r)||x["Hangul Jamo Extended-A"](r)||x["Hangul Jamo Extended-B"](r)||x["Hangul Jamo"](r)||x["Hangul Syllables"](r)||x.Hiragana(r)||x["Ideographic Description Characters"](r)||x.Kanbun(r)||x["Kangxi Radicals"](r)||x["Katakana Phonetic Extensions"](r)||x.Katakana(r)&&r!==12540||!(!x["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!x["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||x["Unified Canadian Aboriginal Syllabics"](r)||x["Unified Canadian Aboriginal Syllabics Extended"](r)||x["Vertical Forms"](r)||x["Yijing Hexagram Symbols"](r)||x["Yi Syllables"](r)||x["Yi Radicals"](r))))}function O(r){return!(z(r)||function(t){return!!(x["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||x["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||x["Letterlike Symbols"](t)||x["Number Forms"](t)||x["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||x["Control Pictures"](t)&&t!==9251||x["Optical Character Recognition"](t)||x["Enclosed Alphanumerics"](t)||x["Geometric Shapes"](t)||x["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||x["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||x["CJK Symbols and Punctuation"](t)||x.Katakana(t)||x["Private Use Area"](t)||x["CJK Compatibility Forms"](t)||x["Small Form Variants"](t)||x["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function N(r){return r>=1424&&r<=2303||x["Arabic Presentation Forms-A"](r)||x["Arabic Presentation Forms-B"](r)}function V(r,t){return!(!t&&N(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||x.Khmer(r))}function G(r){for(const t of r)if(N(t.charCodeAt(0)))return!0;return!1}const W="deferred",X="loading",K="loaded";let Y=null,Z="unavailable",ae=null;const pe=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(Z="error"),Y&&Y(r)};function ge(){ne.fire(new po("pluginStateChange",{pluginStatus:Z,pluginURL:ae}))}const ne=new Uo,ce=function(){return Z},_e=function(){if(Z!==W||!ae)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Z=X,ge(),ae&&si({url:ae},r=>{r?pe(r):(Z=K,ge())})},we={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Z===K||we.applyArabicShaping!=null,isLoading:()=>Z===X,setState(r){Z=r.pluginStatus,ae=r.pluginURL},isParsed:()=>we.applyArabicShaping!=null&&we.processBidirectionalText!=null&&we.processStyledBidirectionalText!=null,getPluginURL:()=>ae};class ve{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(i,s){for(const u of i)if(!V(u.charCodeAt(0),s))return!1;return!0}(t,we.isLoaded())}}class Se{constructor(t,i,s,u){this.property=t,this.value=i,this.expression=function(d,f,g,v){if(Fd(d))return new Vd(d,f);if(jd(d)||Array.isArray(d)&&d.length>0){const b=lh(d,f,g,v);if(b.result==="error")throw new Error(b.value.map(T=>`${T.key}: ${T.message}`).join(", "));return b.value}{let b=d;return typeof d=="string"&&f.type==="color"&&(b=Hr.parse(d)),{kind:"constant",isConfigDependent:!1,evaluate:()=>b}}}(i===void 0?t.specification.default:i,t.specification,s,u)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,s){return this.property.possiblyEvaluate(this,t,i,s)}}class qe{constructor(t,i,s){this.property=t,this.value=new Se(t,void 0,i,s)}transitioned(t,i){return new Ne(this.property,this.value,i,Lr({},t.transition,this.transition),t.now)}untransitioned(){return new Ne(this.property,this.value,null,{},0)}}class De{constructor(t,i,s){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=i,this._options=s,this.isConfigDependent=!1}getValue(t){return Zi(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new qe(this._values[t].property,this._scope,this._options)),this._values[t].value=new Se(this._values[t].property,i===null?void 0:Zi(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,i){i&&(this._options=i);const s=this._properties.properties;if(t)for(const u in t){const d=t[u];if(Tr(u,"-transition")){const f=u.slice(0,-11);s[f]&&this.setTransition(f,d)}else s[u]&&this.setValue(u,d)}}getTransition(t){return Zi(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new qe(this._values[t].property)),this._values[t].transition=Zi(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(t[i]=s);const u=this.getTransition(i);u!==void 0&&(t[`${i}-transition`]=u)}return t}transitioned(t,i){const s=new Me(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(t,i._values[u]);return s}untransitioned(){const t=new Me(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class Ne{constructor(t,i,s,u,d){const f=u.delay||0,g=u.duration||0;d=d||0,this.property=t,this.value=i,this.begin=d+f,this.end=this.begin+g,t.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(t,i,s){const u=t.now||0,d=this.value.possiblyEvaluate(t,i,s),f=this.prior;if(f){if(u>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(u<this.begin)return f.possiblyEvaluate(t,i,s);{const g=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(t,i,s),d,Mr(g))}}return d}}class Me{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,s){const u=new Xe(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(t,i,s);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class We{constructor(t,i,s){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=i,this._options=s,this.isConfigDependent=!1}getValue(t){return Zi(this._values[t].value)}setValue(t,i){this._values[t]=new Se(this._values[t].property,i===null?void 0:Zi(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const i of Object.keys(this._values)){const s=this.getValue(i);s!==void 0&&(t[i]=s)}return t}possiblyEvaluate(t,i,s){const u=new Xe(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(t,i,s);return u}}class Fe{constructor(t,i,s){this.property=t,this.value=i,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,s,u){return this.property.evaluate(this.value,this.parameters,t,i,s,u)}}class Xe{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class he{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,s){const u=Ku[this.specification.type];return u?u(t,i,s):t}}class ke{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,s,u){return new Fe(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},s,u)}:t.expression,i)}interpolate(t,i,s){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new Fe(this,{kind:"constant",value:void 0},t.parameters);const u=Ku[this.specification.type];return u?new Fe(this,{kind:"constant",value:u(t.value.value,i.value.value,s)},t.parameters):t}evaluate(t,i,s,u,d,f){return t.kind==="constant"?t.value:t.evaluate(i,s,u,d,f)}}class nt{constructor(t){this.specification=t}possiblyEvaluate(t,i,s,u){return!!t.expression.evaluate(i,null,{},s,u)}interpolate(){return!1}}class Ke{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new ve(0,{});for(const s in t){const u=t[s];u.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new Se(u,void 0),f=this.defaultTransitionablePropertyValues[s]=new qe(u);this.defaultTransitioningPropertyValues[s]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate(i)}}}Ct(ke,"DataDrivenProperty"),Ct(he,"DataConstantProperty"),Ct(nt,"ColorRampProperty");const Mt="";function wt(r,t){return t?`${r}${Mt}${t}`:r}const Ft="-transition";class St extends Uo{constructor(t,i,s,u){if(super(),this.id=t.id,this.fqid=wt(this.id,s),this.type=t.type,this.scope=s,this.options=u,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),t.slot&&(this.slot=t.slot),i.layout&&(this._unevaluatedLayout=new We(i.layout,this.scope,u),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),i.paint)){this._transitionablePaint=new De(i.paint,this.scope,u);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Xe(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,s={}){if(i!=null&&this._validate(Qb,`layers.${this.id}.layout.${t}`,t,i,s))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=i);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,i),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return Tr(t,Ft)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,s={}){if(i!=null&&this._validate(Jb,`layers.${this.id}.paint.${t}`,t,i,s))return!1;const u=this._transitionablePaint,d=u._properties.properties;if(Tr(t,Ft)){const k=t.slice(0,-11);return d[k]&&u.setTransition(k,i||void 0),!1}if(!d[t])return!1;const f=u._values[t],g=f.value.isDataDriven(),v=f.value;u.setValue(t,i),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=u._values[t].value,T=b.isDataDriven(),M=Tr(t,"pattern")||t==="line-dasharray";return T||g||M||this._handleOverridablePaintPropertyUpdate(t,v,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,i){return null}_handleOverridablePaintPropertyUpdate(t,i,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){return cs({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,i)=>!(t===void 0||i==="layout"&&!Object.keys(t).length||i==="paint"&&!Object.keys(t).length))}_validate(t,i,s,u,d={}){return(!d||d.validate!==!1)&&Yy(this,t.call(Sm,{key:i,layerType:this.type,objectKey:s,value:u,styleSpec:ze,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof Fe&&rl(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Wd(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}const Vt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $t{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Rt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dt(r,t=1){let i=0,s=0;return{members:r.map(u=>{const d=Vt[u.type].BYTES_PER_ELEMENT,f=i=Sr(i,Math.max(t,d)),g=u.components||1;return s=Math.max(s,d),i+=d*g,{name:u.name,type:u.type,components:g,offset:f}}),size:Sr(i,Math.max(s,t)),alignment:t}}function Sr(r,t){return Math.ceil(r/t)*t}class tr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const u=2*t;return this.int16[u+0]=i,this.int16[u+1]=s,t}}tr.prototype.bytesPerElement=4,Ct(tr,"StructArrayLayout2i4");class rn extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,s)}emplace(t,i,s,u){const d=3*t;return this.int16[d+0]=i,this.int16[d+1]=s,this.int16[d+2]=u,t}}rn.prototype.bytesPerElement=6,Ct(rn,"StructArrayLayout3i6");class Gr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,s,u)}emplace(t,i,s,u,d){const f=4*t;return this.int16[f+0]=i,this.int16[f+1]=s,this.int16[f+2]=u,this.int16[f+3]=d,t}}Gr.prototype.bytesPerElement=8,Ct(Gr,"StructArrayLayout4i8");class Ki extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,s,u,d)}emplace(t,i,s,u,d,f){const g=5*t;return this.int16[g+0]=i,this.int16[g+1]=s,this.int16[g+2]=u,this.int16[g+3]=d,this.int16[g+4]=f,t}}Ki.prototype.bytesPerElement=10,Ct(Ki,"StructArrayLayout5i10");class Ho extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,s,u,d,f,g)}emplace(t,i,s,u,d,f,g,v){const b=6*t,T=12*t,M=3*t;return this.int16[b+0]=i,this.int16[b+1]=s,this.uint8[T+4]=u,this.uint8[T+5]=d,this.uint8[T+6]=f,this.uint8[T+7]=g,this.float32[M+2]=v,t}}Ho.prototype.bytesPerElement=12,Ct(Ho,"StructArrayLayout2i4ub1f12");class Nr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,s,u)}emplace(t,i,s,u,d){const f=4*t;return this.float32[f+0]=i,this.float32[f+1]=s,this.float32[f+2]=u,this.float32[f+3]=d,t}}Nr.prototype.bytesPerElement=16,Ct(Nr,"StructArrayLayout4f16");class Cr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,s,u,d)}emplace(t,i,s,u,d,f){const g=6*t,v=3*t;return this.uint16[g+0]=i,this.uint16[g+1]=s,this.uint16[g+2]=u,this.uint16[g+3]=d,this.float32[v+2]=f,t}}Cr.prototype.bytesPerElement=12,Ct(Cr,"StructArrayLayout4ui1f12");class Ir extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,s,u)}emplace(t,i,s,u,d){const f=4*t;return this.uint16[f+0]=i,this.uint16[f+1]=s,this.uint16[f+2]=u,this.uint16[f+3]=d,t}}Ir.prototype.bytesPerElement=8,Ct(Ir,"StructArrayLayout4ui8");class un extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,s,u,d,f)}emplace(t,i,s,u,d,f,g){const v=6*t;return this.int16[v+0]=i,this.int16[v+1]=s,this.int16[v+2]=u,this.int16[v+3]=d,this.int16[v+4]=f,this.int16[v+5]=g,t}}un.prototype.bytesPerElement=12,Ct(un,"StructArrayLayout6i12");class pi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g,v,b,T,M,k){const I=this.length;return this.resize(I+1),this.emplace(I,t,i,s,u,d,f,g,v,b,T,M,k)}emplace(t,i,s,u,d,f,g,v,b,T,M,k,I){const R=12*t;return this.int16[R+0]=i,this.int16[R+1]=s,this.int16[R+2]=u,this.int16[R+3]=d,this.uint16[R+4]=f,this.uint16[R+5]=g,this.uint16[R+6]=v,this.uint16[R+7]=b,this.int16[R+8]=T,this.int16[R+9]=M,this.int16[R+10]=k,this.int16[R+11]=I,t}}pi.prototype.bytesPerElement=24,Ct(pi,"StructArrayLayout4i4ui4i24");class an extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,s,u,d,f)}emplace(t,i,s,u,d,f,g){const v=10*t,b=5*t;return this.int16[v+0]=i,this.int16[v+1]=s,this.int16[v+2]=u,this.float32[b+2]=d,this.float32[b+3]=f,this.float32[b+4]=g,t}}an.prototype.bytesPerElement=20,Ct(an,"StructArrayLayout3i3f20");class Oi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}Oi.prototype.bytesPerElement=4,Ct(Oi,"StructArrayLayout1ul4");class Ji extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const u=2*t;return this.uint16[u+0]=i,this.uint16[u+1]=s,t}}Ji.prototype.bytesPerElement=4,Ct(Ji,"StructArrayLayout2ui4");class Bi extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g,v,b,T,M,k,I){const R=this.length;return this.resize(R+1),this.emplace(R,t,i,s,u,d,f,g,v,b,T,M,k,I)}emplace(t,i,s,u,d,f,g,v,b,T,M,k,I,R){const B=20*t,j=10*t;return this.int16[B+0]=i,this.int16[B+1]=s,this.int16[B+2]=u,this.int16[B+3]=d,this.int16[B+4]=f,this.float32[j+3]=g,this.float32[j+4]=v,this.float32[j+5]=b,this.float32[j+6]=T,this.int16[B+14]=M,this.uint32[j+8]=k,this.uint16[B+18]=I,this.uint16[B+19]=R,t}}Bi.prototype.bytesPerElement=40,Ct(Bi,"StructArrayLayout5i4f1i1ul2ui40");class Zo extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,s,u,d,f,g)}emplace(t,i,s,u,d,f,g,v){const b=8*t;return this.int16[b+0]=i,this.int16[b+1]=s,this.int16[b+2]=u,this.int16[b+4]=d,this.int16[b+5]=f,this.int16[b+6]=g,this.int16[b+7]=v,t}}Zo.prototype.bytesPerElement=16,Ct(Zo,"StructArrayLayout3i2i2i16");class _a extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,s,u,d)}emplace(t,i,s,u,d,f){const g=4*t,v=8*t;return this.float32[g+0]=i,this.float32[g+1]=s,this.float32[g+2]=u,this.int16[v+6]=d,this.int16[v+7]=f,t}}_a.prototype.bytesPerElement=16,Ct(_a,"StructArrayLayout2f1f2i16");class _s extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,s,u)}emplace(t,i,s,u,d){const f=12*t,g=3*t;return this.uint8[f+0]=i,this.uint8[f+1]=s,this.float32[g+1]=u,this.float32[g+2]=d,t}}_s.prototype.bytesPerElement=12,Ct(_s,"StructArrayLayout2ub2f12");class Zr extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,s)}emplace(t,i,s,u){const d=3*t;return this.uint16[d+0]=i,this.uint16[d+1]=s,this.uint16[d+2]=u,t}}Zr.prototype.bytesPerElement=6,Ct(Zr,"StructArrayLayout3ui6");class ys extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue){const fe=this.length;return this.resize(fe+1),this.emplace(fe,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue)}emplace(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue,fe){const xe=30*t,Te=15*t,Ae=60*t;return this.int16[xe+0]=i,this.int16[xe+1]=s,this.int16[xe+2]=u,this.float32[Te+2]=d,this.float32[Te+3]=f,this.uint16[xe+8]=g,this.uint16[xe+9]=v,this.uint32[Te+5]=b,this.uint32[Te+6]=T,this.uint32[Te+7]=M,this.uint16[xe+16]=k,this.uint16[xe+17]=I,this.uint16[xe+18]=R,this.float32[Te+10]=B,this.float32[Te+11]=j,this.uint8[Ae+48]=U,this.uint8[Ae+49]=J,this.uint8[Ae+50]=ee,this.uint32[Te+13]=oe,this.int16[xe+28]=ue,this.uint8[Ae+58]=fe,t}}ys.prototype.bytesPerElement=60,Ct(ys,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Us extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue,fe,xe,Te,Ae,Oe,Ie,He,lt,Ge,et,Ue){const vt=this.length;return this.resize(vt+1),this.emplace(vt,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue,fe,xe,Te,Ae,Oe,Ie,He,lt,Ge,et,Ue)}emplace(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue,fe,xe,Te,Ae,Oe,Ie,He,lt,Ge,et,Ue,vt){const Tt=20*t,ot=40*t,Ut=80*t;return this.float32[Tt+0]=i,this.float32[Tt+1]=s,this.int16[ot+4]=u,this.int16[ot+5]=d,this.int16[ot+6]=f,this.int16[ot+7]=g,this.int16[ot+8]=v,this.int16[ot+9]=b,this.int16[ot+10]=T,this.int16[ot+11]=M,this.int16[ot+12]=k,this.uint16[ot+13]=I,this.uint16[ot+14]=R,this.uint16[ot+15]=B,this.uint16[ot+16]=j,this.uint16[ot+17]=U,this.uint16[ot+18]=J,this.uint16[ot+19]=ee,this.uint16[ot+20]=oe,this.uint16[ot+21]=ue,this.uint16[ot+22]=fe,this.uint16[ot+23]=xe,this.uint16[ot+24]=Te,this.uint16[ot+25]=Ae,this.uint16[ot+26]=Oe,this.uint16[ot+27]=Ie,this.uint32[Tt+14]=He,this.float32[Tt+15]=lt,this.float32[Tt+16]=Ge,this.float32[Tt+17]=et,this.float32[Tt+18]=Ue,this.uint8[Ut+76]=vt,t}}Us.prototype.bytesPerElement=80,Ct(Us,"StructArrayLayout2f9i15ui1ul4f1ub80");class ya extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}ya.prototype.bytesPerElement=4,Ct(ya,"StructArrayLayout1f4");class hh extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,s,u,d)}emplace(t,i,s,u,d,f){const g=5*t;return this.float32[g+0]=i,this.float32[g+1]=s,this.float32[g+2]=u,this.float32[g+3]=d,this.float32[g+4]=f,t}}hh.prototype.bytesPerElement=20,Ct(hh,"StructArrayLayout5f20");class tw extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,s,u,d,f,g)}emplace(t,i,s,u,d,f,g,v){const b=7*t;return this.float32[b+0]=i,this.float32[b+1]=s,this.float32[b+2]=u,this.float32[b+3]=d,this.float32[b+4]=f,this.float32[b+5]=g,this.float32[b+6]=v,t}}tw.prototype.bytesPerElement=28,Ct(tw,"StructArrayLayout7f28");class rw extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,s,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,s,u)}emplace(t,i,s,u,d){const f=6*t;return this.uint32[3*t+0]=i,this.uint16[f+2]=s,this.uint16[f+3]=u,this.uint16[f+4]=d,t}}rw.prototype.bytesPerElement=12,Ct(rw,"StructArrayLayout1ul3ui12");class Tm extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}Tm.prototype.bytesPerElement=2,Ct(Tm,"StructArrayLayout1ui2");class dh extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,s)}emplace(t,i,s,u){const d=3*t;return this.float32[d+0]=i,this.float32[d+1]=s,this.float32[d+2]=u,t}}dh.prototype.bytesPerElement=12,Ct(dh,"StructArrayLayout3f12");class Em extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const s=this.length;return this.resize(s+1),this.emplace(s,t,i)}emplace(t,i,s){const u=2*t;return this.float32[u+0]=i,this.float32[u+1]=s,t}}Em.prototype.bytesPerElement=8,Ct(Em,"StructArrayLayout2f8");class nw extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j){const U=this.length;return this.resize(U+1),this.emplace(U,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j)}emplace(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U){const J=16*t;return this.float32[J+0]=i,this.float32[J+1]=s,this.float32[J+2]=u,this.float32[J+3]=d,this.float32[J+4]=f,this.float32[J+5]=g,this.float32[J+6]=v,this.float32[J+7]=b,this.float32[J+8]=T,this.float32[J+9]=M,this.float32[J+10]=k,this.float32[J+11]=I,this.float32[J+12]=R,this.float32[J+13]=B,this.float32[J+14]=j,this.float32[J+15]=U,t}}nw.prototype.bytesPerElement=64,Ct(nw,"StructArrayLayout16f64");class Ky extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,s,u,d,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,i,s,u,d,f,g)}emplace(t,i,s,u,d,f,g,v){const b=10*t,T=5*t;return this.uint16[b+0]=i,this.uint16[b+1]=s,this.uint16[b+2]=u,this.uint16[b+3]=d,this.float32[T+2]=f,this.float32[T+3]=g,this.float32[T+4]=v,t}}Ky.prototype.bytesPerElement=20,Ct(Ky,"StructArrayLayout4ui3f20");class iw extends Rt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint8[1*t+0]=i,t}}iw.prototype.bytesPerElement=1,Ct(iw,"StructArrayLayout1ub1");class Sk extends $t{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Sk.prototype.size=40;class ow extends Bi{get(t){return new Sk(this,t)}}Ct(ow,"CollisionBoxArray");class Tk extends $t{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Tk.prototype.size=60;class Ek extends ys{get(t){return new Tk(this,t)}}Ct(Ek,"PlacedSymbolArray");class Ck extends $t{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Ck.prototype.size=80;class Mk extends Us{get(t){return new Ck(this,t)}}Ct(Mk,"SymbolInstanceArray");class Ak extends ya{getoffsetX(t){return this.float32[1*t+0]}}Ct(Ak,"GlyphOffsetArray");class kk extends tr{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Ct(kk,"SymbolLineVertexArray");class Pk extends $t{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Pk.prototype.size=12;class Ik extends rw{get(t){return new Pk(this,t)}}Ct(Ik,"FeatureIndexArray");class zk extends Ji{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Ct(zk,"FillExtrusionCentroidArray");const k8=Dt([{name:"a_pos",components:2,type:"Int16"}],4),P8=Dt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class wn{constructor(t=[]){this.segments=t}_prepareSegment(t,i,s,u){let d=this.segments[this.segments.length-1];return t>wn.MAX_VERTEX_ARRAY_LENGTH&&kr(`Max vertices per segment is ${wn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!d||d.vertexLength+t>wn.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==u)&&(d={vertexOffset:i,primitiveOffset:s,vertexLength:0,primitiveLength:0},u!==void 0&&(d.sortKey=u),this.segments.push(d)),d}prepareSegment(t,i,s,u){return this._prepareSegment(t,i.length,s.length,u)}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,s,u){return new wn([{vertexOffset:t,primitiveOffset:i,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}function Rk(r,t){return 256*(r=ct(Math.floor(r),0,255))+ct(Math.floor(t),0,255)}wn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ct(wn,"SegmentVector");const I8=Dt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),z8=Dt([{name:"a_dash",components:4,type:"Uint16"}]);var Jy={exports:{}},Dk={exports:{}};(function(r){r.exports=function(t,i){var s,u,d,f,g,v,b,T;for(u=t.length-(s=3&t.length),d=i,g=3432918353,v=461845907,T=0;T<u;)b=255&t.charCodeAt(T)|(255&t.charCodeAt(++T))<<8|(255&t.charCodeAt(++T))<<16|(255&t.charCodeAt(++T))<<24,++T,d=27492+(65535&(f=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&t.charCodeAt(T+2))<<16;case 2:b^=(255&t.charCodeAt(T+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(T)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}})(Dk);var R8=Dk.exports,Lk={exports:{}};(function(r){r.exports=function(t,i){for(var s,u=t.length,d=i^u,f=0;u>=4;)s=1540483477*(65535&(s=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++f;switch(u){case 3:d^=(255&t.charCodeAt(f+2))<<16;case 2:d^=(255&t.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}})(Lk);var Ok=R8,D8=Lk.exports;Jy.exports=Ok,Jy.exports.murmur3=Ok,Jy.exports.murmur2=D8;var sw=be(Jy.exports);class Cm{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,i,s,u){this.ids.push(Bk(t)),this.positions.push(i,s,u)}eachPosition(t,i){const s=Bk(t);let u=0,d=this.ids.length-1;for(;u<d;){const f=u+d>>1;this.ids[f]>=s?d=f:u=f+1}for(;this.ids[u]===s;)i(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(t,i){const s=new Float64Array(t.ids),u=new Uint32Array(t.positions);return aw(s,u,0,s.length-1),i&&(i.add(s.buffer),i.add(u.buffer)),{ids:s,positions:u}}static deserialize(t){const i=new Cm;let s;i.ids=t.ids,i.positions=t.positions;for(const u of i.ids)u!==s&&i.uniqueIds.push(u),s=u;return i.indexed=!0,i}}function Bk(r){const t=+r;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:sw(String(r))}function aw(r,t,i,s){for(;i<s;){const u=r[i+s>>1];let d=i-1,f=s+1;for(;;){do d++;while(r[d]<u);do f--;while(r[f]>u);if(d>=f)break;Qy(r,d,f),Qy(t,3*d,3*f),Qy(t,3*d+1,3*f+1),Qy(t,3*d+2,3*f+2)}f-i<s-f?(aw(r,t,i,f),i=f+1):(aw(r,t,f+1,s),s=f)}}function Qy(r,t,i){const s=r[t];r[t]=r[i],r[i]=s}Ct(Cm,"FeaturePositionMap");class Yl{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class e0 extends Yl{constructor(t){super(t),this.current=0}set(t,i,s){this.fetchUniformLocation(t,i)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}}class xo extends Yl{constructor(t){super(t),this.current=0}set(t,i,s){this.fetchUniformLocation(t,i)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class fh extends Yl{constructor(t){super(t),this.current=[0,0]}set(t,i,s){this.fetchUniformLocation(t,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}}class lw extends Yl{constructor(t){super(t),this.current=[0,0,0]}set(t,i,s){this.fetchUniformLocation(t,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}}class Fk extends Yl{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,s){this.fetchUniformLocation(t,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class Nk extends Yl{constructor(t){super(t),this.current=Hr.transparent}set(t,i,s){this.fetchUniformLocation(t,i)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const L8=new Float32Array(16);class Mm extends Yl{constructor(t){super(t),this.current=L8}set(t,i,s){if(this.fetchUniformLocation(t,i)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let u=1;u<16;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}}const O8=new Float32Array(9),B8=new Float32Array(4);class cw extends Yl{constructor(t){super(t),this.current=B8}set(t,i,s){if(this.fetchUniformLocation(t,i)){for(let u=0;u<4;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}}function uw(r){return[Rk(255*r.r,255*r.g),Rk(255*r.b,255*r.a)]}class Am{constructor(t,i,s){this.value=t,this.uniformNames=i.map(u=>`u_${u}`),this.type=s}setUniform(t,i,s,u,d){i.set(t,d,u.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new Nk(t):new xo(t)}}class Kd{constructor(t,i){this.uniformNames=i.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,s,u,d){const f=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;f&&i.set(t,d,f)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new Fk(t):new xo(t)}}class Kl{constructor(t,i,s,u){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(d=>({name:`a_${d}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,i,s,u,d,f,g){const v=this.paintVertexArray.length,b=this.expression.evaluate(new ve(0,{brightness:f}),i,{},d,u,g);this.paintVertexArray.resize(t),this._setPaintValue(v,t,b)}updatePaintArray(t,i,s,u,d,f,g){const v=this.expression.evaluate({zoom:0,brightness:g},s,u,void 0,d);this._setPaintValue(t,i,v)}_setPaintValue(t,i,s){if(this.type==="color"){const u=uw(s);for(let d=t;d<i;d++)this.paintVertexArray.emplace(d,u[0],u[1])}else{for(let u=t;u<i;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class va{constructor(t,i,s,u,d,f){this.expression=t,this.uniformNames=i.map(g=>`u_${g}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=i.map(g=>({name:`a_${g}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,i,s,u,d,f,g){const v=this.expression.evaluate(new ve(this.zoom,{brightness:f}),i,{},d,u,g),b=this.expression.evaluate(new ve(this.zoom+1,{brightness:f}),i,{},d,u,g),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,v,b)}updatePaintArray(t,i,s,u,d,f,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},s,u,void 0,d),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},s,u,void 0,d);this._setPaintValue(t,i,v,b)}_setPaintValue(t,i,s,u){if(this.type==="color"){const d=uw(s),f=uw(u);for(let g=t;g<i;g++)this.paintVertexArray.emplace(g,d[0],d[1],f[0],f[1])}else{for(let d=t;d<i;d++)this.paintVertexArray.emplace(d,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,s,u,d){const f=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,g=ct(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);i.set(t,d,g)}getBinding(t,i){return new xo(t)}}class Zc{constructor(t,i,s,u,d){this.expression=t,this.layerId=d,this.paintVertexAttributes=(s==="array"?z8:I8).members;for(let f=0;f<i.length;++f);this.paintVertexArray=new u}populatePaintArray(t,i,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(u,t,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(t,i,s,u,d,f,g){this._setPaintValues(t,i,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(t,i,s,u){if(!u||!s)return;const d=u[s];if(!d)return;const{tl:f,br:g,pixelRatio:v}=d;for(let b=t;b<i;b++)this.paintVertexArray.emplace(b,f[0],f[1],g[0],g[1],v)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ph{constructor(t,i,s=()=>!0){this.binders={},this._buffers=[];const u=[];for(const d in t.paint._values){const f=t.paint.get(d);if(!s(d)||!(f instanceof Fe&&rl(f.property.specification)))continue;const g=N8(d,t.type),v=f.value,b=f.property.specification.type,T=!!f.property.useIntegerZoom,M=d==="line-dasharray"||d.endsWith("pattern"),k=d==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||k)if(v.kind==="source"||k||M){const I=jk(d,b,"source");this.binders[d]=M?new Zc(v,g,b,I,t.id):new Kl(v,g,b,I),u.push(`/a_${d}`)}else{const I=jk(d,b,"composite");this.binders[d]=new va(v,g,b,T,i,I),u.push(`/z_${d}`)}else this.binders[d]=M?new Kd(v.value,g):new Am(v.value,g,b),u.push(`/u_${d}`)}this.cacheKey=u.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof Kl||i instanceof va?i.maxValue:0}populatePaintArrays(t,i,s,u,d,f,g){for(const v in this.binders){const b=this.binders[v];(b instanceof Kl||b instanceof va||b instanceof Zc)&&b.populatePaintArray(t,i,s,u,d,f,g)}}setConstantPatternPositions(t){for(const i in this.binders){const s=this.binders[i];s instanceof Kd&&s.setConstantPatternPositions(t)}}updatePaintArrays(t,i,s,u,d,f,g,v){let b=!1;const T=Object.keys(t),M=T.length!==0,k=M?T:i.uniqueIds;for(const I in this.binders){const R=this.binders[I];if((R instanceof Kl||R instanceof va||R instanceof Zc)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const B=d.paint.get(I);R.expression=B.value;for(const j of k){const U=t[j.toString()];i.eachPosition(j,(J,ee,oe)=>{const ue=u.feature(J);R.updatePaintArray(ee,oe,ue,U,f,g,v)})}if(!M)for(const j of s.uniqueIds){const U=t[j.toString()];s.eachPosition(j,(J,ee,oe)=>{const ue=u.feature(J);R.updatePaintArray(ee,oe,ue,U,f,g,v)})}b=!0}}return b}defines(){const t=[];for(const i in this.binders){const s=this.binders[i];(s instanceof Am||s instanceof Kd)&&t.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Kl||s instanceof va||s instanceof Zc)for(let u=0;u<s.paintVertexAttributes.length;u++)t.push(s.paintVertexAttributes[u].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Am||s instanceof Kd||s instanceof va)for(const u of s.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Am||u instanceof Kd||u instanceof va)for(const d of u.uniformNames)i.push({name:d,property:s,binding:u.getBinding(t,d)})}return i}setUniforms(t,i,s,u,d){for(const{name:f,property:g,binding:v}of s)this.binders[g].setUniform(t,v,d,u.get(g),f)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof Kl||i instanceof va||i instanceof Zc)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const s=this.binders[i];(s instanceof Kl||s instanceof va||s instanceof Zc)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof Kl||i instanceof va||i instanceof Zc)&&i.destroy()}}}class Xc{constructor(t,i,s=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new ph(u,i,s);this.needsUpload=!1,this._featureMap=new Cm,this._featureMapWithoutIds=new Cm,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,i,s,u,d,f,g,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,i,u,d,f,g,v);i.id!==void 0?this._featureMap.add(i.id,s,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,s,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,s,u,d,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,i,g,u,d,f||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const F8={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function N8(r,t){return F8[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}const j8={"line-pattern":{source:Cr,composite:Cr},"fill-pattern":{source:Cr,composite:Cr},"fill-extrusion-pattern":{source:Cr,composite:Cr},"line-dasharray":{source:Ir,composite:Ir}},V8={color:{source:Em,composite:Nr},number:{source:ya,composite:Em}};function jk(r,t,i){const s=j8[r];return s&&s[i]||V8[t][i]}Ct(Am,"ConstantBinder"),Ct(Kd,"PatternConstantBinder"),Ct(Kl,"SourceExpressionBinder"),Ct(Zc,"PatternCompositeBinder"),Ct(va,"CompositeExpressionBinder"),Ct(ph,"ProgramConfiguration",{omit:["_buffers"]}),Ct(Xc,"ProgramConfigurationSet");class Yc{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof jr?new jr(t.lng,t.lat):jr.convert(t),this}setSouthWest(t){return this._sw=t instanceof jr?new jr(t.lng,t.lat):jr.convert(t),this}extend(t){const i=this._sw,s=this._ne;let u,d;if(t instanceof jr)u=t,d=t;else{if(!(t instanceof Yc))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Yc.convert(t)):this.extend(jr.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(jr.convert(t)):this;if(u=t._sw,d=t._ne,!u||!d)return this}return i||s?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),s.lng=Math.max(d.lng,s.lng),s.lat=Math.max(d.lat,s.lat)):(this._sw=new jr(u.lng,u.lat),this._ne=new jr(d.lng,d.lat)),this}getCenter(){return new jr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new jr(this.getWest(),this.getNorth())}getSouthEast(){return new jr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:s}=jr.convert(t);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(t){return!t||t instanceof Yc?t:new Yc(t)}}var mi={},gi={};Object.defineProperty(gi,"__esModule",{value:!0}),gi.setMatrixArrayType=function(r){gi.ARRAY_TYPE=$k=r},gi.toRadian=function(r){return r*U8},gi.equals=function(r,t){return Math.abs(r-t)<=Vk*Math.max(1,Math.abs(r),Math.abs(t))},gi.RANDOM=gi.ARRAY_TYPE=gi.EPSILON=void 0;var Vk=1e-6;gi.EPSILON=Vk;var $k=typeof Float32Array<"u"?Float32Array:Array;gi.ARRAY_TYPE=$k;var $8=Math.random;gi.RANDOM=$8;var U8=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var Sn={};function hw(r){return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(r)}Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.create=function(){var r=new Kc.ARRAY_TYPE(4);return Kc.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},Sn.clone=function(r){var t=new Kc.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},Sn.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},Sn.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r},Sn.fromValues=function(r,t,i,s){var u=new Kc.ARRAY_TYPE(4);return u[0]=r,u[1]=t,u[2]=i,u[3]=s,u},Sn.set=function(r,t,i,s,u){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r},Sn.transpose=function(r,t){if(r===t){var i=t[1];r[1]=t[2],r[2]=i}else r[0]=t[0],r[1]=t[2],r[2]=t[1],r[3]=t[3];return r},Sn.invert=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=i*d-u*s;return f?(r[0]=d*(f=1/f),r[1]=-s*f,r[2]=-u*f,r[3]=i*f,r):null},Sn.adjoint=function(r,t){var i=t[0];return r[0]=t[3],r[1]=-t[1],r[2]=-t[2],r[3]=i,r},Sn.determinant=function(r){return r[0]*r[3]-r[2]*r[1]},Sn.multiply=Gk,Sn.rotate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=Math.sin(i),v=Math.cos(i);return r[0]=s*v+d*g,r[1]=u*v+f*g,r[2]=s*-g+d*v,r[3]=u*-g+f*v,r},Sn.scale=function(r,t,i){var s=t[1],u=t[2],d=t[3],f=i[0],g=i[1];return r[0]=t[0]*f,r[1]=s*f,r[2]=u*g,r[3]=d*g,r},Sn.fromRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=i,r[2]=-i,r[3]=s,r},Sn.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r},Sn.str=function(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Sn.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},Sn.LDU=function(r,t,i,s){return r[2]=s[2]/s[0],i[0]=s[0],i[1]=s[1],i[3]=s[3]-r[2]*i[1],[r,t,i]},Sn.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r},Sn.subtract=Wk,Sn.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},Sn.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(i-f)<=Kc.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-g)<=Kc.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-v)<=Kc.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(d-b)<=Kc.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},Sn.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r},Sn.multiplyScalarAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r[3]=t[3]+i[3]*s,r},Sn.sub=Sn.mul=void 0;var Kc=function(r,t){if(r&&r.__esModule)return r;if(r===null||hw(r)!=="object"&&typeof r!="function")return{default:r};var i=Uk(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function Uk(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Uk=function(s){return s?i:t})(r)}function Gk(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=i[0],v=i[1],b=i[2],T=i[3];return r[0]=s*g+d*v,r[1]=u*g+f*v,r[2]=s*b+d*T,r[3]=u*b+f*T,r}function Wk(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r}Sn.mul=Gk,Sn.sub=Wk;var En={};function dw(r){return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dw(r)}Object.defineProperty(En,"__esModule",{value:!0}),En.create=function(){var r=new sl.ARRAY_TYPE(6);return sl.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r},En.clone=function(r){var t=new sl.ARRAY_TYPE(6);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},En.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},En.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r},En.fromValues=function(r,t,i,s,u,d){var f=new sl.ARRAY_TYPE(6);return f[0]=r,f[1]=t,f[2]=i,f[3]=s,f[4]=u,f[5]=d,f},En.set=function(r,t,i,s,u,d,f){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r[4]=d,r[5]=f,r},En.invert=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=i*d-s*u;return v?(r[0]=d*(v=1/v),r[1]=-s*v,r[2]=-u*v,r[3]=i*v,r[4]=(u*g-d*f)*v,r[5]=(s*f-i*g)*v,r):null},En.determinant=function(r){return r[0]*r[3]-r[1]*r[2]},En.multiply=Hk,En.rotate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=Math.sin(i),T=Math.cos(i);return r[0]=s*T+d*b,r[1]=u*T+f*b,r[2]=s*-b+d*T,r[3]=u*-b+f*T,r[4]=g,r[5]=v,r},En.scale=function(r,t,i){var s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=i[0],b=i[1];return r[0]=t[0]*v,r[1]=s*v,r[2]=u*b,r[3]=d*b,r[4]=f,r[5]=g,r},En.translate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=i[0],T=i[1];return r[0]=s,r[1]=u,r[2]=d,r[3]=f,r[4]=s*b+d*T+g,r[5]=u*b+f*T+v,r},En.fromRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=i,r[2]=-i,r[3]=s,r[4]=0,r[5]=0,r},En.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r[4]=0,r[5]=0,r},En.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=t[0],r[5]=t[1],r},En.str=function(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"},En.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)},En.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r},En.subtract=Zk,En.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r},En.multiplyScalarAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r[3]=t[3]+i[3]*s,r[4]=t[4]+i[4]*s,r[5]=t[5]+i[5]*s,r},En.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]},En.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=r[4],g=r[5],v=t[0],b=t[1],T=t[2],M=t[3],k=t[4],I=t[5];return Math.abs(i-v)<=sl.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-b)<=sl.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-T)<=sl.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(d-M)<=sl.EPSILON*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(f-k)<=sl.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(g-I)<=sl.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))},En.sub=En.mul=void 0;var sl=function(r,t){if(r&&r.__esModule)return r;if(r===null||dw(r)!=="object"&&typeof r!="function")return{default:r};var i=qk(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function qk(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(qk=function(s){return s?i:t})(r)}function Hk(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=i[0],T=i[1],M=i[2],k=i[3],I=i[4],R=i[5];return r[0]=s*b+d*T,r[1]=u*b+f*T,r[2]=s*M+d*k,r[3]=u*M+f*k,r[4]=s*I+d*R+g,r[5]=u*I+f*R+v,r}function Zk(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r}En.mul=Hk,En.sub=Zk;var Xr={};function fw(r){return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(r)}Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.create=function(){var r=new vs.ARRAY_TYPE(9);return vs.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},Xr.fromMat4=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r},Xr.clone=function(r){var t=new vs.ARRAY_TYPE(9);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},Xr.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Xr.fromValues=function(r,t,i,s,u,d,f,g,v){var b=new vs.ARRAY_TYPE(9);return b[0]=r,b[1]=t,b[2]=i,b[3]=s,b[4]=u,b[5]=d,b[6]=f,b[7]=g,b[8]=v,b},Xr.set=function(r,t,i,s,u,d,f,g,v,b){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r[4]=d,r[5]=f,r[6]=g,r[7]=v,r[8]=b,r},Xr.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Xr.transpose=function(r,t){if(r===t){var i=t[1],s=t[2],u=t[5];r[1]=t[3],r[2]=t[6],r[3]=i,r[5]=t[7],r[6]=s,r[7]=u}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r},Xr.invert=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=t[6],b=t[7],T=t[8],M=T*f-g*b,k=-T*d+g*v,I=b*d-f*v,R=i*M+s*k+u*I;return R?(r[0]=M*(R=1/R),r[1]=(-T*s+u*b)*R,r[2]=(g*s-u*f)*R,r[3]=k*R,r[4]=(T*i-u*v)*R,r[5]=(-g*i+u*d)*R,r[6]=I*R,r[7]=(-b*i+s*v)*R,r[8]=(f*i-s*d)*R,r):null},Xr.adjoint=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=t[6],b=t[7],T=t[8];return r[0]=f*T-g*b,r[1]=u*b-s*T,r[2]=s*g-u*f,r[3]=g*v-d*T,r[4]=i*T-u*v,r[5]=u*d-i*g,r[6]=d*b-f*v,r[7]=s*v-i*b,r[8]=i*f-s*d,r},Xr.determinant=function(r){var t=r[3],i=r[4],s=r[5],u=r[6],d=r[7],f=r[8];return r[0]*(f*i-s*d)+r[1]*(-f*t+s*u)+r[2]*(d*t-i*u)},Xr.multiply=Yk,Xr.translate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=t[8],k=i[0],I=i[1];return r[0]=s,r[1]=u,r[2]=d,r[3]=f,r[4]=g,r[5]=v,r[6]=k*s+I*f+b,r[7]=k*u+I*g+T,r[8]=k*d+I*v+M,r},Xr.rotate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=t[8],k=Math.sin(i),I=Math.cos(i);return r[0]=I*s+k*f,r[1]=I*u+k*g,r[2]=I*d+k*v,r[3]=I*f-k*s,r[4]=I*g-k*u,r[5]=I*v-k*d,r[6]=b,r[7]=T,r[8]=M,r},Xr.scale=function(r,t,i){var s=i[0],u=i[1];return r[0]=s*t[0],r[1]=s*t[1],r[2]=s*t[2],r[3]=u*t[3],r[4]=u*t[4],r[5]=u*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Xr.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=t[0],r[7]=t[1],r[8]=1,r},Xr.fromRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=i,r[2]=0,r[3]=-i,r[4]=s,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Xr.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=t[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Xr.fromMat2d=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=0,r[3]=t[2],r[4]=t[3],r[5]=0,r[6]=t[4],r[7]=t[5],r[8]=1,r},Xr.fromQuat=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=i+i,g=s+s,v=u+u,b=i*f,T=s*f,M=s*g,k=u*f,I=u*g,R=u*v,B=d*f,j=d*g,U=d*v;return r[0]=1-M-R,r[3]=T-U,r[6]=k+j,r[1]=T+U,r[4]=1-b-R,r[7]=I-B,r[2]=k-j,r[5]=I+B,r[8]=1-b-M,r},Xr.normalFromMat4=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=t[6],b=t[7],T=t[8],M=t[9],k=t[10],I=t[11],R=t[12],B=t[13],j=t[14],U=t[15],J=i*g-s*f,ee=i*v-u*f,oe=i*b-d*f,ue=s*v-u*g,fe=s*b-d*g,xe=u*b-d*v,Te=T*B-M*R,Ae=T*j-k*R,Oe=T*U-I*R,Ie=M*j-k*B,He=M*U-I*B,lt=k*U-I*j,Ge=J*lt-ee*He+oe*Ie+ue*Oe-fe*Ae+xe*Te;return Ge?(r[0]=(g*lt-v*He+b*Ie)*(Ge=1/Ge),r[1]=(v*Oe-f*lt-b*Ae)*Ge,r[2]=(f*He-g*Oe+b*Te)*Ge,r[3]=(u*He-s*lt-d*Ie)*Ge,r[4]=(i*lt-u*Oe+d*Ae)*Ge,r[5]=(s*Oe-i*He-d*Te)*Ge,r[6]=(B*xe-j*fe+U*ue)*Ge,r[7]=(j*oe-R*xe-U*ee)*Ge,r[8]=(R*fe-B*oe+U*J)*Ge,r):null},Xr.projection=function(r,t,i){return r[0]=2/t,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/i,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r},Xr.str=function(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"},Xr.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},Xr.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r[8]=t[8]+i[8],r},Xr.subtract=Kk,Xr.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*i,r},Xr.multiplyScalarAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r[3]=t[3]+i[3]*s,r[4]=t[4]+i[4]*s,r[5]=t[5]+i[5]*s,r[6]=t[6]+i[6]*s,r[7]=t[7]+i[7]*s,r[8]=t[8]+i[8]*s,r},Xr.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]},Xr.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=r[4],g=r[5],v=r[6],b=r[7],T=r[8],M=t[0],k=t[1],I=t[2],R=t[3],B=t[4],j=t[5],U=t[6],J=t[7],ee=t[8];return Math.abs(i-M)<=vs.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(s-k)<=vs.EPSILON*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(u-I)<=vs.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(d-R)<=vs.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(f-B)<=vs.EPSILON*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(g-j)<=vs.EPSILON*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(v-U)<=vs.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(b-J)<=vs.EPSILON*Math.max(1,Math.abs(b),Math.abs(J))&&Math.abs(T-ee)<=vs.EPSILON*Math.max(1,Math.abs(T),Math.abs(ee))},Xr.sub=Xr.mul=void 0;var vs=function(r,t){if(r&&r.__esModule)return r;if(r===null||fw(r)!=="object"&&typeof r!="function")return{default:r};var i=Xk(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function Xk(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Xk=function(s){return s?i:t})(r)}function Yk(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=t[8],k=i[0],I=i[1],R=i[2],B=i[3],j=i[4],U=i[5],J=i[6],ee=i[7],oe=i[8];return r[0]=k*s+I*f+R*b,r[1]=k*u+I*g+R*T,r[2]=k*d+I*v+R*M,r[3]=B*s+j*f+U*b,r[4]=B*u+j*g+U*T,r[5]=B*d+j*v+U*M,r[6]=J*s+ee*f+oe*b,r[7]=J*u+ee*g+oe*T,r[8]=J*d+ee*v+oe*M,r}function Kk(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r[6]=t[6]-i[6],r[7]=t[7]-i[7],r[8]=t[8]-i[8],r}Xr.mul=Yk,Xr.sub=Kk;var ir={};function pw(r){return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(r)}Object.defineProperty(ir,"__esModule",{value:!0}),ir.create=function(){var r=new Dn.ARRAY_TYPE(16);return Dn.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},ir.clone=function(r){var t=new Dn.ARRAY_TYPE(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},ir.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},ir.fromValues=function(r,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B){var j=new Dn.ARRAY_TYPE(16);return j[0]=r,j[1]=t,j[2]=i,j[3]=s,j[4]=u,j[5]=d,j[6]=f,j[7]=g,j[8]=v,j[9]=b,j[10]=T,j[11]=M,j[12]=k,j[13]=I,j[14]=R,j[15]=B,j},ir.set=function(r,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r[4]=d,r[5]=f,r[6]=g,r[7]=v,r[8]=b,r[9]=T,r[10]=M,r[11]=k,r[12]=I,r[13]=R,r[14]=B,r[15]=j,r},ir.identity=Qk,ir.transpose=function(r,t){if(r===t){var i=t[1],s=t[2],u=t[3],d=t[6],f=t[7],g=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=i,r[6]=t[9],r[7]=t[13],r[8]=s,r[9]=d,r[11]=t[14],r[12]=u,r[13]=f,r[14]=g}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r},ir.invert=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=t[6],b=t[7],T=t[8],M=t[9],k=t[10],I=t[11],R=t[12],B=t[13],j=t[14],U=t[15],J=i*g-s*f,ee=i*v-u*f,oe=i*b-d*f,ue=s*v-u*g,fe=s*b-d*g,xe=u*b-d*v,Te=T*B-M*R,Ae=T*j-k*R,Oe=T*U-I*R,Ie=M*j-k*B,He=M*U-I*B,lt=k*U-I*j,Ge=J*lt-ee*He+oe*Ie+ue*Oe-fe*Ae+xe*Te;return Ge?(r[0]=(g*lt-v*He+b*Ie)*(Ge=1/Ge),r[1]=(u*He-s*lt-d*Ie)*Ge,r[2]=(B*xe-j*fe+U*ue)*Ge,r[3]=(k*fe-M*xe-I*ue)*Ge,r[4]=(v*Oe-f*lt-b*Ae)*Ge,r[5]=(i*lt-u*Oe+d*Ae)*Ge,r[6]=(j*oe-R*xe-U*ee)*Ge,r[7]=(T*xe-k*oe+I*ee)*Ge,r[8]=(f*He-g*Oe+b*Te)*Ge,r[9]=(s*Oe-i*He-d*Te)*Ge,r[10]=(R*fe-B*oe+U*J)*Ge,r[11]=(M*oe-T*fe-I*J)*Ge,r[12]=(g*Ae-f*Ie-v*Te)*Ge,r[13]=(i*Ie-s*Ae+u*Te)*Ge,r[14]=(B*ee-R*ue-j*J)*Ge,r[15]=(T*ue-M*ee+k*J)*Ge,r):null},ir.adjoint=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=t[4],g=t[5],v=t[6],b=t[7],T=t[8],M=t[9],k=t[10],I=t[11],R=t[12],B=t[13],j=t[14],U=t[15];return r[0]=g*(k*U-I*j)-M*(v*U-b*j)+B*(v*I-b*k),r[1]=-(s*(k*U-I*j)-M*(u*U-d*j)+B*(u*I-d*k)),r[2]=s*(v*U-b*j)-g*(u*U-d*j)+B*(u*b-d*v),r[3]=-(s*(v*I-b*k)-g*(u*I-d*k)+M*(u*b-d*v)),r[4]=-(f*(k*U-I*j)-T*(v*U-b*j)+R*(v*I-b*k)),r[5]=i*(k*U-I*j)-T*(u*U-d*j)+R*(u*I-d*k),r[6]=-(i*(v*U-b*j)-f*(u*U-d*j)+R*(u*b-d*v)),r[7]=i*(v*I-b*k)-f*(u*I-d*k)+T*(u*b-d*v),r[8]=f*(M*U-I*B)-T*(g*U-b*B)+R*(g*I-b*M),r[9]=-(i*(M*U-I*B)-T*(s*U-d*B)+R*(s*I-d*M)),r[10]=i*(g*U-b*B)-f*(s*U-d*B)+R*(s*b-d*g),r[11]=-(i*(g*I-b*M)-f*(s*I-d*M)+T*(s*b-d*g)),r[12]=-(f*(M*j-k*B)-T*(g*j-v*B)+R*(g*k-v*M)),r[13]=i*(M*j-k*B)-T*(s*j-u*B)+R*(s*k-u*M),r[14]=-(i*(g*j-v*B)-f*(s*j-u*B)+R*(s*v-u*g)),r[15]=i*(g*k-v*M)-f*(s*k-u*M)+T*(s*v-u*g),r},ir.determinant=function(r){var t=r[0],i=r[1],s=r[2],u=r[3],d=r[4],f=r[5],g=r[6],v=r[7],b=r[8],T=r[9],M=r[10],k=r[11],I=r[12],R=r[13],B=r[14],j=r[15];return(t*f-i*d)*(M*j-k*B)-(t*g-s*d)*(T*j-k*R)+(t*v-u*d)*(T*B-M*R)+(i*g-s*f)*(b*j-k*I)-(i*v-u*f)*(b*B-M*I)+(s*v-u*g)*(b*R-T*I)},ir.multiply=eP,ir.translate=function(r,t,i){var s,u,d,f,g,v,b,T,M,k,I,R,B=i[0],j=i[1],U=i[2];return t===r?(r[12]=t[0]*B+t[4]*j+t[8]*U+t[12],r[13]=t[1]*B+t[5]*j+t[9]*U+t[13],r[14]=t[2]*B+t[6]*j+t[10]*U+t[14],r[15]=t[3]*B+t[7]*j+t[11]*U+t[15]):(u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=t[8],k=t[9],I=t[10],R=t[11],r[0]=s=t[0],r[1]=u,r[2]=d,r[3]=f,r[4]=g,r[5]=v,r[6]=b,r[7]=T,r[8]=M,r[9]=k,r[10]=I,r[11]=R,r[12]=s*B+g*j+M*U+t[12],r[13]=u*B+v*j+k*U+t[13],r[14]=d*B+b*j+I*U+t[14],r[15]=f*B+T*j+R*U+t[15]),r},ir.scale=function(r,t,i){var s=i[0],u=i[1],d=i[2];return r[0]=t[0]*s,r[1]=t[1]*s,r[2]=t[2]*s,r[3]=t[3]*s,r[4]=t[4]*u,r[5]=t[5]*u,r[6]=t[6]*u,r[7]=t[7]*u,r[8]=t[8]*d,r[9]=t[9]*d,r[10]=t[10]*d,r[11]=t[11]*d,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},ir.rotate=function(r,t,i,s){var u,d,f,g,v,b,T,M,k,I,R,B,j,U,J,ee,oe,ue,fe,xe,Te,Ae,Oe,Ie,He=s[0],lt=s[1],Ge=s[2],et=Math.hypot(He,lt,Ge);return et<Dn.EPSILON?null:(He*=et=1/et,lt*=et,Ge*=et,u=Math.sin(i),d=Math.cos(i),v=t[1],b=t[2],T=t[3],k=t[5],I=t[6],R=t[7],j=t[9],U=t[10],J=t[11],fe=He*lt*(f=1-d)-Ge*u,xe=lt*lt*f+d,Te=Ge*lt*f+He*u,Ae=He*Ge*f+lt*u,Oe=lt*Ge*f-He*u,Ie=Ge*Ge*f+d,r[0]=(g=t[0])*(ee=He*He*f+d)+(M=t[4])*(oe=lt*He*f+Ge*u)+(B=t[8])*(ue=Ge*He*f-lt*u),r[1]=v*ee+k*oe+j*ue,r[2]=b*ee+I*oe+U*ue,r[3]=T*ee+R*oe+J*ue,r[4]=g*fe+M*xe+B*Te,r[5]=v*fe+k*xe+j*Te,r[6]=b*fe+I*xe+U*Te,r[7]=T*fe+R*xe+J*Te,r[8]=g*Ae+M*Oe+B*Ie,r[9]=v*Ae+k*Oe+j*Ie,r[10]=b*Ae+I*Oe+U*Ie,r[11]=T*Ae+R*Oe+J*Ie,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)},ir.rotateX=function(r,t,i){var s=Math.sin(i),u=Math.cos(i),d=t[4],f=t[5],g=t[6],v=t[7],b=t[8],T=t[9],M=t[10],k=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=d*u+b*s,r[5]=f*u+T*s,r[6]=g*u+M*s,r[7]=v*u+k*s,r[8]=b*u-d*s,r[9]=T*u-f*s,r[10]=M*u-g*s,r[11]=k*u-v*s,r},ir.rotateY=function(r,t,i){var s=Math.sin(i),u=Math.cos(i),d=t[0],f=t[1],g=t[2],v=t[3],b=t[8],T=t[9],M=t[10],k=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=d*u-b*s,r[1]=f*u-T*s,r[2]=g*u-M*s,r[3]=v*u-k*s,r[8]=d*s+b*u,r[9]=f*s+T*u,r[10]=g*s+M*u,r[11]=v*s+k*u,r},ir.rotateZ=function(r,t,i){var s=Math.sin(i),u=Math.cos(i),d=t[0],f=t[1],g=t[2],v=t[3],b=t[4],T=t[5],M=t[6],k=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=d*u+b*s,r[1]=f*u+T*s,r[2]=g*u+M*s,r[3]=v*u+k*s,r[4]=b*u-d*s,r[5]=T*u-f*s,r[6]=M*u-g*s,r[7]=k*u-v*s,r},ir.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},ir.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ir.fromRotation=function(r,t,i){var s,u,d,f=i[0],g=i[1],v=i[2],b=Math.hypot(f,g,v);return b<Dn.EPSILON?null:(f*=b=1/b,g*=b,v*=b,s=Math.sin(t),u=Math.cos(t),r[0]=f*f*(d=1-u)+u,r[1]=g*f*d+v*s,r[2]=v*f*d-g*s,r[3]=0,r[4]=f*g*d-v*s,r[5]=g*g*d+u,r[6]=v*g*d+f*s,r[7]=0,r[8]=f*v*d+g*s,r[9]=g*v*d-f*s,r[10]=v*v*d+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)},ir.fromXRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=i,r[7]=0,r[8]=0,r[9]=-i,r[10]=s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ir.fromYRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=0,r[2]=-i,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=0,r[10]=s,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ir.fromZRotation=function(r,t){var i=Math.sin(t),s=Math.cos(t);return r[0]=s,r[1]=i,r[2]=0,r[3]=0,r[4]=-i,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ir.fromRotationTranslation=tP,ir.fromQuat2=function(r,t){var i=new Dn.ARRAY_TYPE(3),s=-t[0],u=-t[1],d=-t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=s*s+u*u+d*d+f*f;return M>0?(i[0]=2*(g*f+T*s+v*d-b*u)/M,i[1]=2*(v*f+T*u+b*s-g*d)/M,i[2]=2*(b*f+T*d+g*u-v*s)/M):(i[0]=2*(g*f+T*s+v*d-b*u),i[1]=2*(v*f+T*u+b*s-g*d),i[2]=2*(b*f+T*d+g*u-v*s)),tP(r,t,i),r},ir.getTranslation=function(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r},ir.getScaling=rP,ir.getRotation=function(r,t){var i=new Dn.ARRAY_TYPE(3);rP(i,t);var s=1/i[0],u=1/i[1],d=1/i[2],f=t[0]*s,g=t[1]*u,v=t[2]*d,b=t[4]*s,T=t[5]*u,M=t[6]*d,k=t[8]*s,I=t[9]*u,R=t[10]*d,B=f+T+R,j=0;return B>0?(j=2*Math.sqrt(B+1),r[3]=.25*j,r[0]=(M-I)/j,r[1]=(k-v)/j,r[2]=(g-b)/j):f>T&&f>R?(j=2*Math.sqrt(1+f-T-R),r[3]=(M-I)/j,r[0]=.25*j,r[1]=(g+b)/j,r[2]=(k+v)/j):T>R?(j=2*Math.sqrt(1+T-f-R),r[3]=(k-v)/j,r[0]=(g+b)/j,r[1]=.25*j,r[2]=(M+I)/j):(j=2*Math.sqrt(1+R-f-T),r[3]=(g-b)/j,r[0]=(k+v)/j,r[1]=(M+I)/j,r[2]=.25*j),r},ir.fromRotationTranslationScale=function(r,t,i,s){var u=t[0],d=t[1],f=t[2],g=t[3],v=u+u,b=d+d,T=f+f,M=u*v,k=u*b,I=u*T,R=d*b,B=d*T,j=f*T,U=g*v,J=g*b,ee=g*T,oe=s[0],ue=s[1],fe=s[2];return r[0]=(1-(R+j))*oe,r[1]=(k+ee)*oe,r[2]=(I-J)*oe,r[3]=0,r[4]=(k-ee)*ue,r[5]=(1-(M+j))*ue,r[6]=(B+U)*ue,r[7]=0,r[8]=(I+J)*fe,r[9]=(B-U)*fe,r[10]=(1-(M+R))*fe,r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r},ir.fromRotationTranslationScaleOrigin=function(r,t,i,s,u){var d=t[0],f=t[1],g=t[2],v=t[3],b=d+d,T=f+f,M=g+g,k=d*b,I=d*T,R=d*M,B=f*T,j=f*M,U=g*M,J=v*b,ee=v*T,oe=v*M,ue=s[0],fe=s[1],xe=s[2],Te=u[0],Ae=u[1],Oe=u[2],Ie=(1-(B+U))*ue,He=(I+oe)*ue,lt=(R-ee)*ue,Ge=(I-oe)*fe,et=(1-(k+U))*fe,Ue=(j+J)*fe,vt=(R+ee)*xe,Tt=(j-J)*xe,ot=(1-(k+B))*xe;return r[0]=Ie,r[1]=He,r[2]=lt,r[3]=0,r[4]=Ge,r[5]=et,r[6]=Ue,r[7]=0,r[8]=vt,r[9]=Tt,r[10]=ot,r[11]=0,r[12]=i[0]+Te-(Ie*Te+Ge*Ae+vt*Oe),r[13]=i[1]+Ae-(He*Te+et*Ae+Tt*Oe),r[14]=i[2]+Oe-(lt*Te+Ue*Ae+ot*Oe),r[15]=1,r},ir.fromQuat=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=i+i,g=s+s,v=u+u,b=i*f,T=s*f,M=s*g,k=u*f,I=u*g,R=u*v,B=d*f,j=d*g,U=d*v;return r[0]=1-M-R,r[1]=T+U,r[2]=k-j,r[3]=0,r[4]=T-U,r[5]=1-b-R,r[6]=I+B,r[7]=0,r[8]=k+j,r[9]=I-B,r[10]=1-b-M,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ir.frustum=function(r,t,i,s,u,d,f){var g=1/(i-t),v=1/(u-s),b=1/(d-f);return r[0]=2*d*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*d*v,r[6]=0,r[7]=0,r[8]=(i+t)*g,r[9]=(u+s)*v,r[10]=(f+d)*b,r[11]=-1,r[12]=0,r[13]=0,r[14]=f*d*2*b,r[15]=0,r},ir.perspectiveNO=nP,ir.perspectiveZO=function(r,t,i,s,u){var d,f=1/Math.tan(t/2);return r[0]=f/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=u*(d=1/(s-u)),r[14]=u*s*d):(r[10]=-1,r[14]=-s),r},ir.perspectiveFromFieldOfView=function(r,t,i,s){var u=Math.tan(t.upDegrees*Math.PI/180),d=Math.tan(t.downDegrees*Math.PI/180),f=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),v=2/(f+g),b=2/(u+d);return r[0]=v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=-(f-g)*v*.5,r[9]=(u-d)*b*.5,r[10]=s/(i-s),r[11]=-1,r[12]=0,r[13]=0,r[14]=s*i/(i-s),r[15]=0,r},ir.orthoNO=iP,ir.orthoZO=function(r,t,i,s,u,d,f){var g=1/(t-i),v=1/(s-u),b=1/(d-f);return r[0]=-2*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=b,r[11]=0,r[12]=(t+i)*g,r[13]=(u+s)*v,r[14]=d*b,r[15]=1,r},ir.lookAt=function(r,t,i,s){var u,d,f,g,v,b,T,M,k,I,R=t[0],B=t[1],j=t[2],U=s[0],J=s[1],ee=s[2],oe=i[0],ue=i[1],fe=i[2];return Math.abs(R-oe)<Dn.EPSILON&&Math.abs(B-ue)<Dn.EPSILON&&Math.abs(j-fe)<Dn.EPSILON?Qk(r):(T=R-oe,M=B-ue,k=j-fe,u=J*(k*=I=1/Math.hypot(T,M,k))-ee*(M*=I),d=ee*(T*=I)-U*k,f=U*M-J*T,(I=Math.hypot(u,d,f))?(u*=I=1/I,d*=I,f*=I):(u=0,d=0,f=0),g=M*f-k*d,v=k*u-T*f,b=T*d-M*u,(I=Math.hypot(g,v,b))?(g*=I=1/I,v*=I,b*=I):(g=0,v=0,b=0),r[0]=u,r[1]=g,r[2]=T,r[3]=0,r[4]=d,r[5]=v,r[6]=M,r[7]=0,r[8]=f,r[9]=b,r[10]=k,r[11]=0,r[12]=-(u*R+d*B+f*j),r[13]=-(g*R+v*B+b*j),r[14]=-(T*R+M*B+k*j),r[15]=1,r)},ir.targetTo=function(r,t,i,s){var u=t[0],d=t[1],f=t[2],g=s[0],v=s[1],b=s[2],T=u-i[0],M=d-i[1],k=f-i[2],I=T*T+M*M+k*k;I>0&&(T*=I=1/Math.sqrt(I),M*=I,k*=I);var R=v*k-b*M,B=b*T-g*k,j=g*M-v*T;return(I=R*R+B*B+j*j)>0&&(R*=I=1/Math.sqrt(I),B*=I,j*=I),r[0]=R,r[1]=B,r[2]=j,r[3]=0,r[4]=M*j-k*B,r[5]=k*R-T*j,r[6]=T*B-M*R,r[7]=0,r[8]=T,r[9]=M,r[10]=k,r[11]=0,r[12]=u,r[13]=d,r[14]=f,r[15]=1,r},ir.str=function(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"},ir.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])},ir.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r[8]=t[8]+i[8],r[9]=t[9]+i[9],r[10]=t[10]+i[10],r[11]=t[11]+i[11],r[12]=t[12]+i[12],r[13]=t[13]+i[13],r[14]=t[14]+i[14],r[15]=t[15]+i[15],r},ir.subtract=oP,ir.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*i,r[9]=t[9]*i,r[10]=t[10]*i,r[11]=t[11]*i,r[12]=t[12]*i,r[13]=t[13]*i,r[14]=t[14]*i,r[15]=t[15]*i,r},ir.multiplyScalarAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r[3]=t[3]+i[3]*s,r[4]=t[4]+i[4]*s,r[5]=t[5]+i[5]*s,r[6]=t[6]+i[6]*s,r[7]=t[7]+i[7]*s,r[8]=t[8]+i[8]*s,r[9]=t[9]+i[9]*s,r[10]=t[10]+i[10]*s,r[11]=t[11]+i[11]*s,r[12]=t[12]+i[12]*s,r[13]=t[13]+i[13]*s,r[14]=t[14]+i[14]*s,r[15]=t[15]+i[15]*s,r},ir.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},ir.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=r[4],g=r[5],v=r[6],b=r[7],T=r[8],M=r[9],k=r[10],I=r[11],R=r[12],B=r[13],j=r[14],U=r[15],J=t[0],ee=t[1],oe=t[2],ue=t[3],fe=t[4],xe=t[5],Te=t[6],Ae=t[7],Oe=t[8],Ie=t[9],He=t[10],lt=t[11],Ge=t[12],et=t[13],Ue=t[14],vt=t[15];return Math.abs(i-J)<=Dn.EPSILON*Math.max(1,Math.abs(i),Math.abs(J))&&Math.abs(s-ee)<=Dn.EPSILON*Math.max(1,Math.abs(s),Math.abs(ee))&&Math.abs(u-oe)<=Dn.EPSILON*Math.max(1,Math.abs(u),Math.abs(oe))&&Math.abs(d-ue)<=Dn.EPSILON*Math.max(1,Math.abs(d),Math.abs(ue))&&Math.abs(f-fe)<=Dn.EPSILON*Math.max(1,Math.abs(f),Math.abs(fe))&&Math.abs(g-xe)<=Dn.EPSILON*Math.max(1,Math.abs(g),Math.abs(xe))&&Math.abs(v-Te)<=Dn.EPSILON*Math.max(1,Math.abs(v),Math.abs(Te))&&Math.abs(b-Ae)<=Dn.EPSILON*Math.max(1,Math.abs(b),Math.abs(Ae))&&Math.abs(T-Oe)<=Dn.EPSILON*Math.max(1,Math.abs(T),Math.abs(Oe))&&Math.abs(M-Ie)<=Dn.EPSILON*Math.max(1,Math.abs(M),Math.abs(Ie))&&Math.abs(k-He)<=Dn.EPSILON*Math.max(1,Math.abs(k),Math.abs(He))&&Math.abs(I-lt)<=Dn.EPSILON*Math.max(1,Math.abs(I),Math.abs(lt))&&Math.abs(R-Ge)<=Dn.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ge))&&Math.abs(B-et)<=Dn.EPSILON*Math.max(1,Math.abs(B),Math.abs(et))&&Math.abs(j-Ue)<=Dn.EPSILON*Math.max(1,Math.abs(j),Math.abs(Ue))&&Math.abs(U-vt)<=Dn.EPSILON*Math.max(1,Math.abs(U),Math.abs(vt))},ir.sub=ir.mul=ir.ortho=ir.perspective=void 0;var Dn=function(r,t){if(r&&r.__esModule)return r;if(r===null||pw(r)!=="object"&&typeof r!="function")return{default:r};var i=Jk(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function Jk(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Jk=function(s){return s?i:t})(r)}function Qk(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function eP(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=t[8],k=t[9],I=t[10],R=t[11],B=t[12],j=t[13],U=t[14],J=t[15],ee=i[0],oe=i[1],ue=i[2],fe=i[3];return r[0]=ee*s+oe*g+ue*M+fe*B,r[1]=ee*u+oe*v+ue*k+fe*j,r[2]=ee*d+oe*b+ue*I+fe*U,r[3]=ee*f+oe*T+ue*R+fe*J,r[4]=(ee=i[4])*s+(oe=i[5])*g+(ue=i[6])*M+(fe=i[7])*B,r[5]=ee*u+oe*v+ue*k+fe*j,r[6]=ee*d+oe*b+ue*I+fe*U,r[7]=ee*f+oe*T+ue*R+fe*J,r[8]=(ee=i[8])*s+(oe=i[9])*g+(ue=i[10])*M+(fe=i[11])*B,r[9]=ee*u+oe*v+ue*k+fe*j,r[10]=ee*d+oe*b+ue*I+fe*U,r[11]=ee*f+oe*T+ue*R+fe*J,r[12]=(ee=i[12])*s+(oe=i[13])*g+(ue=i[14])*M+(fe=i[15])*B,r[13]=ee*u+oe*v+ue*k+fe*j,r[14]=ee*d+oe*b+ue*I+fe*U,r[15]=ee*f+oe*T+ue*R+fe*J,r}function tP(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=s+s,v=u+u,b=d+d,T=s*g,M=s*v,k=s*b,I=u*v,R=u*b,B=d*b,j=f*g,U=f*v,J=f*b;return r[0]=1-(I+B),r[1]=M+J,r[2]=k-U,r[3]=0,r[4]=M-J,r[5]=1-(T+B),r[6]=R+j,r[7]=0,r[8]=k+U,r[9]=R-j,r[10]=1-(T+I),r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function rP(r,t){var i=t[4],s=t[5],u=t[6],d=t[8],f=t[9],g=t[10];return r[0]=Math.hypot(t[0],t[1],t[2]),r[1]=Math.hypot(i,s,u),r[2]=Math.hypot(d,f,g),r}function nP(r,t,i,s,u){var d,f=1/Math.tan(t/2);return r[0]=f/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=(u+s)*(d=1/(s-u)),r[14]=2*u*s*d):(r[10]=-1,r[14]=-2*s),r}function iP(r,t,i,s,u,d,f){var g=1/(t-i),v=1/(s-u),b=1/(d-f);return r[0]=-2*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*b,r[11]=0,r[12]=(t+i)*g,r[13]=(u+s)*v,r[14]=(f+d)*b,r[15]=1,r}function oP(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r[6]=t[6]-i[6],r[7]=t[7]-i[7],r[8]=t[8]-i[8],r[9]=t[9]-i[9],r[10]=t[10]-i[10],r[11]=t[11]-i[11],r[12]=t[12]-i[12],r[13]=t[13]-i[13],r[14]=t[14]-i[14],r[15]=t[15]-i[15],r}ir.perspective=nP,ir.ortho=iP,ir.mul=eP,ir.sub=oP;var er={},nr={};function mw(r){return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(r)}Object.defineProperty(nr,"__esModule",{value:!0}),nr.create=aP,nr.clone=function(r){var t=new Jl.ARRAY_TYPE(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},nr.length=lP,nr.fromValues=function(r,t,i){var s=new Jl.ARRAY_TYPE(3);return s[0]=r,s[1]=t,s[2]=i,s},nr.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},nr.set=function(r,t,i,s){return r[0]=t,r[1]=i,r[2]=s,r},nr.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r},nr.subtract=cP,nr.multiply=uP,nr.divide=hP,nr.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r},nr.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r},nr.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r},nr.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.max(t[2],i[2]),r},nr.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r},nr.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r},nr.scaleAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r},nr.distance=dP,nr.squaredDistance=fP,nr.squaredLength=pP,nr.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r},nr.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r},nr.normalize=function(r,t){var i=t[0],s=t[1],u=t[2],d=i*i+s*s+u*u;return d>0&&(d=1/Math.sqrt(d)),r[0]=t[0]*d,r[1]=t[1]*d,r[2]=t[2]*d,r},nr.dot=mP,nr.cross=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=i[0],g=i[1],v=i[2];return r[0]=u*v-d*g,r[1]=d*f-s*v,r[2]=s*g-u*f,r},nr.lerp=function(r,t,i,s){var u=t[0],d=t[1],f=t[2];return r[0]=u+s*(i[0]-u),r[1]=d+s*(i[1]-d),r[2]=f+s*(i[2]-f),r},nr.hermite=function(r,t,i,s,u,d){var f=d*d,g=f*(2*d-3)+1,v=f*(d-2)+d,b=f*(d-1),T=f*(3-2*d);return r[0]=t[0]*g+i[0]*v+s[0]*b+u[0]*T,r[1]=t[1]*g+i[1]*v+s[1]*b+u[1]*T,r[2]=t[2]*g+i[2]*v+s[2]*b+u[2]*T,r},nr.bezier=function(r,t,i,s,u,d){var f=1-d,g=f*f,v=d*d,b=g*f,T=3*d*g,M=3*v*f,k=v*d;return r[0]=t[0]*b+i[0]*T+s[0]*M+u[0]*k,r[1]=t[1]*b+i[1]*T+s[1]*M+u[1]*k,r[2]=t[2]*b+i[2]*T+s[2]*M+u[2]*k,r},nr.random=function(r,t){t=t||1;var i=2*Jl.RANDOM()*Math.PI,s=2*Jl.RANDOM()-1,u=Math.sqrt(1-s*s)*t;return r[0]=Math.cos(i)*u,r[1]=Math.sin(i)*u,r[2]=s*t,r},nr.transformMat4=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=i[3]*s+i[7]*u+i[11]*d+i[15];return r[0]=(i[0]*s+i[4]*u+i[8]*d+i[12])/(f=f||1),r[1]=(i[1]*s+i[5]*u+i[9]*d+i[13])/f,r[2]=(i[2]*s+i[6]*u+i[10]*d+i[14])/f,r},nr.transformMat3=function(r,t,i){var s=t[0],u=t[1],d=t[2];return r[0]=s*i[0]+u*i[3]+d*i[6],r[1]=s*i[1]+u*i[4]+d*i[7],r[2]=s*i[2]+u*i[5]+d*i[8],r},nr.transformQuat=function(r,t,i){var s=i[0],u=i[1],d=i[2],f=t[0],g=t[1],v=t[2],b=u*v-d*g,T=d*f-s*v,M=s*g-u*f,k=u*M-d*T,I=d*b-s*M,R=s*T-u*b,B=2*i[3];return T*=B,M*=B,I*=2,R*=2,r[0]=f+(b*=B)+(k*=2),r[1]=g+T+I,r[2]=v+M+R,r},nr.rotateX=function(r,t,i,s){var u=[],d=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],d[0]=u[0],d[1]=u[1]*Math.cos(s)-u[2]*Math.sin(s),d[2]=u[1]*Math.sin(s)+u[2]*Math.cos(s),r[0]=d[0]+i[0],r[1]=d[1]+i[1],r[2]=d[2]+i[2],r},nr.rotateY=function(r,t,i,s){var u=[],d=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],d[0]=u[2]*Math.sin(s)+u[0]*Math.cos(s),d[1]=u[1],d[2]=u[2]*Math.cos(s)-u[0]*Math.sin(s),r[0]=d[0]+i[0],r[1]=d[1]+i[1],r[2]=d[2]+i[2],r},nr.rotateZ=function(r,t,i,s){var u=[],d=[];return u[0]=t[0]-i[0],u[1]=t[1]-i[1],u[2]=t[2]-i[2],d[0]=u[0]*Math.cos(s)-u[1]*Math.sin(s),d[1]=u[0]*Math.sin(s)+u[1]*Math.cos(s),d[2]=u[2],r[0]=d[0]+i[0],r[1]=d[1]+i[1],r[2]=d[2]+i[2],r},nr.angle=function(r,t){var i=r[0],s=r[1],u=r[2],d=t[0],f=t[1],g=t[2],v=Math.sqrt(i*i+s*s+u*u)*Math.sqrt(d*d+f*f+g*g),b=v&&mP(r,t)/v;return Math.acos(Math.min(Math.max(b,-1),1))},nr.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r},nr.str=function(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"},nr.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]},nr.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=t[0],f=t[1],g=t[2];return Math.abs(i-d)<=Jl.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-f)<=Jl.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(u-g)<=Jl.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},nr.forEach=nr.sqrLen=nr.len=nr.sqrDist=nr.dist=nr.div=nr.mul=nr.sub=void 0;var Jl=function(r,t){if(r&&r.__esModule)return r;if(r===null||mw(r)!=="object"&&typeof r!="function")return{default:r};var i=sP(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function sP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(sP=function(s){return s?i:t})(r)}function aP(){var r=new Jl.ARRAY_TYPE(3);return Jl.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function lP(r){return Math.hypot(r[0],r[1],r[2])}function cP(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r}function uP(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r}function hP(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r[2]=t[2]/i[2],r}function dP(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2])}function fP(r,t){var i=t[0]-r[0],s=t[1]-r[1],u=t[2]-r[2];return i*i+s*s+u*u}function pP(r){var t=r[0],i=r[1],s=r[2];return t*t+i*i+s*s}function mP(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}nr.sub=cP,nr.mul=uP,nr.div=hP,nr.dist=dP,nr.sqrDist=fP,nr.len=lP,nr.sqrLen=pP;var Ql,G8=(Ql=aP(),function(r,t,i,s,u,d){var f,g;for(t||(t=3),i||(i=0),g=s?Math.min(s*t+i,r.length):r.length,f=i;f<g;f+=t)Ql[0]=r[f],Ql[1]=r[f+1],Ql[2]=r[f+2],u(Ql,Ql,d),r[f]=Ql[0],r[f+1]=Ql[1],r[f+2]=Ql[2];return r});nr.forEach=G8;var hr={};function gw(r){return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(r)}Object.defineProperty(hr,"__esModule",{value:!0}),hr.create=_P,hr.clone=function(r){var t=new Gs.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},hr.fromValues=function(r,t,i,s){var u=new Gs.ARRAY_TYPE(4);return u[0]=r,u[1]=t,u[2]=i,u[3]=s,u},hr.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},hr.set=function(r,t,i,s,u){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r},hr.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r},hr.subtract=yP,hr.multiply=vP,hr.divide=xP,hr.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r[3]=Math.ceil(t[3]),r},hr.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r[3]=Math.floor(t[3]),r},hr.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r[3]=Math.min(t[3],i[3]),r},hr.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.max(t[2],i[2]),r[3]=Math.max(t[3],i[3]),r},hr.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r[3]=Math.round(t[3]),r},hr.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r},hr.scaleAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r[2]=t[2]+i[2]*s,r[3]=t[3]+i[3]*s,r},hr.distance=bP,hr.squaredDistance=wP,hr.length=SP,hr.squaredLength=TP,hr.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r},hr.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r[3]=1/t[3],r},hr.normalize=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=i*i+s*s+u*u+d*d;return f>0&&(f=1/Math.sqrt(f)),r[0]=i*f,r[1]=s*f,r[2]=u*f,r[3]=d*f,r},hr.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},hr.cross=function(r,t,i,s){var u=i[0]*s[1]-i[1]*s[0],d=i[0]*s[2]-i[2]*s[0],f=i[0]*s[3]-i[3]*s[0],g=i[1]*s[2]-i[2]*s[1],v=i[1]*s[3]-i[3]*s[1],b=i[2]*s[3]-i[3]*s[2],T=t[0],M=t[1],k=t[2],I=t[3];return r[0]=M*b-k*v+I*g,r[1]=-T*b+k*f-I*d,r[2]=T*v-M*f+I*u,r[3]=-T*g+M*d-k*u,r},hr.lerp=function(r,t,i,s){var u=t[0],d=t[1],f=t[2],g=t[3];return r[0]=u+s*(i[0]-u),r[1]=d+s*(i[1]-d),r[2]=f+s*(i[2]-f),r[3]=g+s*(i[3]-g),r},hr.random=function(r,t){var i,s,u,d,f,g;t=t||1;do f=(i=2*Gs.RANDOM()-1)*i+(s=2*Gs.RANDOM()-1)*s;while(f>=1);do g=(u=2*Gs.RANDOM()-1)*u+(d=2*Gs.RANDOM()-1)*d;while(g>=1);var v=Math.sqrt((1-f)/g);return r[0]=t*i,r[1]=t*s,r[2]=t*u*v,r[3]=t*d*v,r},hr.transformMat4=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3];return r[0]=i[0]*s+i[4]*u+i[8]*d+i[12]*f,r[1]=i[1]*s+i[5]*u+i[9]*d+i[13]*f,r[2]=i[2]*s+i[6]*u+i[10]*d+i[14]*f,r[3]=i[3]*s+i[7]*u+i[11]*d+i[15]*f,r},hr.transformQuat=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=i[0],g=i[1],v=i[2],b=i[3],T=b*s+g*d-v*u,M=b*u+v*s-f*d,k=b*d+f*u-g*s,I=-f*s-g*u-v*d;return r[0]=T*b+I*-f+M*-v-k*-g,r[1]=M*b+I*-g+k*-f-T*-v,r[2]=k*b+I*-v+T*-g-M*-f,r[3]=t[3],r},hr.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r},hr.str=function(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},hr.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},hr.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(i-f)<=Gs.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-g)<=Gs.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-v)<=Gs.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(d-b)<=Gs.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},hr.forEach=hr.sqrLen=hr.len=hr.sqrDist=hr.dist=hr.div=hr.mul=hr.sub=void 0;var Gs=function(r,t){if(r&&r.__esModule)return r;if(r===null||gw(r)!=="object"&&typeof r!="function")return{default:r};var i=gP(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function gP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(gP=function(s){return s?i:t})(r)}function _P(){var r=new Gs.ARRAY_TYPE(4);return Gs.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function yP(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r}function vP(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r[3]=t[3]*i[3],r}function xP(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r[2]=t[2]/i[2],r[3]=t[3]/i[3],r}function bP(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2],t[3]-r[3])}function wP(r,t){var i=t[0]-r[0],s=t[1]-r[1],u=t[2]-r[2],d=t[3]-r[3];return i*i+s*s+u*u+d*d}function SP(r){return Math.hypot(r[0],r[1],r[2],r[3])}function TP(r){var t=r[0],i=r[1],s=r[2],u=r[3];return t*t+i*i+s*s+u*u}hr.sub=yP,hr.mul=vP,hr.div=xP,hr.dist=bP,hr.sqrDist=wP,hr.len=SP,hr.sqrLen=TP;var W8=function(){var r=_P();return function(t,i,s,u,d,f){var g,v;for(i||(i=4),s||(s=0),v=u?Math.min(u*i+s,t.length):t.length,g=s;g<v;g+=i)r[0]=t[g],r[1]=t[g+1],r[2]=t[g+2],r[3]=t[g+3],d(r,r,f),t[g]=r[0],t[g+1]=r[1],t[g+2]=r[2],t[g+3]=r[3];return t}}();function _w(r){return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(r)}hr.forEach=W8,Object.defineProperty(er,"__esModule",{value:!0}),er.create=yw,er.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r},er.setAxisAngle=CP,er.getAxisAngle=function(r,t){var i=2*Math.acos(t[3]),s=Math.sin(i/2);return s>mh.EPSILON?(r[0]=t[0]/s,r[1]=t[1]/s,r[2]=t[2]/s):(r[0]=1,r[1]=0,r[2]=0),i},er.getAngle=function(r,t){var i=zP(r,t);return Math.acos(2*i*i-1)},er.multiply=MP,er.rotateX=function(r,t,i){i*=.5;var s=t[0],u=t[1],d=t[2],f=t[3],g=Math.sin(i),v=Math.cos(i);return r[0]=s*v+f*g,r[1]=u*v+d*g,r[2]=d*v-u*g,r[3]=f*v-s*g,r},er.rotateY=function(r,t,i){i*=.5;var s=t[0],u=t[1],d=t[2],f=t[3],g=Math.sin(i),v=Math.cos(i);return r[0]=s*v-d*g,r[1]=u*v+f*g,r[2]=d*v+s*g,r[3]=f*v-u*g,r},er.rotateZ=function(r,t,i){i*=.5;var s=t[0],u=t[1],d=t[2],f=t[3],g=Math.sin(i),v=Math.cos(i);return r[0]=s*v+u*g,r[1]=u*v-s*g,r[2]=d*v+f*g,r[3]=f*v-d*g,r},er.calculateW=function(r,t){var i=t[0],s=t[1],u=t[2];return r[0]=i,r[1]=s,r[2]=u,r[3]=Math.sqrt(Math.abs(1-i*i-s*s-u*u)),r},er.exp=AP,er.ln=kP,er.pow=function(r,t,i){return kP(r,t),IP(r,r,i),AP(r,r),r},er.slerp=r0,er.random=function(r){var t=mh.RANDOM(),i=mh.RANDOM(),s=mh.RANDOM(),u=Math.sqrt(1-t),d=Math.sqrt(t);return r[0]=u*Math.sin(2*Math.PI*i),r[1]=u*Math.cos(2*Math.PI*i),r[2]=d*Math.sin(2*Math.PI*s),r[3]=d*Math.cos(2*Math.PI*s),r},er.invert=function(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=i*i+s*s+u*u+d*d,g=f?1/f:0;return r[0]=-i*g,r[1]=-s*g,r[2]=-u*g,r[3]=d*g,r},er.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},er.fromMat3=PP,er.fromEuler=function(r,t,i,s){var u=.5*Math.PI/180;t*=u,i*=u,s*=u;var d=Math.sin(t),f=Math.cos(t),g=Math.sin(i),v=Math.cos(i),b=Math.sin(s),T=Math.cos(s);return r[0]=d*v*T-f*g*b,r[1]=f*g*T+d*v*b,r[2]=f*v*b-d*g*T,r[3]=f*v*T+d*g*b,r},er.str=function(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},er.setAxes=er.sqlerp=er.rotationTo=er.equals=er.exactEquals=er.normalize=er.sqrLen=er.squaredLength=er.len=er.length=er.lerp=er.dot=er.scale=er.mul=er.add=er.set=er.copy=er.fromValues=er.clone=void 0;var mh=t0(gi),q8=t0(Xr),ec=t0(nr),xs=t0(hr);function EP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(EP=function(s){return s?i:t})(r)}function t0(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||_w(r)!=="object"&&typeof r!="function")return{default:r};var i=EP(t);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}function yw(){var r=new mh.ARRAY_TYPE(4);return mh.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function CP(r,t,i){i*=.5;var s=Math.sin(i);return r[0]=s*t[0],r[1]=s*t[1],r[2]=s*t[2],r[3]=Math.cos(i),r}function MP(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=i[0],v=i[1],b=i[2],T=i[3];return r[0]=s*T+f*g+u*b-d*v,r[1]=u*T+f*v+d*g-s*b,r[2]=d*T+f*b+s*v-u*g,r[3]=f*T-s*g-u*v-d*b,r}function AP(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=Math.sqrt(i*i+s*s+u*u),g=Math.exp(d),v=f>0?g*Math.sin(f)/f:0;return r[0]=i*v,r[1]=s*v,r[2]=u*v,r[3]=g*Math.cos(f),r}function kP(r,t){var i=t[0],s=t[1],u=t[2],d=t[3],f=Math.sqrt(i*i+s*s+u*u),g=f>0?Math.atan2(f,d)/f:0;return r[0]=i*g,r[1]=s*g,r[2]=u*g,r[3]=.5*Math.log(i*i+s*s+u*u+d*d),r}function r0(r,t,i,s){var u,d,f,g,v,b=t[0],T=t[1],M=t[2],k=t[3],I=i[0],R=i[1],B=i[2],j=i[3];return(d=b*I+T*R+M*B+k*j)<0&&(d=-d,I=-I,R=-R,B=-B,j=-j),1-d>mh.EPSILON?(u=Math.acos(d),f=Math.sin(u),g=Math.sin((1-s)*u)/f,v=Math.sin(s*u)/f):(g=1-s,v=s),r[0]=g*b+v*I,r[1]=g*T+v*R,r[2]=g*M+v*B,r[3]=g*k+v*j,r}function PP(r,t){var i,s=t[0]+t[4]+t[8];if(s>0)i=Math.sqrt(s+1),r[3]=.5*i,r[0]=(t[5]-t[7])*(i=.5/i),r[1]=(t[6]-t[2])*i,r[2]=(t[1]-t[3])*i;else{var u=0;t[4]>t[0]&&(u=1),t[8]>t[3*u+u]&&(u=2);var d=(u+1)%3,f=(u+2)%3;i=Math.sqrt(t[3*u+u]-t[3*d+d]-t[3*f+f]+1),r[u]=.5*i,r[3]=(t[3*d+f]-t[3*f+d])*(i=.5/i),r[d]=(t[3*d+u]+t[3*u+d])*i,r[f]=(t[3*f+u]+t[3*u+f])*i}return r}er.clone=xs.clone,er.fromValues=xs.fromValues,er.copy=xs.copy,er.set=xs.set,er.add=xs.add,er.mul=MP;var IP=xs.scale;er.scale=IP;var zP=xs.dot;er.dot=zP,er.lerp=xs.lerp;var RP=xs.length;er.length=RP,er.len=RP;var DP=xs.squaredLength;er.squaredLength=DP,er.sqrLen=DP;var vw=xs.normalize;er.normalize=vw,er.exactEquals=xs.exactEquals,er.equals=xs.equals;var xa,LP,OP,H8=(xa=ec.create(),LP=ec.fromValues(1,0,0),OP=ec.fromValues(0,1,0),function(r,t,i){var s=ec.dot(t,i);return s<-.999999?(ec.cross(xa,LP,t),ec.len(xa)<1e-6&&ec.cross(xa,OP,t),ec.normalize(xa,xa),CP(r,xa,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(ec.cross(xa,t,i),r[0]=xa[0],r[1]=xa[1],r[2]=xa[2],r[3]=1+s,vw(r,r))});er.rotationTo=H8;var xw,bw,Z8=(xw=yw(),bw=yw(),function(r,t,i,s,u,d){return r0(xw,t,u,d),r0(bw,i,s,d),r0(r,xw,bw,2*d*(1-d)),r});er.sqlerp=Z8;var ba,X8=(ba=q8.create(),function(r,t,i,s){return ba[0]=i[0],ba[3]=i[1],ba[6]=i[2],ba[1]=s[0],ba[4]=s[1],ba[7]=s[2],ba[2]=-t[0],ba[5]=-t[1],ba[8]=-t[2],vw(r,PP(r,ba))});er.setAxes=X8;var yr={};function ww(r){return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(r)}Object.defineProperty(yr,"__esModule",{value:!0}),yr.create=function(){var r=new Ro.ARRAY_TYPE(8);return Ro.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r},yr.clone=function(r){var t=new Ro.ARRAY_TYPE(8);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t},yr.fromValues=function(r,t,i,s,u,d,f,g){var v=new Ro.ARRAY_TYPE(8);return v[0]=r,v[1]=t,v[2]=i,v[3]=s,v[4]=u,v[5]=d,v[6]=f,v[7]=g,v},yr.fromRotationTranslationValues=function(r,t,i,s,u,d,f){var g=new Ro.ARRAY_TYPE(8);g[0]=r,g[1]=t,g[2]=i,g[3]=s;var v=.5*u,b=.5*d,T=.5*f;return g[4]=v*s+b*i-T*t,g[5]=b*s+T*r-v*i,g[6]=T*s+v*t-b*r,g[7]=-v*r-b*t-T*i,g},yr.fromRotationTranslation=NP,yr.fromTranslation=function(r,t){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=.5*t[0],r[5]=.5*t[1],r[6]=.5*t[2],r[7]=0,r},yr.fromRotation=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},yr.fromMat4=function(r,t){var i=tc.create();BP.getRotation(i,t);var s=new Ro.ARRAY_TYPE(3);return BP.getTranslation(s,t),NP(r,i,s),r},yr.copy=jP,yr.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},yr.set=function(r,t,i,s,u,d,f,g,v){return r[0]=t,r[1]=i,r[2]=s,r[3]=u,r[4]=d,r[5]=f,r[6]=g,r[7]=v,r},yr.getDual=function(r,t){return r[0]=t[4],r[1]=t[5],r[2]=t[6],r[3]=t[7],r},yr.setDual=function(r,t){return r[4]=t[0],r[5]=t[1],r[6]=t[2],r[7]=t[3],r},yr.getTranslation=function(r,t){var i=t[4],s=t[5],u=t[6],d=t[7],f=-t[0],g=-t[1],v=-t[2],b=t[3];return r[0]=2*(i*b+d*f+s*v-u*g),r[1]=2*(s*b+d*g+u*f-i*v),r[2]=2*(u*b+d*v+i*g-s*f),r},yr.translate=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=.5*i[0],v=.5*i[1],b=.5*i[2],T=t[4],M=t[5],k=t[6],I=t[7];return r[0]=s,r[1]=u,r[2]=d,r[3]=f,r[4]=f*g+u*b-d*v+T,r[5]=f*v+d*g-s*b+M,r[6]=f*b+s*v-u*g+k,r[7]=-s*g-u*v-d*b+I,r},yr.rotateX=function(r,t,i){var s=-t[0],u=-t[1],d=-t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=g*f+T*s+v*d-b*u,k=v*f+T*u+b*s-g*d,I=b*f+T*d+g*u-v*s,R=T*f-g*s-v*u-b*d;return tc.rotateX(r,t,i),r[4]=M*(f=r[3])+R*(s=r[0])+k*(d=r[2])-I*(u=r[1]),r[5]=k*f+R*u+I*s-M*d,r[6]=I*f+R*d+M*u-k*s,r[7]=R*f-M*s-k*u-I*d,r},yr.rotateY=function(r,t,i){var s=-t[0],u=-t[1],d=-t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=g*f+T*s+v*d-b*u,k=v*f+T*u+b*s-g*d,I=b*f+T*d+g*u-v*s,R=T*f-g*s-v*u-b*d;return tc.rotateY(r,t,i),r[4]=M*(f=r[3])+R*(s=r[0])+k*(d=r[2])-I*(u=r[1]),r[5]=k*f+R*u+I*s-M*d,r[6]=I*f+R*d+M*u-k*s,r[7]=R*f-M*s-k*u-I*d,r},yr.rotateZ=function(r,t,i){var s=-t[0],u=-t[1],d=-t[2],f=t[3],g=t[4],v=t[5],b=t[6],T=t[7],M=g*f+T*s+v*d-b*u,k=v*f+T*u+b*s-g*d,I=b*f+T*d+g*u-v*s,R=T*f-g*s-v*u-b*d;return tc.rotateZ(r,t,i),r[4]=M*(f=r[3])+R*(s=r[0])+k*(d=r[2])-I*(u=r[1]),r[5]=k*f+R*u+I*s-M*d,r[6]=I*f+R*d+M*u-k*s,r[7]=R*f-M*s-k*u-I*d,r},yr.rotateByQuatAppend=function(r,t,i){var s=i[0],u=i[1],d=i[2],f=i[3],g=t[0],v=t[1],b=t[2],T=t[3];return r[0]=g*f+T*s+v*d-b*u,r[1]=v*f+T*u+b*s-g*d,r[2]=b*f+T*d+g*u-v*s,r[3]=T*f-g*s-v*u-b*d,r[4]=(g=t[4])*f+(T=t[7])*s+(v=t[5])*d-(b=t[6])*u,r[5]=v*f+T*u+b*s-g*d,r[6]=b*f+T*d+g*u-v*s,r[7]=T*f-g*s-v*u-b*d,r},yr.rotateByQuatPrepend=function(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=i[0],v=i[1],b=i[2],T=i[3];return r[0]=s*T+f*g+u*b-d*v,r[1]=u*T+f*v+d*g-s*b,r[2]=d*T+f*b+s*v-u*g,r[3]=f*T-s*g-u*v-d*b,r[4]=s*(T=i[7])+f*(g=i[4])+u*(b=i[6])-d*(v=i[5]),r[5]=u*T+f*v+d*g-s*b,r[6]=d*T+f*b+s*v-u*g,r[7]=f*T-s*g-u*v-d*b,r},yr.rotateAroundAxis=function(r,t,i,s){if(Math.abs(s)<Ro.EPSILON)return jP(r,t);var u=Math.hypot(i[0],i[1],i[2]);s*=.5;var d=Math.sin(s),f=d*i[0]/u,g=d*i[1]/u,v=d*i[2]/u,b=Math.cos(s),T=t[0],M=t[1],k=t[2],I=t[3];r[0]=T*b+I*f+M*v-k*g,r[1]=M*b+I*g+k*f-T*v,r[2]=k*b+I*v+T*g-M*f,r[3]=I*b-T*f-M*g-k*v;var R=t[4],B=t[5],j=t[6],U=t[7];return r[4]=R*b+U*f+B*v-j*g,r[5]=B*b+U*g+j*f-R*v,r[6]=j*b+U*v+R*g-B*f,r[7]=U*b-R*f-B*g-j*v,r},yr.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r},yr.multiply=VP,yr.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r},yr.lerp=function(r,t,i,s){var u=1-s;return $P(t,i)<0&&(s=-s),r[0]=t[0]*u+i[0]*s,r[1]=t[1]*u+i[1]*s,r[2]=t[2]*u+i[2]*s,r[3]=t[3]*u+i[3]*s,r[4]=t[4]*u+i[4]*s,r[5]=t[5]*u+i[5]*s,r[6]=t[6]*u+i[6]*s,r[7]=t[7]*u+i[7]*s,r},yr.invert=function(r,t){var i=n0(t);return r[0]=-t[0]/i,r[1]=-t[1]/i,r[2]=-t[2]/i,r[3]=t[3]/i,r[4]=-t[4]/i,r[5]=-t[5]/i,r[6]=-t[6]/i,r[7]=t[7]/i,r},yr.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r[4]=-t[4],r[5]=-t[5],r[6]=-t[6],r[7]=t[7],r},yr.normalize=function(r,t){var i=n0(t);if(i>0){i=Math.sqrt(i);var s=t[0]/i,u=t[1]/i,d=t[2]/i,f=t[3]/i,g=t[4],v=t[5],b=t[6],T=t[7],M=s*g+u*v+d*b+f*T;r[0]=s,r[1]=u,r[2]=d,r[3]=f,r[4]=(g-s*M)/i,r[5]=(v-u*M)/i,r[6]=(b-d*M)/i,r[7]=(T-f*M)/i}return r},yr.str=function(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"},yr.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]},yr.equals=function(r,t){var i=r[0],s=r[1],u=r[2],d=r[3],f=r[4],g=r[5],v=r[6],b=r[7],T=t[0],M=t[1],k=t[2],I=t[3],R=t[4],B=t[5],j=t[6],U=t[7];return Math.abs(i-T)<=Ro.EPSILON*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-M)<=Ro.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-k)<=Ro.EPSILON*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(d-I)<=Ro.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-R)<=Ro.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(g-B)<=Ro.EPSILON*Math.max(1,Math.abs(g),Math.abs(B))&&Math.abs(v-j)<=Ro.EPSILON*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(b-U)<=Ro.EPSILON*Math.max(1,Math.abs(b),Math.abs(U))},yr.sqrLen=yr.squaredLength=yr.len=yr.length=yr.dot=yr.mul=yr.setReal=yr.getReal=void 0;var Ro=Sw(gi),tc=Sw(er),BP=Sw(ir);function FP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(FP=function(s){return s?i:t})(r)}function Sw(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||ww(r)!=="object"&&typeof r!="function")return{default:r};var i=FP(t);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}function NP(r,t,i){var s=.5*i[0],u=.5*i[1],d=.5*i[2],f=t[0],g=t[1],v=t[2],b=t[3];return r[0]=f,r[1]=g,r[2]=v,r[3]=b,r[4]=s*b+u*v-d*g,r[5]=u*b+d*f-s*v,r[6]=d*b+s*g-u*f,r[7]=-s*f-u*g-d*v,r}function jP(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r}function VP(r,t,i){var s=t[0],u=t[1],d=t[2],f=t[3],g=i[4],v=i[5],b=i[6],T=i[7],M=t[4],k=t[5],I=t[6],R=t[7],B=i[0],j=i[1],U=i[2],J=i[3];return r[0]=s*J+f*B+u*U-d*j,r[1]=u*J+f*j+d*B-s*U,r[2]=d*J+f*U+s*j-u*B,r[3]=f*J-s*B-u*j-d*U,r[4]=s*T+f*g+u*b-d*v+M*J+R*B+k*U-I*j,r[5]=u*T+f*v+d*g-s*b+k*J+R*j+I*B-M*U,r[6]=d*T+f*b+s*v-u*g+I*J+R*U+M*j-k*B,r[7]=f*T-s*g-u*v-d*b+R*J-M*B-k*j-I*U,r}yr.getReal=tc.copy,yr.setReal=tc.copy,yr.mul=VP;var $P=tc.dot;yr.dot=$P;var UP=tc.length;yr.length=UP,yr.len=UP;var n0=tc.squaredLength;yr.squaredLength=n0,yr.sqrLen=n0;var lr={};function Tw(r){return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(r)}Object.defineProperty(lr,"__esModule",{value:!0}),lr.create=WP,lr.clone=function(r){var t=new gh.ARRAY_TYPE(2);return t[0]=r[0],t[1]=r[1],t},lr.fromValues=function(r,t){var i=new gh.ARRAY_TYPE(2);return i[0]=r,i[1]=t,i},lr.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r},lr.set=function(r,t,i){return r[0]=t,r[1]=i,r},lr.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r},lr.subtract=qP,lr.multiply=HP,lr.divide=ZP,lr.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r},lr.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r},lr.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r},lr.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r},lr.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r},lr.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r},lr.scaleAndAdd=function(r,t,i,s){return r[0]=t[0]+i[0]*s,r[1]=t[1]+i[1]*s,r},lr.distance=XP,lr.squaredDistance=YP,lr.length=KP,lr.squaredLength=JP,lr.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r},lr.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r},lr.normalize=function(r,t){var i=t[0],s=t[1],u=i*i+s*s;return u>0&&(u=1/Math.sqrt(u)),r[0]=t[0]*u,r[1]=t[1]*u,r},lr.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]},lr.cross=function(r,t,i){var s=t[0]*i[1]-t[1]*i[0];return r[0]=r[1]=0,r[2]=s,r},lr.lerp=function(r,t,i,s){var u=t[0],d=t[1];return r[0]=u+s*(i[0]-u),r[1]=d+s*(i[1]-d),r},lr.random=function(r,t){t=t||1;var i=2*gh.RANDOM()*Math.PI;return r[0]=Math.cos(i)*t,r[1]=Math.sin(i)*t,r},lr.transformMat2=function(r,t,i){var s=t[0],u=t[1];return r[0]=i[0]*s+i[2]*u,r[1]=i[1]*s+i[3]*u,r},lr.transformMat2d=function(r,t,i){var s=t[0],u=t[1];return r[0]=i[0]*s+i[2]*u+i[4],r[1]=i[1]*s+i[3]*u+i[5],r},lr.transformMat3=function(r,t,i){var s=t[0],u=t[1];return r[0]=i[0]*s+i[3]*u+i[6],r[1]=i[1]*s+i[4]*u+i[7],r},lr.transformMat4=function(r,t,i){var s=t[0],u=t[1];return r[0]=i[0]*s+i[4]*u+i[12],r[1]=i[1]*s+i[5]*u+i[13],r},lr.rotate=function(r,t,i,s){var u=t[0]-i[0],d=t[1]-i[1],f=Math.sin(s),g=Math.cos(s);return r[0]=u*g-d*f+i[0],r[1]=u*f+d*g+i[1],r},lr.angle=function(r,t){var i=r[0],s=r[1],u=t[0],d=t[1],f=Math.sqrt(i*i+s*s)*Math.sqrt(u*u+d*d);return Math.acos(Math.min(Math.max(f&&(i*u+s*d)/f,-1),1))},lr.zero=function(r){return r[0]=0,r[1]=0,r},lr.str=function(r){return"vec2("+r[0]+", "+r[1]+")"},lr.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]},lr.equals=function(r,t){var i=r[0],s=r[1],u=t[0],d=t[1];return Math.abs(i-u)<=gh.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-d)<=gh.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},lr.forEach=lr.sqrLen=lr.sqrDist=lr.dist=lr.div=lr.mul=lr.sub=lr.len=void 0;var gh=function(r,t){if(r&&r.__esModule)return r;if(r===null||Tw(r)!=="object"&&typeof r!="function")return{default:r};var i=GP(void 0);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}(gi);function GP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(GP=function(s){return s?i:t})(r)}function WP(){var r=new gh.ARRAY_TYPE(2);return gh.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function qP(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r}function HP(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r}function ZP(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r}function XP(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1])}function YP(r,t){var i=t[0]-r[0],s=t[1]-r[1];return i*i+s*s}function KP(r){return Math.hypot(r[0],r[1])}function JP(r){var t=r[0],i=r[1];return t*t+i*i}lr.len=KP,lr.sub=qP,lr.mul=HP,lr.div=ZP,lr.dist=XP,lr.sqrDist=YP,lr.sqrLen=JP;var Y8=function(){var r=WP();return function(t,i,s,u,d,f){var g,v;for(i||(i=2),s||(s=0),v=u?Math.min(u*i+s,t.length):t.length,g=s;g<v;g+=i)r[0]=t[g],r[1]=t[g+1],d(r,r,f),t[g]=r[0],t[g+1]=r[1];return t}}();function Ew(r){return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(r)}lr.forEach=Y8,Object.defineProperty(mi,"__esModule",{value:!0}),a.e=mi.vec4=a.v=mi.vec3=mi.vec2=mi.quat2=a.q=mi.quat=a.m=mi.mat4=a.bx=mi.mat3=mi.mat2d=a.h=mi.mat2=mi.glMatrix=void 0;var K8=al(gi);mi.glMatrix=K8;var J8=al(Sn);a.h=mi.mat2=J8;var Q8=al(En);mi.mat2d=Q8;var eV=al(Xr);a.bx=mi.mat3=eV;var tV=al(ir);a.m=mi.mat4=tV;var rV=al(er);a.q=mi.quat=rV;var nV=al(yr);mi.quat2=nV;var iV=al(lr);mi.vec2=iV;var oV=al(nr);a.v=mi.vec3=oV;var sV=al(hr);function QP(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(QP=function(s){return s?i:t})(r)}function al(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||Ew(r)!=="object"&&typeof r!="function")return{default:r};var i=QP(t);if(i&&i.has(r))return i.get(r);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in r)if(d!=="default"&&Object.prototype.hasOwnProperty.call(r,d)){var f=u?Object.getOwnPropertyDescriptor(r,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=r[d]}return s.default=r,i&&i.set(r,s),s}a.e=mi.vec4=sV;const aV=Dt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:i0}=aV,eI=Dt([{name:"a_pos_3",components:3,type:"Int16"}]);var km=Dt([{name:"a_pos",type:"Int16",components:2}]),tI={};(function(r,t){(function(i){function s(d,f,g){var v=u(256*d,256*(f=Math.pow(2,g)-f-1),g),b=u(256*(d+1),256*(f+1),g);return v[0]+","+v[1]+","+b[0]+","+b[1]}function u(d,f,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[d*v-2*Math.PI*6378137/2,f*v-2*Math.PI*6378137/2]}i.getURL=function(d,f,g,v,b,T){return T=T||{},d+"?"+["bbox="+s(g,v,b),"format="+(T.format||"image/png"),"service="+(T.service||"WMS"),"version="+(T.version||"1.1.1"),"request="+(T.request||"GetMap"),"srs="+(T.srs||"EPSG:3857"),"width="+(T.width||256),"height="+(T.height||256),"layers="+f].join("&")},i.getTileBBox=s,i.getMercCoords=u,Object.defineProperty(i,"__esModule",{value:!0})})(t)})(0,tI);var lV=tI;class _h{constructor(t,i,s){this.z=t,this.x=i,this.y=s,this.key=Pm(0,t,t,i,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const s=lV.getTileBBox(this.x,this.y,this.z),u=function(d,f,g){let v,b="";for(let T=d;T>0;T--)v=1<<T-1,b+=(f&v?1:0)+(g&v?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class rI{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Pm(t,i.z,i.z,i.x,i.y)}}class Mi{constructor(t,i,s,u,d){this.overscaledZ=t,this.wrap=i,this.canonical=new _h(s,+u,+d),this.key=i===0&&t===s?this.canonical.key:Pm(i,t,s,u,d)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Mi(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Mi(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return Pm(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-t;return Pm(this.wrap*+i,t,t,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Mi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new Mi(i,this.wrap,i,s,u),new Mi(i,this.wrap,i,s+1,u),new Mi(i,this.wrap,i,s,u+1),new Mi(i,this.wrap,i,s+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Mi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Mi(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new rI(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pm(r,t,i,s,u){const d=1<<Math.min(i,22);let f=d*(u%d)+s%d;return r&&i<22&&(f+=d*d*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*f+i)+(t-i)}const cV=[r=>{let t=r.canonical.x-1,i=r.wrap;return t<0&&(t=(1<<r.canonical.z)-1,i--),new Mi(r.overscaledZ,i,r.canonical.z,t,r.canonical.y)},r=>{let t=r.canonical.x+1,i=r.wrap;return t===1<<r.canonical.z&&(t=0,i++),new Mi(r.overscaledZ,i,r.canonical.z,t,r.canonical.y)},r=>new Mi(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,(r.canonical.y===0?1<<r.canonical.z:r.canonical.y)-1),r=>new Mi(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y===(1<<r.canonical.z)-1?0:r.canonical.y+1)];Ct(_h,"CanonicalTileID"),Ct(Mi,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class Cw{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,s){const u=a.v.dot(i,this.dir);if(Math.abs(u)<1e-6)return!1;const d=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/u;return s[0]=this.pos[0]+this.dir[0]*d,s[1]=this.pos[1]+this.dir[1]*d,s[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(t,i,s){if(a.v.equals(this.pos,t)||i===0)return s[0]=s[1]=s[2]=0,!1;const[u,d,f]=this.dir,g=this.pos[0]-t[0],v=this.pos[1]-t[1],b=this.pos[2]-t[2],T=u*u+d*d+f*f,M=2*(g*u+v*d+b*f),k=M*M-4*T*(g*g+v*v+b*b-i*i);if(k<0){const I=Math.max(-M/2,0),R=g+u*I,B=v+d*I,j=b+f*I,U=Math.hypot(R,B,j);return s[0]=R*i/U,s[1]=B*i/U,s[2]=j*i/U,!1}{const I=(-M-Math.sqrt(k))/(2*T);if(I<0){const R=Math.hypot(g,v,b);return s[0]=g*i/R,s[1]=v*i/R,s[2]=b*i/R,!1}return s[0]=g+u*I,s[1]=v+d*I,s[2]=b+f*I,!0}}}class Mw{constructor(t,i,s,u,d){this.TL=t,this.TR=i,this.BR=s,this.BL=u,this.horizon=d}static fromInvProjectionMatrix(t,i,s){const u=[-1,1,1],d=[1,1,1],f=[1,-1,1],g=[-1,-1,1],v=a.v.transformMat4(u,u,t),b=a.v.transformMat4(d,d,t),T=a.v.transformMat4(f,f,t),M=a.v.transformMat4(g,g,t);return new Mw(v,b,T,M,i/s)}}function Im(r,t,i){let s=1/0,u=-1/0;const d=[];for(const f of r){a.v.sub(d,f,t);const g=a.v.dot(d,i);s=Math.min(s,g),u=Math.max(u,g)}return[s,u]}function nI(r,t){let i=!0;for(let s=0;s<r.planes.length;s++){const u=r.planes[s];let d=0;for(let f=0;f<t.length;f++)d+=a.v.dot(u,t[f])+u[3]>=0;if(d===0)return 0;d!==t.length&&(i=!1)}return i?2:1}function iI(r,t){for(const i of r.projections){const s=Im(t,r.points[0],i.axis);if(i.projection[1]<s[0]||i.projection[0]>s[1])return 0}return 1}function oI(r,t){let i=0;const s=[0,0,0,0];for(let u=0;u<r.length;u++)s[0]=r[u][0],s[1]=r[u][1],s[2]=r[u][2],s[3]=1,a.e.dot(s,t)>=0&&i++;return i}class Aw{constructor(t,i){this.points=t||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=Gn.fromPoints(this.points),this.projections=[],this.frustumEdges=[a.v.sub([],this.points[2],this.points[3]),a.v.sub([],this.points[0],this.points[3]),a.v.sub([],this.points[4],this.points[0]),a.v.sub([],this.points[5],this.points[1]),a.v.sub([],this.points[6],this.points[2]),a.v.sub([],this.points[7],this.points[3])];for(const s of this.frustumEdges){const u=[0,-s[2],s[1]],d=[s[2],0,-s[0]];this.projections.push({axis:u,projection:Im(this.points,this.points[0],u)}),this.projections.push({axis:d,projection:Im(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(t,i,s,u){const d=Math.pow(2,s),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const T=a.e.transformMat4([],b,t),M=1/T[3]/i*d;return a.e.mul(T,T,[M,M,u?1/T[3]:M,M])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const T=a.v.sub([],f[b[0]],f[b[1]]),M=a.v.sub([],f[b[2]],f[b[1]]),k=a.v.normalize([],a.v.cross([],T,M)),I=-a.v.dot(k,f[b[1]]);return k.concat(I)}),v=[];for(let b=0;b<f.length;b++)v.push([f[b][0],f[b][1],f[b][2]]);return new Aw(v,g)}intersectsPrecise(t,i,s){for(let u=0;u<i.length;u++)if(!oI(t,i[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!oI(t,this.planes[u]))return 0;for(const u of s)for(const d of this.frustumEdges){const f=a.v.cross([],u,d),g=a.v.length(f);if(g===0)continue;a.v.scale(f,f,1/g);const v=Im(this.points,this.points[0],f),b=Im(t,this.points[0],f);if(v[0]>b[1]||b[0]>v[1])return 0}return 1}}class Gn{static fromPoints(t){const i=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of t)a.v.min(i,i,u),a.v.max(s,s,u);return new Gn(i,s)}static fromTileIdAndHeight(t,i,s){const u=1<<t.canonical.z,d=t.canonical.x,f=t.canonical.y;return new Gn([d/u,f/u,i],[(d+1)/u,(f+1)/u,s])}static applyTransform(t,i){const s=t.getCorners();for(let u=0;u<s.length;++u)a.v.transformMat4(s[u],s[u],i);return Gn.fromPoints(s)}static projectAabbCorners(t,i){const s=t.getCorners();for(let u=0;u<s.length;++u)a.v.transformMat4(s[u],s[u],i);return s}constructor(t,i){this.min=t,this.max=i,this.center=a.v.scale([],a.v.add([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],s=a.v.clone(this.min),u=a.v.clone(this.max);for(let d=0;d<i.length;d++)s[d]=i[d]?this.min[d]:this.center[d],u[d]=i[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new Gn(s,u)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?nI(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?nI(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,i){return i||this.intersects(t)?iI(t,this.getCorners()):0}intersectsPreciseFlat(t,i){return i||this.intersectsFlat(t)?iI(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let i=0;i<3;++i)if(this.min[i]>t.max[i]||t.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t.min[i]),this.max[i]=Math.max(this.max[i],t.max[i])}encapsulatePoint(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t[i]),this.max[i]=Math.max(this.max[i],t[i])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Ct(Gn,"Aabb");const kw=5,sI=6,bs=_t/Math.PI/2,uV=16383,Jd=64,Pw=[Jd,32,16],Ws=-bs,qs=bs,hV=[new Gn([Ws,Ws,Ws],[qs,qs,qs]),new Gn([Ws,Ws,Ws],[0,0,qs]),new Gn([0,Ws,Ws],[qs,0,qs]),new Gn([Ws,0,Ws],[0,qs,qs]),new Gn([0,0,Ws],[qs,qs,qs])];function o0(r){return r*bs/Dm}function aI(r,t,i,s=!0){const u=a.v.scale([],r._camera.position,r.worldSize),d=[t,i,1,1];a.e.transformMat4(d,d,r.pixelMatrixInverse),a.e.scale(d,d,1/d[3]);const f=a.v.sub([],d,u),g=a.v.normalize([],f),v=r.globeMatrix,b=[v[12],v[13],v[14]],T=a.v.sub([],b,u),M=a.v.length(T),k=a.v.normalize([],T),I=r.worldSize/(2*Math.PI),R=a.v.dot(k,g),B=Math.asin(I/M);if(B<Math.acos(R)){if(!s)return null;const Ie=[],He=[];a.v.scale(Ie,g,M/R),a.v.normalize(He,a.v.sub(He,Ie,T)),a.v.normalize(g,a.v.add(g,T,a.v.scale(g,He,Math.tan(B)*M)))}const j=[];new Cw(u,g).closestPointOnSphere(b,I,j);const U=a.v.normalize([],zt(v,0)),J=a.v.normalize([],zt(v,1)),ee=a.v.normalize([],zt(v,2)),oe=a.v.dot(U,j),ue=a.v.dot(J,j),fe=a.v.dot(ee,j),xe=ar(Math.asin(-ue/I));let Te=ar(Math.atan2(oe,fe));Te=r.center.lng+function(Ie,He){const lt=(He-Ie+180)%360-180;return lt<-180?lt+360:lt}(r.center.lng,Te);const Ae=cl(Te),Oe=ct(ul(xe),0,1);return new Gi(Ae,Oe)}class dV{constructor(t,i,s){this.a=a.v.sub([],t,s),this.b=a.v.sub([],i,s),this.center=s;const u=a.v.normalize([],this.a),d=a.v.normalize([],this.b);this.angle=Math.acos(a.v.dot(u,d))}}function Iw(r,t){if(r.angle===0)return null;let i;return i=r.a[t]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[t]/r.a[t]/Math.sin(r.angle)-1/Math.tan(r.angle)),i<0||i>1?null:function(s,u,d,f){const g=Math.sin(d);return s*(Math.sin((1-f)*d)/g)+u*(Math.sin(f*d)/g)}(r.a[t],r.b[t],r.angle,ct(i,0,1))+r.center[t]}function ll(r){if(r.z<=1)return hV[r.z+2*r.y+r.x];const t=zw(s0(r));return Gn.fromPoints(t)}function rc(r,t,i){return a.v.scale(r,r,1-i),a.v.scaleAndAdd(r,r,t,i)}function lI(r,t){const i=nc(t.zoom);if(i===0)return ll(r);const s=s0(r),u=zw(s),d=cl(s.getWest())*t.worldSize,f=cl(s.getEast())*t.worldSize,g=ul(s.getNorth())*t.worldSize,v=ul(s.getSouth())*t.worldSize,b=[d,g,0],T=[f,g,0],M=[d,v,0],k=[f,v,0],I=a.m.invert([],t.globeMatrix);return a.v.transformMat4(b,b,I),a.v.transformMat4(T,T,I),a.v.transformMat4(M,M,I),a.v.transformMat4(k,k,I),u[0]=rc(u[0],M,i),u[1]=rc(u[1],k,i),u[2]=rc(u[2],T,i),u[3]=rc(u[3],b,i),Gn.fromPoints(u)}function cI(r,t,i){for(const s of r)a.v.transformMat4(s,s,t),a.v.scale(s,s,i)}function uI(r,t,i,s){const u=t/r.worldSize,d=r.globeMatrix;if(i.z<=1){const Ae=ll(i).getCorners();return cI(Ae,d,u),Gn.fromPoints(Ae)}const f=s0(i,s),g=zw(f);cI(g,d,u);const v=Number.MAX_VALUE,b=[-v,-v,-v],T=[v,v,v];if(f.contains(r.center)){for(const Ie of g)a.v.min(T,T,Ie),a.v.max(b,b,Ie);b[2]=0;const Ae=r.point,Oe=[Ae.x*u,Ae.y*u,0];return a.v.min(T,T,Oe),a.v.max(b,b,Oe),new Gn(T,b)}const M=[d[12]*u,d[13]*u,d[14]*u],k=f.getCenter(),I=ct(r.center.lat,-Nn,Nn),R=ct(k.lat,-Nn,Nn),B=cl(r.center.lng),j=ul(I);let U=B-cl(k.lng);const J=j-ul(R);U>.5?U-=1:U<-.5&&(U+=1);let ee=0;if(Math.abs(U)>Math.abs(J))ee=U>=0?1:3;else{ee=J>=0?0:2;const Ae=[d[4]*u,d[5]*u,d[6]*u],Oe=-Math.sin(st(J>=0?f.getSouth():f.getNorth()))*bs;a.v.scaleAndAdd(M,M,Ae,Oe)}const oe=g[ee],ue=g[(ee+1)%4],fe=new dV(oe,ue,M),xe=[Iw(fe,0)||oe[0],Iw(fe,1)||oe[1],Iw(fe,2)||oe[2]],Te=nc(r.zoom);if(Te>0){const Ae=function({x:Ie,y:He,z:lt},Ge,et,Ue,vt){const Tt=1/(1<<lt);let ot=Ie*Tt,Ut=ot+Tt,At=He*Tt,yt=At+Tt,Gt=0;const Lt=(ot+Ut)/2-Ue;return Lt>.5?Gt=-1:Lt<-.5&&(Gt=1),ot=((ot+Gt)*Ge-(Ue*=Ge))*et+Ue,Ut=((Ut+Gt)*Ge-Ue)*et+Ue,At=(At*Ge-(vt*=Ge))*et+vt,yt=(yt*Ge-vt)*et+vt,[[ot,yt,0],[Ut,yt,0],[Ut,At,0],[ot,At,0]]}(i,t,r._pixelsPerMercatorPixel,B,j);for(let Ie=0;Ie<g.length;Ie++)rc(g[Ie],Ae[Ie],Te);const Oe=a.v.add([],Ae[ee],Ae[(ee+1)%4]);a.v.scale(Oe,Oe,.5),rc(xe,Oe,Te)}for(const Ae of g)a.v.min(T,T,Ae),a.v.max(b,b,Ae);return T[2]=Math.min(oe[2],ue[2]),a.v.min(T,T,xe),a.v.max(b,b,xe),new Gn(T,b)}function s0({x:r,y:t,z:i},s=!1){const u=1/(1<<i),d=new jr(Xo(r*u),t===(1<<i)-1&&s?-90:Fi((t+1)*u)),f=new jr(Xo((r+1)*u),t===0&&s?90:Fi(t*u));return new Yc(d,f)}function zw(r){const t=st(r.getNorth()),i=st(r.getSouth()),s=Math.cos(t),u=Math.cos(i),d=Math.sin(t),f=Math.sin(i),g=r.getWest(),v=r.getEast();return[Qd(u,f,g),Qd(u,f,v),Qd(s,d,v),Qd(s,d,g)]}function Qd(r,t,i,s=bs){return i=st(i),[r*Math.sin(i)*s,-t*s,r*Math.cos(i)*s]}function yh(r,t,i){return Qd(Math.cos(st(r)),Math.sin(st(r)),t,i)}function zm(r,t,i,s){const u=1<<i.z,d=(r/_t+i.x)/u;return yh(Fi((t/_t+i.y)/u),Xo(d),s)}function a0({min:r,max:t}){return uV/Math.max(t[0]-r[0],t[1]-r[1],t[2]-r[2])}const hI=new Float64Array(16);function Rm(r){const t=a0(r),i=a.m.fromScaling(hI,[t,t,t]);return a.m.translate(i,i,a.v.negate([],r.min))}function Rw(r){const t=a.m.fromTranslation(hI,r.min),i=1/a0(r);return a.m.scale(t,t,[i,i,i])}function Dw(r){const t=_t/(2*Math.PI);return r/(2*Math.PI)/t}function dI(r,t){return _t/(512*Math.pow(2,r))*a0(ll(t))}function fI(r,t,i,s,u){const d=Dw(i),f=[r,t,-i/(2*Math.PI)],g=a.m.identity(new Float64Array(16));return a.m.translate(g,g,f),a.m.scale(g,g,[d,d,d]),a.m.rotateX(g,g,st(-u)),a.m.rotateY(g,g,st(-s)),g}function nc(r){return Jt(kw,sI,r)}function pI(r,t){const i=yh(t.lat,t.lng),s=function(d){const f=yh(d._center.lat,d._center.lng),g=a.v.fromValues(0,1,0);let v=a.v.cross([],g,f);const b=a.m.fromRotation([],-d.angle,f);v=a.v.transformMat4(v,v,b),a.m.fromRotation(b,-d._pitch,v);const T=a.v.normalize([],f);return a.v.scale(T,T,o0(d.cameraToCenterDistance/d.pixelsPerMeter)),a.v.transformMat4(T,T,b),a.v.add([],f,T)}(r),u=a.v.subtract([],s,i);return a.v.angle(u,i)}function Lw(r,t){return pI(r,t)>Math.PI/2*1.01}const mI=st(85),fV=Math.cos(mI),pV=Math.sin(mI),Dm=63710088e-1,Ow=2*Math.PI*Dm;class Jc{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Jc(qt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,s=this.lat*i,u=t.lat*i,d=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((t.lng-this.lng)*i);return Dm*Math.acos(Math.min(d,1))}toBounds(t=0){const i=360*t/40075017,s=i/Math.cos(Math.PI/180*this.lat);return new Yc(new Jc(this.lng-s,this.lat-i),new Jc(this.lng+s,this.lat+i))}toEcef(t){const i=o0(t);return yh(this.lat,this.lng,bs+i)}static convert(t){if(t instanceof Jc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Jc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Jc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var jr=Jc;const mV=0,gV=25.5;function Bw(r){return Ow*Math.cos(r*Math.PI/180)}function cl(r){return(180+r)/360}function ul(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function bo(r,t){return r/Bw(t)}function Xo(r){return 360*r-180}function Fi(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function gI(r,t){return r*Bw(Fi(t))}const Nn=85.051129;function _I(r){return Math.cos(st(ct(r,-Nn,Nn)))}function vh(r,t){const i=ct(t,mV,gV),s=Math.pow(2,i);return _I(r)*Ow/(512*s)}function yI(r){return 1/Math.cos(r*Math.PI/180)}function l0(r,t=0){const i=Math.exp(Math.PI*(1-(r.y+t/_t)/(1<<r.z)*2));return 80150034*i/(i*i+1)/_t/(1<<r.z)}class Gi{constructor(t,i,s=0){this.x=+t,this.y=+i,this.z=+s}static fromLngLat(t,i=0){const s=jr.convert(t);return new Gi(cl(s.lng),ul(s.lat),bo(i,s.lat))}toLngLat(){return new jr(Xo(this.x),Fi(this.y))}toAltitude(){return gI(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ow*yI(Fi(this.y))}}function Fw(r,t,i,s,u,d,f,g,v){const b=(t+s)/2,T=(i+u)/2,M=new Pe(b,T);g(M),function(k,I,R,B,j,U){const J=R-j,ee=B-U;return Math.abs((B-I)*J-(R-k)*ee)/Math.hypot(J,ee)}(M.x,M.y,d.x,d.y,f.x,f.y)>=v?(Fw(r,t,i,b,T,d,M,g,v),Fw(r,b,T,s,u,M,f,g,v)):r.push(f)}function vI(r,t,i){let s=r[0],u=s.x,d=s.y;t(s);const f=[s];for(let g=1;g<r.length;g++){const v=r[g],{x:b,y:T}=v;t(v),Fw(f,u,d,b,T,s,v,t,i),u=b,d=T,s=v}return f}function Nw(r,t,i,s){if(s(t,i)){const u=t.add(i)._mult(.5);Nw(r,t,u,s),Nw(r,u,i,s)}else r.push(i)}function _V(r,t){let i=r[0];const s=[i];for(let u=1;u<r.length;u++){const d=r[u];Nw(s,i,d,t),i=d}return s}const jw=Math.pow(2,14)-1,xI=-jw-1;function yV(r,t){const i=Math.round(r.x*t),s=Math.round(r.y*t);return r.x=ct(i,xI,jw),r.y=ct(s,xI,jw),(i<r.x||i>r.x+1||s<r.y||s>r.y+1)&&kr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function hl(r,t,i){const s=r.loadGeometry(),u=r.extent,d=_t/u;if(t&&i&&i.projection.isReprojectedInTileSpace){const f=1<<t.z,{scale:g,x:v,y:b,projection:T}=i,M=k=>{const I=Xo((t.x+k.x/u)/f),R=Fi((t.y+k.y/u)/f),B=T.project(I,R);k.x=(B.x*g-v)*u,k.y=(B.y*g-b)*u};for(let k=0;k<s.length;k++)if(r.type!==1)s[k]=vI(s[k],M,1);else{const I=[];for(const R of s[k])R.x<0||R.x>=u||R.y<0||R.y>=u||(M(R),I.push(R));s[k]=I}}for(const f of s)for(const g of f)yV(g,d);return s}function Qc(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?hl(r):[]}}function c0(r,t,i,s,u){r.emplaceBack(2*t+(s+1)/2,2*i+(u+1)/2)}function u0(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Vw{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new tr,this.indexArray=new Zr,this.segments=new wn,this.programConfigurations=new Xc(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,s,u){const d=this.layers[0],f=[];let g=null;d.type==="circle"&&(g=d.layout.get("circle-sort-key"));for(const{feature:b,id:T,index:M,sourceLayerIndex:k}of t){const I=this.layers[0]._featureFilter.needGeometry,R=Qc(b,I);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),R,s))continue;const B=g?g.evaluate(R,{},s):void 0,j={id:T,properties:b.properties,type:b.type,sourceLayerIndex:k,index:M,geometry:I?R.geometry:hl(b,s,u),patterns:{},sortKey:B};f.push(j)}g&&f.sort((b,T)=>b.sortKey-T.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new un,v=u.projection);for(const b of f){const{geometry:T,index:M,sourceLayerIndex:k}=b,I=t[M].feature;this.addFeature(b,T,M,i.availableImages,s,v,i.brightness),i.featureIndex.insert(I,T,M,k,this.index)}}update(t,i,s,u,d){const f=Object.keys(t).length!==0;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,f?this.stateDependentLayers:this.layers,s,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,k8.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,P8.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,s,u,d,f,g){for(const v of i)for(const b of v){const T=b.x,M=b.y;if(T<0||T>=_t||M<0||M>=_t)continue;if(f){const R=f.projectTilePoint(T,M,d),B=f.upVector(d,T,M),j=this.globeExtVertexArray;u0(j,R,B),u0(j,R,B),u0(j,R,B),u0(j,R,B)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=k.vertexLength;c0(this.layoutVertexArray,T,M,-1,-1),c0(this.layoutVertexArray,T,M,1,-1),c0(this.layoutVertexArray,T,M,1,1),c0(this.layoutVertexArray,T,M,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},u,d,g)}}function bI(r,t){for(let i=0;i<r.length;i++)if(xh(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(xh(r,t[i]))return!0;return!!$w(r,t)}function vV(r,t,i){return!!xh(r,t)||!!Uw(t,r,i)}function wI(r,t){if(r.length===1)return TI(t,r[0]);for(let i=0;i<t.length;i++){const s=t[i];for(let u=0;u<s.length;u++)if(xh(r,s[u]))return!0}for(let i=0;i<r.length;i++)if(TI(t,r[i]))return!0;for(let i=0;i<t.length;i++)if($w(r,t[i]))return!0;return!1}function xV(r,t,i){if(r.length>1){if($w(r,t))return!0;for(let s=0;s<t.length;s++)if(Uw(t[s],r,i))return!0}for(let s=0;s<r.length;s++)if(Uw(r[s],t,i))return!0;return!1}function $w(r,t){if(r.length===0||t.length===0)return!1;for(let i=0;i<r.length-1;i++){const s=r[i],u=r[i+1];for(let d=0;d<t.length-1;d++)if(bV(s,u,t[d],t[d+1]))return!0}return!1}function bV(r,t,i,s){return tt(r,i,s)!==tt(t,i,s)&&tt(r,t,i)!==tt(r,t,s)}function Uw(r,t,i){const s=i*i;if(t.length===1)return r.distSqr(t[0])<s;for(let u=1;u<t.length;u++)if(SI(r,t[u-1],t[u])<s)return!0;return!1}function SI(r,t,i){const s=t.distSqr(i);if(s===0)return r.distSqr(t);const u=((r.x-t.x)*(i.x-t.x)+(r.y-t.y)*(i.y-t.y))/s;return r.distSqr(u<0?t:u>1?i:i.sub(t)._mult(u)._add(t))}function TI(r,t){let i,s,u,d=!1;for(let f=0;f<r.length;f++){i=r[f];for(let g=0,v=i.length-1;g<i.length;v=g++)s=i[g],u=i[v],s.y>t.y!=u.y>t.y&&t.x<(u.x-s.x)*(t.y-s.y)/(u.y-s.y)+s.x&&(d=!d)}return d}function xh(r,t){let i=!1;for(let s=0,u=r.length-1;s<r.length;u=s++){const d=r[s],f=r[u];d.y>t.y!=f.y>t.y&&t.x<(f.x-d.x)*(t.y-d.y)/(f.y-d.y)+d.x&&(i=!i)}return i}function EI(r,t,i,s,u){for(const f of r)if(t<=f.x&&i<=f.y&&s>=f.x&&u>=f.y)return!0;const d=[new Pe(t,i),new Pe(t,u),new Pe(s,u),new Pe(s,i)];if(r.length>2){for(const f of d)if(xh(r,f))return!0}for(let f=0;f<r.length-1;f++)if(wV(r[f],r[f+1],d))return!0;return!1}function wV(r,t,i){const s=i[0],u=i[2];if(r.x<s.x&&t.x<s.x||r.x>u.x&&t.x>u.x||r.y<s.y&&t.y<s.y||r.y>u.y&&t.y>u.y)return!1;const d=tt(r,t,i[0]);return d!==tt(r,t,i[1])||d!==tt(r,t,i[2])||d!==tt(r,t,i[3])}function ef(r,t,i,s,u,d){let f=t.y-r.y,g=r.x-t.x;if(d=d||0){const v=f*f+g*g;if(v===0)return!0;const b=Math.sqrt(v);f/=b,g/=b}return!((i.x-r.x)*f+(i.y-r.y)*g-d<0||(s.x-r.x)*f+(s.y-r.y)*g-d<0||(u.x-r.x)*f+(u.y-r.y)*g-d<0)}function Gw(r,t,i,s,u,d,f){return!(ef(r,t,s,u,d,f)||ef(t,i,s,u,d,f)||ef(i,r,s,u,d,f)||ef(s,u,r,t,i,f)||ef(u,d,r,t,i,f)||ef(d,s,r,t,i,f))}function tf(r,t,i){const s=t.paint.get(r).value;return s.kind==="constant"?s.value:i.programConfigurations.get(t.id).getMaxValue(r)}function h0(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function CI(r,t,i,s,u){if(!t[0]&&!t[1])return r;const d=Pe.convert(t)._mult(u);i==="viewport"&&d._rotate(-s);const f=[];for(let g=0;g<r.length;g++)f.push(r[g].sub(d));return f}function MI(r,t,i,s){const u=Pe.convert(r)._mult(s);return t==="viewport"&&u._rotate(-i),u}Ct(Vw,"CircleBucket",{omit:["layers"]});const SV=new Ke({"circle-sort-key":new ke(ze.layout_circle["circle-sort-key"]),visibility:new he(ze.layout_circle.visibility)});var TV={paint:new Ke({"circle-radius":new ke(ze.paint_circle["circle-radius"]),"circle-color":new ke(ze.paint_circle["circle-color"]),"circle-blur":new ke(ze.paint_circle["circle-blur"]),"circle-opacity":new ke(ze.paint_circle["circle-opacity"]),"circle-translate":new he(ze.paint_circle["circle-translate"]),"circle-translate-anchor":new he(ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new he(ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new he(ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ke(ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ke(ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ke(ze.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new he(ze.paint_circle["circle-emissive-strength"])}),layout:SV};const EV=a.m.create(),AI=r=>{const t=[];return r.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),r.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function kI(r,t,i,s,u,d,f,g,v){if(d&&r.queryGeometry.isAboveHorizon)return!1;d&&(v*=r.pixelToTileUnitsFactor);const b=r.tileID.canonical,T=i.projection.upVectorScale(b,i.center.lat,i.worldSize).metersToTile;for(const M of t)for(const k of M){const I=k.add(g),R=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(I.x,I.y,!0):0,B=i.projection.projectTilePoint(I.x,I.y,b);if(R>0){const ee=i.projection.upVector(b,I.x,I.y);B.x+=ee[0]*T*R,B.y+=ee[1]*T*R,B.z+=ee[2]*T*R}const j=d?I:CV(B.x,B.y,B.z,s),U=d?r.tilespaceRays.map(ee=>AV(ee,R)):r.queryGeometry.screenGeometry,J=a.e.transformMat4([],[B.x,B.y,B.z,1],s);if(!f&&d?v*=J[3]/i.cameraToCenterDistance:f&&!d&&(v*=i.cameraToCenterDistance/J[3]),d){const ee=Fi((k.y/_t+b.y)/(1<<b.z));v/=i.projection.pixelsPerMeter(ee,1)/bo(1,ee)}if(vV(U,j,v))return!0}return!1}function CV(r,t,i,s){const u=a.e.transformMat4([],[r,t,i,1],s);return new Pe(u[0]/u[3],u[1]/u[3])}const PI=a.v.fromValues(0,0,0),MV=a.v.fromValues(0,0,1);function AV(r,t){const i=a.v.create();return PI[2]=t,r.intersectsPlane(PI,MV,i),new Pe(i[0],i[1])}class II extends Vw{}function zI(r,{width:t,height:i},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*i*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(t*i*s);return r.width=t,r.height=i,r.data=u,r}function RI(r,t,i){const{width:s,height:u}=t;s===r.width&&u===r.height||(Ww(r,t,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,s),height:Math.min(r.height,u)},i),r.width=s,r.height=u,r.data=t.data)}function Ww(r,t,i,s,u,d,f){if(u.width===0||u.height===0)return t;if(u.width>r.width||u.height>r.height||i.x>r.width-u.width||i.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||s.x>t.width-u.width||s.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const g=r.data,v=t.data,b=d===4&&f;for(let T=0;T<u.height;T++){const M=((i.y+T)*r.width+i.x)*d,k=((s.y+T)*t.width+s.x)*d;if(b)for(let I=0;I<u.width;I++){const R=M+I*d+3,B=k+I*d;v[B+0]=255,v[B+1]=255,v[B+2]=255,v[B+3]=g[R]}else for(let I=0;I<u.width*d;I++)v[k+I]=g[M+I]}return t}Ct(II,"HeatmapBucket",{omit:["layers"]});class ic{constructor(t,i){zI(this,t,1,i)}resize(t){RI(this,new ic(t),1)}clone(){return new ic({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,s,u,d){Ww(t,i,s,u,d,1)}}class ws{constructor(t,i){zI(this,t,4,i)}resize(t){RI(this,new ws(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ws({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,s,u,d,f){Ww(t,i,s,u,d,4,f)}}class DI{constructor(t,i){this.width=t.width,this.height=t.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}Ct(ic,"AlphaImage"),Ct(ws,"RGBAImage");const kV=new Ke({visibility:new he(ze.layout_heatmap.visibility)});var PV={paint:new Ke({"heatmap-radius":new ke(ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ke(ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new he(ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nt(ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new he(ze.paint_heatmap["heatmap-opacity"])}),layout:kV};function d0(r){const t={},i=r.resolution||256,s=r.clips?r.clips.length:1,u=r.image||new ws({width:i,height:s}),d=(f,g,v)=>{t[r.evaluationKey]=v;const b=r.expression.evaluate(t);b&&(u.data[f+g+0]=Math.floor(255*b.r/b.a),u.data[f+g+1]=Math.floor(255*b.g/b.a),u.data[f+g+2]=Math.floor(255*b.b/b.a),u.data[f+g+3]=Math.floor(255*b.a))};if(r.clips)for(let f=0,g=0;f<s;++f,g+=4*i)for(let v=0,b=0;v<i;v++,b+=4){const T=v/(i-1),{start:M,end:k}=r.clips[f];d(g,b,M*(1-T)+k*T)}else for(let f=0,g=0;f<i;f++,g+=4)d(0,g,f/(i-1));return u}const IV=new Ke({visibility:new he(ze.layout_hillshade.visibility)});var zV={paint:new Ke({"hillshade-illumination-direction":new he(ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new he(ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new he(ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new he(ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new he(ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new he(ze.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new he(ze.paint_hillshade["hillshade-emissive-strength"])}),layout:IV};const RV=Dt([{name:"a_pos",components:2,type:"Int16"}],4),{members:DV}=RV;var qw={exports:{}};function f0(r,t,i){i=i||2;var s,u,d,f,g,v,b,T=t&&t.length,M=T?t[0]*i:r.length,k=LI(r,0,M,i,!0),I=[];if(!k||k.next===k.prev)return I;if(T&&(k=function(B,j,U,J){var ee,oe,ue,fe=[];for(ee=0,oe=j.length;ee<oe;ee++)(ue=LI(B,j[ee]*J,ee<oe-1?j[ee+1]*J:B.length,J,!1))===ue.next&&(ue.steiner=!0),fe.push($V(ue));for(fe.sort(NV),ee=0;ee<fe.length;ee++)U=jV(fe[ee],U);return U}(r,t,k,i)),r.length>80*i){s=d=r[0],u=f=r[1];for(var R=i;R<M;R+=i)(g=r[R])<s&&(s=g),(v=r[R+1])<u&&(u=v),g>d&&(d=g),v>f&&(f=v);b=(b=Math.max(d-s,f-u))!==0?32767/b:0}return Lm(k,I,i,s,u,b,0),I}function LI(r,t,i,s,u){var d,f;if(u===Xw(r,t,i,s)>0)for(d=t;d<i;d+=s)f=FI(d,r[d],r[d+1],f);else for(d=i-s;d>=t;d-=s)f=FI(d,r[d],r[d+1],f);return f&&p0(f,f.next)&&(Bm(f),f=f.next),f}function bh(r,t){if(!r)return r;t||(t=r);var i,s=r;do if(i=!1,s.steiner||!p0(s,s.next)&&ei(s.prev,s,s.next)!==0)s=s.next;else{if(Bm(s),(s=t=s.prev)===s.next)break;i=!0}while(i||s!==t);return t}function Lm(r,t,i,s,u,d,f){if(r){!f&&d&&function(T,M,k,I){var R=T;do R.z===0&&(R.z=Hw(R.x,R.y,M,k,I)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==T);R.prevZ.nextZ=null,R.prevZ=null,function(B){var j,U,J,ee,oe,ue,fe,xe,Te=1;do{for(U=B,B=null,oe=null,ue=0;U;){for(ue++,J=U,fe=0,j=0;j<Te&&(fe++,J=J.nextZ);j++);for(xe=Te;fe>0||xe>0&&J;)fe!==0&&(xe===0||!J||U.z<=J.z)?(ee=U,U=U.nextZ,fe--):(ee=J,J=J.nextZ,xe--),oe?oe.nextZ=ee:B=ee,ee.prevZ=oe,oe=ee;U=J}oe.nextZ=null,Te*=2}while(ue>1)}(R)}(r,s,u,d);for(var g,v,b=r;r.prev!==r.next;)if(g=r.prev,v=r.next,d?OV(r,s,u,d):LV(r))t.push(g.i/i|0),t.push(r.i/i|0),t.push(v.i/i|0),Bm(r),r=v.next,b=v.next;else if((r=v)===b){f?f===1?Lm(r=BV(bh(r),t,i),t,i,s,u,d,2):f===2&&FV(r,t,i,s,u,d):Lm(bh(r),t,i,s,u,d,1);break}}}function LV(r){var t=r.prev,i=r,s=r.next;if(ei(t,i,s)>=0)return!1;for(var u=t.x,d=i.x,f=s.x,g=t.y,v=i.y,b=s.y,T=u<d?u<f?u:f:d<f?d:f,M=g<v?g<b?g:b:v<b?v:b,k=u>d?u>f?u:f:d>f?d:f,I=g>v?g>b?g:b:v>b?v:b,R=s.next;R!==t;){if(R.x>=T&&R.x<=k&&R.y>=M&&R.y<=I&&rf(u,g,d,v,f,b,R.x,R.y)&&ei(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function OV(r,t,i,s){var u=r.prev,d=r,f=r.next;if(ei(u,d,f)>=0)return!1;for(var g=u.x,v=d.x,b=f.x,T=u.y,M=d.y,k=f.y,I=g<v?g<b?g:b:v<b?v:b,R=T<M?T<k?T:k:M<k?M:k,B=g>v?g>b?g:b:v>b?v:b,j=T>M?T>k?T:k:M>k?M:k,U=Hw(I,R,t,i,s),J=Hw(B,j,t,i,s),ee=r.prevZ,oe=r.nextZ;ee&&ee.z>=U&&oe&&oe.z<=J;){if(ee.x>=I&&ee.x<=B&&ee.y>=R&&ee.y<=j&&ee!==u&&ee!==f&&rf(g,T,v,M,b,k,ee.x,ee.y)&&ei(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=j&&oe!==u&&oe!==f&&rf(g,T,v,M,b,k,oe.x,oe.y)&&ei(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;ee&&ee.z>=U;){if(ee.x>=I&&ee.x<=B&&ee.y>=R&&ee.y<=j&&ee!==u&&ee!==f&&rf(g,T,v,M,b,k,ee.x,ee.y)&&ei(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;oe&&oe.z<=J;){if(oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=j&&oe!==u&&oe!==f&&rf(g,T,v,M,b,k,oe.x,oe.y)&&ei(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function BV(r,t,i){var s=r;do{var u=s.prev,d=s.next.next;!p0(u,d)&&OI(u,s,s.next,d)&&Om(u,d)&&Om(d,u)&&(t.push(u.i/i|0),t.push(s.i/i|0),t.push(d.i/i|0),Bm(s),Bm(s.next),s=r=d),s=s.next}while(s!==r);return bh(s)}function FV(r,t,i,s,u,d){var f=r;do{for(var g=f.next.next;g!==f.prev;){if(f.i!==g.i&&UV(f,g)){var v=BI(f,g);return f=bh(f,f.next),v=bh(v,v.next),Lm(f,t,i,s,u,d,0),void Lm(v,t,i,s,u,d,0)}g=g.next}f=f.next}while(f!==r)}function NV(r,t){return r.x-t.x}function jV(r,t){var i=function(u,d){var f,g=d,v=u.x,b=u.y,T=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var M=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(M<=v&&M>T&&(T=M,f=g.x<g.next.x?g:g.next,M===v))return f}g=g.next}while(g!==d);if(!f)return null;var k,I=f,R=f.x,B=f.y,j=1/0;g=f;do v>=g.x&&g.x>=R&&v!==g.x&&rf(b<B?v:T,b,R,B,b<B?T:v,b,g.x,g.y)&&(k=Math.abs(b-g.y)/(v-g.x),Om(g,u)&&(k<j||k===j&&(g.x>f.x||g.x===f.x&&VV(f,g)))&&(f=g,j=k)),g=g.next;while(g!==I);return f}(r,t);if(!i)return t;var s=BI(i,r);return bh(s,s.next),bh(i,i.next)}function VV(r,t){return ei(r.prev,r,t.prev)<0&&ei(t.next,r,r.next)<0}function Hw(r,t,i,s,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*u|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function $V(r){var t=r,i=r;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==r);return i}function rf(r,t,i,s,u,d,f,g){return(u-f)*(t-g)>=(r-f)*(d-g)&&(r-f)*(s-g)>=(i-f)*(t-g)&&(i-f)*(d-g)>=(u-f)*(s-g)}function UV(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(i,s){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==s.i&&u.next.i!==s.i&&OI(u,u.next,i,s))return!0;u=u.next}while(u!==i);return!1}(r,t)&&(Om(r,t)&&Om(t,r)&&function(i,s){var u=i,d=!1,f=(i.x+s.x)/2,g=(i.y+s.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&f<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==i);return d}(r,t)&&(ei(r.prev,r,t.prev)||ei(r,t.prev,t))||p0(r,t)&&ei(r.prev,r,r.next)>0&&ei(t.prev,t,t.next)>0)}function ei(r,t,i){return(t.y-r.y)*(i.x-t.x)-(t.x-r.x)*(i.y-t.y)}function p0(r,t){return r.x===t.x&&r.y===t.y}function OI(r,t,i,s){var u=g0(ei(r,t,i)),d=g0(ei(r,t,s)),f=g0(ei(i,s,r)),g=g0(ei(i,s,t));return u!==d&&f!==g||!(u!==0||!m0(r,i,t))||!(d!==0||!m0(r,s,t))||!(f!==0||!m0(i,r,s))||!(g!==0||!m0(i,t,s))}function m0(r,t,i){return t.x<=Math.max(r.x,i.x)&&t.x>=Math.min(r.x,i.x)&&t.y<=Math.max(r.y,i.y)&&t.y>=Math.min(r.y,i.y)}function g0(r){return r>0?1:r<0?-1:0}function Om(r,t){return ei(r.prev,r,r.next)<0?ei(r,t,r.next)>=0&&ei(r,r.prev,t)>=0:ei(r,t,r.prev)<0||ei(r,r.next,t)<0}function BI(r,t){var i=new Zw(r.i,r.x,r.y),s=new Zw(t.i,t.x,t.y),u=r.next,d=t.prev;return r.next=t,t.prev=r,i.next=u,u.prev=i,s.next=i,i.prev=s,d.next=s,s.prev=d,s}function FI(r,t,i,s){var u=new Zw(r,t,i);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function Bm(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Zw(r,t,i){this.i=r,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xw(r,t,i,s){for(var u=0,d=t,f=i-s;d<i;d+=s)u+=(r[f]-r[d])*(r[d+1]+r[f+1]),f=d;return u}qw.exports=f0,qw.exports.default=f0,f0.deviation=function(r,t,i,s){var u=t&&t.length,d=Math.abs(Xw(r,0,u?t[0]*i:r.length,i));if(u)for(var f=0,g=t.length;f<g;f++)d-=Math.abs(Xw(r,t[f]*i,f<g-1?t[f+1]*i:r.length,i));var v=0;for(f=0;f<s.length;f+=3){var b=s[f]*i,T=s[f+1]*i,M=s[f+2]*i;v+=Math.abs((r[b]-r[M])*(r[T+1]-r[b+1])-(r[b]-r[T])*(r[M+1]-r[b+1]))}return d===0&&v===0?0:Math.abs((v-d)/d)},f0.flatten=function(r){for(var t=r[0][0].length,i={vertices:[],holes:[],dimensions:t},s=0,u=0;u<r.length;u++){for(var d=0;d<r[u].length;d++)for(var f=0;f<t;f++)i.vertices.push(r[u][d][f]);u>0&&i.holes.push(s+=r[u-1].length)}return i};var _0=be(qw.exports);function Yw(r,t){const i=r.length;if(i<=1)return[r];const s=[];let u,d;for(let f=0;f<i;f++){const g=de(r[f]);g!==0&&(r[f].area=Math.abs(g),d===void 0&&(d=g<0),d===g<0?(u&&s.push(u),u=[r[f]]):u.push(r[f]))}if(u&&s.push(u),t>1)for(let f=0;f<s.length;f++)s[f].length<=t||(uy(s[f],t,1,s[f].length-1,GV),s[f]=s[f].slice(0,t));return s}function GV(r,t){return t.area-r.area}function Kw(r,t,i){const s=i.patternDependencies;let u=!1;for(const d of t){const f=d.paint.get(`${r}-pattern`);f.isConstant()||(u=!0);const g=f.constantOr(null);g&&(u=!0,s[g]=!0)}return u}function Jw(r,t,i,s,u){const d=u.patternDependencies;for(const f of t){const g=f.paint.get(`${r}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:s},i,{},u.availableImages);v=v&&v.name?v.name:v,d[v]=!0,i.patterns[f.id]=v}}return i}class y0{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tr,this.indexArray=new Zr,this.indexArray2=new Ji,this.programConfigurations=new Xc(t.layers,t.zoom),this.segments=new wn,this.segments2=new wn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,s,u){this.hasPattern=Kw("fill",this.layers,i);const d=this.layers[0].layout.get("fill-sort-key"),f=[];for(const{feature:g,id:v,index:b,sourceLayerIndex:T}of t){const M=this.layers[0]._featureFilter.needGeometry,k=Qc(g,M);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),k,s))continue;const I=d?d.evaluate(k,{},s,i.availableImages):void 0,R={id:v,properties:g.properties,type:g.type,sourceLayerIndex:T,index:b,geometry:M?k.geometry:hl(g,s,u),patterns:{},sortKey:I};f.push(R)}d&&f.sort((g,v)=>g.sortKey-v.sortKey);for(const g of f){const{geometry:v,index:b,sourceLayerIndex:T}=g;if(this.hasPattern){const M=Jw("fill",this.layers,g,this.zoom,i);this.patternFeatures.push(M)}else this.addFeature(g,v,b,s,{},i.availableImages,i.brightness);i.featureIndex.insert(t[b].feature,v,b,T,this.index)}}update(t,i,s,u,d){const f=Object.keys(t).length!==0;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,f?this.stateDependentLayers:this.layers,s,u,d)}addFeatures(t,i,s,u,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,s,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,DV),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,s,u,d,f=[],g){for(const v of Yw(i,500)){let b=0;for(const B of v)b+=B.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),M=T.vertexLength,k=[],I=[];for(const B of v){if(B.length===0)continue;B!==v[0]&&I.push(k.length/2);const j=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),U=j.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(U+B.length-1,U),k.push(B[0].x),k.push(B[0].y);for(let J=1;J<B.length;J++)this.layoutVertexArray.emplaceBack(B[J].x,B[J].y),this.indexArray2.emplaceBack(U+J-1,U+J),k.push(B[J].x),k.push(B[J].y);j.vertexLength+=B.length,j.primitiveLength+=B.length}const R=_0(k,I);for(let B=0;B<R.length;B+=3)this.indexArray.emplaceBack(M+R[B],M+R[B+1],M+R[B+2]);T.vertexLength+=b,T.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,u,g)}}Ct(y0,"FillBucket",{omit:["layers","patternFeatures"]});const WV=new Ke({"fill-sort-key":new ke(ze.layout_fill["fill-sort-key"]),visibility:new he(ze.layout_fill.visibility)});var qV={paint:new Ke({"fill-antialias":new he(ze.paint_fill["fill-antialias"]),"fill-opacity":new ke(ze.paint_fill["fill-opacity"]),"fill-color":new ke(ze.paint_fill["fill-color"]),"fill-outline-color":new ke(ze.paint_fill["fill-outline-color"]),"fill-translate":new he(ze.paint_fill["fill-translate"]),"fill-translate-anchor":new he(ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new ke(ze.paint_fill["fill-pattern"]),"fill-emissive-strength":new he(ze.paint_fill["fill-emissive-strength"])}),layout:WV};const HV=Dt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ZV=Dt([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),XV=Dt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),YV=Dt([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),KV=Dt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:JV}=HV;var v0={},QV=Ze,NI=nf;function nf(r,t,i,s,u){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=s,this._values=u,r.readFields(e$,this,t)}function e$(r,t,i){r==1?t.id=i.readVarint():r==2?function(s,u){for(var d=s.readVarint()+s.pos;s.pos<d;){var f=u._keys[s.readVarint()],g=u._values[s.readVarint()];u.properties[f]=g}}(i,t):r==3?t.type=i.readVarint():r==4&&(t._geometry=i.pos)}function t$(r){for(var t,i,s=0,u=0,d=r.length,f=d-1;u<d;f=u++)s+=((i=r[f]).x-(t=r[u]).x)*(t.y+i.y);return s}nf.types=["Unknown","Point","LineString","Polygon"],nf.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,i=r.readVarint()+r.pos,s=1,u=0,d=0,f=0,g=[];r.pos<i;){if(u<=0){var v=r.readVarint();s=7&v,u=v>>3}if(u--,s===1||s===2)d+=r.readSVarint(),f+=r.readSVarint(),s===1&&(t&&g.push(t),t=[]),t.push(new QV(d,f));else{if(s!==7)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&g.push(t),g},nf.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,i=1,s=0,u=0,d=0,f=1/0,g=-1/0,v=1/0,b=-1/0;r.pos<t;){if(s<=0){var T=r.readVarint();i=7&T,s=T>>3}if(s--,i===1||i===2)(u+=r.readSVarint())<f&&(f=u),u>g&&(g=u),(d+=r.readSVarint())<v&&(v=d),d>b&&(b=d);else if(i!==7)throw new Error("unknown command "+i)}return[f,v,g,b]},nf.prototype.toGeoJSON=function(r,t,i){var s,u,d=this.extent*Math.pow(2,i),f=this.extent*r,g=this.extent*t,v=this.loadGeometry(),b=nf.types[this.type];function T(I){for(var R=0;R<I.length;R++){var B=I[R];I[R]=[360*(B.x+f)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(B.y+g)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(s=0;s<v.length;s++)M[s]=v[s][0];T(v=M);break;case 2:for(s=0;s<v.length;s++)T(v[s]);break;case 3:for(v=function(I){var R=I.length;if(R<=1)return[I];for(var B,j,U=[],J=0;J<R;J++){var ee=t$(I[J]);ee!==0&&(j===void 0&&(j=ee<0),j===ee<0?(B&&U.push(B),B=[I[J]]):B.push(I[J]))}return B&&U.push(B),U}(v),s=0;s<v.length;s++)for(u=0;u<v[s].length;u++)T(v[s][u])}v.length===1?v=v[0]:b="Multi"+b;var k={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(k.id=this.id),k};var r$=NI,jI=VI;function VI(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(n$,this,t),this.length=this._features.length}function n$(r,t,i){r===15?t.version=i.readVarint():r===1?t.name=i.readString():r===5?t.extent=i.readVarint():r===2?t._features.push(i.pos):r===3?t._keys.push(i.readString()):r===4&&t._values.push(function(s){for(var u=null,d=s.readVarint()+s.pos;s.pos<d;){var f=s.readVarint()>>3;u=f===1?s.readString():f===2?s.readFloat():f===3?s.readDouble():f===4?s.readVarint64():f===5?s.readVarint():f===6?s.readSVarint():f===7?s.readBoolean():null}return u}(i))}VI.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new r$(this._pbf,t,this.extent,this._keys,this._values)};var i$=jI;function o$(r,t,i){if(r===3){var s=new i$(i,i.readVarint()+i.pos);s.length&&(t[s.name]=s)}}var Qw=v0.VectorTile=function(r,t){this.layers=r.readFields(o$,{},t)},x0=v0.VectorTileFeature=NI;function b0(r,t,i,s){const u=[],d=s===0?(f,g,v,b,T,M)=>{f.push(new Pe(M,v+(M-g)/(b-g)*(T-v)))}:(f,g,v,b,T,M)=>{f.push(new Pe(g+(M-v)/(T-v)*(b-g),M))};for(const f of r){const g=[];for(const v of f){if(v.length<=2)continue;const b=[];for(let k=0;k<v.length-1;k++){const I=v[k].x,R=v[k].y,B=v[k+1].x,j=v[k+1].y,U=s===0?I:R,J=s===0?B:j;U<t?J>t&&d(b,I,R,B,j,t):U>i?J<i&&d(b,I,R,B,j,i):b.push(v[k]),J<t&&U>=t&&d(b,I,R,B,j,t),J>i&&U<=i&&d(b,I,R,B,j,i)}let T=v[v.length-1];const M=s===0?T.x:T.y;M>=t&&M<=i&&b.push(T),b.length&&(T=b[b.length-1],b[0].x===T.x&&b[0].y===T.y||b.push(b[0]),g.push(b))}g.length&&u.push(g)}return u}v0.VectorTileLayer=jI;class $I{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const s=t[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var s$={read:function(r,t,i,s,u){var d,f,g=8*u-s-1,v=(1<<g)-1,b=v>>1,T=-7,M=i?u-1:0,k=i?-1:1,I=r[t+M];for(M+=k,d=I&(1<<-T)-1,I>>=-T,T+=g;T>0;d=256*d+r[t+M],M+=k,T-=8);for(f=d&(1<<-T)-1,d>>=-T,T+=s;T>0;f=256*f+r[t+M],M+=k,T-=8);if(d===0)d=1-b;else{if(d===v)return f?NaN:1/0*(I?-1:1);f+=Math.pow(2,s),d-=b}return(I?-1:1)*f*Math.pow(2,d-s)},write:function(r,t,i,s,u,d){var f,g,v,b=8*d-u-1,T=(1<<b)-1,M=T>>1,k=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=s?0:d-1,R=s?1:-1,B=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,f=T):(f=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-f))<1&&(f--,v*=2),(t+=f+M>=1?k/v:k*Math.pow(2,1-M))*v>=2&&(f++,v/=2),f+M>=T?(g=0,f=T):f+M>=1?(g=(t*v-1)*Math.pow(2,u),f+=M):(g=t*Math.pow(2,M-1)*Math.pow(2,u),f=0));u>=8;r[i+I]=255&g,I+=R,g/=256,u-=8);for(f=f<<u|g,b+=u;b>0;r[i+I]=255&f,I+=R,f/=256,b-=8);r[i+I-R]|=128*B}},UI=hn,w0=s$;function hn(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}hn.Varint=0,hn.Fixed64=1,hn.Bytes=2,hn.Fixed32=5;var eS=4294967296,GI=1/eS,WI=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oc(r){return r.type===hn.Bytes?r.readVarint()+r.pos:r.pos+1}function of(r,t,i){return i?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function qI(r,t,i){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(s);for(var u=i.pos-1;u>=r;u--)i.buf[u+s]=i.buf[u]}function a$(r,t){for(var i=0;i<r.length;i++)t.writeVarint(r[i])}function l$(r,t){for(var i=0;i<r.length;i++)t.writeSVarint(r[i])}function c$(r,t){for(var i=0;i<r.length;i++)t.writeFloat(r[i])}function u$(r,t){for(var i=0;i<r.length;i++)t.writeDouble(r[i])}function h$(r,t){for(var i=0;i<r.length;i++)t.writeBoolean(r[i])}function d$(r,t){for(var i=0;i<r.length;i++)t.writeFixed32(r[i])}function f$(r,t){for(var i=0;i<r.length;i++)t.writeSFixed32(r[i])}function p$(r,t){for(var i=0;i<r.length;i++)t.writeFixed64(r[i])}function m$(r,t){for(var i=0;i<r.length;i++)t.writeSFixed64(r[i])}function S0(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function sf(r,t,i){r[i]=t,r[i+1]=t>>>8,r[i+2]=t>>>16,r[i+3]=t>>>24}function HI(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}hn.prototype={destroy:function(){this.buf=null},readFields:function(r,t,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),u=s>>3,d=this.pos;this.type=7&s,r(u,t,this),this.pos===d&&this.skip(s)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=S0(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=HI(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=S0(this.buf,this.pos)+S0(this.buf,this.pos+4)*eS;return this.pos+=8,r},readSFixed64:function(){var r=S0(this.buf,this.pos)+HI(this.buf,this.pos+4)*eS;return this.pos+=8,r},readFloat:function(){var r=w0.read(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=w0.read(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,i,s=this.buf;return t=127&(i=s[this.pos++]),i<128?t:(t|=(127&(i=s[this.pos++]))<<7,i<128?t:(t|=(127&(i=s[this.pos++]))<<14,i<128?t:(t|=(127&(i=s[this.pos++]))<<21,i<128?t:function(u,d,f){var g,v,b=f.buf;if(g=(112&(v=b[f.pos++]))>>4,v<128||(g|=(127&(v=b[f.pos++]))<<3,v<128)||(g|=(127&(v=b[f.pos++]))<<10,v<128)||(g|=(127&(v=b[f.pos++]))<<17,v<128)||(g|=(127&(v=b[f.pos++]))<<24,v<128)||(g|=(1&(v=b[f.pos++]))<<31,v<128))return of(u,g,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=s[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&WI?function(i,s,u){return WI.decode(i.subarray(s,u))}(this.buf,t,r):function(i,s,u){for(var d="",f=s;f<u;){var g,v,b,T=i[f],M=null,k=T>239?4:T>223?3:T>191?2:1;if(f+k>u)break;k===1?T<128&&(M=T):k===2?(192&(g=i[f+1]))==128&&(M=(31&T)<<6|63&g)<=127&&(M=null):k===3?(v=i[f+2],(192&(g=i[f+1]))==128&&(192&v)==128&&((M=(15&T)<<12|(63&g)<<6|63&v)<=2047||M>=55296&&M<=57343)&&(M=null)):k===4&&(v=i[f+2],b=i[f+3],(192&(g=i[f+1]))==128&&(192&v)==128&&(192&b)==128&&((M=(15&T)<<18|(63&g)<<12|(63&v)<<6|63&b)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,k=1):M>65535&&(M-=65536,d+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),d+=String.fromCharCode(M),f+=k}return d}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==hn.Bytes)return r.push(this.readVarint(t));var i=oc(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==hn.Bytes)return r.push(this.readSVarint());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==hn.Bytes)return r.push(this.readBoolean());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==hn.Bytes)return r.push(this.readFloat());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==hn.Bytes)return r.push(this.readDouble());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==hn.Bytes)return r.push(this.readFixed32());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==hn.Bytes)return r.push(this.readSFixed32());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==hn.Bytes)return r.push(this.readFixed64());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==hn.Bytes)return r.push(this.readSFixed64());var t=oc(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===hn.Varint)for(;this.buf[this.pos++]>127;);else if(t===hn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===hn.Fixed32)this.pos+=4;else{if(t!==hn.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),sf(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),sf(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),sf(this.buf,-1&r,this.pos),sf(this.buf,Math.floor(r*GI),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),sf(this.buf,-1&r,this.pos),sf(this.buf,Math.floor(r*GI),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,i){var s,u;if(t>=0?(s=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,f,g){g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,g.buf[g.pos]=127&(d>>>=7)}(s,0,i),function(d,f){var g=(7&d)<<4;f.buf[f.pos++]|=g|((d>>>=3)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d)))))}(u,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(s,u,d){for(var f,g,v=0;v<u.length;v++){if((f=u.charCodeAt(v))>55295&&f<57344){if(!g){f>56319||v+1===u.length?(s[d++]=239,s[d++]=191,s[d++]=189):g=f;continue}if(f<56320){s[d++]=239,s[d++]=191,s[d++]=189,g=f;continue}f=g-55296<<10|f-56320|65536,g=null}else g&&(s[d++]=239,s[d++]=191,s[d++]=189,g=null);f<128?s[d++]=f:(f<2048?s[d++]=f>>6|192:(f<65536?s[d++]=f>>12|224:(s[d++]=f>>18|240,s[d++]=f>>12&63|128),s[d++]=f>>6&63|128),s[d++]=63&f|128)}return d}(this.buf,r,this.pos);var i=this.pos-t;i>=128&&qI(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),w0.write(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),w0.write(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,t){this.pos++;var i=this.pos;r(t,this);var s=this.pos-i;s>=128&&qI(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(r,t,i){this.writeTag(r,hn.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,a$,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,l$,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,h$,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,c$,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,u$,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,d$,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,f$,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,p$,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,m$,t)},writeBytesField:function(r,t){this.writeTag(r,hn.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,hn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,hn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,hn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,hn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,hn.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,hn.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,hn.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,hn.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,hn.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var T0=be(UI);const g$=["tile","layer","source","sourceLayer","state"];class ZI{constructor(t,i,s,u,d){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=s,this._y=u,this.properties=t.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of g$)this[i]!==void 0&&(t[i]=this[i]);return t}}class _${constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,s){const u=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][u]=this.stateChanges[t][u]||{},Lr(this.stateChanges[t][u],s),this.deletedStates[t]===null){this.deletedStates[t]={};for(const d in this.state[t])d!==u&&(this.deletedStates[t][d]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][u]===null){this.deletedStates[t][u]={};for(const d in this.state[t][u])s[d]||(this.deletedStates[t][u][d]=null)}else for(const d in s)this.deletedStates[t]&&this.deletedStates[t][u]&&this.deletedStates[t][u][d]===null&&delete this.deletedStates[t][u][d]}removeFeatureState(t,i,s){if(this.deletedStates[t]===null)return;const u=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},s&&i!==void 0)this.deletedStates[t][u]!==null&&(this.deletedStates[t][u]=this.deletedStates[t][u]||{},this.deletedStates[t][u][s]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][u])for(s in this.deletedStates[t][u]={},this.stateChanges[t][u])this.deletedStates[t][u][s]=null;else this.deletedStates[t][u]=null;else this.deletedStates[t]=null}getState(t,i){const s=String(i),u=Lr({},(this.state[t]||{})[s],(this.stateChanges[t]||{})[s]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const d=this.deletedStates[t][i];if(d===null)return{};for(const f in d)delete u[f]}return u}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const d={};for(const f in this.stateChanges[u])this.state[u][f]||(this.state[u][f]={}),Lr(this.state[u][f],this.stateChanges[u][f]),d[f]=this.state[u][f];s[u]=d}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const d={};if(this.deletedStates[u]===null)for(const f in this.state[u])d[f]={},this.state[u][f]={};else for(const f in this.deletedStates[u]){if(this.deletedStates[u][f]===null)this.state[u][f]={};else if(this.state[u][f])for(const g of Object.keys(this.deletedStates[u][f]))delete this.state[u][f][g];d[f]=this.state[u][f]}s[u]=s[u]||{},Lr(s[u],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(const u in t)t[u].setFeatureState(s,i)}}class XI{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const s=this.toIdx(t,i);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function YI(r,t,i,s){let u=0,d=Number.MAX_VALUE;for(let f=0;f<3;f++)if(Math.abs(s[f])<1e-15){if(i[f]<r[f]||i[f]>t[f])return null}else{const g=1/s[f];let v=(r[f]-i[f])*g,b=(t[f]-i[f])*g;if(v>b){const T=v;v=b,b=T}if(v>u&&(u=v),b<d&&(d=b),u>d)return null}return u}function KI(r,t,i,s,u,d,f,g,v,b,T){const M=s-r,k=u-t,I=d-i,R=f-r,B=g-t,j=v-i,U=T[1]*j-T[2]*B,J=T[2]*R-T[0]*j,ee=T[0]*B-T[1]*R,oe=M*U+k*J+I*ee;if(Math.abs(oe)<1e-15)return null;const ue=1/oe,fe=b[0]-r,xe=b[1]-t,Te=b[2]-i,Ae=(fe*U+xe*J+Te*ee)*ue;if(Ae<0||Ae>1)return null;const Oe=xe*I-Te*k,Ie=Te*M-fe*I,He=fe*k-xe*M,lt=(T[0]*Oe+T[1]*Ie+T[2]*He)*ue;return lt<0||Ae+lt>1?null:(R*Oe+B*Ie+j*He)*ue}function JI(r,t,i){return(r-t)/(i-t)}function QI(r,t,i,s,u,d,f,g,v){const b=1<<i,T=d-s,M=f-u,k=(r+1)/b*T+s,I=(t+0)/b*M+u,R=(t+1)/b*M+u;g[0]=(r+0)/b*T+s,g[1]=I,v[0]=k,v[1]=R}class e3{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(d){const f=Math.ceil(Math.log2(d.dim/8)),g=[];let v=Math.ceil(Math.pow(2,f));const b=1/v,T=(I,R,B,j,U)=>{const J=j?1:0,ee=(I+1)*B-J,oe=R*B,ue=(R+1)*B-J;U[0]=I*B,U[1]=oe,U[2]=ee,U[3]=ue};let M=new XI(v);const k=[];for(let I=0;I<v*v;I++){T(I%v,Math.floor(I/v),b,!1,k);const R=eu(k[0],k[1],d),B=eu(k[2],k[1],d),j=eu(k[2],k[3],d),U=eu(k[0],k[3],d);M.minimums.push(Math.min(R,B,j,U)),M.maximums.push(Math.max(R,B,j,U)),M.leaves.push(1)}for(g.push(M),v/=2;v>=1;v/=2){const I=g[g.length-1];M=new XI(v);for(let R=0;R<v*v;R++){T(R%v,Math.floor(R/v),2,!0,k);const B=I.getElevation(k[0],k[1]),j=I.getElevation(k[2],k[1]),U=I.getElevation(k[2],k[3]),J=I.getElevation(k[0],k[3]),ee=I.isLeaf(k[0],k[1]),oe=I.isLeaf(k[2],k[1]),ue=I.isLeaf(k[2],k[3]),fe=I.isLeaf(k[0],k[3]),xe=Math.min(B.min,j.min,U.min,J.min),Te=Math.max(B.max,j.max,U.max,J.max),Ae=ee&&oe&&ue&&fe;M.maximums.push(Te),M.minimums.push(xe),M.leaves.push(Te-xe<=5&&Ae?1:0)}g.push(M)}return g}(this.dem),s=i.length-1,u=i[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,s,0)}raycastRoot(t,i,s,u,d,f,g=1){return YI([t,i,-100],[s,u,this.maximums[0]*g],d,f)}raycast(t,i,s,u,d,f,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(t,i,s,u,d,f,g);if(v==null)return null;const b=[],T=[],M=[],k=[],I=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:R,t:B,nodex:j,nodey:U,depth:J}=I.pop();if(this.leaves[R]){QI(j,U,J,t,i,s,u,M,k);const oe=1<<J,ue=(j+0)/oe,fe=(j+1)/oe,xe=(U+0)/oe,Te=(U+1)/oe,Ae=eu(ue,xe,this.dem)*g,Oe=eu(fe,xe,this.dem)*g,Ie=eu(fe,Te,this.dem)*g,He=eu(ue,Te,this.dem)*g,lt=KI(M[0],M[1],Ae,k[0],M[1],Oe,k[0],k[1],Ie,d,f),Ge=KI(k[0],k[1],Ie,M[0],k[1],He,M[0],M[1],Ae,d,f),et=Math.min(lt!==null?lt:Number.MAX_VALUE,Ge!==null?Ge:Number.MAX_VALUE);if(et!==Number.MAX_VALUE)return et;{const Ue=a.v.scaleAndAdd([],d,f,B);if(t3(Ae,Oe,He,Ie,JI(Ue[0],M[0],k[0]),JI(Ue[1],M[1],k[1]))>=Ue[2])return B}continue}let ee=0;for(let oe=0;oe<this._siblingOffset.length;oe++){QI((j<<1)+this._siblingOffset[oe][0],(U<<1)+this._siblingOffset[oe][1],J+1,t,i,s,u,M,k),M[2]=-100,k[2]=this.maximums[this.childOffsets[R]+oe]*g;const ue=YI(M,k,d,f);if(ue!=null){const fe=ue;b[oe]=fe;let xe=!1;for(let Te=0;Te<ee&&!xe;Te++)fe>=b[T[Te]]&&(T.splice(Te,0,oe),xe=!0);xe||(T[ee]=oe),ee++}}for(let oe=0;oe<ee;oe++){const ue=T[oe];I.push({idx:this.childOffsets[R]+ue,t:b[ue],nodex:(j<<1)+this._siblingOffset[ue][0],nodey:(U<<1)+this._siblingOffset[ue][1],depth:J+1})}}return null}_addNode(t,i,s){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,s,u,d){if(t[u].isLeaf(i,s)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const f=u-1,g=t[f];let v=0,b=0;for(let T=0;T<this._siblingOffset.length;T++){const M=2*i+this._siblingOffset[T][0],k=2*s+this._siblingOffset[T][1],I=g.getElevation(M,k),R=g.isLeaf(M,k),B=this._addNode(I.min,I.max,R);R&&(v|=1<<T),b||(b=B)}for(let T=0;T<this._siblingOffset.length;T++)v&1<<T||this._construct(t,2*i+this._siblingOffset[T][0],2*s+this._siblingOffset[T][1],f,b+T)}}function t3(r,t,i,s,u,d){return ur(ur(r,i,d),ur(t,s,d),u)}function eu(r,t,i){const s=i.dim,u=ct(r*s-.5,0,s-1),d=ct(t*s-.5,0,s-1),f=Math.floor(u),g=Math.floor(d),v=Math.min(f+1,s-1),b=Math.min(g+1,s-1);return t3(i.get(f,g),i.get(v,g),i.get(f,b),i.get(v,b),u-f,d-g)}const y$={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function v$(r,t,i){return(256*r*256+256*t+i)/10-1e4}function x$(r,t,i){return 256*r+t+i/256-32768}class E0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,s,u=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return kr(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const d=this.dim=i.height-2,f=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=u,this._modifiedForSources={},!u){for(let v=0;v<d;v++)f[this._idx(-1,v)]=f[this._idx(0,v)],f[this._idx(d,v)]=f[this._idx(d-1,v)],f[this._idx(v,-1)]=f[this._idx(v,0)],f[this._idx(v,d)]=f[this._idx(v,d-1)];f[this._idx(-1,-1)]=f[this._idx(0,0)],f[this._idx(d,-1)]=f[this._idx(d-1,0)],f[this._idx(-1,d)]=f[this._idx(0,d-1)],f[this._idx(d,d)]=f[this._idx(d-1,d-1)]}const g=s==="terrarium"?x$:v$;for(let v=0;v<f.length;++v){const b=4*v;this.floatView[v]=g(this.pixels[b],this.pixels[b+1],this.pixels[b+2])}this._timestamp=Di.now()}_buildQuadTree(){this._tree=new e3(this)}get(t,i,s=!1){s&&(t=ct(t,-1,this.dim),i=ct(i,-1,this.dim));const u=this._idx(t,i);return this.floatView[u]}set(t,i,s){const u=this._idx(t,i),d=this.floatView[u];return this.floatView[u]=s,s-d}static getUnpackVector(t){return y$[t]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}static pack(t,i){const s=[0,0,0,0],u=E0.getUnpackVector(i);let d=Math.floor((t+u[3])/u[2]);return s[2]=d%256,d=Math.floor(d/256),s[1]=d%256,d=Math.floor(d/256),s[0]=d,s}getPixels(){return new DI({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,d=i*this.dim+this.dim,f=s*this.dim,g=s*this.dim+this.dim;switch(i){case-1:u=d-1;break;case 1:d=u+1}switch(s){case-1:f=g-1;break;case 1:g=f+1}const v=-i*this.dim,b=-s*this.dim;for(let T=f;T<g;T++)for(let M=u;M<d;M++){const k=4*this._idx(M,T),I=4*this._idx(M+v,T+b);this.pixels[k+0]=t.pixels[I+0],this.pixels[k+1]=t.pixels[I+1],this.pixels[k+2]=t.pixels[I+2],this.pixels[k+3]=t.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ct(E0,"DEMData"),Ct(e3,"DemMinMaxQuadTree",{omit:["dem"]});class af{constructor(t,i,s){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=s}static create(t,i,s){const u=s||t.findDEMTileFor(i);if(!u||!u.dem)return;const d=u.dem,f=u.tileID,g=1<<i.canonical.z-f.canonical.z;return new af(u,d.dim/_t/g,[(i.canonical.x/g-f.canonical.x)*d.dim,(i.canonical.y/g-f.canonical.y)*d.dim])}tileCoordToPixel(t,i){const s=i*this._scale+this._offset[1],u=Math.floor(t*this._scale+this._offset[0]),d=Math.floor(s);return new Pe(u,d)}getElevationAt(t,i,s,u){const d=t*this._scale+this._offset[0],f=i*this._scale+this._offset[1],g=Math.floor(d),v=Math.floor(f),b=this._dem;return u=!!u,s?ur(ur(b.get(g,v,u),b.get(g,v+1,u),f-v),ur(b.get(g+1,v,u),b.get(g+1,v+1,u),f-v),d-g):b.get(g,v,u)}getElevationAtPixel(t,i,s){return this._dem.get(t,i,!!s)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*bo(1,t)*this._dem.stride}}class tS{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Hc(_t,16,0),this.featureIndexArray=new Ik,this.promoteId=i}insert(t,i,s,u,d,f=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,d,f);const v=this.grid;for(let b=0;b<i.length;b++){const T=i[b],M=[1/0,1/0,-1/0,-1/0];for(let k=0;k<T.length;k++){const I=T[k];M[0]=Math.min(M[0],I.x),M[1]=Math.min(M[1],I.y),M[2]=Math.max(M[2],I.x),M[3]=Math.max(M[3],I.y)}M[0]<_t&&M[1]<_t&&M[2]>=0&&M[3]>=0&&v.insert(g,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Qw(new T0(this.rawTileData)).layers,this.sourceLayerCoder=new $I(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,s,u){this.loadVTLayers();const d=t.params||{},f=Wd(d.filter),g=t.tileResult,v=t.transform,b=g.bufferedTilespaceBounds,T=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(R,B,j,U)=>EI(g.bufferedTilespaceGeometry,R,B,j,U));T.sort(b$);let M=null;v.elevation&&T.length>0&&(M=af.create(v.elevation,this.tileID));const k={};let I;for(let R=0;R<T.length;R++){const B=T[R];if(B===I)continue;I=B;const j=this.featureIndexArray.get(B);let U=null;this.loadMatchingFeature(k,j,f,d.layers,d.availableImages,i,s,u,(J,ee,oe,ue=0)=>(U||(U=hl(J,this.tileID.canonical,t.tileTransform)),ee.queryIntersectsFeature(g,J,oe,U,this.z,t.transform,t.pixelPosMatrix,M,ue)))}return k}loadMatchingFeature(t,i,s,u,d,f,g,v,b){const{featureIndex:T,bucketIndex:M,sourceLayerIndex:k,layoutVertexArrayOffset:I}=i,R=this.bucketLayerIDs[M];if(u&&!function(J,ee){for(let oe=0;oe<J.length;oe++)if(ee.indexOf(J[oe])>=0)return!0;return!1}(u,R))return;const B=this.sourceLayerCoder.decode(k),j=this.vtLayers[B].feature(T);if(s.needGeometry){const J=Qc(j,!0);if(!s.filter(new ve(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!s.filter(new ve(this.tileID.overscaledZ),j))return;const U=this.getId(j,B);for(let J=0;J<R.length;J++){const ee=R[J];if(u&&u.indexOf(ee)<0)continue;const oe=f[ee];if(!oe)continue;let ue={};U!==void 0&&v&&(ue=v.getState(oe.sourceLayer||"_geojsonTileLayer",U));const fe=Lr({},g[ee]);fe.paint=r3(fe.paint,oe.paint,j,ue,d),fe.layout=r3(fe.layout,oe.layout,j,ue,d);const xe=!b||b(j,oe,ue,I);if(!xe)continue;const Te=new ZI(j,this.z,this.x,this.y,U);Te.layer=fe;let Ae=t[ee];Ae===void 0&&(Ae=t[ee]=[]),Ae.push({featureIndex:T,feature:Te,intersectionZ:xe})}}lookupSymbolFeatures(t,i,s,u,d,f,g,v){const b={};this.loadVTLayers();const T=Wd(d);for(const M of t)this.loadMatchingFeature(b,{bucketIndex:s,sourceLayerIndex:u,featureIndex:M,layoutVertexArrayOffset:0},T,f,g,v,i);return b}loadFeature(t){const{featureIndex:i,sourceLayerIndex:s}=t;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),d=this.vtFeatures[u];if(d[i])return d[i];const f=this.vtLayers[u].feature(i);return d[i]=f,f}hasLayer(t){for(const i of this.bucketLayerIDs)for(const s of i)if(t===s)return!0;return!1}getId(t,i){let s=t.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];u!=null&&(s=t.properties[u]),typeof s=="boolean"&&(s=Number(s))}return s}}function r3(r,t,i,s,u){return oi(r,(d,f)=>{const g=t instanceof Xe?t.get(f):null;return g&&g.evaluate?g.evaluate(i,s,u):g})}function b$(r,t){return t-r}Ct(tS,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const w$=Dt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),S$=Dt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),T$=Dt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const E$=Dt([{name:"a_z_offset",components:1,type:"Float32"}],4),C$=Dt([{name:"a_texb",components:2,type:"Uint16"}]),M$=Dt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),A$=Dt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Dt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const n3=Dt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),k$=Dt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dt([{name:"triangle",components:3,type:"Uint16"}]),Dt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dt([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dt([{type:"Float32",name:"offsetX"}]),Dt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ni=24;const wa=128;function rS(r,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ve(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:u}=i;let d=0;for(;d<s.length&&s[d]<=r;)d++;d=Math.max(0,d-1);let f=d;for(;f<s.length&&s[f]<r+1;)f++;f=Math.min(s.length-1,f);const g=s[d],v=s[f];return i.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:v,minSize:i.evaluate(new ve(g)),maxSize:i.evaluate(new ve(v)),interpolationType:u}}}function C0(r,{uSize:t,uSizeT:i},{lowerSize:s,upperSize:u}){return r.kind==="source"?s/wa:r.kind==="composite"?ur(s/wa,u/wa,i):t}function lf(r,t){let i=0,s=0;if(r.kind==="constant")s=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:d,maxZoom:f}=r,g=u?ct(ms.interpolationFactor(u,t,d,f),0,1):0;r.kind==="camera"?s=ur(r.minSize,r.maxSize,g):i=g}return{uSizeT:i,uSize:s}}var P$=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:wa,evaluateSizeForFeature:C0,evaluateSizeForZoom:lf,getSizeData:rS});function I$(r,t,i){return r.sections.forEach(s=>{s.text=function(u,d,f){const g=d.layout.get("text-transform").evaluate(f,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),we.applyArabicShaping&&(u=we.applyArabicShaping(u)),u}(s.text,t,i)}),r}const Fm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function z$(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}function R$(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}const nS=3;function D$(r,t,i){t.glyphs=[],r===1&&i.readMessage(L$,t)}function L$(r,t,i){if(r===3){const{id:s,bitmap:u,width:d,height:f,left:g,top:v,advance:b}=i.readMessage(O$,{});t.glyphs.push({id:s,bitmap:new ic({width:d+2*nS,height:f+2*nS},u),metrics:{width:d,height:f,left:g,top:v,advance:b}})}else r===4?t.ascender=i.readSVarint():r===5&&(t.descender=i.readSVarint())}function O$(r,t,i){r===1?t.id=i.readVarint():r===2?t.bitmap=i.readBytes():r===3?t.width=i.readVarint():r===4?t.height=i.readVarint():r===5?t.left=i.readSVarint():r===6?t.top=i.readSVarint():r===7&&(t.advance=i.readVarint())}const i3=nS,Ss={horizontal:1,vertical:2,horizontalOnly:3},o3=-17;class Nm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const s=new Nm;return s.scale=t||1,s.fontStack=i,s}static forImage(t){const i=new Nm;return i.imageName=t,i}}class cf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const s=new cf;for(let u=0;u<t.sections.length;u++){const d=t.sections[u];d.image?s.addImageSection(d):s.addTextSection(d,i)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(i,s){let u="";for(let d=0;d<i.length;d++){const f=i.charCodeAt(d+1)||null,g=i.charCodeAt(d-1)||null;u+=!s&&(f&&O(f)&&!Fm[i[d+1]]||g&&O(g)&&!Fm[i[d-1]])||!Fm[i[d]]?i[d]:Fm[i[d]]}return u}(this.text,t)}trim(){let t=0;for(let s=0;s<this.text.length&&M0[this.text.charCodeAt(s)];s++)t++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&M0[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const s=new cf;return s.text=this.text.substring(t,i),s.sectionIndex=this.sectionIndex.slice(t,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(Nm.forText(t.scale,t.fontStack||i));const s=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(s)}addImageSection(t){const i=t.image?t.image.namePrimary:"";if(i.length===0)return void kr("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCodePoint(s),this.sections.push(Nm.forImage(i)),this.sectionIndex.push(this.sections.length-1)):kr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function iS(r,t,i,s,u,d,f,g,v,b,T,M,k,I,R){const B=cf.fromFeature(r,u);M===Ss.vertical&&B.verticalizePunctuation(k);let j=[];const U=function(fe,xe,Te,Ae,Oe,Ie){if(!fe)return[];const He=[],lt=function(vt,Tt,ot,Ut,At,yt){let Gt=0;for(let Lt=0;Lt<vt.length();Lt++){const Nt=vt.getSection(Lt);Gt+=s3(vt.getCodePoint(Lt),Nt,Ut,At,Tt,yt)}return Gt/Math.max(1,Math.ceil(Gt/ot))}(fe,xe,Te,Ae,Oe,Ie),Ge=fe.text.indexOf("")>=0;let et=0;for(let vt=0;vt<fe.length();vt++){const Tt=fe.getSection(vt),ot=fe.getCodePoint(vt);if(M0[ot]||(et+=s3(ot,Tt,Ae,Oe,xe,Ie)),vt<fe.length()-1){const Ut=!((Ue=ot)<11904||!(x["Bopomofo Extended"](Ue)||x.Bopomofo(Ue)||x["CJK Compatibility Forms"](Ue)||x["CJK Compatibility Ideographs"](Ue)||x["CJK Compatibility"](Ue)||x["CJK Radicals Supplement"](Ue)||x["CJK Strokes"](Ue)||x["CJK Symbols and Punctuation"](Ue)||x["CJK Unified Ideographs Extension A"](Ue)||x["CJK Unified Ideographs"](Ue)||x["Enclosed CJK Letters and Months"](Ue)||x["Halfwidth and Fullwidth Forms"](Ue)||x.Hiragana(Ue)||x["Ideographic Description Characters"](Ue)||x["Kangxi Radicals"](Ue)||x["Katakana Phonetic Extensions"](Ue)||x.Katakana(Ue)||x["Vertical Forms"](Ue)||x["Yi Radicals"](Ue)||x["Yi Syllables"](Ue)));(B$[ot]||Ut||Tt.imageName)&&He.push(l3(vt+1,et,lt,He,F$(ot,fe.getCodePoint(vt+1),Ut&&Ge),!1))}}var Ue;return c3(l3(fe.length(),et,lt,He,0,!0))}(B,b,d,t,s,I),{processBidirectionalText:J,processStyledBidirectionalText:ee}=we;if(J&&B.sections.length===1){const fe=J(B.toString(),U);for(const xe of fe){const Te=new cf;Te.text=xe,Te.sections=B.sections;for(let Ae=0;Ae<xe.length;Ae++)Te.sectionIndex.push(0);j.push(Te)}}else if(ee){const fe=ee(B.text,B.sectionIndex,U);for(const xe of fe){const Te=new cf;Te.text=xe[0],Te.sectionIndex=xe[1],Te.sections=B.sections,j.push(Te)}}else j=function(fe,xe){const Te=[],Ae=fe.text;let Oe=0;for(const Ie of xe)Te.push(fe.substring(Oe,Ie)),Oe=Ie;return Oe<Ae.length&&Te.push(fe.substring(Oe,Ae.length)),Te}(B,U);const oe=[],ue={positionedLines:oe,text:B.toString(),top:T[1],bottom:T[1],left:T[0],right:T[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(fe,xe,Te,Ae,Oe,Ie,He,lt,Ge,et,Ue,vt){let Tt=0,ot=0,Ut=0;const At=lt==="right"?1:lt==="left"?0:.5;let yt=!1;for(const vr of Oe){const rr=vr.getSections();for(const mr of rr){if(mr.imageName)continue;const zr=xe[mr.fontStack];if(zr&&(yt=zr.ascender!==void 0&&zr.descender!==void 0,!yt))break}if(!yt)break}let Gt=0;for(const vr of Oe){vr.trim();const rr=vr.getMaxScale(),mr=(rr-1)*Ni,zr={positionedGlyphs:[],lineOffset:0};fe.positionedLines[Gt]=zr;const nn=zr.positionedGlyphs;let sr=0;if(!vr.length()){ot+=Ie,++Gt;continue}let dn=0,on=0;for(let Wr=0;Wr<vr.length();Wr++){const Rr=vr.getSection(Wr),Pn=vr.getSectionIndex(Wr),fn=vr.getCodePoint(Wr);let jn=Rr.scale,_i=null,wo=null,Wn=null,Ln=Ni,Qi=0;const eo=!(Ge===Ss.horizontal||!Ue&&!z(fn)||Ue&&(M0[fn]||(Lt=fn,x.Arabic(Lt)||x["Arabic Supplement"](Lt)||x["Arabic Extended-A"](Lt)||x["Arabic Presentation Forms-A"](Lt)||x["Arabic Presentation Forms-B"](Lt))));if(Rr.imageName){const So=Ae[Rr.imageName];if(!So)continue;Wn=Rr.imageName,fe.iconsInText=fe.iconsInText||!0,wo=So.paddedRect;const pn=So.displaySize;jn=jn*Ni/vt,_i={width:pn[0],height:pn[1],left:0,top:-i3,advance:eo?pn[1]:pn[0],localGlyph:!1},Qi=yt?-_i.height*jn:o3+rr*Ni-pn[1]*jn,Ln=_i.advance;const Ca=(eo?pn[0]:pn[1])*jn-Ni*rr;Ca>0&&Ca>sr&&(sr=Ca)}else{const So=Te[Rr.fontStack];if(!So)continue;So[fn]&&(wo=So[fn]);const pn=xe[Rr.fontStack];if(!pn)continue;const Ca=pn.glyphs[fn];if(!Ca)continue;if(_i=Ca.metrics,Ln=fn!==8203?Ni:0,yt){const gf=pn.ascender!==void 0?Math.abs(pn.ascender):0,lc=pn.descender!==void 0?Math.abs(pn.descender):0,cc=(gf+lc)*jn;dn<cc&&(dn=cc,on=(gf-lc)/2*jn),Qi=-gf*jn}else Qi=o3+(rr-jn)*Ni}eo?(fe.verticalizable=!0,nn.push({glyph:fn,imageName:Wn,x:Tt,y:ot+Qi,vertical:eo,scale:jn,localGlyph:_i.localGlyph,fontStack:Rr.fontStack,sectionIndex:Pn,metrics:_i,rect:wo}),Tt+=Ln*jn+et):(nn.push({glyph:fn,imageName:Wn,x:Tt,y:ot+Qi,vertical:eo,scale:jn,localGlyph:_i.localGlyph,fontStack:Rr.fontStack,sectionIndex:Pn,metrics:_i,rect:wo}),Tt+=_i.advance*jn+et)}nn.length!==0&&(Ut=Math.max(Tt-et,Ut),yt?u3(nn,At,sr,on,Ie*rr/2):u3(nn,At,sr,0,Ie/2)),Tt=0;const Vr=Ie*rr+sr;zr.lineOffset=Math.max(sr,mr),ot+=Vr,++Gt}var Lt;const Nt=ot,{horizontalAlign:ft,verticalAlign:Kt}=oS(He);(function(vr,rr,mr,zr,nn,sr){const dn=(rr-mr)*nn,on=-sr*zr;for(const Vr of vr)for(const Wr of Vr.positionedGlyphs)Wr.x+=dn,Wr.y+=on})(fe.positionedLines,At,ft,Kt,Ut,Nt),fe.top+=-Kt*Nt,fe.bottom=fe.top+Nt,fe.left+=-ft*Ut,fe.right=fe.left+Ut,fe.hasBaseline=yt}(ue,t,i,s,j,f,g,v,M,b,k,R),!function(fe){for(const xe of fe)if(xe.positionedGlyphs.length!==0)return!1;return!0}(oe)&&ue}const M0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},B$={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function s3(r,t,i,s,u,d){if(t.imageName){const f=s[t.imageName];return f?f.displaySize[0]*t.scale*Ni/d+u:0}{const f=i[t.fontStack],g=f&&f.glyphs[r];return g?g.metrics.advance*t.scale+u:0}}function a3(r,t,i,s){const u=Math.pow(r-t,2);return s?r<t?u/2:2*u:u+Math.abs(i)*i}function F$(r,t,i){let s=0;return r===10&&(s-=1e4),i&&(s+=150),r!==40&&r!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function l3(r,t,i,s,u,d){let f=null,g=a3(t,i,u,d);for(const v of s){const b=a3(t-v.x,i,u,d)+v.badness;b<=g&&(f=v,g=b)}return{index:r,x:t,priorBreak:f,badness:g}}function c3(r){return r?c3(r.priorBreak).concat(r.index):[]}function oS(r){let t=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function u3(r,t,i,s,u){if(!(t||i||s||u))return;const d=r.length-1,f=r[d],g=(f.x+f.metrics.advance*f.scale)*t;for(let v=0;v<=d;v++)r[v].x-=g,r[v].y+=i+s+u}function N$(r,t,i,s){const{horizontalAlign:u,verticalAlign:d}=oS(s),f=i[0]-r.displaySize[0]*u,g=i[1]-r.displaySize[1]*d;return{imagePrimary:r,imageSecondary:t,top:g,bottom:g+r.displaySize[1],left:f,right:f+r.displaySize[0]}}function h3(r,t,i,s,u,d){const f=r.imagePrimary;let g;if(f.content){const j=f.content,U=f.pixelRatio||1;g=[j[0]/U,j[1]/U,f.displaySize[0]-j[2]/U,f.displaySize[1]-j[3]/U]}const v=t.left*d,b=t.right*d;let T,M,k,I;i==="width"||i==="both"?(I=u[0]+v-s[3],M=u[0]+b+s[1]):(I=u[0]+(v+b-f.displaySize[0])/2,M=I+f.displaySize[0]);const R=t.top*d,B=t.bottom*d;return i==="height"||i==="both"?(T=u[1]+R-s[0],k=u[1]+B+s[2]):(T=u[1]+(R+B-f.displaySize[1])/2,k=T+f.displaySize[1]),{imagePrimary:f,imageSecondary:void 0,top:T,right:M,bottom:k,left:I,collisionPadding:g}}class sc extends Pe{constructor(t,i,s,u,d){super(t,i),this.angle=u,this.z=s,d!==void 0&&(this.segment=d)}clone(){return new sc(this.x,this.y,this.z,this.angle,this.segment)}}function d3(r,t,i,s,u){if(t.segment===void 0)return!0;let d=t,f=t.segment+1,g=0;for(;g>-i/2;){if(f--,f<0)return!1;g-=r[f].dist(d),d=r[f]}g+=r[f].dist(r[f+1]),f++;const v=[];let b=0;for(;g<i/2;){const T=r[f],M=r[f+1];if(!M)return!1;let k=r[f-1].angleTo(T)-T.angleTo(M);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:k}),b+=k;g-v[0].distance>s;)b-=v.shift().angleDelta;if(b>u)return!1;f++,g+=T.dist(M)}return!0}function f3(r){let t=0;for(let i=0;i<r.length-1;i++)t+=r[i].dist(r[i+1]);return t}function p3(r,t,i){return r?.6*t*i:0}function m3(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function j$(r,t,i,s,u,d){const f=p3(i,u,d),g=m3(i,s)*d;let v=0;const b=f3(r)/2;for(let T=0;T<r.length-1;T++){const M=r[T],k=r[T+1],I=M.dist(k);if(v+I>b){const R=(b-v)/I,B=ur(M.x,k.x,R),j=ur(M.y,k.y,R),U=new sc(B,j,0,k.angleTo(M),T);return!f||d3(r,U,g,f,t)?U:void 0}v+=I}}function V$(r,t,i,s,u,d,f,g,v){const b=p3(s,d,f),T=m3(s,u),M=T*f,k=r[0].x===0||r[0].x===v||r[0].y===0||r[0].y===v;return t-M<t/4&&(t=M+t/4),g3(r,k?t/2*g%t:(T/2+2*d)*f*g%t,t,b,i,M,k,!1,v)}function g3(r,t,i,s,u,d,f,g,v){const b=d/2,T=f3(r);let M=0,k=t-i,I=[];for(let R=0;R<r.length-1;R++){const B=r[R],j=r[R+1],U=B.dist(j),J=j.angleTo(B);for(;k+i<M+U;){k+=i;const ee=(k-M)/U,oe=ur(B.x,j.x,ee),ue=ur(B.y,j.y,ee);if(oe>=0&&oe<v&&ue>=0&&ue<v&&k-b>=0&&k+b<=T){const fe=new sc(oe,ue,0,J,R);s&&!d3(r,fe,d,s,u)||I.push(fe)}}M+=U}return g||I.length||f||(I=g3(r,M/2,i,s,u,d,f,!0,v)),I}function _3(r,t,i,s,u){const d=[];for(let f=0;f<r.length;f++){const g=r[f];let v;for(let b=0;b<g.length-1;b++){let T=g[b],M=g[b+1];T.x<t&&M.x<t||(T.x<t?T=new Pe(t,T.y+(t-T.x)/(M.x-T.x)*(M.y-T.y))._round():M.x<t&&(M=new Pe(t,T.y+(t-T.x)/(M.x-T.x)*(M.y-T.y))._round()),T.y<i&&M.y<i||(T.y<i?T=new Pe(T.x+(i-T.y)/(M.y-T.y)*(M.x-T.x),i)._round():M.y<i&&(M=new Pe(T.x+(i-T.y)/(M.y-T.y)*(M.x-T.x),i)._round()),T.x>=s&&M.x>=s||(T.x>=s?T=new Pe(s,T.y+(s-T.x)/(M.x-T.x)*(M.y-T.y))._round():M.x>=s&&(M=new Pe(s,T.y+(s-T.x)/(M.x-T.x)*(M.y-T.y))._round()),T.y>=u&&M.y>=u||(T.y>=u?T=new Pe(T.x+(u-T.y)/(M.y-T.y)*(M.x-T.x),u)._round():M.y>=u&&(M=new Pe(T.x+(u-T.y)/(M.y-T.y)*(M.x-T.x),u)._round()),v&&T.equals(v[v.length-1])||(v=[T],d.push(v)),v.push(M)))))}}return d}function sS(r){let t=0,i=0;for(const f of r)t+=f.w*f.h,i=Math.max(i,f.w);r.sort((f,g)=>g.h-f.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let u=0,d=0;for(const f of r)for(let g=s.length-1;g>=0;g--){const v=s[g];if(!(f.w>v.w||f.h>v.h)){if(f.x=v.x,f.y=v.y,d=Math.max(d,f.y+f.h),u=Math.max(u,f.x+f.w),f.w===v.w&&f.h===v.h){const b=s.pop();g<s.length&&(s[g]=b)}else f.h===v.h?(v.x+=f.w,v.w-=f.w):f.w===v.w?(v.y+=f.h,v.h-=f.h):(s.push({x:v.x+f.w,y:v.y,w:v.w-f.w,h:f.h}),v.y+=f.h,v.h-=f.h);break}}return{w:u,h:d,fill:t/(u*d)||0}}Ct(sc,"Anchor");const Yo=1;class aS{constructor(t,{pixelRatio:i,version:s,stretchX:u,stretchY:d,content:f}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=u,this.stretchY=d,this.content=f,this.version=s}get tl(){return[this.paddedRect.x+Yo,this.paddedRect.y+Yo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yo,this.paddedRect.y+this.paddedRect.h-Yo]}get displaySize(){return[(this.paddedRect.w-2*Yo)/this.pixelRatio,(this.paddedRect.h-2*Yo)/this.pixelRatio]}}class y3{constructor(t,i){const s={},u={};this.haveRenderCallbacks=[];const d=[];this.addImages(t,s,d),this.addImages(i,u,d);const{w:f,h:g}=sS(d),v=new ws({width:f||1,height:g||1});for(const b in t){const T=t[b],M=s[b].paddedRect;ws.copy(T.data,v,{x:0,y:0},{x:M.x+Yo,y:M.y+Yo},T.data,T.sdf)}for(const b in i){const T=i[b],M=u[b].paddedRect,k=M.x+Yo,I=M.y+Yo,R=T.data.width,B=T.data.height;ws.copy(T.data,v,{x:0,y:0},{x:k,y:I},T.data),ws.copy(T.data,v,{x:0,y:B-1},{x:k,y:I-1},{width:R,height:1}),ws.copy(T.data,v,{x:0,y:0},{x:k,y:I+B},{width:R,height:1}),ws.copy(T.data,v,{x:R-1,y:0},{x:k-1,y:I},{width:1,height:B}),ws.copy(T.data,v,{x:0,y:0},{x:k+R,y:I},{width:1,height:B})}this.image=v,this.iconPositions=s,this.patternPositions=u}addImages(t,i,s){for(const u in t){const d=t[u],f={x:0,y:0,w:d.data.width+2*Yo,h:d.data.height+2*Yo};s.push(f),i[u]=new aS(f,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,i,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>t.hasImage(u,s)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,s);for(const u in t.getUpdatedImages(s))this.patchUpdatedImage(this.iconPositions[u],t.getImage(u,s),i),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u,s),i)}patchUpdatedImage(t,i,s){if(!t||!i||t.version===i.version)return;t.version=i.version;const[u,d]=t.tl,f=!!Object.keys(this.patternPositions).length;s.update(i.data,{useMipmap:f},{x:u,y:d})}}Ct(aS,"ImagePosition"),Ct(y3,"ImageAtlas");const jm=1e20;function v3(r,t,i,s,u,d,f,g,v){for(let b=t;b<t+s;b++)x3(r,i*d+b,d,u,f,g,v);for(let b=i;b<i+u;b++)x3(r,b*d+t,1,s,f,g,v)}function x3(r,t,i,s,u,d,f){d[0]=0,f[0]=-jm,f[1]=jm,u[0]=r[t];for(let g=1,v=0,b=0;g<s;g++){u[g]=r[t+g*i];const T=g*g;do{const M=d[v];b=(u[g]-u[M]+T-M*M)/(g-M)/2}while(b<=f[v]&&--v>-1);v++,d[v]=g,f[v]=b,f[v+1]=jm}for(let g=0,v=0;g<s;g++){for(;f[v+1]<g;)v++;const b=d[v],T=g-b;r[t+g*i]=u[b]+T*T}}const Sa=2,lS={none:0,ideographs:1,all:2};class uf{constructor(t,i,s){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=s,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,i){this.urls[i]=t}getGlyphs(t,i,s){const u=[],d=this.urls[i]||L.GLYPHS_URL;for(const f in t)for(const g of t[f])u.push({stack:f,id:g});_r(u,({stack:f,id:g},v)=>{let b=this.entries[f];b||(b=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=b.glyphs[g];if(T!==void 0)return void v(null,{stack:f,id:g,glyph:T});if(T=this._tinySDF(b,f,g),T)return b.glyphs[g]=T,void v(null,{stack:f,id:g,glyph:T});const M=Math.floor(g/256);if(256*M>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void v(null,{stack:f,id:g,glyph:T});let k=b.requests[M];k||(k=b.requests[M]=[],uf.loadGlyphRange(f,M,d,this.requestManager,(I,R)=>{if(R){b.ascender=R.ascender,b.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(b.glyphs[+B]=R.glyphs[+B]);b.ranges[M]=!0}for(const B of k)B(I,R);delete b.requests[M]})),k.push((I,R)=>{I?v(I):R&&v(null,{stack:f,id:g,glyph:R.glyphs[g]||null})})},(f,g)=>{if(f)s(f);else if(g){const v={};for(const{stack:b,id:T,glyph:M}of g)v[b]===void 0&&(v[b]={}),v[b].glyphs===void 0&&(v[b].glyphs={}),v[b].glyphs[T]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;s(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==lS.none&&(this.localGlyphMode===lS.all?!!this.localFontFamily:!!this.localFontFamily&&(x["CJK Unified Ideographs"](t)||x["Hangul Syllables"](t)||x.Hiragana(t)||x.Katakana(t)||x["CJK Symbols and Punctuation"](t)||x["CJK Unified Ideographs Extension A"](t)||x["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,i,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let d=t.tinySDF;if(!d){let B="400";/bold/i.test(i)?B="900":/medium/i.test(i)?B="500":/light/i.test(i)&&(B="200"),d=t.tinySDF=new uf.TinySDF({fontFamily:u,fontWeight:B,fontSize:24*Sa,buffer:3*Sa,radius:8*Sa}),d.fontWeight=B}if(this.localGlyphs[d.fontWeight][s])return this.localGlyphs[d.fontWeight][s];const f=String.fromCodePoint(s),{data:g,width:v,height:b,glyphWidth:T,glyphHeight:M,glyphLeft:k,glyphTop:I,glyphAdvance:R}=d.draw(f);return this.localGlyphs[d.fontWeight][s]={id:s,bitmap:new ic({width:v,height:b},g),metrics:{width:T/Sa,height:M/Sa,left:k/Sa,top:I/Sa-27,advance:R/Sa,localGlyph:!0}}}}uf.loadGlyphRange=function(r,t,i,s,u){const d=256*t,f=d+255,g=s.transformRequest(s.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${d}-${f}`),kn.Glyphs);si(g,(v,b)=>{if(v)u(v);else if(b){const T={},M=function(k){return new T0(k).readFields(D$,{})}(b);for(const k of M.glyphs)T[k.id]=k;u(null,{glyphs:T,ascender:M.ascender,descender:M.descender})}})},uf.TinySDF=class{constructor({fontSize:r=24,buffer:t=3,radius:i=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:d="normal",fontStyle:f="normal"}={}){this.buffer=t,this.cutoff=s,this.radius=i;const g=this.size=r+4*t,v=this._createCanvas(g),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${f} ${d} ${r}px ${u}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(r){const t=document.createElement("canvas");return t.width=t.height=r,t}draw(r){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:d}=this.ctx.measureText(r),f=Math.ceil(i),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-u))),v=Math.min(this.size-this.buffer,f+Math.ceil(s)),b=g+2*this.buffer,T=v+2*this.buffer,M=Math.max(b*T,0),k=new Uint8ClampedArray(M),I={data:k,width:b,height:T,glyphWidth:g,glyphHeight:v,glyphTop:f,glyphLeft:0,glyphAdvance:t};if(g===0||v===0)return I;const{ctx:R,buffer:B,gridInner:j,gridOuter:U}=this;R.clearRect(B,B,g,v),R.fillText(r,B,B+f);const J=R.getImageData(B,B,g,v);U.fill(jm,0,M),j.fill(0,0,M);for(let ee=0;ee<v;ee++)for(let oe=0;oe<g;oe++){const ue=J.data[4*(ee*g+oe)+3]/255;if(ue===0)continue;const fe=(ee+B)*b+oe+B;if(ue===1)U[fe]=0,j[fe]=jm;else{const xe=.5-ue;U[fe]=xe>0?xe*xe:0,j[fe]=xe<0?xe*xe:0}}v3(U,0,0,b,T,b,this.f,this.v,this.z),v3(j,B,B,g,v,b,this.f,this.v,this.z);for(let ee=0;ee<M;ee++){const oe=Math.sqrt(U[ee])-Math.sqrt(j[ee]);k[ee]=Math.round(255-255*(oe/this.radius+this.cutoff))}return I}};const tu=Yo;function b3(r,t,i,s){const u=[],d=r.imagePrimary,f=d.pixelRatio,g=d.paddedRect.w-2*tu,v=d.paddedRect.h-2*tu,b=r.right-r.left,T=r.bottom-r.top,M=d.stretchX||[[0,g]],k=d.stretchY||[[0,v]],I=(Ie,He)=>Ie+He[1]-He[0],R=M.reduce(I,0),B=k.reduce(I,0),j=g-R,U=v-B;let J=0,ee=R,oe=0,ue=B,fe=0,xe=j,Te=0,Ae=U;if(d.content&&s){const Ie=d.content;J=A0(M,0,Ie[0]),oe=A0(k,0,Ie[1]),ee=A0(M,Ie[0],Ie[2]),ue=A0(k,Ie[1],Ie[3]),fe=Ie[0]-J,Te=Ie[1]-oe,xe=Ie[2]-Ie[0]-ee,Ae=Ie[3]-Ie[1]-ue}const Oe=(Ie,He,lt,Ge)=>{const et=k0(Ie.stretch-J,ee,b,r.left),Ue=P0(Ie.fixed-fe,xe,Ie.stretch,R),vt=k0(He.stretch-oe,ue,T,r.top),Tt=P0(He.fixed-Te,Ae,He.stretch,B),ot=k0(lt.stretch-J,ee,b,r.left),Ut=P0(lt.fixed-fe,xe,lt.stretch,R),At=k0(Ge.stretch-oe,ue,T,r.top),yt=P0(Ge.fixed-Te,Ae,Ge.stretch,B),Gt=new Pe(et,vt),Lt=new Pe(ot,vt),Nt=new Pe(ot,At),ft=new Pe(et,At),Kt=new Pe(Ue/f,Tt/f),vr=new Pe(Ut/f,yt/f),rr=t*Math.PI/180;if(rr){const on=Math.sin(rr),Vr=Math.cos(rr),Wr=[Vr,-on,on,Vr];Gt._matMult(Wr),Lt._matMult(Wr),ft._matMult(Wr),Nt._matMult(Wr)}const mr=Ie.stretch+Ie.fixed,zr=lt.stretch+lt.fixed,nn=He.stretch+He.fixed,sr=Ge.stretch+Ge.fixed,dn=r.imageSecondary;return{tl:Gt,tr:Lt,bl:ft,br:Nt,texPrimary:{x:d.paddedRect.x+tu+mr,y:d.paddedRect.y+tu+nn,w:zr-mr,h:sr-nn},texSecondary:dn?{x:dn.paddedRect.x+tu+mr,y:dn.paddedRect.y+tu+nn,w:zr-mr,h:sr-nn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Kt,pixelOffsetBR:vr,minFontScaleX:xe/f/b,minFontScaleY:Ae/f/T,isSDF:i}};if(s&&(d.stretchX||d.stretchY)){const Ie=w3(M,j,R),He=w3(k,U,B);for(let lt=0;lt<Ie.length-1;lt++){const Ge=Ie[lt],et=Ie[lt+1];for(let Ue=0;Ue<He.length-1;Ue++)u.push(Oe(Ge,He[Ue],et,He[Ue+1]))}}else u.push(Oe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return u}function A0(r,t,i){let s=0;for(const u of r)s+=Math.max(t,Math.min(i,u[1]))-Math.max(t,Math.min(i,u[0]));return s}function w3(r,t,i){const s=[{fixed:-tu,stretch:0}];for(const[u,d]of r){const f=s[s.length-1];s.push({fixed:u-f.stretch,stretch:f.stretch}),s.push({fixed:u-f.stretch,stretch:f.stretch+(d-u)})}return s.push({fixed:t+tu,stretch:i}),s}function k0(r,t,i,s){return r/t*i+s}function P0(r,t,i,s){return r-t*i/s}function $$(r,t,i,s){const u=t+r.positionedLines[s].lineOffset;return s===0?i+u/2:i+(u+(t+r.positionedLines[s-1].lineOffset))/2}function U$(r,t=1,i=!1){let s=1/0,u=1/0,d=-1/0,f=-1/0;const g=r[0];for(let I=0;I<g.length;I++){const R=g[I];(!I||R.x<s)&&(s=R.x),(!I||R.y<u)&&(u=R.y),(!I||R.x>d)&&(d=R.x),(!I||R.y>f)&&(f=R.y)}const v=Math.min(d-s,f-u);let b=v/2;const T=new Sd([],G$);if(v===0)return new Pe(s,u);for(let I=s;I<d;I+=v)for(let R=u;R<f;R+=v)T.push(new hf(I+b,R+b,b,r));let M=function(I){let R=0,B=0,j=0;const U=I[0];for(let J=0,ee=U.length,oe=ee-1;J<ee;oe=J++){const ue=U[J],fe=U[oe],xe=ue.x*fe.y-fe.x*ue.y;B+=(ue.x+fe.x)*xe,j+=(ue.y+fe.y)*xe,R+=3*xe}return new hf(B/R,j/R,0,I)}(r),k=T.length;for(;T.length;){const I=T.pop();(I.d>M.d||!M.d)&&(M=I,i&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,k)),I.max-M.d<=t||(b=I.h/2,T.push(new hf(I.p.x-b,I.p.y-b,b,r)),T.push(new hf(I.p.x+b,I.p.y-b,b,r)),T.push(new hf(I.p.x-b,I.p.y+b,b,r)),T.push(new hf(I.p.x+b,I.p.y+b,b,r)),k+=4)}return i&&(console.log(`num probes: ${k}`),console.log(`best distance: ${M.d}`)),M.p}function G$(r,t){return t.max-r.max}class hf{constructor(t,i,s,u){this.p=new Pe(t,i),this.h=s,this.d=function(d,f){let g=!1,v=1/0;for(let b=0;b<f.length;b++){const T=f[b];for(let M=0,k=T.length,I=k-1;M<k;I=M++){const R=T[M],B=T[I];R.y>d.y!=B.y>d.y&&d.x<(B.x-R.x)*(d.y-R.y)/(B.y-R.y)+R.x&&(g=!g),v=Math.min(v,SI(d,R,B))}}return(g?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const df=7,cS=Number.POSITIVE_INFINITY,W$=Math.sqrt(2);function S3(r,[t,i]){let s=0,u=0;if(i===cS){t<0&&(t=0);const d=t/W$;switch(r){case"top-right":case"top-left":u=d-df;break;case"bottom-right":case"bottom-left":u=-d+df;break;case"bottom":u=-t+df;break;case"top":u=t-df}switch(r){case"top-right":case"bottom-right":s=-d;break;case"top-left":case"bottom-left":s=d;break;case"left":s=t;break;case"right":s=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),r){case"top-right":case"top-left":case"top":u=i-df;break;case"bottom-right":case"bottom-left":case"bottom":u=-i+df}switch(r){case"top-right":case"bottom-right":case"right":s=-t;break;case"top-left":case"bottom-left":case"left":s=t}}return[s,u]}function q$(r,t,i,s,u,d,f,g,v,b,T){r.createArrays(),r.tilePixelRatio=_t/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const M=r.layers[0].layout,k=r.layers[0]._unevaluatedLayout._values,I={};if(r.textSizeData.kind==="composite"){const{minZoom:U,maxZoom:J}=r.textSizeData;I.compositeTextSizes=[k["text-size"].possiblyEvaluate(new ve(U),g),k["text-size"].possiblyEvaluate(new ve(J),g)]}if(r.iconSizeData.kind==="composite"){const{minZoom:U,maxZoom:J}=r.iconSizeData;I.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new ve(U),g),k["icon-size"].possiblyEvaluate(new ve(J),g)]}I.layoutTextSize=k["text-size"].possiblyEvaluate(new ve(v+1),g),I.layoutIconSize=k["icon-size"].possiblyEvaluate(new ve(v+1),g),I.textMaxSize=k["text-size"].possiblyEvaluate(new ve(18),g);const R=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",B=M.get("text-size");let j=!1;for(const U of r.features)if(U.icon&&U.icon.nameSecondary){j=!0;break}for(const U of r.features){const J=M.get("text-font").evaluate(U,{},g).join(","),ee=B.evaluate(U,{},g),oe=I.layoutTextSize.evaluate(U,{},g),ue=(I.layoutIconSize.evaluate(U,{},g),{horizontal:{},vertical:void 0}),fe=U.text;let xe,Te=[0,0];if(fe){const Ie=fe.toString(),He=M.get("text-letter-spacing").evaluate(U,{},g)*Ni,lt=M.get("text-line-height").evaluate(U,{},g)*Ni,Ge=C(Ie)?He:0,et=M.get("text-anchor").evaluate(U,{},g),Ue=M.get("text-variable-anchor");if(!Ue){const At=M.get("text-radial-offset").evaluate(U,{},g);Te=At?S3(et,[At*Ni,cS]):M.get("text-offset").evaluate(U,{},g).map(yt=>yt*Ni)}let vt=R?"center":M.get("text-justify").evaluate(U,{},g);const Tt=M.get("symbol-placement")==="point",ot=Tt?M.get("text-max-width").evaluate(U,{},g)*Ni:1/0,Ut=At=>{r.allowVerticalPlacement&&S(Ie)&&(ue.vertical=iS(fe,t,i,u,J,ot,lt,et,At,Ge,Te,Ss.vertical,!0,oe,ee))};if(!R&&Ue){const At=vt==="auto"?Ue.map(Gt=>uS(Gt)):[vt];let yt=!1;for(let Gt=0;Gt<At.length;Gt++){const Lt=At[Gt];if(!ue.horizontal[Lt])if(yt)ue.horizontal[Lt]=ue.horizontal[0];else{const Nt=iS(fe,t,i,u,J,ot,lt,"center",Lt,Ge,Te,Ss.horizontal,!1,oe,ee);Nt&&(ue.horizontal[Lt]=Nt,yt=Nt.positionedLines.length===1)}}Ut("left")}else{if(vt==="auto"&&(vt=uS(et)),Tt||M.get("text-writing-mode").indexOf("horizontal")>=0||!S(Ie)){const At=iS(fe,t,i,u,J,ot,lt,et,vt,Ge,Te,Ss.horizontal,!1,oe,ee);At&&(ue.horizontal[vt]=At)}Ut(Tt?"left":vt)}}let Ae=!1;if(U.icon&&U.icon.namePrimary){const Ie=s[U.icon.namePrimary];Ie&&(xe=N$(u[U.icon.namePrimary],U.icon.nameSecondary?u[U.icon.nameSecondary]:void 0,M.get("icon-offset").evaluate(U,{},g),M.get("icon-anchor").evaluate(U,{},g)),Ae=Ie.sdf,r.sdfIcons===void 0?r.sdfIcons=Ie.sdf:r.sdfIcons!==Ie.sdf&&kr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ie.pixelRatio!==r.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Oe=E3(ue.horizontal)||ue.vertical;r.iconsInText||(r.iconsInText=!!Oe&&Oe.iconsInText),(Oe||xe)&&H$(r,U,ue,xe,s,I,oe,0,Te,Ae,f,g,b,T,j)}d&&r.generateCollisionDebugBuffers(v,r.collisionBoxArray)}function uS(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function H$(r,t,i,s,u,d,f,g,v,b,T,M,k,I,R){let B=d.textMaxSize.evaluate(t,{},M);B===void 0&&(B=f);const j=r.layers[0].layout,U=j.get("icon-offset").evaluate(t,{},M),J=E3(i.horizontal)||i.vertical,ee=k.name==="globe",oe=Ni,ue=f/oe,fe=r.tilePixelRatio*B/oe,xe=(et=r.overscaling,r.zoom>18&&et>2&&(et>>=1),Math.max(_t/(512*et),1)*j.get("symbol-spacing")),Te=j.get("text-padding")*r.tilePixelRatio,Ae=j.get("icon-padding")*r.tilePixelRatio,Oe=st(j.get("text-max-angle")),Ie=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",He=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",lt=j.get("symbol-placement"),Ge=xe/2;var et;const Ue=j.get("icon-text-fit").evaluate(t,{},M),vt=j.get("icon-text-fit-padding").evaluate(t,{},M),Tt=Ue!=="none";let ot;r.hasAnyIconTextFit===!1&&Tt&&(r.hasAnyIconTextFit=!0),s&&Tt&&(r.allowVerticalPlacement&&i.vertical&&(ot=h3(s,i.vertical,Ue,vt,U,ue)),J&&(s=h3(s,J,Ue,vt,U,ue)));const Ut=(At,yt,Gt)=>{if(yt.x<0||yt.x>=_t||yt.y<0||yt.y>=_t)return;let Lt=null;if(ee){const{x:Nt,y:ft,z:Kt}=k.projectTilePoint(yt.x,yt.y,Gt);Lt={anchor:new sc(Nt,ft,Kt,0,void 0),up:k.upVector(Gt,yt.x,yt.y)}}(function(Nt,ft,Kt,vr,rr,mr,zr,nn,sr,dn,on,Vr,Wr,Rr,Pn,fn,jn,_i,wo,Wn,Ln,Qi,eo,So,pn,Ca,gf){const lc=Nt.addToLineVertexArray(ft,vr);let cc,og,sg,ev,Wz,qz,Hz,Zz=0,Xz=0,Yz=0,Kz=0,FS=-1,NS=-1;const pl={};let Jz=sw("");const Mh=Kt?Kt.anchor:ft,jS=sr.layout.get("icon-text-fit").evaluate(Ln,{},pn)!=="none";let VS=0,$S=0;if(sr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[VS,$S]=sr.layout.get("text-offset").evaluate(Ln,{},pn).map(Ko=>Ko*Ni):(VS=sr.layout.get("text-radial-offset").evaluate(Ln,{},pn)*Ni,$S=cS),Nt.allowVerticalPlacement&&rr.vertical){const Ko=rr.vertical;if(Pn)qz=hS(Ko),nn&&(Hz=hS(nn));else{const Jo=sr.layout.get("text-rotate").evaluate(Ln,{},pn)+90;sg=I0(dn,Mh,ft,on,Vr,Wr,Ko,Rr,Jo,fn),nn&&(ev=I0(dn,Mh,ft,on,Vr,Wr,nn,_i,Jo))}}if(mr){const Ko=sr.layout.get("icon-rotate").evaluate(Ln,{},pn),Jo=b3(mr,Ko,eo,jS),_f=nn?b3(nn,Ko,eo,jS):void 0;og=I0(dn,Mh,ft,on,Vr,Wr,mr,_i,Ko),Zz=4*Jo.length;const Qz=Nt.iconSizeData;let Ah=null;Qz.kind==="source"?(Ah=[wa*sr.layout.get("icon-size").evaluate(Ln,{},pn)],Ah[0]>ru&&kr(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${Vm}. Reduce your "icon-size".`)):Qz.kind==="composite"&&(Ah=[wa*Qi.compositeIconSizes[0].evaluate(Ln,{},pn),wa*Qi.compositeIconSizes[1].evaluate(Ln,{},pn)],(Ah[0]>ru||Ah[1]>ru)&&kr(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${Vm}. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,Jo,Ah,Wn,wo,Ln,!1,Kt,ft,lc.lineStartIndex,lc.lineLength,-1,So,pn,Ca,gf),FS=Nt.icon.placedSymbolArray.length-1,_f&&(Xz=4*_f.length,Nt.addSymbols(Nt.icon,_f,Ah,Wn,wo,Ln,Ss.vertical,Kt,ft,lc.lineStartIndex,lc.lineLength,-1,So,pn,Ca,gf),NS=Nt.icon.placedSymbolArray.length-1)}for(const Ko in rr.horizontal){const Jo=rr.horizontal[Ko];cc||(Jz=sw(Jo.text),Pn?Wz=hS(Jo):cc=I0(dn,Mh,ft,on,Vr,Wr,Jo,Rr,sr.layout.get("text-rotate").evaluate(Ln,{},pn),fn));const _f=Jo.positionedLines.length===1;if(Yz+=T3(Nt,Kt,ft,Jo,zr,sr,Pn,Ln,fn,lc,rr.vertical?Ss.horizontal:Ss.horizontalOnly,_f?Object.keys(rr.horizontal):[Ko],pl,FS,Qi,So,pn,Ca),_f)break}rr.vertical&&(Kz+=T3(Nt,Kt,ft,rr.vertical,zr,sr,Pn,Ln,fn,lc,Ss.vertical,["vertical"],pl,NS,Qi,So,pn,Ca));let uu=-1;const US=(Ko,Jo)=>Ko?Math.max(Ko,Jo):Jo;uu=US(Wz,uu),uu=US(qz,uu),uu=US(Hz,uu);const l7=uu>-1?1:0;Nt.glyphOffsetArray.length>=qm.MAX_GLYPHS&&kr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ln.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,Ln.sortKey),Nt.symbolInstances.emplaceBack(ft.x,ft.y,Mh.x,Mh.y,Mh.z,pl.right>=0?pl.right:-1,pl.center>=0?pl.center:-1,pl.left>=0?pl.left:-1,pl.vertical>=0?pl.vertical:-1,FS,NS,Jz,cc!==void 0?cc:Nt.collisionBoxArray.length,cc!==void 0?cc+1:Nt.collisionBoxArray.length,sg!==void 0?sg:Nt.collisionBoxArray.length,sg!==void 0?sg+1:Nt.collisionBoxArray.length,og!==void 0?og:Nt.collisionBoxArray.length,og!==void 0?og+1:Nt.collisionBoxArray.length,ev||Nt.collisionBoxArray.length,ev?ev+1:Nt.collisionBoxArray.length,on,Yz,Kz,Zz,Xz,l7,0,VS,$S,uu,0,jS?1:0)})(r,yt,Lt,At,i,s,u,ot,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,Te,Ie,v,0,Ae,He,U,t,d,b,T,M,I,R)};if(lt==="line")for(const At of _3(t.geometry,0,0,_t,_t)){const yt=V$(At,xe,Oe,i.vertical||J,s,oe,fe,r.overscaling,_t);for(const Gt of yt)J&&Z$(r,J.text,Ge,Gt)||Ut(At,Gt,M)}else if(lt==="line-center"){for(const At of t.geometry)if(At.length>1){const yt=j$(At,Oe,i.vertical||J,s,oe,fe);yt&&Ut(At,yt,M)}}else if(t.type==="Polygon")for(const At of Yw(t.geometry,0)){const yt=U$(At,16);Ut(At[0],new sc(yt.x,yt.y,0,0,void 0),M)}else if(t.type==="LineString")for(const At of t.geometry)Ut(At,new sc(At[0].x,At[0].y,0,0,void 0),M);else if(t.type==="Point")for(const At of t.geometry)for(const yt of At)Ut([yt],new sc(yt.x,yt.y,0,0,void 0),M)}const Vm=255,ru=Vm*wa;function T3(r,t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j,U){const J=function(ue,fe,xe,Te,Ae,Oe,Ie,He){const lt=[];if(fe.positionedLines.length===0)return lt;const Ge=Te.layout.get("text-rotate").evaluate(Oe,{})*Math.PI/180,et=function(Ut){const At=Ut[0],yt=Ut[1],Gt=At*yt;return Gt>0?[At,-yt]:Gt<0?[-At,yt]:At===0?[yt,At]:[yt,-At]}(xe);let Ue=Math.abs(fe.top-fe.bottom);for(const Ut of fe.positionedLines)Ue-=Ut.lineOffset;const vt=fe.positionedLines.length,Tt=Ue/vt;let ot=fe.top-xe[1];for(let Ut=0;Ut<vt;++Ut){const At=fe.positionedLines[Ut];ot=$$(fe,Tt,ot,Ut);for(const yt of At.positionedGlyphs){if(!yt.rect)continue;const Gt=yt.rect||{};let Lt=i3+1,Nt=!0,ft=1,Kt=0;if(yt.imageName){const Wn=Ie[yt.imageName];if(!Wn)continue;if(Wn.sdf){kr("SDF images are not supported in formatted text and will be ignored.");continue}Nt=!1,ft=Wn.pixelRatio,Lt=Yo/ft}const vr=(Ae||He)&&yt.vertical,rr=yt.metrics.advance*yt.scale/2,mr=yt.metrics,zr=yt.rect;if(zr===null)continue;He&&fe.verticalizable&&(Kt=yt.imageName?rr-yt.metrics.width*yt.scale/2:0);const nn=Ae?[yt.x+rr,yt.y]:[0,0];let sr=[0,0],dn=[0,0],on=!1;Ae||(vr?(dn=[yt.x+rr+et[0],yt.y+et[1]-Kt],on=!0):sr=[yt.x+rr+xe[0],yt.y+xe[1]-Kt]);const Vr=zr.w*yt.scale/(ft*(yt.localGlyph?Sa:1)),Wr=zr.h*yt.scale/(ft*(yt.localGlyph?Sa:1));let Rr,Pn,fn,jn;if(vr){const Wn=yt.y-ot,Ln=new Pe(-rr,rr-Wn),Qi=-Math.PI/2,eo=new Pe(...dn);Rr=new Pe(-rr+sr[0],sr[1]),Rr._rotateAround(Qi,Ln)._add(eo),Rr.x+=-Wn+rr,Rr.y-=(mr.left-Lt)*yt.scale;const So=yt.imageName?mr.advance*yt.scale:Ni*yt.scale,pn=String.fromCodePoint(yt.glyph);z$(pn)?Rr.x+=(1-Lt)*yt.scale:R$(pn)?Rr.x+=So-mr.height*yt.scale+(-Lt-1)*yt.scale:Rr.x+=yt.imageName||mr.width+2*Lt===zr.w&&mr.height+2*Lt===zr.h?(So-Wr)/2:(So-(mr.height+2*Lt)*yt.scale)/2,Pn=new Pe(Rr.x,Rr.y-Vr),fn=new Pe(Rr.x+Wr,Rr.y),jn=new Pe(Rr.x+Wr,Rr.y-Vr)}else{const Wn=(mr.left-Lt)*yt.scale-rr+sr[0],Ln=(-mr.top-Lt)*yt.scale+sr[1],Qi=Wn+Vr,eo=Ln+Wr;Rr=new Pe(Wn,Ln),Pn=new Pe(Qi,Ln),fn=new Pe(Wn,eo),jn=new Pe(Qi,eo)}if(Ge){let Wn;Wn=Ae?new Pe(0,0):on?new Pe(et[0],et[1]):new Pe(xe[0],xe[1]),Rr._rotateAround(Ge,Wn),Pn._rotateAround(Ge,Wn),fn._rotateAround(Ge,Wn),jn._rotateAround(Ge,Wn)}const _i=new Pe(0,0),wo=new Pe(0,0);lt.push({tl:Rr,tr:Pn,bl:fn,br:jn,texPrimary:Gt,texSecondary:void 0,writingMode:fe.writingMode,glyphOffset:nn,sectionIndex:yt.sectionIndex,isSDF:Nt,pixelOffsetTL:_i,pixelOffsetBR:wo,minFontScaleX:0,minFontScaleY:0})}}return lt}(0,s,v,d,f,g,u,r.allowVerticalPlacement),ee=r.textSizeData;let oe=null;ee.kind==="source"?(oe=[wa*d.layout.get("text-size").evaluate(g,{},j)],oe[0]>ru&&kr(`${r.layerIds[0]}: Value for "text-size" is >= ${Vm}. Reduce your "text-size".`)):ee.kind==="composite"&&(oe=[wa*R.compositeTextSizes[0].evaluate(g,{},j),wa*R.compositeTextSizes[1].evaluate(g,{},j)],(oe[0]>ru||oe[1]>ru)&&kr(`${r.layerIds[0]}: Value for "text-size" is >= ${Vm}. Reduce your "text-size".`)),r.addSymbols(r.text,J,oe,v,f,g,T,t,i,b.lineStartIndex,b.lineLength,I,B,j,U,!1);for(const ue of M)k[ue]=r.text.placedSymbolArray.length-1;return 4*J.length}function E3(r){for(const t in r)return r[t];return null}function I0(r,t,i,s,u,d,f,g,v,b){let T=f.top,M=f.bottom,k=f.left,I=f.right;const R=f.collisionPadding;if(R&&(k-=R[0],T-=R[1],I+=R[2],M+=R[3]),v){const B=new Pe(k,T),j=new Pe(I,T),U=new Pe(k,M),J=new Pe(I,M),ee=st(v);let oe=new Pe(0,0);b&&(oe=new Pe(b[0],b[1])),B._rotateAround(ee,oe),j._rotateAround(ee,oe),U._rotateAround(ee,oe),J._rotateAround(ee,oe),k=Math.min(B.x,j.x,U.x,J.x),I=Math.max(B.x,j.x,U.x,J.x),T=Math.min(B.y,j.y,U.y,J.y),M=Math.max(B.y,j.y,U.y,J.y)}return r.emplaceBack(t.x,t.y,t.z,i.x,i.y,k,T,I,M,g,s,u,d),r.length-1}function hS(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const t=r.bottom-r.top;return t>0?Math.max(10,t):null}function Z$(r,t,i,s){const u=r.compareText;if(t in u){const d=u[t];for(let f=d.length-1;f>=0;f--)if(s.dist(d[f])<i)return!0}else u[t]=[];return u[t].push(s),!1}function C3(r,t){const i=r.fovAboveCenter,s=r.elevation?r.elevation.getMinElevationBelowMSL()*t:0,u=(r._camera.position[2]*r.worldSize-s)/Math.cos(r._pitch),d=Math.sin(i)*u/Math.sin(Math.max(Math.PI/2-r._pitch-i,.01)),f=Math.sin(r._pitch)*d+u;return Math.min(1.01*f,u*(1/r._horizonShift))}function nu(r,t){if(!t.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:t};const i=Math.pow(2,-r.z),s=r.x*i,u=(r.x+1)*i,d=r.y*i,f=(r.y+1)*i,g=Xo(s),v=Xo(u),b=Fi(d),T=Fi(f),M=t.project(g,b),k=t.project(v,b),I=t.project(v,T),R=t.project(g,T);let B=Math.min(M.x,k.x,I.x,R.x),j=Math.min(M.y,k.y,I.y,R.y),U=Math.max(M.x,k.x,I.x,R.x),J=Math.max(M.y,k.y,I.y,R.y);const ee=i/16;function oe(fe,xe,Te,Ae,Oe,Ie){const He=(Te+Oe)/2,lt=(Ae+Ie)/2,Ge=t.project(Xo(He),Fi(lt)),et=Math.max(0,B-Ge.x,j-Ge.y,Ge.x-U,Ge.y-J);B=Math.min(B,Ge.x),U=Math.max(U,Ge.x),j=Math.min(j,Ge.y),J=Math.max(J,Ge.y),et>ee&&(oe(fe,Ge,Te,Ae,He,lt),oe(Ge,xe,He,lt,Oe,Ie))}oe(M,k,s,d,u,d),oe(k,I,u,d,u,f),oe(I,R,u,f,s,f),oe(R,M,s,f,s,d),B-=ee,j-=ee,U+=ee,J+=ee;const ue=1/Math.max(U-B,J-j);return{scale:ue,x:B*ue,y:j*ue,x2:U*ue,y2:J*ue,projection:t}}function M3(r,{x:t,y:i},s=0){return new Pe(((t-s)*r.scale-r.x)*_t,(i*r.scale-r.y)*_t)}const X$=a.m.identity(new Float32Array(16));class iu{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new jr(0,0)}projectTilePoint(t,i,s){return{x:t,y:i,z:0}}locationPoint(t,i,s=!0){return t._coordinatePoint(t.locationCoordinate(i),s)}pixelsPerMeter(t,i){return bo(1,t)*i}pixelSpaceConversion(t,i,s){return 1}farthestPixelDistance(t){return C3(t,t.pixelsPerMeter)}pointCoordinate(t,i,s,u){const d=t.horizonLineFromTop(!1),f=new Pe(i,Math.max(d,s));return t.rayIntersectionCoordinate(t.pointRayIntersection(f,u))}pointCoordinate3D(t,i,s){const u=new Pe(i,s);if(t.elevation)return t.elevation.pointCoordinate(u);{const d=this.pointCoordinate(t,u.x,u.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const s=t.horizonLineFromTop();return i.y<s}createInversionMatrix(t,i){return X$}createTileMatrix(t,i,s){let u,d,f;const g=s.canonical,v=a.m.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=nu(g,this);u=1,d=b.x+s.wrap*b.scale,f=b.y,a.m.scale(v,v,[u/b.scale,u/b.scale,t.pixelsPerMeter/i])}else u=i/t.zoomScale(g.z),d=(g.x+Math.pow(2,g.z)*s.wrap)*u,f=g.y*u;return a.m.translate(v,v,[d,f,0]),a.m.scale(v,v,[u/_t,u/_t,1]),v}upVector(t,i,s){return[0,0,1]}upVectorScale(t,i,s){return{metersToTile:1}}}class Y$ extends iu{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,s]=this.parallels=t.parallels||[29.5,45.5],u=Math.sin(st(i));this.n=(u+Math.sin(st(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:s,c:u,r0:d}=this,f=st(t-this.center[0]),g=st(i),v=Math.sqrt(u-2*s*Math.sin(g))/s;return{x:v*Math.sin(f*s),y:v*Math.cos(f*s)-d,z:0}}unproject(t,i){const{n:s,c:u,r0:d}=this,f=d+i;let g=Math.atan2(t,Math.abs(f))*Math.sign(f);f*s<0&&(g-=Math.PI*Math.sign(t)*Math.sign(f));const v=st(this.center[0])*s;g=qt(g,-Math.PI-v,Math.PI-v);const b=ct(ar(g/s)+this.center[0],-180,180),T=Math.asin(ct((u-(t*t+f*f)*s*s)/(2*s),-1,1)),M=ct(ar(T),-Nn,Nn);return new jr(b,M)}}const $m=1.340264,Um=-.081106,Gm=893e-6,Wm=.003796,z0=Math.sqrt(3)/2;class K$ extends iu{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const s=Math.asin(z0*Math.sin(i)),u=s*s,d=u*u*u;return{x:.5*(t*Math.cos(s)/(z0*($m+3*Um*u+d*(7*Gm+9*Wm*u)))/Math.PI+.5),y:1-.5*(s*($m+Um*u+d*(Gm+Wm*u))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,u=s*s,d=u*u*u;for(let T,M,k,I=0;I<12&&(M=s*($m+Um*u+d*(Gm+Wm*u))-i,k=$m+3*Um*u+d*(7*Gm+9*Wm*u),T=M/k,s=ct(s-T,-Math.PI/3,Math.PI/3),u=s*s,d=u*u*u,!(Math.abs(T)<1e-12));++I);const f=z0*t*($m+3*Um*u+d*(7*Gm+9*Wm*u))/Math.cos(s),g=Math.asin(Math.sin(s)/z0),v=ct(180*f/Math.PI,-180,180),b=ct(180*g/Math.PI,-Nn,Nn);return new jr(v,b)}}class J$ extends iu{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const s=360*(t-.5),u=ct(360*(.5-i),-Nn,Nn);return new jr(s,u)}}const ff=Math.PI/2;function R0(r){return Math.tan((ff+r)/2)}class Q$ extends iu{constructor(t){super(t),this.center=t.center||[0,30];const[i,s]=this.parallels=t.parallels||[30,30];let u=st(i),d=st(s);this.southernCenter=u+d<0,this.southernCenter&&(u=-u,d=-d);const f=Math.cos(u),g=R0(u);this.n=u===d?Math.sin(u):Math.log(f/Math.cos(d))/Math.log(R0(d)/g),this.f=f*Math.pow(R0(u),this.n)/this.n}project(t,i){i=st(i),this.southernCenter&&(i=-i),t=st(t-this.center[0]);const s=1e-6,{n:u,f:d}=this;d>0?i<-ff+s&&(i=-ff+s):i>ff-s&&(i=ff-s);const f=d/Math.pow(R0(i),u);let g=f*Math.sin(u*t),v=d-f*Math.cos(u*t);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:s,f:u}=this,d=u-i,f=Math.sign(d),g=Math.sign(s)*Math.sqrt(t*t+d*d);let v=Math.atan2(t,Math.abs(d))*f;d*s<0&&(v-=Math.PI*Math.sign(t)*f);const b=ct(ar(v/s)+this.center[0],-180,180),T=ct(ar(2*Math.atan(Math.pow(u/g,1/s))-ff),-Nn,Nn);return new jr(b,this.southernCenter?-T:T)}}class A3 extends iu{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:cl(t),y:ul(i),z:0}}unproject(t,i){const s=Xo(t),u=Fi(i);return new jr(s,u)}}const k3=st(Nn);class eU extends iu{project(t,i){const s=(i=st(i))*i,u=s*s;return{x:.5*((t=st(t))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,u=25,d=0,f=s*s;do{f=s*s;const b=f*f;d=(s*(1.007226+f*(.015085+b*(.028874*f-.044475-.005916*b)))-i)/(1.007226+f*(.045255+b*(.259866*f-.311325-.005916*11*b))),s=ct(s-d,-k3,k3)}while(Math.abs(d)>1e-6&&--u>0);f=s*s;const g=ct(ar(t/(.8707+f*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979))),-180,180),v=ar(s);return new jr(g,v)}}const P3=st(Nn);class tU extends iu{project(t,i){i=st(i),t=st(t);const s=Math.cos(i),u=2/Math.PI,d=Math.acos(s*Math.cos(t/2)),f=Math.sin(d)/d,g=.5*(t*u+2*s*Math.sin(t/2)/f)||0,v=.5*(i+Math.sin(i)/f)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(t,i){let s=t=(2*t-.5)*Math.PI,u=i=(2*(1-i)-1)*Math.PI,d=25;const f=1e-6;let g=0,v=0;do{const b=Math.cos(u),T=Math.sin(u),M=2*T*b,k=T*T,I=b*b,R=Math.cos(s/2),B=Math.sin(s/2),j=2*R*B,U=B*B,J=1-I*R*R,ee=J?1/J:0,oe=J?Math.acos(b*R)*Math.sqrt(1/J):0,ue=.5*(2*oe*b*B+2*s/Math.PI)-t,fe=.5*(oe*T+u)-i,xe=.5*ee*(I*U+oe*b*R*k)+1/Math.PI,Te=ee*(j*M/4-oe*T*B),Ae=.125*ee*(M*B-oe*T*I*j),Oe=.5*ee*(k*R+oe*U*b)+.5,Ie=Te*Ae-Oe*xe;g=(fe*Te-ue*Oe)/Ie,v=(ue*Ae-fe*xe)/Ie,s=ct(s-g,-Math.PI,Math.PI),u=ct(u-v,-P3,P3)}while((Math.abs(g)>f||Math.abs(v)>f)&&--d>0);return new jr(ar(s),ar(u))}}class I3 extends iu{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(st(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:s,cosPhi:u}=this;return{x:st(t)*u*s+.5,y:-Math.sin(st(i))/u*s+.5,z:0}}unproject(t,i){const{scale:s,cosPhi:u}=this,d=-(i-.5)/s,f=ct(ar((t-.5)/s)/u,-180,180),g=Math.asin(ct(d*u,-1,1)),v=ct(ar(g),-Nn,Nn);return new jr(f,v)}}class rU extends A3{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,s){const u=zm(t,i,s),d=Rm(ll(s));return a.v.transformMat4(u,u,d),{x:u[0],y:u[1],z:u[2]}}locationPoint(t,i){const s=yh(i.lat,i.lng),u=a.v.normalize([],s),d=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude,f=bo(1,0)*_t*d;a.v.scaleAndAdd(s,s,u,f);const g=a.m.identity(new Float64Array(16));return a.m.multiply(g,t.pixelMatrix,t.globeMatrix),a.v.transformMat4(s,s,g),new Pe(s[0],s[1])}pixelsPerMeter(t,i){return bo(1,0)*i}pixelSpaceConversion(t,i,s){const u=bo(1,t)*i,d=ur(bo(1,45)*i,u,s);return this.pixelsPerMeter(t,i)/d}createTileMatrix(t,i,s){const u=Rw(ll(s.canonical));return a.m.multiply(new Float64Array(16),t.globeMatrix,u)}createInversionMatrix(t,i){const{center:s}=t,u=Rm(ll(i));return a.m.rotateY(u,u,st(s.lng)),a.m.rotateX(u,u,st(s.lat)),a.m.scale(u,u,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(t,i,s,u){return aI(t,i,s,!0)||new Gi(0,0)}pointCoordinate3D(t,i,s){const u=this.pointCoordinate(t,i,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(t,i){return!aI(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(u,d){const f=u.cameraToCenterDistance,g=u._centerAltitude*d,v=u._camera,b=u._camera.forward(),T=a.v.add([],a.v.scale([],b,-f),[0,0,g]),M=u.worldSize/(2*Math.PI),k=[0,0,-M],I=u.width/u.height,R=Math.tan(u.fovAboveCenter),B=a.v.scale([],v.up(),R),j=a.v.scale([],v.right(),R*I),U=a.v.normalize([],a.v.add([],a.v.add([],b,B),j)),J=[];let ee;if(new Cw(T,U).closestPointOnSphere(k,M,J)){const oe=a.v.add([],J,k),ue=a.v.sub([],oe,T);ee=Math.cos(u.fovAboveCenter)*a.v.length(ue)}else{const oe=a.v.sub([],T,k),ue=a.v.sub([],k,T);a.v.normalize(ue,ue);const fe=a.v.length(oe)-M;ee=Math.sqrt(fe*(fe+2*M));const xe=Math.acos(ee/(M+fe))-Math.acos(a.v.dot(b,ue));ee*=Math.cos(xe)}return 1.01*ee}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),s=nc(t.zoom);if(s>0){const u=C3(t,bo(1,t.center.lat)*t.worldSize),d=t.worldSize/(2*Math.PI),f=Math.max(t.width,t.height)/t.worldSize*Math.PI;return ur(i,u+d*(1-Math.cos(f)),Math.pow(s,10))}return i}upVector(t,i,s){return zm(i,s,t,1)}upVectorScale(t){return{metersToTile:o0(a0(ll(t)))}}}function z3(r){const t=r.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(r.name){case"mercator":return new A3(r);case"equirectangular":return new J$(r);case"naturalEarth":return new eU(r);case"equalEarth":return new K$(r);case"winkelTripel":return new tU(r);case"albers":return i?new I3(r):new Y$(r);case"lambertConformalConic":return i?new I3(r):new Q$(r);case"globe":return new rU(r)}throw new Error(`Invalid projection name: ${r.name}`)}const nU=new Ke({"symbol-placement":new he(ze.layout_symbol["symbol-placement"]),"symbol-spacing":new he(ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new he(ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ke(ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new he(ze.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new he(ze.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new he(ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new he(ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new he(ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new he(ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new ke(ze.layout_symbol["icon-size"]),"icon-text-fit":new ke(ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ke(ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new ke(ze.layout_symbol["icon-image"]),"icon-rotate":new ke(ze.layout_symbol["icon-rotate"]),"icon-padding":new he(ze.layout_symbol["icon-padding"]),"icon-keep-upright":new he(ze.layout_symbol["icon-keep-upright"]),"icon-offset":new ke(ze.layout_symbol["icon-offset"]),"icon-anchor":new ke(ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new he(ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new he(ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new he(ze.layout_symbol["text-rotation-alignment"]),"text-field":new ke(ze.layout_symbol["text-field"]),"text-font":new ke(ze.layout_symbol["text-font"]),"text-size":new ke(ze.layout_symbol["text-size"]),"text-max-width":new ke(ze.layout_symbol["text-max-width"]),"text-line-height":new ke(ze.layout_symbol["text-line-height"]),"text-letter-spacing":new ke(ze.layout_symbol["text-letter-spacing"]),"text-justify":new ke(ze.layout_symbol["text-justify"]),"text-radial-offset":new ke(ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new he(ze.layout_symbol["text-variable-anchor"]),"text-anchor":new ke(ze.layout_symbol["text-anchor"]),"text-max-angle":new he(ze.layout_symbol["text-max-angle"]),"text-writing-mode":new he(ze.layout_symbol["text-writing-mode"]),"text-rotate":new ke(ze.layout_symbol["text-rotate"]),"text-padding":new he(ze.layout_symbol["text-padding"]),"text-keep-upright":new he(ze.layout_symbol["text-keep-upright"]),"text-transform":new ke(ze.layout_symbol["text-transform"]),"text-offset":new ke(ze.layout_symbol["text-offset"]),"text-allow-overlap":new he(ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new he(ze.layout_symbol["text-ignore-placement"]),"text-optional":new he(ze.layout_symbol["text-optional"]),visibility:new he(ze.layout_symbol.visibility)});var dS={paint:new Ke({"icon-opacity":new ke(ze.paint_symbol["icon-opacity"]),"icon-emissive-strength":new ke(ze.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ke(ze.paint_symbol["text-emissive-strength"]),"icon-color":new ke(ze.paint_symbol["icon-color"]),"icon-halo-color":new ke(ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new ke(ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ke(ze.paint_symbol["icon-halo-blur"]),"icon-translate":new he(ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new he(ze.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ke(ze.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ke(ze.paint_symbol["text-opacity"]),"text-color":new ke(ze.paint_symbol["text-color"],{runtimeType:mo,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ke(ze.paint_symbol["text-halo-color"]),"text-halo-width":new ke(ze.paint_symbol["text-halo-width"]),"text-halo-blur":new ke(ze.paint_symbol["text-halo-blur"]),"text-translate":new he(ze.paint_symbol["text-translate"]),"text-translate-anchor":new he(ze.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new he(ze.paint_symbol["icon-color-saturation"])}),layout:nU};class R3{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:da,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ct(R3,"FormatSectionOverride",{omit:["defaultValue"]});class D0 extends St{constructor(t,i,s){super(t,dS,i,s)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const d of s)u.indexOf(d)<0&&u.push(d);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,s,u){const d=this.layout.get(t).evaluate(i,{},s,u),f=this._unevaluatedLayout._values[t];return f.isDataDriven()||jd(f.value)||!d?d:function(g,v){return v.replace(/{([^{}]+)}/g,(b,T)=>T in g?String(g[T]):"")}(i.properties,d)}createBucket(t){return new qm(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of dS.paint.overridableProperties){if(!D0.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),s=new R3(i),u=new pm(s,i.property.specification,this.scope,this.options);let d=null;d=i.value.kind==="constant"||i.value.kind==="source"?new sh("source",u):new ah("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new Fe(i.property,d,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&D0.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const s=t.get("text-field"),u=dS.paint.properties[i];let d=!1;const f=g=>{for(const v of g)if(u.overrides&&u.overrides.hasOverride(v))return void(d=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Li)f(s.value.value.sections);else if(s.value.kind==="source"){const g=b=>{d||(b instanceof Re&&Fn(b.value)===Bs?f(b.value.sections):b instanceof cn?f(b.sections):b.eachChild(g))},v=s.value;v._styleExpression&&g(v._styleExpression.expression)}return d}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,s=[];return t&&s.push("symbolIcon"),i&&s.push("symbolSDF"),s}getDefaultProgramParams(t,i){return{config:new ph(this,i),overrideFog:!1}}}const iU=x0.types,oU=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function L0(r,t,i,s,u,d,f,g,v,b,T,M,k){const I=g?Math.min(ru,Math.round(g[0])):0,R=g?Math.min(ru,Math.round(g[1])):0;r.emplaceBack(t,i,Math.round(32*s),Math.round(32*u),d,f,(I<<1)+(v?1:0),R,16*b,16*T,256*M,256*k)}function O0(r,t,i){r.emplaceBack(t,i)}function B0(r,t,i,s,u,d,f){r.emplaceBack(t,i,s,u,d,f)}function F0(r,t,i,s,u){r.emplaceBack(t,i,s,u),r.emplaceBack(t,i,s,u),r.emplaceBack(t,i,s,u),r.emplaceBack(t,i,s,u)}function sU(r){for(const t of r.sections)if(G(t.text))return!0;return!1}class fS{constructor(t){this.layoutVertexArray=new pi,this.indexArray=new Zr,this.programConfigurations=t,this.segments=new wn,this.dynamicLayoutVertexArray=new Nr,this.opacityVertexArray=new Oi,this.placedSymbolArray=new Ek,this.iconTransitioningVertexArray=new Ji,this.globeExtVertexArray=new an,this.zOffsetVertexArray=new ya}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,i,s,u,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,w$.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,T$.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,oU,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,C$.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,S$.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,E$.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Ct(fS,"SymbolBuffers");class pS{constructor(t,i,s){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new s,this.segments=new wn,this.collisionVertexArray=new _s,this.collisionVertexArrayExt=new Nr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,M$.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,A$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ct(pS,"CollisionBuffers");class N0{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=a.m.identity([]),this.placementViewportMatrix=a.m.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rS(this.zoom,i["text-size"]),this.iconSizeData=rS(this.zoom,i["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),d=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(f=>Ss[f]),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=s.get("symbol-z-elevate")}createArrays(){this.text=new fS(new Xc(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new fS(new Xc(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Ak,this.lineVertexArray=new kk,this.symbolInstances=new Mk}calculateGlyphDependencies(t,i,s,u,d){for(let f=0;f<t.length;f++){const g=t.codePointAt(f);if(g===void 0)break;if(i[g]=!0,u&&d&&g<=65535){const v=Fm[t.charAt(f)];v&&(i[v.charCodeAt(0)]=!0)}}}populate(t,i,s,u){const d=this.layers[0],f=d.layout,g=this.projection.name==="globe",v=f.get("text-font"),b=f.get("text-field"),T=f.get("icon-image"),M=(b.value.kind!=="constant"||b.value.value instanceof Li&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),k=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,I=f.get("symbol-sort-key");if(this.features=[],!M&&!k)return;const R=i.iconDependencies,B=i.glyphDependencies,j=i.availableImages,U=new ve(this.zoom);for(const{feature:J,id:ee,index:oe,sourceLayerIndex:ue}of t){const fe=d._featureFilter.needGeometry,xe=Qc(J,fe);if(!d._featureFilter.filter(U,xe,s))continue;if(fe||(xe.geometry=hl(J,s,u)),g&&J.type!==1&&s.z<=5){const Ie=xe.geometry,He=.98078528056,lt=(Ge,et)=>{const Ue=zm(Ge.x,Ge.y,s,1),vt=zm(et.x,et.y,s,1);return a.v.dot(Ue,vt)<He};for(let Ge=0;Ge<Ie.length;Ge++)Ie[Ge]=_V(Ie[Ge],lt)}let Te,Ae;if(M){const Ie=d.getValueAndResolveTokens("text-field",xe,s,j),He=Li.factory(Ie);sU(He)&&(this.hasRTLText=!0),(!this.hasRTLText||ce()==="unavailable"||this.hasRTLText&&we.isParsed())&&(Te=I$(He,d,xe))}if(k){const Ie=d.getValueAndResolveTokens("icon-image",xe,s,j);Ae=Ie instanceof Yi?Ie:Yi.fromString(Ie)}if(!Te&&!Ae)continue;const Oe=this.sortFeaturesByKey?I.evaluate(xe,{},s):void 0;if(this.features.push({id:ee,text:Te,icon:Ae,index:oe,sourceLayerIndex:ue,geometry:xe.geometry,properties:J.properties,type:iU[J.type],sortKey:Oe}),Ae&&(R[Ae.namePrimary]=!0,Ae.nameSecondary&&(R[Ae.nameSecondary]=!0)),Te){const Ie=v.evaluate(xe,{},s).join(","),He=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ss.vertical)>=0;for(const lt of Te.sections)if(lt.image)R[lt.image.namePrimary]=!0;else{const Ge=S(Te.toString()),et=lt.fontStack||Ie,Ue=B[et]=B[et]||{};this.calculateGlyphDependencies(lt.text,Ue,He,this.allowVerticalPlacement,Ge)}}}f.get("symbol-placement")==="line"&&(this.features=function(J){const ee={},oe={},ue=[];let fe=0;function xe(Ie){ue.push(J[Ie]),fe++}function Te(Ie,He,lt){const Ge=oe[Ie];return delete oe[Ie],oe[He]=Ge,ue[Ge].geometry[0].pop(),ue[Ge].geometry[0]=ue[Ge].geometry[0].concat(lt[0]),Ge}function Ae(Ie,He,lt){const Ge=ee[He];return delete ee[He],ee[Ie]=Ge,ue[Ge].geometry[0].shift(),ue[Ge].geometry[0]=lt[0].concat(ue[Ge].geometry[0]),Ge}function Oe(Ie,He,lt){const Ge=lt?He[0][He[0].length-1]:He[0][0];return`${Ie}:${Ge.x}:${Ge.y}`}for(let Ie=0;Ie<J.length;Ie++){const He=J[Ie],lt=He.geometry,Ge=He.text?He.text.toString():null;if(!Ge){xe(Ie);continue}const et=Oe(Ge,lt),Ue=Oe(Ge,lt,!0);if(et in oe&&Ue in ee&&oe[et]!==ee[Ue]){const vt=Ae(et,Ue,lt),Tt=Te(et,Ue,ue[vt].geometry);delete ee[et],delete oe[Ue],oe[Oe(Ge,ue[Tt].geometry,!0)]=Tt,ue[vt].geometry=null}else et in oe?Te(et,Ue,lt):Ue in ee?Ae(et,Ue,lt):(xe(Ie),ee[et]=fe-1,oe[Ue]=fe-1)}return ue.filter(Ie=>Ie.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,ee)=>J.sortKey-ee.sortKey)}update(t,i,s,u,d){const f=Object.keys(t).length!==0;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,i,g,s,u,d),this.icon.programConfigurations.updatePaintArrays(t,i,g,s,u,d)}updateZOffset(){const t=(d,f,g)=>{s+=f,s>d.length&&d.resize(s);for(let v=-f;v<0;v++)d.emplace(v+s,g)},i=(d,f,g)=>{u+=f,u>d.length&&d.resize(u);for(let v=-f;v<0;v++)d.emplace(v+u,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let s=0,u=0;for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:b}=f,T=f.zOffset,M=b>0;if((g>0||v>0)&&(t(this.text.zOffsetVertexArray,g,T),t(this.text.zOffsetVertexArray,v,T)),M){const{placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:I}=f;k>=0&&i(this.icon.zOffsetVertexArray,b,T),I>=0&&i(this.icon.zOffsetVertexArray,f.numVerticalIconVertices,T)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=z3(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const s=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:u,y:d}of i)this.lineVertexArray.emplaceBack(u,d);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,i,s,u,d,f,g,v,b,T,M,k,I,R,B,j){const U=t.indexArray,J=t.layoutVertexArray,ee=t.globeExtVertexArray,oe=t.segments.prepareSegment(4*i.length,J,U,this.canOverlap?f.sortKey:void 0),ue=this.glyphOffsetArray.length,fe=oe.vertexLength,xe=this.allowVerticalPlacement&&g===Ss.vertical?Math.PI/2:0,Te=f.text&&f.text.sections;for(let Oe=0;Oe<i.length;Oe++){const{tl:Ie,tr:He,bl:lt,br:Ge,texPrimary:et,texSecondary:Ue,pixelOffsetTL:vt,pixelOffsetBR:Tt,minFontScaleX:ot,minFontScaleY:Ut,glyphOffset:At,isSDF:yt,sectionIndex:Gt}=i[Oe],Lt=oe.vertexLength,Nt=At[1];if(L0(J,b.x,b.y,Ie.x,Nt+Ie.y,et.x,et.y,s,yt,vt.x,vt.y,ot,Ut),L0(J,b.x,b.y,He.x,Nt+He.y,et.x+et.w,et.y,s,yt,Tt.x,vt.y,ot,Ut),L0(J,b.x,b.y,lt.x,Nt+lt.y,et.x,et.y+et.h,s,yt,vt.x,Tt.y,ot,Ut),L0(J,b.x,b.y,Ge.x,Nt+Ge.y,et.x+et.w,et.y+et.h,s,yt,Tt.x,Tt.y,ot,Ut),v){const{x:ft,y:Kt,z:vr}=v.anchor,[rr,mr,zr]=v.up;B0(ee,ft,Kt,vr,rr,mr,zr),B0(ee,ft,Kt,vr,rr,mr,zr),B0(ee,ft,Kt,vr,rr,mr,zr),B0(ee,ft,Kt,vr,rr,mr,zr),F0(t.dynamicLayoutVertexArray,ft,Kt,vr,xe)}else F0(t.dynamicLayoutVertexArray,b.x,b.y,b.z,xe);if(j){const ft=Ue||et;O0(t.iconTransitioningVertexArray,ft.x,ft.y),O0(t.iconTransitioningVertexArray,ft.x+ft.w,ft.y),O0(t.iconTransitioningVertexArray,ft.x,ft.y+ft.h),O0(t.iconTransitioningVertexArray,ft.x+ft.w,ft.y+ft.h)}U.emplaceBack(Lt,Lt+1,Lt+2),U.emplaceBack(Lt+1,Lt+2,Lt+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),Oe!==i.length-1&&Gt===i[Oe+1].sectionIndex||t.programConfigurations.populatePaintArrays(J.length,f,f.index,{},I,R,B,Te&&Te[Gt])}const Ae=v?v.anchor:b;t.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Ae.z,b.x,b.y,ue,this.glyphOffsetArray.length-ue,fe,T,M,b.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],g,0,!1,0,k,0)}_commitLayoutVertex(t,i,s,u,d,f,g){t.emplaceBack(i,s,u,d,f,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,i,s,u,d,f,g){const v=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),b=v.vertexLength,T=g.tileAnchorX,M=g.tileAnchorY;for(let I=0;I<4;I++)s.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(s.collisionVertexArrayExt,i,t.padding,g.zOffset),this._commitLayoutVertex(s.layoutVertexArray,u,d,f,T,M,new Pe(t.x1,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,d,f,T,M,new Pe(t.x2,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,d,f,T,M,new Pe(t.x2,t.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,d,f,T,M,new Pe(t.x1,t.y2)),v.vertexLength+=4;const k=s.indexArray;k.emplaceBack(b,b+1),k.emplaceBack(b+1,b+2),k.emplaceBack(b+2,b+3),k.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,s,u,d,f){for(let g=u;g<d;g++){const v=s.get(g),b=this.getSymbolInstanceTextSize(t,f,i,g);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,f)}}_addIconDebugCollisionBoxes(t,i,s,u,d,f){for(let g=u;g<d;g++){const v=s.get(g),b=this.getSymbolInstanceIconSize(t,i,f.placedIconSymbolIndex);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,f)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pS(Zo,n3.members,Ji),this.iconCollisionBox=new pS(Zo,n3.members,Ji);const s=lf(this.iconSizeData,t),u=lf(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(u,t,i,f.textBoxStartIndex,f.textBoxEndIndex,f),this._addTextDebugCollisionBoxes(u,t,i,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,i,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,i,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}}getSymbolInstanceTextSize(t,i,s,u){const d=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),f=C0(this.textSizeData,t,d)/Ni;return this.tilePixelRatio*f}getSymbolInstanceIconSize(t,i,s){const u=this.icon.placedSymbolArray.get(s),d=C0(this.iconSizeData,t,u);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(t,i,s,u){t.emplaceBack(i,-s,-s,u),t.emplaceBack(i,s,-s,u),t.emplaceBack(i,s,s,u),t.emplaceBack(i,-s,s,u)}_updateTextDebugCollisionBoxes(t,i,s,u,d,f){for(let g=u;g<d;g++){const v=s.get(g),b=this.getSymbolInstanceTextSize(t,f,i,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding,f.zOffset)}}_updateIconDebugCollisionBoxes(t,i,s,u,d,f){for(let g=u;g<d;g++){const v=s.get(g),b=this.getSymbolInstanceIconSize(t,i,f.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding,f.zOffset)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=lf(this.iconSizeData,t),u=lf(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(u,t,i,f.textBoxStartIndex,f.textBoxEndIndex,f),this._updateTextDebugCollisionBoxes(u,t,i,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,i,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,i,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,s,u,d,f,g,v,b){const T={};if(i<s){const{x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe,featureIndex:ue}=t.get(i);T.textBox={x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe},T.textFeatureIndex=ue}if(u<d){const{x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe,featureIndex:ue}=t.get(u);T.verticalTextBox={x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe},T.verticalTextFeatureIndex=ue}if(f<g){const{x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe,featureIndex:ue}=t.get(f);T.iconBox={x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe},T.iconFeatureIndex=ue}if(v<b){const{x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe,featureIndex:ue}=t.get(v);T.verticalIconBox={x1:M,y1:k,x2:I,y2:R,padding:B,projectedAnchorX:j,projectedAnchorY:U,projectedAnchorZ:J,tileAnchorX:ee,tileAnchorY:oe},T.verticalIconFeatureIndex=ue}return T}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,i){const s=t.placedSymbolArray.get(i),u=s.vertexStartIndex+4*s.numGlyphs;for(let d=s.vertexStartIndex;d<u;d+=4)t.indexArray.emplaceBack(d,d+1,d+2),t.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),s=Math.cos(t),u=[],d=[],f=[];for(let g=0;g<this.symbolInstances.length;++g){f.push(g);const v=this.symbolInstances.get(g);u.push(0|Math.round(i*v.tileAnchorX+s*v.tileAnchorY)),d.push(v.featureIndex)}return f.sort((g,v)=>u[g]-u[v]||d[v]-d[g]),f}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:f,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:b}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),d>=0&&d!==u&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&f!==d&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ct(N0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),N0.MAX_GLYPHS=65535,N0.addDynamicAttributes=F0;var qm=N0;const aU=Dt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:lU}=aU,cU=Dt([{name:"a_packed",components:4,type:"Float32"}]),{members:uU}=cU,hU=x0.types,dU=Math.cos(Math.PI/180*37.5);class j0{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Ho,this.layoutVertexArray2=new Nr,this.indexArray=new Zr,this.programConfigurations=new Xc(t.layers,t.zoom),this.segments=new wn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,s,u){this.hasPattern=Kw("line",this.layers,i);const d=this.layers[0].layout.get("line-sort-key"),f=[];for(const{feature:T,id:M,index:k,sourceLayerIndex:I}of t){const R=this.layers[0]._featureFilter.needGeometry,B=Qc(T,R);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),B,s))continue;const j=d?d.evaluate(B,{},s):void 0,U={id:M,properties:T.properties,type:T.type,sourceLayerIndex:I,index:k,geometry:R?B.geometry:hl(T,s,u),patterns:{},sortKey:j};f.push(U)}d&&f.sort((T,M)=>T.sortKey-M.sortKey);const{lineAtlas:g,featureIndex:v}=i,b=this.addConstantDashes(g);for(const T of f){const{geometry:M,index:k,sourceLayerIndex:I}=T;if(b&&this.addFeatureDashes(T,g),this.hasPattern){const R=Jw("line",this.layers,T,this.zoom,i);this.patternFeatures.push(R)}else this.addFeature(T,M,k,s,g.positions,i.availableImages,i.brightness);v.insert(t[k].feature,M,k,I,this.index)}}addConstantDashes(t){let i=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,d=s.layout.get("line-cap").value;if(u.kind!=="constant"||d.kind!=="constant")i=!0;else{const f=d.value,g=u.value;if(!g)continue;t.addDash(g,f)}}return i}addFeatureDashes(t,i){const s=this.zoom;for(const u of this.layers){const d=u.paint.get("line-dasharray").value,f=u.layout.get("line-cap").value;if(d.kind==="constant"&&f.kind==="constant")continue;let g,v;if(d.kind==="constant"){if(g=d.value,!g)continue}else g=d.evaluate({zoom:s},t);v=f.kind==="constant"?f.value:f.evaluate({zoom:s},t),i.addDash(g,v),t.patterns[u.id]=i.getKey(g,v)}}update(t,i,s,u,d){const f=Object.keys(t).length!==0;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,f?this.stateDependentLayers:this.layers,s,u,d)}addFeatures(t,i,s,u,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,i,s,u,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,uU)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lU),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,s,u,d,f,g){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),T=v.get("line-cap").evaluate(t,{}),M=v.get("line-miter-limit"),k=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const I of i)this.addLine(I,t,b,T,M,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,u,g)}addLine(t,i,s,u,d,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let U=0;U<t.length-1;U++)this.totalDistance+=t[U].dist(t[U+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=hU[i.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let b=0;for(;b<v-1&&t[b].equals(t[b+1]);)b++;if(v<(g?3:2))return;s==="bevel"&&(d=1.05);const T=this.overscaling<=16?15*_t/(512*this.overscaling):0,M=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let k,I,R,B,j;this.e1=this.e2=-1,g&&(k=t[v-2],j=t[b].sub(k)._unit()._perp());for(let U=b;U<v;U++){if(R=U===v-1?g?t[b+1]:void 0:t[U+1],R&&t[U].equals(R))continue;j&&(B=j),k&&(I=k),k=t[U],j=R?R.sub(k)._unit()._perp():B,B=B||j;let J=B.add(j);J.x===0&&J.y===0||J._unit();const ee=B.x*j.x+B.y*j.y,oe=J.x*j.x+J.y*j.y,ue=oe!==0?1/oe:1/0,fe=2*Math.sqrt(2-2*oe),xe=oe<dU&&I&&R,Te=B.x*j.y-B.y*j.x>0;if(xe&&U>b){const Ie=k.dist(I);if(Ie>2*T){const He=k.sub(k.sub(I)._mult(T/Ie)._round());this.updateDistance(I,He),this.addCurrentVertex(He,B,0,0,M),I=He}}const Ae=I&&R;let Oe=Ae?s:g?"butt":u;if(Ae&&Oe==="round"&&(ue<f?Oe="miter":ue<=2&&(Oe="fakeround")),Oe==="miter"&&ue>d&&(Oe="bevel"),Oe==="bevel"&&(ue>2&&(Oe="flipbevel"),ue<d&&(Oe="miter")),I&&this.updateDistance(I,k),Oe==="miter")J._mult(ue),this.addCurrentVertex(k,J,0,0,M);else if(Oe==="flipbevel"){if(ue>100)J=j.mult(-1);else{const Ie=ue*B.add(j).mag()/B.sub(j).mag();J._perp()._mult(Ie*(Te?-1:1))}this.addCurrentVertex(k,J,0,0,M),this.addCurrentVertex(k,J.mult(-1),0,0,M)}else if(Oe==="bevel"||Oe==="fakeround"){const Ie=-Math.sqrt(ue*ue-1),He=Te?Ie:0,lt=Te?0:Ie;if(I&&this.addCurrentVertex(k,B,He,lt,M),Oe==="fakeround"){const Ge=Math.round(180*fe/Math.PI/20);for(let et=1;et<Ge;et++){let Ue=et/Ge;if(Ue!==.5){const Tt=Ue-.5;Ue+=Ue*Tt*(Ue-1)*((1.0904+ee*(ee*(3.55645-1.43519*ee)-3.2452))*Tt*Tt+(.848013+ee*(.215638*ee-1.06021)))}const vt=j.sub(B)._mult(Ue)._add(B)._unit()._mult(Te?-1:1);this.addHalfVertex(k,vt.x,vt.y,!1,Te,0,M)}}R&&this.addCurrentVertex(k,j,-He,-lt,M)}else if(Oe==="butt")this.addCurrentVertex(k,J,0,0,M);else if(Oe==="square"){const Ie=I?1:-1;I||this.addCurrentVertex(k,J,Ie,Ie,M),this.addCurrentVertex(k,J,0,0,M),I&&this.addCurrentVertex(k,J,Ie,Ie,M)}else Oe==="round"&&(I&&(this.addCurrentVertex(k,B,0,0,M),this.addCurrentVertex(k,B,1,1,M,!0)),R&&(this.addCurrentVertex(k,j,-1,-1,M,!0),this.addCurrentVertex(k,j,0,0,M)));if(xe&&U<v-1){const Ie=k.dist(R);if(Ie>2*T){const He=k.add(R.sub(k)._mult(T/Ie)._round());this.updateDistance(k,He),this.addCurrentVertex(He,j,0,0,M),k=He}}}}addCurrentVertex(t,i,s,u,d,f=!1){const g=i.y*u-i.x,v=-i.y-i.x*u;this.addHalfVertex(t,i.x+i.y*s,i.y-i.x*s,f,!1,s,d),this.addHalfVertex(t,g,v,f,!0,-u,d)}addHalfVertex({x:t,y:i},s,u,d,f,g,v){this.layoutVertexArray.emplaceBack((t<<1)+(d?1:0),(i<<1)+(f?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),f?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}Ct(j0,"LineBucket",{omit:["layers","patternFeatures"]});class ac{constructor(t,i,s,u){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(i,u)}update(t,i,s){const{width:u,height:d}=t,{context:f}=this,{gl:g}=f;if(g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!i||i.premultiply!==!1)),s||this.size&&this.size[0]===u&&this.size[1]===d){const{x:v,y:b}=s||{x:0,y:0};if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap)g.texSubImage2D(g.TEXTURE_2D,0,v,b,g.RGBA,g.UNSIGNED_BYTE,t);else{let T=this.format,M=g.UNSIGNED_BYTE;this.format===g.R32F&&(T=g.RED,M=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,v,b,u,d,T,M,t.data)}}else if(this.size=[u,d],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap){let v=this.format;this.format===g.R8&&(v=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,v,g.UNSIGNED_BYTE,t)}else{let v=this.format,b=this.format,T=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(v=g.DEPTH_COMPONENT16,T=g.UNSIGNED_SHORT),this.format===g.R8&&(b=g.RED),this.format===g.R32F&&(T=g.FLOAT,b=g.RED),g.texImage2D(g.TEXTURE_2D,0,v,u,d,0,b,T,t.data)}this.useMipmap=!!(i&&i.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,i,s=!1){const{context:u}=this,{gl:d}=u;d.bindTexture(d.TEXTURE_2D,this.texture),t!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!s?t===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),i!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(t,i,s,u){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),i!==this.magFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,i),this.magFilter=i),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?t===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),this.wrapS=s),u!==this.wrapT&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class V0{constructor(t,i){this.context=t,this.texture=i}bind(t,i){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,t),this.minFilter=t),i!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,i),this.wrapS=i)}}const Hs=32,dl=33,ou=new Uint16Array(8184);for(let r=0;r<2046;r++){let t=r+2,i=0,s=0,u=0,d=0,f=0,g=0;for(1&t?u=d=f=Hs:i=s=g=Hs;(t>>=1)>1;){const b=i+u>>1,T=s+d>>1;1&t?(u=i,d=s,i=f,s=g):(i=u,s=d,u=f,d=g),f=b,g=T}const v=4*r;ou[v+0]=i,ou[v+1]=s,ou[v+2]=u,ou[v+3]=d}const fl=new Uint16Array(2178),su=new Uint8Array(1089),$0=new Uint16Array(1089);function D3(r){return r===0?-.03125:r===32?.03125:0}var U0=Dt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const L3={type:2,extent:_t,loadGeometry:()=>[[new Pe(0,0),new Pe(_t+1,0),new Pe(_t+1,_t+1),new Pe(0,_t+1),new Pe(0,0)]]};class mS{constructor(t,i,s,u,d){this.tileID=t,this.uid=sn(),this.uses=0,this.tileSize=i,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<Di.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=nu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,s){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(u,d){const f={};if(!d)return f;for(const g of u){const v=g.layerIds.map(b=>d.getLayer(b)).filter(Boolean);if(v.length!==0){g.layers=v,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>v.filter(T=>T.id===b)[0]));for(const b of v)f[b.fqid]=g}}return f}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const d=this.buckets[u];if(d instanceof qm){if(this.hasSymbolBuckets=!0,!s)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const d=this.buckets[u];if(d instanceof qm&&d.hasRTLText){this.hasRTLText=!0,we.isLoading()||we.isLoaded()||ce()!=="deferred"||_e();break}}this.queryPadding=0;for(const u in this.buckets){const d=this.buckets[u],f=i.style.getOwnLayer(u);if(!f)continue;const g=f.queryRadius(d);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new ow}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(t)}const i=t.gl,s=this.imageAtlas;if(s&&!s.uploaded){const u=!!Object.keys(s.patternPositions).length;this.imageAtlasTexture=new ac(t,s.image,i.RGBA,{useMipmap:u}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new ac(t,this.glyphAtlasImage,i.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ac(t,this.lineAtlas.image,i.R8),this.lineAtlas.uploaded=!0)}prepare(t,i,s){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,s),!i||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const u=i.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,i)))}queryRenderedFeatures(t,i,s,u,d,f,g,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:g,transform:f,params:d,tileTransform:this.tileTransform},t,i,s):{}}querySourceFeatures(t,i){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),d=i?i.sourceLayer:"",f=u._geojsonTileLayer||u[d];if(!f)return;const g=Wd(i&&i.filter),{z:v,x:b,y:T}=this.tileID.canonical,M={z:v,x:b,y:T};for(let k=0;k<f.length;k++){const I=f.feature(k);if(g.needGeometry){const j=Qc(I,!0);if(!g.filter(new ve(this.tileID.overscaledZ),j,this.tileID.canonical))continue}else if(!g.filter(new ve(this.tileID.overscaledZ),I))continue;const R=s.getId(I,d),B=new ZI(I,v,b,T,R);B.tile=M,t.push(B)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const s=rt(t.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const d=this.expirationTime-i;d?this.expirationTime=s+Math.max(d,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&i&&this.updateBuckets(t,i)}updateBuckets(t,i){if(!this.latestFeatureIndex)return;const s=this.latestFeatureIndex.loadVTLayers(),u=i.style.listImages(),d=i.style.getBrightness();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const g=this.buckets[f],v=g.layers[0].sourceLayer||"_geojsonTileLayer",b=s[v];let T={};if(t&&(T=t[v],!b||!T||Object.keys(T).length===0))continue;if(g.update(T,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},d),g instanceof j0||g instanceof y0){const k=i.style.getOwnSourceCache(g.layers[0].source);i._terrain&&i._terrain.enabled&&k&&g.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(k.id,this.tileID)}const M=i&&i.style&&i.style.getOwnLayer(f);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Di.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Di.now()+t}setTexture(t,i){const s=i.context,u=s.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture&&this.texture instanceof ac?this.texture.update(t,{useMipmap:!0}):(this.texture=new ac(s,t,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(t,i){const s={};for(const u of i)s[u]=!0;this.dependencies[t]=s}hasDependency(t,i){for(const s of t){const u=this.dependencies[s];if(u){for(const d of i)if(u[d])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const s=hl(L3,this.tileID.canonical,this.tileTransform)[0],u=new tr,d=new Tm;for(let f=0;f<s.length;f++){const{x:g,y:v}=s[f];u.emplaceBack(g,v),d.emplaceBack(f)}d.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(d),this._tileDebugBuffer=t.createVertexBuffer(u,km.members),this._tileDebugSegments=wn.simpleSegment(0,0,u.length,d.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const s=hl(L3,this.tileID.canonical,this.tileTransform)[0];let u,d;if(this.isRaster){const f=function(g,v){const b=nu(g,v),T=Math.pow(2,g.z);for(let j=0;j<dl;j++)for(let U=0;U<dl;U++){const J=Xo((g.x+(U+D3(U))/Hs)/T),ee=Fi((g.y+(j+D3(j))/Hs)/T),oe=v.project(J,ee),ue=j*dl+U;fl[2*ue+0]=Math.round((oe.x*b.scale-b.x)*_t),fl[2*ue+1]=Math.round((oe.y*b.scale-b.y)*_t)}su.fill(0),$0.fill(0);for(let j=2045;j>=0;j--){const U=4*j,J=ou[U+0],ee=ou[U+1],oe=ou[U+2],ue=ou[U+3],fe=J+oe>>1,xe=ee+ue>>1,Te=fe+xe-ee,Ae=xe+J-fe,Oe=ee*dl+J,Ie=ue*dl+oe,He=xe*dl+fe,lt=Math.hypot((fl[2*Oe+0]+fl[2*Ie+0])/2-fl[2*He+0],(fl[2*Oe+1]+fl[2*Ie+1])/2-fl[2*He+1])>=16;su[He]=su[He]||(lt?1:0),j<1022&&(su[He]=su[He]||su[(ee+Ae>>1)*dl+(J+Te>>1)]||su[(ue+Ae>>1)*dl+(oe+Te>>1)])}const M=new Gr,k=new Zr;let I=0;function R(j,U){const J=U*dl+j;return $0[J]===0&&(M.emplaceBack(fl[2*J+0],fl[2*J+1],j*_t/Hs,U*_t/Hs),$0[J]=++I),$0[J]-1}function B(j,U,J,ee,oe,ue){const fe=j+J>>1,xe=U+ee>>1;if(Math.abs(j-oe)+Math.abs(U-ue)>1&&su[xe*dl+fe])B(oe,ue,j,U,fe,xe),B(J,ee,oe,ue,fe,xe);else{const Te=R(j,U),Ae=R(J,ee),Oe=R(oe,ue);k.emplaceBack(Te,Ae,Oe)}}return B(0,0,Hs,Hs,Hs,0),B(Hs,Hs,0,0,0,Hs),{vertices:M,indices:k}}(this.tileID.canonical,i);u=f.vertices,d=f.indices}else{u=new Gr,d=new Zr;for(const{x:g,y:v}of s)u.emplaceBack(g,v,0,0);const f=_0(u.int16,void 0,4);for(let g=0;g<f.length;g+=3)d.emplaceBack(f[g],f[g+1],f[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(u,U0.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(d),this._tileBoundsSegments=wn.simpleSegment(0,0,u.length,d.length)}_makeGlobeTileDebugBuffers(t,i){const s=i.projection;if(!s||s.name!=="globe"||i.freezeTileCoverage)return;const u=this.tileID.canonical,d=Rm(lI(u,i)),f=nc(i.zoom);let g;f>0&&(g=a.m.invert(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,u,i,d,g,f),this._makeGlobeTileDebugTextBuffer(t,u,i,d,g,f)}_globePoint(t,i,s,u,d,f,g){let v=zm(t,i,s);if(f){const b=1<<s.z,T=cl(u.center.lng),M=ul(u.center.lat),k=(s.x+.5)/b-T;let I=0;k>.5?I=-1:k<-.5&&(I=1);let R=(t/_t+s.x)/b+I,B=(i/_t+s.y)/b;R=(R-T)*u._pixelsPerMercatorPixel+T,B=(B-M)*u._pixelsPerMercatorPixel+M;const j=[R*u.worldSize,B*u.worldSize,0];a.v.transformMat4(j,j,f),v=rc(v,j,g)}return a.v.transformMat4(v,v,d)}_makeGlobeTileDebugBorderBuffer(t,i,s,u,d,f){const g=new tr,v=new Tm,b=new rn,T=(k,I,R,B,j)=>{const U=(R-k)/(j-1),J=(B-I)/(j-1),ee=g.length;for(let oe=0;oe<j;oe++){const ue=k+oe*U,fe=I+oe*J;g.emplaceBack(ue,fe);const xe=this._globePoint(ue,fe,i,s,u,d,f);b.emplaceBack(xe[0],xe[1],xe[2]),v.emplaceBack(ee+oe)}},M=_t;T(0,0,M,0,16),T(M,0,M,M,16),T(M,M,0,M,16),T(0,M,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,km.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,eI.members),this._tileDebugSegments=wn.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugTextBuffer(t,i,s,u,d,f){const g=_t/4,v=new tr,b=new Zr,T=new rn,M=25;b.reserve(32),v.reserve(M),T.reserve(M);const k=(I,R)=>M*I+R;for(let I=0;I<M;I++){const R=I*g;for(let B=0;B<M;B++){const j=B*g;v.emplaceBack(j,R);const U=this._globePoint(j,R,i,s,u,d,f);T.emplaceBack(U[0],U[1],U[2])}}for(let I=0;I<4;I++)for(let R=0;R<4;R++){const B=k(I,R),j=k(I,R+1),U=k(I+1,R),J=k(I+1,R+1);b.emplaceBack(B,j,U),b.emplaceBack(U,j,J)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(v,km.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(T,eI.members),this._tileDebugTextSegments=wn.simpleSegment(0,0,M,32)}destroy(t=!1){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof ac&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class fU{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,s){const u=t.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const d={value:i,timeout:void 0};if(s!==void 0&&(d.timeout=setTimeout(()=>{this.remove(t,d)},s)),this.data[u].push(d),this.order.push(u),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const s=t.wrapped().key,u=i===void 0?0:this.data[s].indexOf(i),d=this.data[s][u];return this.data[s].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(d.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const s in this.data)for(const u of this.data[s])t(u.value)||i.push(u);for(const s of i)this.remove(s.value.tileID,s)}}class wh{constructor(t,i,s,u){this.id=wh.uniqueIdxCounter,wh.uniqueIdxCounter++,this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!s,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||u||i.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=wh.uniqueIdxCounter,wh.uniqueIdxCounter++;const i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}wh.uniqueIdxCounter=0;class pf{constructor(t,i,s){this.func=t,this.mask=i,this.range=s}}pf.ReadOnly=!1,pf.ReadWrite=!0,pf.disabled=new pf(519,pf.ReadOnly,[0,1]);const gS=7680;class _S{constructor(t,i,s,u,d,f){this.test=t,this.ref=i,this.mask=s,this.fail=u,this.depthFail=d,this.pass=f}}_S.disabled=new _S({func:519,mask:0},0,0,gS,gS,gS);class Zs{constructor(t,i,s,u){this.blendFunction=t,this.blendColor=i,this.mask=s,this.blendEquation=u}}Zs.Replace=[1,0,1,0],Zs.disabled=new Zs(Zs.Replace,Hr.transparent,[!1,!1,!1,!1]),Zs.unblended=new Zs(Zs.Replace,Hr.transparent,[!0,!0,!0,!0]),Zs.alphaBlended=new Zs([1,771,1,771],Hr.transparent,[!0,!0,!0,!0]),Zs.multiply=new Zs([774,0,774,0],Hr.transparent,[!0,!0,!0,!0]);const yS=1029,vS=2305;class Ta{constructor(t,i,s){this.enable=t,this.mode=i,this.frontFace=s}}Ta.disabled=new Ta(!1,yS,vS),Ta.backCCW=new Ta(!0,yS,vS),Ta.backCW=new Ta(!0,yS,2304),Ta.frontCW=new Ta(!0,1028,2304),Ta.frontCCW=new Ta(!0,1028,vS);class Sh extends Uo{constructor(t,i,s){super(),this.id=t,this._onlySymbols=s,i.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new fU(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new _$,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="errored"&&(i.state!=="loaded"||!i.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const s=this._tiles[i];s.upload(t),s.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return wr(this._tiles).map(t=>t.tileID).sort(O3).map(t=>t.key)}getRenderableIds(t,i){const s=[];for(const u in this._tiles)this._isIdRenderable(+u,t,i)&&s.push(this._tiles[u]);return t?s.sort((u,d)=>{const f=u.tileID,g=d.tileID,v=new Pe(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),b=new Pe(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||b.y-v.y||b.x-v.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(O3).map(u=>u.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())&&(s||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const s=this._tiles[t];s&&(s.state!=="loading"&&(s.state=i),this._loadTile(s,this._tileLoaded.bind(this,s,t,i)))}_tileLoaded(t,i,s,u){if(u)if(t.state="errored",u.status!==404)this._source.fire(new ha(u,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new po("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Di.now(),s==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new po("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const d=i[u];if(t.neighboringTiles&&t.neighboringTiles[d]){const f=this.getTileByID(d);s(t,f),s(f,t)}}function s(u,d){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let f=d.tileID.canonical.x-u.tileID.canonical.x;const g=d.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),b=d.tileID.key;f===0&&g===0||Math.abs(g)>1||(Math.abs(f)>1&&(Math.abs(f+v)===1?f+=v:Math.abs(f-v)===1&&(f-=v)),d.dem&&u.dem&&(u.dem.backfillBorder(d.dem,f,g),u.neighboringTiles&&u.neighboringTiles[b]&&(u.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,s,u){for(const d in this._tiles){let f=this._tiles[d];if(u[d]||!f.hasData()||f.tileID.overscaledZ<=i||f.tileID.overscaledZ>s)continue;let g=f.tileID;for(;f&&f.tileID.overscaledZ>i+1;){const b=f.tileID.scaledTo(f.tileID.overscaledZ-1);f=this._tiles[b.key],f&&f.hasData()&&(g=b)}let v=g;for(;v.overscaledZ>i;)if(v=v.scaledTo(v.overscaledZ-1),t[v.key]){u[g.key]=g;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const s=this._loadedParentTiles[t.key];return s&&s.tileID.overscaledZ>=i?s:null}for(let s=t.overscaledZ-1;s>=i;s--){const u=t.scaledTo(s),d=this._getLoadedTile(u);if(d)return d}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const s=Math.ceil(t.width/i)+1,u=Math.ceil(t.height/i)+1,d=Math.floor(s*u*5),f=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,d):d,g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const s={};for(const u in this._tiles){const d=this._tiles[u];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+i),s[d.tileID.key]=d}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(t,i,s,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let d;if(this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Mi(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(d=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(v=>this._source.hasTile(v)))):d=[],d.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!xS(this._source.type)){const v=t.coveringZoomLevel({tileSize:i||this._source.tileSize,roundZoom:this._source.roundZoom&&!s}),b=Math.min(v,this._source.maxzoom),T=t.extendTileCoverForShadows(d,u,b);for(const M of T)this._shadowCasterTiles[M.key]=!0,d.push(M)}const f=this._updateRetainedTiles(d);if(xS(this._source.type)&&d.length!==0){const v={},b={},T=Object.keys(f);for(const k of T){const I=f[k],R=this._tiles[k];if(!R||R.fadeEndTime&&R.fadeEndTime<=Di.now())continue;const B=this.findLoadedParent(I,Math.max(I.overscaledZ-Sh.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),v[B.tileID.key]=B.tileID),b[k]=I}const M=d[d.length-1].overscaledZ;for(const k in this._tiles){const I=this._tiles[k];if(f[k]||!I.hasData())continue;let R=I.tileID;for(;R.overscaledZ>M;){R=R.scaledTo(R.overscaledZ-1);const B=this._tiles[R.key];if(B&&B.hasData()&&b[R.key]){f[k]=I.tileID;break}}}for(const k in v)f[k]||(this._coveredTiles[k]=!0,f[k]=v[k])}for(const v in f)this._tiles[v].clearFadeHold();const g=function(v,b){const T=[];for(const M in v)M in b||T.push(M);return T}(this._tiles,f);for(const v of g){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const s={},u=t.reduce((b,T)=>Math.min(b,T.overscaledZ),1/0),d=t[0].overscaledZ,f=Math.max(d-Sh.maxOverzooming,this._source.minzoom),g=Math.max(d+Sh.maxUnderzooming,this._source.minzoom),v={};for(const b of t){const T=this._addTile(b);i[b.key]=b,T.hasData()||u<this._source.maxzoom&&(v[b.key]=b)}this._retainLoadedChildren(v,u,g,i);for(const b of t){let T=this._tiles[b.key];if(T.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const k=b.children(this._source.maxzoom)[0],I=this.getTile(k);if(I&&I.hasData()){i[k.key]=k;continue}}else{const k=b.children(this._source.maxzoom);if(i[k[0].key]&&i[k[1].key]&&i[k[2].key]&&i[k[3].key])continue}let M=T.wasRequested();for(let k=b.overscaledZ-1;k>=f;--k){const I=b.scaledTo(k);if(s[I.key]||(s[I.key]=!0,T=this.getTile(I),!T&&M&&(T=this._addTile(I)),T&&(i[I.key]=I,M=T.wasRequested(),T.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let s,u=this._tiles[t].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}i.push(u.key);const d=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(d),s)break;u=d}for(const d of i)this._loadedParentTiles[d]=s}}_addTile(t){let i=this._tiles[t.key];if(i)return i.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const s=!!i;if(!s){const u=this.map?this.map.painter:null;i=new mS(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,s||this._source.fire(new po("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const s=i.getExpiryTimeout();s&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},s))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,s){const u=[],d=this.transform;if(!d)return u;const f=d.projection.name==="globe",g=cl(d.center.lng);for(const v in this._tiles){const b=this._tiles[v];if(s&&b.clearQueryDebugViz(),b.holdingForFade())continue;let T;if(f){const M=b.tileID.canonical;if(M.z===0){const k=[Math.abs(ct(g,...Hm(M,-1))-g),Math.abs(ct(g,...Hm(M,1))-g)];T=[0,2*k.indexOf(Math.min(...k))-1]}else{const k=[Math.abs(ct(g,...Hm(M,-1))-g),Math.abs(ct(g,...Hm(M,0))-g),Math.abs(ct(g,...Hm(M,1))-g)];T=[k.indexOf(Math.min(...k))-1]}}else T=[0];for(const M of T){const k=t.containsTile(b,d,i,M);k&&u.push(k)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,i){const s=this.getRenderableIds(t,i).map(d=>this._tiles[d].tileID),u=this.transform.projection.name==="globe";for(const d of s)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped()),d.expandedProjMatrix=u?this.transform.calculateProjMatrix(d.toUnwrapped(),!1,!0):d.projMatrix;return s}sortCoordinatesByDistance(t){const i=t.slice(),s=this.transform._camera.position,u=this.transform._camera.forward(),d={};for(const f of i){const g=1/(1<<f.canonical.z);d[f.key]=((f.canonical.x+.5)*g+f.wrap-s[0])*u[0]+((f.canonical.y+.5)*g-s[1])*u[1]-s[2]*u[2]}return i.sort((f,g)=>d[f.key]-d[g.key]),i}hasTransition(){if(this._source.hasTransition())return!0;if(xS(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Di.now())return!0}return!1}setFeatureState(t,i,s){this._state.updateState(t=t||"_geojsonTileLayer",i,s)}removeFeatureState(t,i,s){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,s)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,s){const u=this._tiles[t];u&&u.setDependencies(i,s)}reloadTilesForDependencies(t,i){for(const s in this._tiles)this._tiles[s].hasDependency(t,i)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(t,i))}_preloadTiles(t,i){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,i))};return void this._source.on("data",g)}const s=new Map,u=Array.isArray(t)?t:[t],d=this.map.painter.terrain,f=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const g of u){const v=g.coveringTiles({tileSize:f,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of v)s.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}_r(Array.from(s.values()),(g,v)=>{const b=new mS(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,T=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),v(T,b)})},i)}}function O3(r,t){const i=Math.abs(2*r.wrap)-+(r.wrap<0),s=Math.abs(2*t.wrap)-+(t.wrap<0);return r.overscaledZ-t.overscaledZ||s-i||t.canonical.y-r.canonical.y||t.canonical.x-r.canonical.x}function xS(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function Hm(r,t){const i=1<<r.z;return[r.x/i+t,(r.x+1)/i+t]}Sh.maxOverzooming=10,Sh.maxUnderzooming=3;const pU=Dt([{name:"a_pos_3f",components:3,type:"Float32"}]),mU=Dt([{name:"a_color_3f",components:3,type:"Float32"}]),gU=Dt([{name:"a_color_4f",components:4,type:"Float32"}]),_U=Dt([{name:"a_uv_2f",components:2,type:"Float32"}]),yU=Dt([{name:"a_normal_3f",components:3,type:"Float32"}]),vU=Dt([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),xU=Dt([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function B3(r,t){const i=G0(r.projection,r.zoom,r.width,r.height),s=function(d,f,g,v,b){const T=new jr(g.lng-180*au,g.lat),M=new jr(g.lng+180*au,g.lat),k=d.project(T.lng,T.lat),I=d.project(M.lng,M.lat),R=-Math.atan2(I.y-k.y,I.x-k.x),B=Gi.fromLngLat(g);B.y=ct(B.y,-1+au,1-au);const j=B.toLngLat(),U=d.project(j.lng,j.lat),J=Gi.fromLngLat(j);J.x+=au;const ee=J.toLngLat(),oe=d.project(ee.lng,ee.lat),ue=j3(oe.x-U.x,oe.y-U.y,R),fe=Gi.fromLngLat(j);fe.y+=au;const xe=fe.toLngLat(),Te=d.project(xe.lng,xe.lat),Ae=j3(Te.x-U.x,Te.y-U.y,R),Oe=Math.abs(ue.x)/Math.abs(Ae.y),Ie=a.m.identity([]);a.m.rotateZ(Ie,Ie,-R*(1-(b?0:v)));const He=a.m.identity([]);return a.m.scale(He,He,[1,1-(1-Oe)*v,1]),He[4]=-Ae.x/Ae.y*v,a.m.rotateZ(He,He,R),a.m.multiply(He,Ie,He),He}(r.projection,0,r.center,i,t),u=F3(r);return a.m.scale(s,s,[u,u,1]),s}function F3(r){const t=r.projection,i=G0(r.projection,r.zoom,r.width,r.height),s=N3(t,r.center),u=N3(t,jr.convert(t.center));return Math.pow(2,s*i+(1-i)*u)}function G0(r,t,i,s,u=1/0){const d=r.range;if(!d)return 0;const f=Math.min(u,Math.max(i,s)),g=Math.log(f/1024)/Math.LN2;return Jt(d[0]+g,d[1]+g,t)}const au=1/4e4;function N3(r,t){const i=ct(t.lat,-Nn,Nn),s=new jr(t.lng-180*au,i),u=new jr(t.lng+180*au,i),d=r.project(s.lng,i),f=r.project(u.lng,i),g=Gi.fromLngLat(s),v=Gi.fromLngLat(u),b=f.x-d.x,T=f.y-d.y,M=v.x-g.x,k=v.y-g.y,I=Math.sqrt((M*M+k*k)/(b*b+T*T));return Math.log(I)/Math.LN2}function j3(r,t,i){const s=Math.cos(i),u=Math.sin(i);return{x:r*s-t*u,y:r*u+t*s}}function V3(r,t,i){return t*(_t/(r.tileSize*Math.pow(2,i-r.tileID.overscaledZ)))}function $3(r,t,i){a.m.identity(r),a.m.rotateZ(r,r,st(t[2])),a.m.rotateX(r,r,st(t[0])),a.m.rotateY(r,r,st(t[1])),a.m.scale(r,r,i),a.m.multiply(r,r,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function W0(r,t,i,s,u,d,f,g){const v=[i[0]-t[0],i[1]-t[1],0],b=[s[0]-t[0],s[1]-t[1],0];if(a.v.length(v)<1e-12||a.v.length(b)<1e-12)return a.q.identity(r);const T=a.v.cross([],v,b);a.v.normalize(T,T),a.v.subtract(b,s,t),v[2]=(d-u)*g,b[2]=(f-u)*g;const M=v;return a.v.cross(M,v,b),a.v.normalize(M,M),a.q.rotationTo(r,T,M)}function U3(r,t,i=!1){const s=nc(t.zoom),u=function(d,f,g){const v=f.worldSize,b=[d[12],d[13],d[14]],T=Fi(b[1]/v),M=Xo(b[0]/v),k=a.m.identity([]),I=bo(1,T)*v,R=bo(1,0)*v*vh(T,f.zoom),B=1/Dw(v);let j=R*B;if(g){const oe=G0(f.projection,f.zoom,f.width,f.height,1024);j=B*f.projection.pixelSpaceConversion(f.center.lat,v,oe)}const U=yh(T,M);a.v.add(U,U,a.v.scale([],a.v.normalize([],U),I*j*b[2]));const J=function(oe){const ue=[oe[0],oe[1],oe[2]];let fe=[0,1,0];const xe=a.v.cross([],fe,ue);return a.v.cross(fe,ue,xe),a.v.squaredLength(fe)===0&&(fe=[0,1,0],a.v.cross(xe,ue,fe)),a.v.normalize(xe,xe),a.v.normalize(fe,fe),a.v.normalize(ue,ue),[xe[0],xe[1],xe[2],0,fe[0],fe[1],fe[2],0,ue[0],ue[1],ue[2],0,oe[0],oe[1],oe[2],1]}(U);a.m.scale(k,k,[j,j,j*I]),a.m.translate(k,k,[-b[0],-b[1],-b[2]]);const ee=a.m.multiply([],f.globeMatrix,J);return a.m.multiply(ee,ee,k),a.m.multiply(ee,ee,d),ee}(r,t,i);if(s>0){const d=function(f,g){const v=g.worldSize,b=bo(1,0)*v*vh(g.center.lat,g.zoom)/Dw(v),T=bo(1,g.center.lat)*v,M=a.m.identity([]);return a.m.rotateY(M,M,st(g.center.lng)),a.m.rotateX(M,M,st(g.center.lat)),a.m.translate(M,M,[0,0,bs]),a.m.scale(M,M,[b,b,b*T]),a.m.translate(M,M,[g.point.x-.5*v,g.point.y-.5*v,0]),a.m.multiply(M,M,f),a.m.multiply(M,g.globeMatrix,M)}(r,t);return function(f,g,v){const b=(R,B,j)=>{const U=a.v.length(R),J=a.v.length(B),ee=rc(R,B,j);return a.v.scale(ee,ee,1/a.v.length(ee)*ur(U,J,j))},T=b([f[0],f[1],f[2]],[g[0],g[1],g[2]],v),M=b([f[4],f[5],f[6]],[g[4],g[5],g[6]],v),k=b([f[8],f[9],f[10]],[g[8],g[9],g[10]],v),I=rc([f[12],f[13],f[14]],[g[12],g[13],g[14]],v);return[T[0],T[1],T[2],0,M[0],M[1],M[2],0,k[0],k[1],k[2],0,I[0],I[1],I[2],1]}(u,d,s)}return u}const Th=64,q0={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4};function Zm(r,t,i=!1){r.uploaded||(r.gfxTexture=new ac(t,r.image,i?t.gl.R8:t.gl.RGBA,{useMipmap:r.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),r.uploaded=!0,r.image=null)}function bU(r,t,i){r.indexBuffer=t.createIndexBuffer(r.indexArray,!1,!0),r.vertexBuffer=t.createVertexBuffer(r.vertexArray,pU.members,!1,!0),r.normalArray&&(r.normalBuffer=t.createVertexBuffer(r.normalArray,yU.members,!1,!0)),r.texcoordArray&&(r.texcoordBuffer=t.createVertexBuffer(r.texcoordArray,_U.members,!1,!0)),r.colorArray&&(r.colorBuffer=t.createVertexBuffer(r.colorArray,(r.colorArray.bytesPerElement===12?mU:gU).members,!1,!0)),r.featureArray&&(r.pbrBuffer=t.createVertexBuffer(r.featureArray,xU.members,!0)),r.segments=wn.simpleSegment(0,0,r.vertexArray.length,r.indexArray.length);const s=r.material;s.pbrMetallicRoughness.baseColorTexture&&Zm(s.pbrMetallicRoughness.baseColorTexture,t),s.pbrMetallicRoughness.metallicRoughnessTexture&&Zm(s.pbrMetallicRoughness.metallicRoughnessTexture,t),s.normalTexture&&Zm(s.normalTexture,t),s.occlusionTexture&&Zm(s.occlusionTexture,t,i),s.emissionTexture&&Zm(s.emissionTexture,t)}function bS(r,t,i){if(r.meshes)for(const s of r.meshes)bU(s,t,i);if(r.children)for(const s of r.children)bS(s,t,i)}function H0(r){if(r.meshes)for(const t of r.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(r.children)for(const t of r.children)H0(t)}function Z0(r){if(r.meshes)for(const i of r.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((t=i.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(r.children)for(const i of r.children)Z0(i)}class G3{constructor(t,i){this.feature=t,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class W3{constructor(){this.instancedDataArray=new nw,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class q3{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,i,s,u){this.tileToMeter=l0(s);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:f,id:g,index:v,sourceLayerIndex:b}of t){const T=Qc(f,d);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),T,s))continue;const M={id:g,sourceLayerIndex:b,index:v,geometry:d?T.geometry:hl(f,s,u),properties:f.properties,type:f.type,patterns:{}},k=this.addFeature(M,M.geometry,T);k&&i.featureIndex.insert(f,M.geometry,v,b,this.index,this.instancesPerModel[k].instancedDataArray.length)}this.lookup=null}update(t,i,s,u){for(const d in this.instancesPerModel){const f=this.instancesPerModel[d];for(const g in t)f.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(f.features[f.idToFeaturesIndex[g]],t[g],f,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const i in this.instancesPerModel){const s=this.instancesPerModel[i];for(const u of s.features){const d=this.layers[0],f=u.feature,g=this.canonical,v=d.paint.get("model-rotation").evaluate(f,{},g),b=d.paint.get("model-scale").evaluate(f,{},g),T=d.paint.get("model-translation").evaluate(f,{},g);a.v.exactEquals(u.rotation,v)&&a.v.exactEquals(u.scale,b)&&a.v.exactEquals(u.translation,T)||(this.evaluate(u,u.featureStates,s,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const i in this.instancesPerModel){const s=this.instancesPerModel[i];s.instancedDataArray.length<0||s.instancedDataArray.length===0||(s.instancedDataBuffer?s.instancedDataBuffer.updateData(s.instancedDataArray):s.instancedDataBuffer=t.createVertexBuffer(s.instancedDataArray,vU.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const i=this.instancesPerModel[t];i.instancedDataArray.length!==0&&i.instancedDataBuffer&&i.instancedDataBuffer.destroy()}}addFeature(t,i,s){const u=this.layers[0],d=u.layout.get("model-id").evaluate(s,{},this.canonical);if(!d)return kr(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),d;this.instancesPerModel[d]||(this.instancesPerModel[d]=new W3);const f=this.instancesPerModel[d],g=f.instancedDataArray,v=new G3(s,g.length);for(const b of i)for(const T of b){if(T.x<0||T.x>=_t||T.y<0||T.y>=_t)continue;const M=(this.lookupDim-1)/_t,k=this.lookupDim*(T.y*M|0)+T.x*M|0;if(this.lookup){if(this.lookup[k]!==0)continue;this.lookup[k]=1}this.instanceCount++;const I=g.length;g.resize(I+1),f.instancesEvaluatedElevation.push(0),g.float32[16*I]=T.x,g.float32[16*I+1]=T.y}return v.instancedDataCount=f.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(t.id&&(f.idToFeaturesIndex[t.id]=f.features.length),f.features.push(v),this.evaluate(v,{},f,!1)),d}evaluate(t,i,s,u){const d=this.layers[0],f=t.feature,g=this.canonical,v=t.rotation=d.paint.get("model-rotation").evaluate(f,i,g),b=t.scale=d.paint.get("model-scale").evaluate(f,i,g),T=t.translation=d.paint.get("model-translation").evaluate(f,i,g),M=d.paint.get("model-color").evaluate(f,i,g);M.a=d.paint.get("model-color-mix-intensity").evaluate(f,i,g);const k=[];this.maxVerticalOffset<T[2]&&(this.maxVerticalOffset=T[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),$3(k,v,b);const I=Math.round(100*M.a)+M.b/1.05;for(let R=0;R<t.instancedDataCount;++R){const B=t.instancedDataOffset+R,j=16*B,U=s.instancedDataArray.float32;let J=0;u&&(J=U[j+6]-s.instancesEvaluatedElevation[B]);const ee=0|U[j+1];U[j]=(0|U[j])+M.r/1.05,U[j+1]=ee+M.g/1.05,U[j+2]=I,U[j+3]=1/(g.z>10?this.tileToMeter:l0(g,ee)),U[j+4]=T[0],U[j+5]=T[1],U[j+6]=T[2]+J,U[j+7]=k[0],U[j+8]=k[1],U[j+9]=k[2],U[j+10]=k[4],U[j+11]=k[5],U[j+12]=k[6],U[j+13]=k[8],U[j+14]=k[9],U[j+15]=k[10],s.instancesEvaluatedElevation[B]=T[2]}}}Ct(q3,"ModelBucket",{omit:["layers"]}),Ct(W3,"PerModelAttributes"),Ct(G3,"ModelFeature");const wU=new Ke({visibility:new he(ze.layout_model.visibility),"model-id":new ke(ze.layout_model["model-id"])});var SU={paint:new Ke({"model-opacity":new he(ze.paint_model["model-opacity"]),"model-rotation":new ke(ze.paint_model["model-rotation"]),"model-scale":new ke(ze.paint_model["model-scale"]),"model-translation":new ke(ze.paint_model["model-translation"]),"model-color":new ke(ze.paint_model["model-color"]),"model-color-mix-intensity":new ke(ze.paint_model["model-color-mix-intensity"]),"model-type":new he(ze.paint_model["model-type"]),"model-cast-shadows":new he(ze.paint_model["model-cast-shadows"]),"model-receive-shadows":new he(ze.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new he(ze.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ke(ze.paint_model["model-emissive-strength"]),"model-roughness":new ke(ze.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ke(ze.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new he(ze.paint_model["model-cutoff-fade-range"])}),layout:wU};const wS=new Float32Array(262144),Eh=new Uint8Array(262144);function H3(r){let t=0;if(r.meshes)for(const i of r.meshes)t=Math.max(t,i.aabb.max[2]);if(r.children)for(const i of r.children)t=Math.max(t,H3(i));return t}const Z3=["","wall","door","roof","window","lamp","logo"];class X3{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:H3(t)}}}}class Y3{constructor(t,i,s,u){this.nodes=t,this.id=i,this.modelTraits|=q0.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,s&&(this.modelTraits|=q0.HasMapboxMeshFeatures),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=u,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const s of i){const u=s.node;this.uploaded?this.updatePbrBuffer(u):bS(u,t,!0)}for(const s of i)H0(s.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let i=!1;if(!t.meshes)return i;for(const s of t.meshes)s.pbrBuffer&&(s.pbrBuffer.updateData(s.featureArray),i=!0);return i}needsReEvaluation(t,i,s){const u=t.transform.projectionOptions,d=t.style.getBrightness(),f=this.brightness!==d;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||Xm(s.paint.get("model-color").value,f)||Xm(s.paint.get("model-color-mix-intensity").value,f)||Xm(s.paint.get("model-roughness").value,f)||Xm(s.paint.get("model-emissive-strength").value,f)||Xm(s.paint.get("model-height-based-emissive-strength-multiplier").value,f))&&(this.projection=u,this.brightness=d,!0)}evaluateScale(t,i){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const s=this.getNodesInfo(),u=this.id.canonical;for(const d of s){const f=d.feature;d.evaluatedScale=i.paint.get("model-scale").evaluate(f,{},u)}}evaluate(t){const i=this.getNodesInfo();for(const s of i){if(!s.node.meshes)continue;const u=s.feature,d=s.node.meshes&&s.node.meshes[0].featureData,f=s.evaluatedColor[2],g=s.evaluatedRMEA[2],v=this.id.canonical;if(s.hasTranslucentParts=!1,d){for(let b=0;b<Z3.length;b++){const T=Z3[b];T.length&&(u.properties.part=T);const M=t.paint.get("model-color").evaluate(u,{},v),k=t.paint.get("model-color-mix-intensity").evaluate(u,{},v);s.evaluatedColor[b]=[M.r,M.g,M.b,k],s.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(u,{},v),s.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v),s.evaluatedRMEA[b][3]=M.a,s.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!s.hasTranslucentParts&&M.a<1&&(s.hasTranslucentParts=!0)}delete u.properties.part,EU(s,f!==s.evaluatedColor[2]||g!==s.evaluatedRMEA[2])}else s.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v);s.evaluatedScale=t.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(s.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,i,s,u){const d=t.findDEMTileFor(s);if(d&&(d.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const f=af.create(t,s,d);if(!f)return;this.modelTraits&q0.HasMapboxMeshFeatures&&this.updateDEM(t,f,s,u);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const b=v.footprint.vertices;let T=f.getElevationAt(b[0].x,b[0].y,!0,!0);for(let M=1;M<b.length;M++)T=Math.min(T,f.getElevationAt(b[M].x,b[M].y,!0,!0));v.elevation=T}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=i}}updateDEM(t,i,s,u){let d=i._dem._modifiedForSources[u];if(d===void 0&&(i._dem._modifiedForSources[u]=[],d=i._dem._modifiedForSources[u]),d.includes(s.canonical))return;const f=i._dem.dim;d.push(s.canonical);let g=!1;for(const v of this.getNodesInfo()){const b=v.node;if(!b.footprint||!b.footprint.grid)continue;const T=b.footprint.grid,M=i.tileCoordToPixel(T.min.x,T.min.y),k=i.tileCoordToPixel(T.max.x,T.max.y),I=Math.min(Math.min(f-k.y,M.x),Math.min(M.y,f-k.x));if(I<0)continue;const R=ct(I,2,5);let B=Math.max(0,M.x-R),j=Math.max(0,M.y-R),U=Math.min(k.x+R,f-1),J=Math.min(k.y+R,f-1);for(let fe=j;fe<=J;++fe)for(let xe=B;xe<=U;++xe)Eh[fe*f+xe]=255;let ee=0,oe=0;for(let fe=0;fe<T.cellsY;++fe)for(let xe=0;xe<T.cellsX;++xe){if(!T.cells[fe*T.cellsX+xe])continue;const Te=i.tileCoordToPixel(T.min.x+xe/T.xScale,T.min.y+fe/T.yScale),Ae=i.tileCoordToPixel(T.min.x+(xe+1)/T.xScale,T.min.y+(fe+1)/T.yScale);for(let Oe=Te.y;Oe<=Math.min(Ae.y+1,f-1);++Oe)for(let Ie=Te.x;Ie<=Math.min(Ae.x+1,f-1);++Ie)Eh[Oe*f+Ie]===255&&(Eh[Oe*f+Ie]=0,ee+=i.getElevationAtPixel(Ie,Oe),oe++)}const ue=ee/oe;B=Math.max(1,M.x-R),j=Math.max(1,M.y-R),U=Math.min(k.x+R,f-2),J=Math.min(k.y+R,f-2),g=!0;for(let fe=j;fe<=J;++fe)for(let xe=B;xe<=U;++xe)Eh[fe*f+xe]===0&&(wS[fe*f+xe]=i._dem.set(xe,fe,ue));for(let fe=1;fe<R;++fe){B=Math.max(1,M.x-fe),j=Math.max(1,M.y-fe),U=Math.min(k.x+fe,f-2),J=Math.min(k.y+fe,f-2);for(let xe=j;xe<=J;++xe)for(let Te=B;Te<=U;++Te){const Ae=xe*f+Te;if(Eh[Ae]===255){let Oe=0,Ie=0,He=-1,lt=-1;for(let Ge=-1;Ge<=1;++Ge)for(let et=-1;et<=1;++et){const Ue=(xe+Ge)*f+Te+et;if(Eh[Ue]>=fe)continue;const vt=wS[Ue],Tt=Math.abs(vt);Tt>Ie&&(Oe=vt,Ie=Tt,He=et,lt=Ge)}if(Ie>.1){const Ge=1-(fe+.5*Math.abs(He*lt))/R;let et=i._dem.get(Te,xe)+Oe*Ge;const Ue=i._dem.get(Te+He,xe+lt),vt=i._dem.get(Te-He,xe-lt,!0);(et-Ue)*(et-vt)>0&&(et=(Ue+vt)/2),wS[Ae]=i._dem.set(Te,xe,et),Eh[Ae]=fe}}}}}g&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=Di.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new X3(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)Z0(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const i of t)H0(i.node),Z0(i.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const s=i.getReplacementRegionsForTile(t.toUnwrapped()),u=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const f=u[d].node;u[d].hiddenByReplacement=!!f.footprint&&!s.find(g=>g.footprint===f.footprint)}}getHeightAtTileCoord(t,i){const s=this.getNodesInfo(),u=[];for(let d=0;d<this.nodesInfo.length;d++){const f=s[d],g=f.node.meshes[0];if(t<g.aabb.min[0]||i<g.aabb.min[1]||t>g.aabb.max[0]||i>g.aabb.max[1])continue;const v=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*Th|0,b=Math.min(63,(i-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*Th|0)*Th+Math.min(63,v);if(!(g.heightmap[b]<0&&f.node.footprint))return f.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:f.feature.properties.height,hidden:!1,verticalScale:f.evaluatedScale[2]};if(f.node.footprint.grid.query(new Pe(t,i),new Pe(t,i),u),u.length>0)return{height:void 0,maxHeight:f.feature.properties.height,hidden:f.hiddenByReplacement,verticalScale:f.evaluatedScale[2]}}}}function Xm(r,t){return!r.isLightConstant&&t}function TU(r,t,i,s,u,d,f,g){let v=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,T=240&t|(240&t)>>4;i[3]>0&&(v=ur(v,255*i[0],i[3]),b=ur(b,255*i[1],i[3]),T=ur(T,255*i[2],i[3]));const M=v<<8|b,k=T<<8|Math.floor(255*s[3]),I=function(fe){const xe=ct(fe,0,2);return Math.min(Math.round(.5*xe*255),255)}(s[2])<<8|15*s[0]<<4|15*s[1],R=ct(u[0],0,1),B=ct(u[1],0,1),j=ct(u[2],0,1),U=ct(u[3],0,1);let J,ee,oe,ue;if(R!==B&&f!==d&&B!==R){const fe=f-d;ee=1/(fe*(B-R)),oe=-(d+fe*R)/(fe*(B-R));const xe=ct(u[4],-1,1);ue=Math.pow(10,xe),J=255*j<<8|255*U}else J=65535,ee=0,oe=1,ue=1;if(r.emplaceBack(M,k,I,J,ee,oe,ue),g){const fe=g.length;g.clear();for(let xe=0;xe<fe;xe++)g.emplaceBack(M,k,I,J,ee,oe,ue)}}function EU(r,t){const i=r.node;let s=0;for(const u of i.meshes){if(i.lights&&i.lightMeshIndex===s||!u.featureData)continue;u.featureArray=new Ky,u.featureArray.reserve(u.featureData.length);let d=t;for(const f of u.featureData){let g;const v=65535&f,b=(15&v)<8?15&v:0,T=f>>16&65535,M=r.evaluatedRMEA[b],k=r.evaluatedColor[b],I=r.emissionHeightBasedParams[b];if(d&&b===2&&i.lights&&(g=new Ky,g.resize(10*i.lights.length)),TU(u.featureArray,T,k,M,I,u.aabb.min[2],u.aabb.max[2],g),g&&d){d=!1;const R=i.meshes[i.lightMeshIndex];R.featureArray=g,R.featureArray._trim()}}u.featureArray._trim(),s++}}function X0(r,t){return r.x-t.x||r.y-t.y}function K3(r,t){return X0(r.min,t.min)===0&&X0(r.max,t.max)===0}function J3(r,t){return!(r.min.x>t.max.x||r.max.x<t.min.x||r.min.y>t.max.y||r.max.y<t.min.y)}function Q3(r,t,i){const s=1/_t,u=1/(1<<i.canonical.z),d=(t.x*s+i.canonical.x)*u+i.wrap,f=(t.y*s+i.canonical.y)*u;return{min:new Pe((r.x*s+i.canonical.x)*u+i.wrap,(r.y*s+i.canonical.y)*u),max:new Pe(d,f)}}function CU(r,t,i){const s=1<<i.canonical.z,u=((t.x-i.wrap)*s-i.canonical.x)*_t,d=(t.y*s-i.canonical.y)*_t;return{min:new Pe(((r.x-i.wrap)*s-i.canonical.x)*_t,(r.y*s-i.canonical.y)*_t),max:new Pe(u,d)}}function ez(r,t,i,s,u,d,f){const g=r.indices,v=r.vertices,b=[];for(let T=s;T<s+u;T+=3){const M=t[i[T+0]+d],k=t[i[T+1]+d],I=t[i[T+2]+d],R=Math.min(M.x,k.x,I.x),B=Math.max(M.x,k.x,I.x),j=Math.min(M.y,k.y,I.y),U=Math.max(M.y,k.y,I.y);b.length=0,r.grid.query(new Pe(R,j),new Pe(B,U),b);for(let J=0;J<b.length;J++){const ee=b[J];if(Gw(v[g[3*ee+0]],v[g[3*ee+1]],v[g[3*ee+2]],M,k,I,f))return!0}}return!1}function tz(r,t,i,s){if(!r||!i)return!1;let u=r.vertices;if(!t.canonical.equals(s.canonical)||t.wrap!==s.wrap){if(i.vertices.length<r.vertices.length)return tz(i,s,r,t);const d=t.canonical,f=s.canonical,g=Math.pow(2,f.z-d.z);u=r.vertices.map(v=>new Pe(v.x*d.x*_t*g-f.x*_t,v.y*d.y*_t*g-f.y*_t))}return ez(i,u,r.indices,0,r.indices.length,0,0)}Ct(Y3,"Tiled3dModelBucket",{omit:["layers"]}),Ct(X3,"Tiled3dModelFeature");const MU=x0.types,AU=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],kU=["fill-extrusion-flood-light-ground-radius"],PU=Math.pow(2,13),IU=Math.pow(2,15)-1,rz=new Pe(0,1),lu=2147483648;function Ym(r,t,i,s,u,d,f,g){r.emplaceBack((t<<1)+f,(i<<1)+d,(Math.floor(s*PU)<<1)+u,Math.round(g))}function Y0(r,t,i,s,u,d){r.emplaceBack(t.x,t.y,(i.x<<1)+s,(i.y<<1)+u,d)}function Km(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class nz{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class iz{constructor(){this.centroidXY=new Pe(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Pe(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Pe(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Pe(this.max.x-this.min.x,this.max.y-this.min.y)}}class oz{constructor(){this.acc=new Pe(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,i){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=i.x,t.min.y=t.max.y=i.y)}appendEdge(t,i,s){this.accCount++,this.acc._add(i);let u=!!this.borders;i.x<t.min.x?(t.min.x=i.x,u=!0):i.x>t.max.x&&(t.max.x=i.x,u=!0),i.y<t.min.y?(t.min.y=i.y,u=!0):i.y>t.max.y&&(t.max.y=i.y,u=!0),((i.x===0||i.x===_t)&&i.x===s.x)!=((i.y===0||i.y===_t)&&i.y===s.y)&&this.processBorderOverlap(i,s),u&&this.checkBorderIntersection(i,s)}checkBorderIntersection(t,i){i.x<0!=t.x<0&&this.addBorderIntersection(0,ur(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>_t!=t.x>_t&&this.addBorderIntersection(1,ur(i.y,t.y,(_t-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,ur(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>_t!=t.y>_t&&this.addBorderIntersection(3,ur(i.x,t.x,(_t-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[t];i<s[0]&&(s[0]=i),i>s[1]&&(s[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const s=t.x===0?0:1;this.addBorderIntersection(s,i.y),this.addBorderIntersection(s,t.y)}else{const s=t.y===0?2:3;this.addBorderIntersection(s,i.x),this.addBorderIntersection(s,t.x)}}centroid(){return this.accCount===0?new Pe(0,0):new Pe(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0):0}}function sz(r,t){const i=r.add(t)._unit(),s=ct(r.x*i.x+r.y*i.y,-1,1);var u,d,f;return u=Math.acos(s),Math.min(4,Math.max(-4,Math.tan(u)))/4*IU*((d=r).x*(f=t).y-d.y*f.x<0?-1:1)}const zU=[r=>r.x<0,r=>r.x>_t,r=>r.y<0,r=>r.y>_t];function RU(r,t,i,s){const u=[4];if(s===0)return u;i._mult(s);const d=r.sub(i),f=t.sub(i),g=[r,t,d,f];for(let v=0;v<4;v++)for(const b of g)if(zU[v](b)){u.push(v);break}return u}class az{constructor(t){this.vertexArray=new Ki,this.indexArray=new Zr,this.programConfigurations=new Xc(t.layers,t.zoom,i=>kU.includes(i)),this._segments=new wn,this.hiddenByLandmarkVertexArray=new iw,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new wn}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,i,s,u=!1){const d=t.length;if(d>2){let f=Math.max(0,this._segments.get().length-1);const g=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[f].length);let v;f!==this._segments.get().length-1&&(f++,this._segmentToGroundQuads[f]=[],this._segmentToRegionTriCounts[f]=[0,0,0,0,0]);{const b=t[0],T=t[1];v=sz(b.sub(t[d-1])._perp()._unit(),T.sub(b)._perp()._unit())}for(let b=0;b<d;b++){const T=b===d-1?0:b+1,M=t[b],k=t[T],I=t[T===d-1?0:T+1],R=k.sub(M)._perp()._unit(),B=sz(R,I.sub(k)._perp()._unit()),j=v,U=B;if(SS(M,k,i)||u&&uz(M,i)&&uz(k,i)){v=B;continue}const J=g.vertexLength;Y0(this.vertexArray,M,k,1,1,j),Y0(this.vertexArray,M,k,1,0,j),Y0(this.vertexArray,M,k,0,1,U),Y0(this.vertexArray,M,k,0,0,U),g.vertexLength+=4;const ee=RU(M,k,R,s);for(const oe of ee)this._segmentToGroundQuads[f].push({id:J,region:oe}),this._segmentToRegionTriCounts[f][oe]+=2,g.primitiveLength+=2;v=B}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),i=t.length;for(let s=0;s<i;s++)this._segmentToGroundQuads[s].sort((u,d)=>u.region-d.region);for(let s=0;s<i;s++){const u=this._segmentToGroundQuads[s],d=t[s],f=this._segmentToRegionTriCounts[s];f.reduce((v,b)=>v+b,0);let g=0;for(let v=0;v<=4;v++){const b=f[v];if(b!==0){let T=this.regionSegments[v];T||(T=this.regionSegments[v]=new wn);const M={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+g,vertexLength:d.vertexLength,primitiveLength:b};T.get().push(M)}g+=b}for(let v=0;v<u.length;v++){const b=u[v].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,i,s,u,d,f){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,i,s,u,d,f)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,ZV.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,i,s,u,d,f){this.hasData()&&this.programConfigurations.updatePaintArrays(t,i,s,u,d,f)}updateHiddenByLandmark(t){if(!this.hasData())return;const i=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const s=t.flags&lu?1:0;for(let u=t.groundVertexArrayOffset;u<i;++u)this.hiddenByLandmarkVertexArray.emplace(u,s);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,YV.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const i=this.regionSegments[t];i&&i.destroy()}}}}class Jm{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Zr,this.footprintVertices=new tr,this.footprintSegments=[],this.layoutVertexArray=new Gr,this.centroidVertexArray=new zk,this.indexArray=new Zr,this.programConfigurations=new Xc(t.layers,t.zoom,i=>AU.includes(i)),this.segments=new wn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new az(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,i,s,u){this.features=[],this.hasPattern=Kw("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=l0(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:d,id:f,index:g,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,T=Qc(d,b);if(!this.layers[0]._featureFilter.filter(new ve(this.zoom),T,s))continue;const M={id:f,sourceLayerIndex:v,index:g,geometry:b?T.geometry:hl(d,s,u),properties:d.properties,type:d.type,patterns:{}},k=this.layoutVertexArray.length;this.hasPattern?this.features.push(Jw("fill-extrusion",this.layers,M,this.zoom,i)):this.addFeature(M,M.geometry,g,s,{},i.availableImages,u,i.brightness),i.featureIndex.insert(d,M.geometry,g,v,this.index,k)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,i,s,u,d,f){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,i,s,u,d,f)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,i,s,u,d){const f=Object.keys(t).length!==0;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,i,g,s,u,d),this.groundEffect.update(t,i,g,s,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,JV),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,KV.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,XV.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,s,u,d,f,g,v){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,T=[new Pe(0,0),new Pe(_t,_t)],M=g.projection,k=M.name==="globe",I=MU[t.type]==="Polygon",R=new oz;R.centroidDataIndex=this.centroidData.length;const B=new iz,j=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},u)<=0,U=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},u);B.height=U,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new un);const J=Yw(i,500);for(let Te=J.length-1;Te>=0;Te--){const Ae=J[Te];(Ae.length===0||(ee=Ae[0]).every(Oe=>Oe.x<=0)||ee.every(Oe=>Oe.x>=_t)||ee.every(Oe=>Oe.y<=0)||ee.every(Oe=>Oe.y>=_t))&&J.splice(Te,1)}var ee;let oe;if(k)oe=pz(J,T,u);else{oe=[];for(const Te of J)oe.push({polygon:Te,bounds:T})}const ue=I?this.edgeRadius:0,fe=ue>0&&this.zoom<17,xe=(Te,Ae)=>{if(Te.length===0)return!1;const Oe=Te[Te.length-1];return Ae.x===Oe.x&&Ae.y===Oe.y};for(const{polygon:Te,bounds:Ae}of oe){let Oe=0,Ie=0;for(const et of Te)I&&!et[0].equals(et[et.length-1])&&et.push(et[0]),Ie+=I?et.length-1:et.length;const He=this.segments.prepareSegment((I?5:4)*Ie,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const lt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ge=new nz;if(Ge.vertexOffset=this.footprintVertices.length,Ge.indexOffset=3*this.footprintIndices.length,Ge.ringIndices=[],I){const et=[],Ue=[];Oe=He.vertexLength;for(let Tt=0;Tt<Te.length;Tt++){const ot=Te[Tt];ot.length&&Tt!==0&&Ue.push(et.length/2);const Ut=[];let At,yt;At=ot[1].sub(ot[0])._perp()._unit(),Ge.ringIndices.push(ot.length-1);for(let Gt=1;Gt<ot.length;Gt++){const Lt=ot[Gt],Nt=ot[Gt===ot.length-1?1:Gt+1],ft=Lt.clone();if(ue){yt=Nt.sub(Lt)._perp()._unit();const Kt=At.add(yt)._unit(),vr=ue*Math.min(4,1/(At.x*Kt.x+At.y*Kt.y));ft.x+=vr*Kt.x,ft.y+=vr*Kt.y,ft.x=Math.round(ft.x),ft.y=Math.round(ft.y),At=yt}!j||ue!==0&&!fe||xe(Ut,ft)||Ut.push(ft),Ym(this.layoutVertexArray,ft.x,ft.y,0,0,1,1,0),He.vertexLength++,this.footprintVertices.emplaceBack(Lt.x,Lt.y),et.push(Lt.x,Lt.y),k&&Km(this.layoutVertexExtArray,M.projectTilePoint(ft.x,ft.y,u),M.upVector(u,ft.x,ft.y))}j&&(ue===0||fe)&&(Ut.length!==0&&xe(Ut,Ut[0])&&Ut.pop(),this.groundEffect.addData(Ut,Ae,b))}const vt=_0(et,Ue);for(let Tt=0;Tt<vt.length;Tt+=3)this.footprintIndices.emplaceBack(Ge.vertexOffset+vt[Tt+0],Ge.vertexOffset+vt[Tt+1],Ge.vertexOffset+vt[Tt+2]),this.indexArray.emplaceBack(Oe+vt[Tt],Oe+vt[Tt+2],Oe+vt[Tt+1]),He.primitiveLength++;Ge.indexCount+=vt.length,Ge.vertexCount+=this.footprintVertices.length-Ge.vertexOffset}for(let et=0;et<Te.length;et++){const Ue=Te[et];R.startRing(B,Ue[0]);let vt=Ue.length>4&&hz(Ue[Ue.length-2],Ue[0],Ue[1]),Tt=ue?DU(Ue[Ue.length-2],Ue[0],Ue[1],ue):0;const ot=[];let Ut,At,yt;At=Ue[1].sub(Ue[0])._perp()._unit();let Gt=!0;for(let Lt=1,Nt=0;Lt<Ue.length;Lt++){let ft=Ue[Lt-1],Kt=Ue[Lt];const vr=Ue[Lt===Ue.length-1?1:Lt+1];if(R.appendEdge(B,Kt,ft),SS(Kt,ft,Ae)){ue&&(At=vr.sub(Kt)._perp()._unit(),Gt=!Gt);continue}const rr=Kt.sub(ft)._perp(),mr=rr.x/(Math.abs(rr.x)+Math.abs(rr.y)),zr=rr.y>0?1:0,nn=ft.dist(Kt);if(Nt+nn>32768&&(Nt=0),ue){yt=vr.sub(Kt)._perp()._unit();let Vr=cz(ft,Kt,vr,lz(At,yt),ue);isNaN(Vr)&&(Vr=0);const Wr=Kt.sub(ft)._unit();ft=ft.add(Wr.mult(Tt))._round(),Kt=Kt.add(Wr.mult(-Vr))._round(),Tt=Vr,At=yt,j&&this.zoom>=17&&(xe(ot,ft)||ot.push(ft),xe(ot,Kt)||ot.push(Kt))}const sr=He.vertexLength,dn=Ue.length>4&&hz(ft,Kt,vr);let on=dz(Nt,vt,Gt);if(Ym(this.layoutVertexArray,ft.x,ft.y,mr,zr,0,0,on),Ym(this.layoutVertexArray,ft.x,ft.y,mr,zr,0,1,on),Nt+=nn,on=dz(Nt,dn,!Gt),vt=dn,Ym(this.layoutVertexArray,Kt.x,Kt.y,mr,zr,0,0,on),Ym(this.layoutVertexArray,Kt.x,Kt.y,mr,zr,0,1,on),He.vertexLength+=4,this.indexArray.emplaceBack(sr+0,sr+1,sr+2),this.indexArray.emplaceBack(sr+1,sr+3,sr+2),He.primitiveLength+=2,ue){const Vr=Oe+(Lt===1?Ue.length-2:Lt-2),Wr=Lt===1?Oe:Vr+1;if(this.indexArray.emplaceBack(sr+1,Vr,sr+3),this.indexArray.emplaceBack(Vr,Wr,sr+3),He.primitiveLength+=2,Ut===void 0&&(Ut=sr),!SS(vr,Ue[Lt],Ae)){const Rr=Lt===Ue.length-1?Ut:He.vertexLength;this.indexArray.emplaceBack(sr+2,sr+3,Rr),this.indexArray.emplaceBack(sr+3,Rr+1,Rr),this.indexArray.emplaceBack(sr+3,Wr,Rr+1),He.primitiveLength+=3}Gt=!Gt}if(k){const Vr=this.layoutVertexExtArray,Wr=M.projectTilePoint(ft.x,ft.y,u),Rr=M.projectTilePoint(Kt.x,Kt.y,u),Pn=M.upVector(u,ft.x,ft.y),fn=M.upVector(u,Kt.x,Kt.y);Km(Vr,Wr,Pn),Km(Vr,Wr,Pn),Km(Vr,Rr,fn),Km(Vr,Rr,fn)}}I&&(Oe+=Ue.length-1),j&&ue&&this.zoom>=17&&(ot.length!==0&&xe(ot,ot[0])&&ot.pop(),this.groundEffect.addData(ot,Ae,b,ue>0))}this.footprintSegments.push(Ge),lt.triangleCount=this.indexArray.length-lt.triangleArrayOffset,this.polygonSegments.push(lt),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=R.borders?rz:this.encodeCentroid(R,B),this.centroidData.push(B),R.borders){this.featuresOnBorder.push(R);const Te=this.featuresOnBorder.length-1;for(let Ae=0;Ae<R.borders.length;Ae++)R.borders[Ae][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ae].push(Te)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,u,v),this.groundEffect.addPaintPropertiesData(t,s,d,f,u,v),this.maxHeight=Math.max(this.maxHeight,U)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((i,s)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[s].borders[t][0])}splitToSubtiles(){const t=[];for(let g=0;g<this.centroidData.length;g++){const v=this.centroidData[g],b=+(v.min.y+v.max.y>_t),T=2*b+(+(v.min.x+v.max.x>_t)^b);for(let M=0;M<v.polygonSegLen;M++){const k=v.polygonSegIdx+M;t.push({centroidIdx:g,subtile:T,polygonSegmentIdx:k,triangleSegmentIdx:this.polygonSegments[k].triangleSegIdx})}}const i=new Zr;t.sort((g,v)=>g.triangleSegmentIdx===v.triangleSegmentIdx?g.subtile-v.subtile:g.triangleSegmentIdx-v.triangleSegmentIdx);let s=0,u=0,d=0;for(const g of t){if(g.triangleSegmentIdx!==s)break;d++}const f=t.length;for(;u!==t.length;){s=t[u].triangleSegmentIdx;let g=0,v=u,b=u;for(let T=v;T<d&&t[T].subtile===g;T++)b++;for(;v!==d;){const T=t[v];g=T.subtile;const M=this.centroidData[T.centroidIdx].min.clone(),k=this.centroidData[T.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[s].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[s].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=v;R<b;R++){const B=t[R],j=this.polygonSegments[B.polygonSegmentIdx],U=this.centroidData[B.centroidIdx].min,J=this.centroidData[B.centroidIdx].max,ee=this.indexArray.uint16;for(let oe=j.triangleArrayOffset;oe<j.triangleArrayOffset+j.triangleCount;oe++)i.emplaceBack(ee[3*oe],ee[3*oe+1],ee[3*oe+2]);I.primitiveLength+=j.triangleCount,M.x=Math.min(M.x,U.x),M.y=Math.min(M.y,U.y),k.x=Math.max(k.x,J.x),k.y=Math.max(k.y,J.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:M,max:k}),v=b;for(let R=v;R<d&&t[R].subtile===t[v].subtile;R++)b++}u=d;for(let T=u;T<f&&t[T].triangleSegmentIdx===t[u].triangleSegmentIdx;T++)d++}i._trim(),this.indexArray=i}getVisibleSegments(t,i,s){let u=0,d=0;const f=1<<t.canonical.z;if(i){const B=i.getMinMaxForTile(t);B&&(u=B.min,d=B.max)}d+=this.maxHeight;const g=t.toUnwrapped();let v;const b=[g.canonical.x/f+g.wrap,g.canonical.y/f],T=[(g.canonical.x+1)/f+g.wrap,(g.canonical.y+1)/f],M=new wn,k=(B,j,U)=>[B[0]*(1-U[0])+j[0]*U[0],B[1]*(1-U[1])+j[1]*U[1]],I=[],R=[];for(const B of this.triangleSubSegments){I[0]=B.min.x/_t,I[1]=B.min.y/_t,R[0]=B.max.x/_t,R[1]=B.max.y/_t;const j=k(b,T,I),U=k(b,T,R);if(new Gn([j[0],j[1],u],[U[0],U[1],d]).intersectsPrecise(s)===0){v&&(M.segments.push(v),v=void 0);continue}const J=B.segment;v&&v.vertexOffset!==J.vertexOffset&&(M.segments.push(v),v=void 0),v?(v.vertexLength+=J.vertexLength,v.primitiveLength+=J.primitiveLength):v={vertexOffset:J.vertexOffset,primitiveLength:J.primitiveLength,vertexLength:J.vertexLength,primitiveOffset:J.primitiveOffset,sortKey:void 0,vaos:{}}}return v&&M.segments.push(v),M}encodeCentroid(t,i){const s=t.centroid(),u=i.span(),d=Math.min(7,Math.round(u.x*this.tileToMeter/10)),f=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new Pe(ct(s.x,1,_t-1)<<3|d,ct(s.y,1,_t-1)<<3|f)}encodeBorderCentroid(t){if(!t.borders)return new Pe(0,0);const i=t.borders,s=Number.MAX_VALUE;if(i[0][0]!==s||i[1][0]!==s){const u=i[0][0]!==s?0:1;return new Pe(6|(i[0][0]!==s?0:65528),((i[u][0]+i[u][1])/2|0)<<3|6)}{const u=i[2][0]!==s?2:3;return new Pe(((i[u][0]+i[u][1])/2|0)<<3|6,6|(i[2][0]!==s?0:65528))}}showCentroid(t){const i=this.centroidData[t.centroidDataIndex];i.flags&=lu,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const i=t.vertexArrayOffset,s=t.vertexCount+t.vertexArrayOffset,u=t.flags&lu?rz:t.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==u.y||d!==u.x){for(let f=i;f<s;++f)this.centroidVertexArray.emplace(f,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const s=i.getReplacementRegionsForTile(t.toUnwrapped());if(function(d,f){if(d.length!==f.length)return!1;for(let g=0;g<d.length;g++)if(d[g].sourceId!==f[g].sourceId||!K3(d[g],f[g]))return!1;return!0}(this.activeReplacements,s))return;if(this.activeReplacements=s,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const d of this.centroidData)d.flags&=2147483647;const u=[];for(const d of this.activeReplacements){const f=Math.pow(2,d.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&lu||d.min.x>g.max.x||g.min.x>d.max.x||d.min.y>g.max.y||g.min.y>d.max.y))for(let v=0;v<g.footprintSegLen;v++){const b=this.footprintSegments[g.footprintSegIdx+v];if(u.length=0,LU(this.footprintVertices,b.vertexOffset,b.vertexCount,d.footprintTileId.canonical,t.canonical,u),ez(d.footprint,u,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-f)){g.flags|=lu;break}}}for(const d of this.centroidData)this.writeCentroidToBuffer(d);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,i,s){let u=!1;for(let d=0;d<s.footprintSegLen;d++){const f=this.footprintSegments[s.footprintSegIdx+d];let g=0;for(const v of f.ringIndices){for(let b=g,T=v+g-1;b<v+g;T=b++){const M=this.footprintVertices.int16[2*(b+f.vertexOffset)+0],k=this.footprintVertices.int16[2*(b+f.vertexOffset)+1],I=this.footprintVertices.int16[2*(T+f.vertexOffset)+1];k>i!=I>i&&t<(this.footprintVertices.int16[2*(T+f.vertexOffset)+0]-M)*(i-k)/(I-k)+M&&(u=!u)}g=v}}return u}getHeightAtTileCoord(t,i){let s=Number.NEGATIVE_INFINITY,u=!0;const d=4*(t+_t)*_t+(i+_t);if(this.partLookup.hasOwnProperty(d)){const f=this.partLookup[d];return f?{height:f.height,hidden:!!(f.flags&lu)}:void 0}for(const f of this.centroidData)t>f.max.x||f.min.x>t||i>f.max.y||f.min.y>i||this.footprintContainsPoint(t,i,f)&&f&&f.height>s&&(s=f.height,this.partLookup[d]=f,u=!!(f.flags&lu));if(s!==Number.NEGATIVE_INFINITY)return{height:s,hidden:u};this.partLookup[d]=void 0}}function lz(r,t){const i=r.add(t)._unit();return r.x*i.x+r.y*i.y}function DU(r,t,i,s){const u=t.sub(r)._perp()._unit(),d=i.sub(t)._perp()._unit();return cz(r,t,i,lz(u,d),s)}function cz(r,t,i,s,u){const d=Math.sqrt(1-s*s);return Math.min(r.dist(t)/3,t.dist(i)/3,u*d/s)}function SS(r,t,i){return r.x<i[0].x&&t.x<i[0].x||r.x>i[1].x&&t.x>i[1].x||r.y<i[0].y&&t.y<i[0].y||r.y>i[1].y&&t.y>i[1].y}function uz(r,t){return r.x<t[0].x||r.x>t[1].x||r.y<t[0].y||r.y>t[1].y}function hz(r,t,i){if(r.x<0||r.x>=_t||t.x<0||t.x>=_t||i.x<0||i.x>=_t)return!1;const s=i.sub(t),u=s.perp(),d=r.sub(t);return(s.x*d.x+s.y*d.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(d.x*d.x+d.y*d.y))>-.866&&u.x*d.x+u.y*d.y<0}function dz(r,t,i){const s=t?2|r:-3&r;return i?1|s:-2&s}function fz(){const r=Math.PI/32,t=Math.tan(r),i=Dm;return i*Math.sqrt(1+2*t*t)-i}function pz(r,t,i){const s=1<<i.z,u=Xo(i.x/s),d=Xo((i.x+1)/s),f=Fi(i.y/s),g=Fi((i.y+1)/s);return function(v,b,T,M,k=0,I){const R=[];if(!v.length||!T||!M)return R;const B=(fe,xe)=>{for(const Te of fe)R.push({polygon:Te,bounds:xe})},j=Math.ceil(Math.log2(T)),U=Math.ceil(Math.log2(M)),J=j-U,ee=[];for(let fe=0;fe<Math.abs(J);fe++)ee.push(J>0?0:1);for(let fe=0;fe<Math.min(j,U);fe++)ee.push(0),ee.push(1);let oe=v;if(oe=b0(oe,b[0].y-k,b[1].y+k,1),oe=b0(oe,b[0].x-k,b[1].x+k,0),!oe.length)return R;const ue=[];for(ee.length?ue.push({polygons:oe,bounds:b,depth:0}):B(oe,b);ue.length;){const fe=ue.pop(),xe=fe.depth,Te=ee[xe],Ae=fe.bounds[0],Oe=fe.bounds[1],Ie=Te===0?Ae.x:Ae.y,He=Te===0?Oe.x:Oe.y,lt=I?I(Te,Ie,He):.5*(Ie+He),Ge=b0(fe.polygons,Ie-k,lt+k,Te),et=b0(fe.polygons,lt-k,He+k,Te);if(Ge.length){const Ue=[Ae,new Pe(Te===0?lt:Oe.x,Te===1?lt:Oe.y)];ee.length>xe+1?ue.push({polygons:Ge,bounds:Ue,depth:xe+1}):B(Ge,Ue)}if(et.length){const Ue=[new Pe(Te===0?lt:Ae.x,Te===1?lt:Ae.y),Oe];ee.length>xe+1?ue.push({polygons:et,bounds:Ue,depth:xe+1}):B(et,Ue)}}return R}(r,t,Math.ceil((d-u)/11.25),Math.ceil((f-g)/11.25),1,(v,b,T)=>{if(v===0)return .5*(b+T);{const M=Fi((i.y+b/_t)/s);return(ul(.5*(Fi((i.y+T/_t)/s)+M))*s-i.y)*_t}})}function LU(r,t,i,s,u,d){const f=Math.pow(2,s.z-u.z);for(let g=0;g<i;g++){let v=r.int16[2*(g+t)+0],b=r.int16[2*(g+t)+1];v=(v+u.x*_t)*f-s.x*_t,b=(b+u.y*_t)*f-s.y*_t,d.push(new Pe(v,b))}}Ct(Jm,"FillExtrusionBucket",{omit:["layers","features"]}),Ct(iz,"PartData"),Ct(nz,"FootprintSegment"),Ct(oz,"BorderCentroidData"),Ct(az,"GroundEffect");const OU=new Ke({visibility:new he(ze["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new he(ze["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var BU={paint:new Ke({"fill-extrusion-opacity":new he(ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ke(ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new he(ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new he(ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ke(ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ke(ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ke(ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new he(ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new he(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new he(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new he(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new he(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new he(ze["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new he(ze["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new he(ze["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ke(ze["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ke(ze["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new he(ze["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new he(ze["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new he(ze["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new he(ze["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new he(ze["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:OU};class mf extends Pe{constructor(t,i,s){super(t,i),this.z=s}}function Qm(r,t){return r.x*t.x+r.y*t.y}function mz(r,t){if(r.length===1){let i=0;const s=t[i++];let u;for(;!u||s.equals(u);)if(u=t[i++],!u)return 1/0;for(;i<t.length;i++){const d=t[i],f=r[0],g=u.sub(s),v=d.sub(s),b=f.sub(s),T=Qm(g,g),M=Qm(g,v),k=Qm(v,v),I=Qm(b,g),R=Qm(b,v),B=T*k-M*M,j=(k*I-M*R)/B,U=(T*R-M*I)/B,J=s.z*(1-j-U)+u.z*j+d.z*U;if(isFinite(J))return J}return 1/0}{let i=1/0;for(const s of t)i=Math.min(i,s.z);return i}}function gz(r,t,i,s,u,d,f,g){const v=f*u.getElevationAt(r,t,!0,!0),b=d[0]!==0,T=b?d[1]===0?f*(d[0]/7-450):f*function(M,k,I){const R=Math.floor(k[0]/8),B=Math.floor(k[1]/8),j=10*(k[0]-8*R),U=10*(k[1]-8*B),J=M.getElevationAt(R,B,!0,!0),ee=M.getMeterToDEM(I),oe=Math.floor(.5*(j*ee-1)),ue=Math.floor(.5*(U*ee-1)),fe=M.tileCoordToPixel(R,B),xe=2*oe+1,Te=2*ue+1,Ae=function(et,Ue,vt,Tt,ot){return[et.getElevationAtPixel(Ue,vt,!0),et.getElevationAtPixel(Ue+ot,vt,!0),et.getElevationAtPixel(Ue,vt+ot,!0),et.getElevationAtPixel(Ue+Tt,vt+ot,!0)]}(M,fe.x-oe,fe.y-ue,xe,Te),Oe=Math.abs(Ae[0]-Ae[1]),Ie=Math.abs(Ae[2]-Ae[3]),He=Math.abs(Ae[0]-Ae[2])+Math.abs(Ae[1]-Ae[3]),lt=Math.min(.25,.5*ee*(Oe+Ie)/xe),Ge=Math.min(.25,.5*ee*He/Te);return J+Math.max(lt*j,Ge*U)}(u,d,g):v;return{base:v+(i===0)?-1:i,top:b?Math.max(T+s,v+i+2):v+s}}const FU=new Ke({"line-cap":new ke(ze.layout_line["line-cap"]),"line-join":new ke(ze.layout_line["line-join"]),"line-miter-limit":new he(ze.layout_line["line-miter-limit"]),"line-round-limit":new he(ze.layout_line["line-round-limit"]),"line-sort-key":new ke(ze.layout_line["line-sort-key"]),visibility:new he(ze.layout_line.visibility)});var _z={paint:new Ke({"line-opacity":new ke(ze.paint_line["line-opacity"]),"line-color":new ke(ze.paint_line["line-color"]),"line-translate":new he(ze.paint_line["line-translate"]),"line-translate-anchor":new he(ze.paint_line["line-translate-anchor"]),"line-width":new ke(ze.paint_line["line-width"]),"line-gap-width":new ke(ze.paint_line["line-gap-width"]),"line-offset":new ke(ze.paint_line["line-offset"]),"line-blur":new ke(ze.paint_line["line-blur"]),"line-dasharray":new ke(ze.paint_line["line-dasharray"]),"line-pattern":new ke(ze.paint_line["line-pattern"]),"line-gradient":new nt(ze.paint_line["line-gradient"]),"line-trim-offset":new he(ze.paint_line["line-trim-offset"]),"line-emissive-strength":new he(ze.paint_line["line-emissive-strength"]),"line-border-width":new ke(ze.paint_line["line-border-width"]),"line-border-color":new ke(ze.paint_line["line-border-color"])}),layout:FU};function yz(r,t){return 1/V3(r,1,t.tileZoom)}function vz(r,t,i,s){return r.translatePosMatrix(s||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const xz=r=>{const t=[];bz(r)&&t.push("RENDER_LINE_DASH"),r.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=r.paint.get("line-trim-offset");return i[0]===0&&i[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),r.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function bz(r){const t=r.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const wz=new class extends ke{possiblyEvaluate(r,t){return t=new ve(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,i,s){return t=Lr({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,i,s)}}(_z.paint.properties["line-width"].specification);function Sz(r,t){return t>0?t+2*r:r}wz.useIntegerZoom=!0;const NU=new Ke({visibility:new he(ze.layout_background.visibility)});var jU={paint:new Ke({"background-color":new he(ze.paint_background["background-color"]),"background-pattern":new he(ze.paint_background["background-pattern"]),"background-opacity":new he(ze.paint_background["background-opacity"]),"background-emissive-strength":new he(ze.paint_background["background-emissive-strength"])}),layout:NU};const VU=new Ke({visibility:new he(ze.layout_raster.visibility)});var $U={paint:new Ke({"raster-opacity":new he(ze.paint_raster["raster-opacity"]),"raster-color":new nt(ze.paint_raster["raster-color"]),"raster-color-mix":new he(ze.paint_raster["raster-color-mix"]),"raster-color-range":new he(ze.paint_raster["raster-color-range"]),"raster-hue-rotate":new he(ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new he(ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new he(ze.paint_raster["raster-brightness-max"]),"raster-saturation":new he(ze.paint_raster["raster-saturation"]),"raster-contrast":new he(ze.paint_raster["raster-contrast"]),"raster-resampling":new he(ze.paint_raster["raster-resampling"]),"raster-fade-duration":new he(ze.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new he(ze.paint_raster["raster-emissive-strength"]),"raster-array-band":new he(ze.paint_raster["raster-array-band"]),"raster-elevation":new he(ze.paint_raster["raster-elevation"])}),layout:VU};function K0(r,t,i,s,u,d,f,g){const v=[r,t,1,i,s,1,u,d,1],b=[f,g,1],T=a.bx.adjoint([],v),[M,k,I]=a.v.transformMat3(b,b,T);return a.bx.multiply(v,v,[M,0,0,0,k,0,0,0,I])}function Tz(r,t,i,s,u,d,f,g){const v=function(b,T,M,k,I,R,B,j){const U=K0(0,0,1,0,1,1,0,1),J=K0(b,T,M,k,I,R,B,j),ee=a.bx.adjoint([],U);return a.bx.multiply(J,J,ee)}(r,t,i,s,u,d,f,g);return[v[2]/v[8]/_t,v[5]/v[8]/_t]}function J0(r){return[r[0],Math.min(Math.max(r[1],-Nn),Nn)]}class Ez extends Uo{constructor(t,i,s,u){super(),this.id=t,this.dispatcher=s,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=i,this._dirty=!1}load(t,i){if(this._loaded=i||!1,this.fire(new po("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Ye(this.map._requestManager.transformRequest(this.url,kn.Image),(s,u)=>{this._imageRequest=null,this._loaded=!0,s?this.fire(new ha(s)):u&&(this.image=u instanceof HTMLImageElement?Di.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new V0(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new po("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof V0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=t[0][1],s=t[0][1];for(const d of t)d[1]>s&&(s=d[1]),d[1]<i&&(i=d[1]);const u=(s+i)/2;if(u>Nn?this.onNorthPole=!0:u<-Nn&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=t.map(Gi.fromLngLat);this.tileID=function(f){let g=1/0,v=1/0,b=-1/0,T=-1/0;for(const B of f)g=Math.min(g,B.x),v=Math.min(v,B.y),b=Math.max(b,B.x),T=Math.max(T,B.y);const M=Math.max(b-g,T-v),k=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),I=Math.pow(2,k);let R=Math.floor((g+b)/2*I);return R>1&&(R-=1),new _h(k,R,Math.floor((v+T)/2*I))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new po("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const j in this.tiles){const U=this.tiles[j];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const i=nu(new _h(0,0,0),this.map.transform.projection),s=[i.projection.project(this.coordinates[0][0],this.coordinates[0][1]),i.projection.project(this.coordinates[1][0],this.coordinates[1][1]),i.projection.project(this.coordinates[2][0],this.coordinates[2][1]),i.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(j){const U=j[1].x-j[0].x,J=j[1].y-j[0].y,ee=j[2].x-j[1].x,oe=j[2].y-j[1].y,ue=j[3].x-j[2].x,fe=j[3].y-j[2].y,xe=j[0].x-j[3].x,Te=j[0].y-j[3].y,Ae=U*oe-ee*J,Oe=ee*fe-ue*oe,Ie=ue*Te-xe*fe,He=xe*J-U*Te;return Ae>0&&Oe>0&&Ie>0&&He>0||Ae<0&&Oe<0&&Ie<0&&He<0}(s))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const u=nu(this.tileID,this.map.transform.projection),[d,f,g,v]=this.coordinates.map(j=>{const U=u.projection.project(j[0],j[1]);return M3(u,U)._round()});this.perspectiveTransform=Tz(d.x,d.y,f.x,f.y,g.x,g.y,v.x,v.y);const b=this._boundsArray=new Gr;b.emplaceBack(d.x,d.y,0,0),b.emplaceBack(f.x,f.y,_t,0),b.emplaceBack(v.x,v.y,0,_t),b.emplaceBack(g.x,g.y,_t,_t),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(b,U0.members),this.boundsSegments=wn.simpleSegment(0,0,4,2);const T=[],M=function(j){return[J0(j[0]),J0(j[1]),J0(j[2]),J0(j[3])]}(this.coordinates),[k,I,R,B]=function(j){let U=j[0][0],J=U,ee=j[0][1],oe=ee;for(let ue=1;ue<j.length;ue++)j[ue][0]<U?U=j[ue][0]:j[ue][0]>J&&(J=j[ue][0]),j[ue][1]<ee?ee=j[ue][1]:j[ue][1]>oe&&(oe=j[ue][1]);return[U,ee,J-U,oe-ee]}(M);{const j=new Gr,[U,J,ee,oe]=function(Ue){let vt=Ue[0].x,Tt=vt,ot=Ue[0].y,Ut=ot;for(let At=1;At<Ue.length;At++)Ue[At].x<vt?vt=Ue[At].x:Ue[At].x>Tt&&(Tt=Ue[At].x),Ue[At].y<ot?ot=Ue[At].y:Ue[At].y>Ut&&(Ut=Ue[At].y);return[vt,ot,Tt-vt,Ut-ot]}(s),ue=Ue=>[(Ue.x-U)/ee,(Ue.y-J)/oe],[fe,xe,Te,Ae]=s.map(ue),Oe=function(Ue,vt,Tt,ot,Ut,At,yt,Gt){const Lt=K0(0,0,1,0,1,1,0,1),Nt=K0(Ue,vt,Tt,ot,Ut,At,yt,Gt),ft=a.bx.adjoint([],Nt);return a.bx.multiply(Lt,Lt,ft)}(fe[0],fe[1],xe[0],xe[1],Te[0],Te[1],Ae[0],Ae[1]);this.elevatedGlobePerspectiveTransform=Tz(fe[0],fe[1],xe[0],xe[1],Te[0],Te[1],Ae[0],Ae[1]);const Ie=(Ue,vt)=>{T.push(Ue.lng);const Tt=Math.round((Ue.lng-k)/R*_t),ot=Math.round((Ue.lat-I)/B*_t),Ut=ue(vt),At=a.v.transformMat3([],[Ut[0],Ut[1],1],Oe),yt=Math.round(At[0]/At[2]*_t),Gt=Math.round(At[1]/At[2]*_t);j.emplaceBack(Tt,ot,yt,Gt)},He=s[3].x-s[0].x,lt=s[3].y-s[0].y,Ge=s[2].x-s[1].x,et=s[2].y-s[1].y;for(let Ue=0;Ue<65;Ue++){const vt=Ue/64,Tt=[s[0].x+vt*He,s[0].y+vt*lt],ot=[s[1].x+vt*Ge,s[1].y+vt*et],Ut=ot[0]-Tt[0],At=ot[1]-Tt[1];for(let yt=0;yt<65;yt++){const Gt=yt/64,Lt={x:Tt[0]+Ut*Gt,y:Tt[1]+At*Gt,z:0};Ie(i.projection.unproject(Lt.x,Lt.y),Lt)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(j,U0.members)}{this.maxLongitudeTriangleSize=0;let j=[],U=new Zr;const J=(ee,oe,ue)=>{U.emplaceBack(ee,oe,ue);const fe=T[ee],xe=T[oe],Te=T[ue],Ae=Math.min(Math.min(fe,xe),Te),Oe=Math.max(Math.max(fe,xe),Te)-Ae;Oe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Oe),j.push(Ae+Oe/2)};for(let ee=0;ee<64;ee++)for(let oe=0;oe<64;oe++){const ue=65*ee+oe,fe=ue+1,xe=ue+65,Te=xe+1;J(ue,xe,fe),J(fe,xe,Te)}[j,U]=function(ee,oe){const ue=Array.from({length:ee.length},(Te,Ae)=>Ae);ue.sort((Te,Ae)=>ee[Te]-ee[Ae]);const fe=[],xe=new Zr;for(let Te=0;Te<ue.length;Te++){const Ae=ue[Te];fe.push(ee[Ae]);const Oe=3*Ae,Ie=Oe+1;xe.emplaceBack(oe.uint16[Oe],oe.uint16[Ie],oe.uint16[Ie+1])}return[fe,xe]}(j,U),this.elevatedGlobeTrianglesCenterLongitudes=j,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(U)}this.elevatedGlobeSegments=wn.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,R/_t,0,B/_t,0,0,I,k,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const i=this.map.painter.context,s=i.gl;!this._dirty||this.texture instanceof V0||(this.texture?this.texture.update(this.image):(this.texture=new ac(i,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(i)}loadTile(t,i){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},i(null)):(t.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const i=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!i)return null;const s=this.elevatedGlobeTrianglesCenterLongitudes;let u=((T,M)=>T+360*Math.round((M-T)/360))(t+180,s[0]);const d=new wn,f=(T,M)=>{d.segments.push({vertexOffset:0,primitiveOffset:T,vertexLength:i.segments[0].vertexLength,primitiveLength:M,sortKey:void 0,vaos:{}})},g=.51*this.maxLongitudeTriangleSize;if(Math.abs(s[0]-u)<=g){const T=jt(s,0,s.length,u+g);return T===s.length||f(T,it(s,T+1,s.length,u+360-g)-T),d}u<s[0]&&(u+=360);const v=it(s,0,s.length,u-g);if(v===s.length)return f(0,s.length),d;f(0,v-0);const b=jt(s,v+1,s.length,u+g);return b!==s.length&&f(b,s.length-b),d}}class UU extends St{constructor(t,i){super(t,{},i),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const GU=new Ke({visibility:new he(ze.layout_sky.visibility)});var WU={paint:new Ke({"sky-type":new he(ze.paint_sky["sky-type"]),"sky-atmosphere-sun":new he(ze.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new he(ze.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new he(ze.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new he(ze.paint_sky["sky-gradient-radius"]),"sky-gradient":new nt(ze.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new he(ze.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new he(ze.paint_sky["sky-atmosphere-color"]),"sky-opacity":new he(ze.paint_sky["sky-opacity"])}),layout:GU};function TS(r,t,i){const s=[0,0,1],u=a.q.identity([]);return a.q.rotateY(u,u,i?-st(r)+Math.PI:st(r)),a.q.rotateX(u,u,-st(t)),a.v.transformQuat(s,s,u),a.v.normalize(s,s)}var qU={paint:new Ke({})};const HU={circle:class extends St{constructor(r,t,i){super(r,TV,t,i)}createBucket(r){return new Vw(r)}queryRadius(r){const t=r;return tf("circle-radius",this,t)+tf("circle-stroke-width",this,t)+h0(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,i,s,u,d,f,g){const v=MI(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,r.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return kI(r,s,d,f,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(r,t){const i=AI(this);return{config:new ph(this,t),defines:i,overrideFog:!1}}},heatmap:class extends St{createBucket(r){return new II(r)}constructor(r,t,i){super(r,PV,t,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=d0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return tf("heatmap-radius",this,r)}queryIntersectsFeature(r,t,i,s,u,d,f,g){const v=this.paint.get("heatmap-radius").evaluate(t,i);return kI(r,s,d,f,g,!0,!0,new Pe(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(r,t){return r==="heatmap"?{config:new ph(this,t),overrideFog:!1}:{}}},hillshade:class extends St{constructor(r,t,i){super(r,zV,t,i)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},fill:class extends St{constructor(r,t,i){super(r,qV,t,i)}getProgramIds(){const r=this.paint.get("fill-pattern"),t=r&&r.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(r,t){return{config:new ph(this,t),overrideFog:!1}}recalculate(r,t){super.recalculate(r,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new y0(r)}queryRadius(){return h0(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,i,s,u,d){return!r.queryGeometry.isAboveHorizon&&wI(CI(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,r.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends St{constructor(r,t,i){super(r,BU,t,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(r){return new Jm(r)}queryRadius(){return h0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(r,t,i,s,u,d,f,g,v){const b=MI(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,r.pixelToTileUnitsFactor),T=this.paint.get("fill-extrusion-height").evaluate(t,i),M=this.paint.get("fill-extrusion-base").evaluate(t,i),k=[0,0],I=g&&d.elevation,R=d.elevation?d.elevation.exaggeration():1,B=r.tile.getBucket(this);if(I&&B instanceof Jm){const oe=B.centroidVertexArray,ue=v+1;ue<oe.length&&(k[0]=oe.geta_centroid_pos0(ue),k[1]=oe.geta_centroid_pos1(ue))}if(k[0]===0&&k[1]===1)return!1;d.projection.name==="globe"&&(s=pz([s],[new Pe(0,0),new Pe(_t,_t)],r.tileID.canonical).map(oe=>oe.polygon).flat());const j=I?g:null,[U,J]=function(oe,ue,fe,xe,Te,Ae,Oe,Ie,He,lt,Ge){return oe.projection.name==="globe"?function(et,Ue,vt,Tt,ot,Ut,At,yt,Gt,Lt,Nt){const ft=[],Kt=[],vr=et.projection.upVectorScale(Nt,et.center.lat,et.worldSize).metersToTile,rr=[0,0,0,1],mr=[0,0,0,1],zr=(sr,dn,on,Vr)=>{sr[0]=dn,sr[1]=on,sr[2]=Vr,sr[3]=1},nn=fz();vt>0&&(vt+=nn),Tt+=nn;for(const sr of Ue){const dn=[],on=[];for(const Vr of sr){const Wr=Vr.x+ot.x,Rr=Vr.y+ot.y,Pn=et.projection.projectTilePoint(Wr,Rr,Nt),fn=et.projection.upVector(Nt,Vr.x,Vr.y);let jn=vt,_i=Tt;if(At){const wo=gz(Wr,Rr,vt,Tt,At,yt,Gt,Lt);jn+=wo.base,_i+=wo.top}vt!==0?zr(rr,Pn.x+fn[0]*vr*jn,Pn.y+fn[1]*vr*jn,Pn.z+fn[2]*vr*jn):zr(rr,Pn.x,Pn.y,Pn.z),zr(mr,Pn.x+fn[0]*vr*_i,Pn.y+fn[1]*vr*_i,Pn.z+fn[2]*vr*_i),a.v.transformMat4(rr,rr,Ut),a.v.transformMat4(mr,mr,Ut),dn.push(new mf(rr[0],rr[1],rr[2])),on.push(new mf(mr[0],mr[1],mr[2]))}ft.push(dn),Kt.push(on)}return[ft,Kt]}(oe,ue,fe,xe,Te,Ae,Oe,Ie,He,lt,Ge):Oe?function(et,Ue,vt,Tt,ot,Ut,At,yt,Gt){const Lt=[],Nt=[],ft=[0,0,0,1];for(const Kt of et){const vr=[],rr=[];for(const mr of Kt){const zr=mr.x+Tt.x,nn=mr.y+Tt.y,sr=gz(zr,nn,Ue,vt,Ut,At,yt,Gt);ft[0]=zr,ft[1]=nn,ft[2]=sr.base,ft[3]=1,a.e.transformMat4(ft,ft,ot),ft[3]=Math.max(ft[3],1e-5);const dn=new mf(ft[0]/ft[3],ft[1]/ft[3],ft[2]/ft[3]);ft[0]=zr,ft[1]=nn,ft[2]=sr.top,ft[3]=1,a.e.transformMat4(ft,ft,ot),ft[3]=Math.max(ft[3],1e-5);const on=new mf(ft[0]/ft[3],ft[1]/ft[3],ft[2]/ft[3]);vr.push(dn),rr.push(on)}Lt.push(vr),Nt.push(rr)}return[Lt,Nt]}(ue,fe,xe,Te,Ae,Oe,Ie,He,lt):function(et,Ue,vt,Tt,ot){const Ut=[],At=[],yt=ot[8]*Ue,Gt=ot[9]*Ue,Lt=ot[10]*Ue,Nt=ot[11]*Ue,ft=ot[8]*vt,Kt=ot[9]*vt,vr=ot[10]*vt,rr=ot[11]*vt;for(const mr of et){const zr=[],nn=[];for(const sr of mr){const dn=sr.x+Tt.x,on=sr.y+Tt.y,Vr=ot[0]*dn+ot[4]*on+ot[12],Wr=ot[1]*dn+ot[5]*on+ot[13],Rr=ot[2]*dn+ot[6]*on+ot[14],Pn=ot[3]*dn+ot[7]*on+ot[15],fn=Vr+yt,jn=Wr+Gt,_i=Rr+Lt,wo=Math.max(Pn+Nt,1e-5),Wn=Vr+ft,Ln=Wr+Kt,Qi=Rr+vr,eo=Math.max(Pn+rr,1e-5);zr.push(new mf(fn/wo,jn/wo,_i/wo)),nn.push(new mf(Wn/eo,Ln/eo,Qi/eo))}Ut.push(zr),At.push(nn)}return[Ut,At]}(ue,fe,xe,Te,Ae)}(d,s,M,T,b,f,j,k,R,d.center.lat,r.tileID.canonical),ee=r.queryGeometry;return function(oe,ue,fe){let xe=1/0;wI(fe,ue)&&(xe=mz(fe,ue[0]));for(let Te=0;Te<ue.length;Te++){const Ae=ue[Te],Oe=oe[Te];for(let Ie=0;Ie<Ae.length-1;Ie++){const He=Ae[Ie],lt=[He,Ae[Ie+1],Oe[Ie+1],Oe[Ie],He];bI(fe,lt)&&(xe=Math.min(xe,mz(fe,lt)))}}return xe!==1/0&&xe}(U,J,ee.isPointQuery()?ee.screenBounds:ee.screenGeometry)}},line:class extends St{constructor(r,t,i){super(r,_z,t,i),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Qp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=wz.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new j0(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(r,t){const i=xz(this);return{config:new ph(this,t),defines:i,overrideFog:!1}}queryRadius(r){const t=r,i=Sz(tf("line-width",this,t),tf("line-gap-width",this,t)),s=tf("line-offset",this,t);return i/2+Math.abs(s)+h0(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,i,s,u,d){if(r.queryGeometry.isAboveHorizon)return!1;const f=CI(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,r.pixelToTileUnitsFactor),g=r.pixelToTileUnitsFactor/2*Sz(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),v=this.paint.get("line-offset").evaluate(t,i);return v&&(s=function(b,T){const M=[],k=new Pe(0,0);for(let I=0;I<b.length;I++){const R=b[I],B=[];for(let j=0;j<R.length;j++){const U=R[j],J=R[j+1],ee=j===0?k:U.sub(R[j-1])._unit()._perp(),oe=j===R.length-1?k:J.sub(U)._unit()._perp(),ue=ee._add(oe)._unit();ue._mult(1/(ue.x*oe.x+ue.y*oe.y)),B.push(ue._mult(T)._add(U))}M.push(B)}return M}(s,v*r.pixelToTileUnitsFactor)),function(b,T,M){for(let k=0;k<T.length;k++){const I=T[k];if(b.length>=3){for(let R=0;R<I.length;R++)if(xh(b,I[R]))return!0}if(xV(b,I,M))return!0}return!1}(f,s,g)}isTileClipped(){return!0}},symbol:D0,background:class extends St{constructor(r,t,i){super(r,jU,t,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},raster:class extends St{constructor(r,t,i){super(r,$U,t,i),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(r){return!(r&&r._source instanceof Ez)||!r._source.onNorthPole&&!r._source.onSouthPole&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-color"].value.expression,[t,i]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=d0({expression:r,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:i}],resolution:256}),this.colorRampTexture=null}},sky:class extends St{constructor(r,t,i){super(r,WU,t,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=d0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(r,t){if(this.paint.get("sky-type")==="atmosphere"){const s=this.paint.get("sky-atmosphere-sun"),u=!s,d=r.style.light,f=d.properties.get("position");return u&&d.properties.get("anchor")==="viewport"&&kr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?TS(f.azimuthal,90-f.polar,t):TS(s[0],90-s[1],t)}const i=this.paint.get("sky-gradient-center");return TS(i[0],90-i[1],t)}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}},slot:class extends St{constructor(r,t,i){super(r,qU,t)}},model:class extends St{constructor(r,t,i){super(r,SU,t,i)}createBucket(r){return new q3(r)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(r,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven()||r!=="model-color"&&r!=="model-color-mix-intensity"&&r!=="model-rotation"&&r!=="model-scale"&&r!=="model-translation"&&r!=="model-emissive-strength")}_isPropertyZoomDependent(r){const t=this._transitionablePaint._values[r];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof ah}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};class ZU{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class XU{constructor(){this.tasks={},this.taskQueue=[],Ti(["process"],this),this.invoker=new ZU(this.process),this.nextId=0}add(t,i){const s=this.nextId++,u=function({type:d,isSymbolTile:f,zoom:g}){return g=g||0,d==="message"?0:d!=="maybePrepare"||f?d!=="parseTile"||f?d==="parseTile"&&f?300-g:d==="maybePrepare"&&f?400-g:500:200-g:100-g}(i);if(u===0){Ce();try{t()}finally{}return null}return this.tasks[s]={fn:t,metadata:i,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){Ce();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const d=this.tasks[this.taskQueue[u]];d.priority<i&&(i=d.priority,t=u)}if(t===null)return null;const s=this.taskQueue[t];return this.taskQueue.splice(t,1),s}remove(){this.invoker.remove()}}class Cz{constructor(t,i,s){this.target=t,this.parent=i,this.mapId=s,this.callbacks={},this.cancelCallbacks={},Ti(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new XU}send(t,i,s,u,d=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=f,this.callbacks[g]=s);const v=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!s,targetMapId:u,mustQueue:d,sourceMapId:this.mapId,data:h(i,v)},v),{cancel:()=>{s&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(t){const i=t.data,s=i.id;if(s&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const u=this.cancelCallbacks[s];delete this.cancelCallbacks[s],u&&u.cancel()}else if(i.mustQueue||Ce()){const u=this.callbacks[s],d=this.scheduler.add(()=>this.processTask(s,i),u&&u.metadata||{type:"message"});d&&(this.cancelCallbacks[s]=d)}else this.processTask(s,i)}processTask(t,i){if(delete this.cancelCallbacks[t],i.type==="<response>"){const s=this.callbacks[t];delete this.callbacks[t],s&&(i.error?s(_(i.error)):s(null,_(i.data)))}else{const s=new Set,u=i.hasCallback?(f,g)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?h(f):null,data:h(g,s)},s)}:f=>{},d=_(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,d,u);else if(this.parent.getWorkerSource){const f=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,f[0],d.source,d.scope)[f[1]](d,u)}else u(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class eg{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=sn();const s=this.workerPool.acquire(this.id);for(let u=0;u<s.length;u++){const d=new eg.Actor(s[u],i,this.id);d.name=`Worker ${u}`,this.actors.push(d)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,i,s){_r(this.actors,(u,d)=>{u.send(t,i,d)},s=s||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}eg.Actor=Cz;class Mz{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new ic({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const s=this.getKey(t,i);return this.positions[s]}trim(){const t=this.width,i=this.height=Si(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,s){const u=[];let d=t.length%2==1?-t[t.length-1]*s:0,f=t[0]*s,g=!0;u.push({left:d,right:f,isDash:g,zeroLength:t[0]===0});let v=t[0];for(let b=1;b<t.length;b++){g=!g;const T=t[b];d=v*s,v+=T,f=v*s,u.push({left:d,right:f,isDash:g,zeroLength:T===0})}return u}addRoundDash(t,i,s){const u=i/2;for(let d=-s;d<=s;d++){const f=this.width*(this.nextRow+s+d);let g=0,v=t[g];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++g]);const T=Math.abs(b-v.left),M=Math.abs(b-v.right),k=Math.min(T,M);let I;const R=d/s*(u+1);if(v.isDash){const B=u-Math.abs(R);I=Math.sqrt(k*k+B*B)}else I=u-Math.sqrt(k*k+R*R);this.image.data[f+b]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(t,i){for(let v=t.length-1;v>=0;--v){const b=t[v],T=t[v+1];b.zeroLength?t.splice(v,1):T&&T.isDash===b.isDash&&(T.left=b.left,t.splice(v,1))}const s=t[0],u=t[t.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const d=this.width*this.nextRow;let f=0,g=t[f];for(let v=0;v<this.width;v++){v/g.right>1&&(g=t[++f]);const b=Math.abs(v-g.left),T=Math.abs(v-g.right),M=Math.min(b,T);this.image.data[d+v]=Math.max(0,Math.min(255,(g.isDash?M:-M)+i+128))}}addDash(t,i){const s=this.getKey(t,i);if(this.positions[s])return this.positions[s];const u=i==="round",d=u?7:0,f=2*d+1;if(this.nextRow+f>this.height)return kr("LineAtlas out of space"),null;t.length===0&&t.push(1);let g=0;for(let T=0;T<t.length;T++)t[T]<0&&(kr("Negative value is found in line dasharray, replacing values with 0"),t[T]=0),g+=t[T];if(g!==0){const T=this.width/g,M=this.getDashRanges(t,this.width,T);u?this.addRoundDash(M,T,d):this.addRegularDash(M,i==="square"?.5*T:0)}const v=this.nextRow+d;this.nextRow+=f;const b={tl:[v,d],br:[g,0]};return this.positions[s]=b,b}}Ct(Mz,"LineAtlas");const Az=1*Sa;class kz{constructor(t){const i={},s=[];for(const g in t){const v=t[g],b=i[g]={};for(const T in v.glyphs){const M=v.glyphs[+T];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const k=M.metrics.localGlyph?Az:1,I={x:0,y:0,w:M.bitmap.width+2*k,h:M.bitmap.height+2*k};s.push(I),b[T]=I}}const{w:u,h:d}=sS(s),f=new ic({width:u||1,height:d||1});for(const g in t){const v=t[g];for(const b in v.glyphs){const T=v.glyphs[+b];if(!T||T.bitmap.width===0||T.bitmap.height===0)continue;const M=i[g][b],k=T.metrics.localGlyph?Az:1;ic.copy(T.bitmap,f,{x:0,y:0},{x:M.x+k,y:M.y+k},T.bitmap)}}this.image=f,this.positions=i}}Ct(kz,"GlyphAtlas");class YU{constructor(t){this.tileID=new Mi(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=nu(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,i,s,u,d){this.status="parsing",this.data=t,this.collisionBoxArray=new ow;const f=new $I(Object.keys(t.layers).sort()),g=new tS(this.tileID,this.promoteId);g.bucketLayerIDs=[];const v={},b=new Mz(256,256),T={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:s,brightness:this.brightness},M=i.familiesBySource[this.source];for(const J in M){const ee=t.layers[J];if(!ee)continue;let oe=!1,ue=!1,fe=!1;for(const Ae of M[J])Ae[0].type==="symbol"?oe=!0:ue=!0,Ae[0].is3D()&&Ae[0].type!=="model"&&(fe=!0);if(this.extraShadowCaster&&!fe||this.isSymbolTile===!0&&!oe||this.isSymbolTile===!1&&!ue)continue;ee.version===1&&kr(`Vector tile source "${this.source}" layer "${J}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xe=f.encode(J),Te=[];for(let Ae=0;Ae<ee.length;Ae++){const Oe=ee.feature(Ae),Ie=g.getId(Oe,J);Te.push({feature:Oe,id:Ie,index:Ae,sourceLayerIndex:xe})}for(const Ae of M[J]){const Oe=Ae[0];(!this.extraShadowCaster||Oe.is3D()&&Oe.type!=="model")&&(this.isSymbolTile!==void 0&&Oe.type==="symbol"!==this.isSymbolTile||Oe.minzoom&&this.zoom<Math.floor(Oe.minzoom)||Oe.maxzoom&&this.zoom>=Oe.maxzoom||Oe.visibility!=="none"&&(ES(Ae,this.zoom,T.brightness,s),(v[Oe.id]=Oe.createBucket({index:g.bucketLayerIDs.length,layers:Ae,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xe,sourceID:this.source,projection:this.projection.spec})).populate(Te,T,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(Ae.map(Ie=>Ie.id))))}}let k,I,R,B;b.trim();const j={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},U=()=>{if(k)return this.status="done",d(k);if(this.extraShadowCaster)this.status="done",d(null,{buckets:wr(v).filter(J=>!J.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:T.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(I&&R&&B){const J=new kz(I),ee=new y3(R,B);for(const oe in v){const ue=v[oe];ue instanceof qm?(ES(ue.layers,this.zoom,T.brightness,s),q$(ue,I,J.positions,R,ee.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):ue.hasPattern&&(ue instanceof j0||ue instanceof y0||ue instanceof Jm)&&(ES(ue.layers,this.zoom,T.brightness,s),ue.addFeatures(T,this.tileID.canonical,ee.patternPositions,s,this.tileTransform,this.brightness))}this.status="done",d(null,{buckets:wr(v).filter(oe=>!oe.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:J.image,lineAtlas:b,imageAtlas:ee,brightness:T.brightness})}};if(!this.extraShadowCaster){const J=oi(T.glyphDependencies,ue=>Object.keys(ue).map(Number));Object.keys(J).length?u.send("getGlyphs",{uid:this.uid,stacks:J,scope:this.scope},(ue,fe)=>{k||(k=ue,I=fe,U())},void 0,!1,j):I={};const ee=Object.keys(T.iconDependencies);ee.length?u.send("getImages",{icons:ee,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(ue,fe)=>{k||(k=ue,R=fe,U())},void 0,!1,j):R={};const oe=Object.keys(T.patternDependencies);oe.length?u.send("getImages",{icons:oe,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(ue,fe)=>{k||(k=ue,B=fe,U())},void 0,!1,j):B={}}U()}}function ES(r,t,i,s){const u=new ve(t,{brightness:i});for(const d of r)d.recalculate(u,s)}class Pz{constructor(t){this.entries={},this.scheduler=t}request(t,i,s,u){const d=this.entries[t]=this.entries[t]||{callbacks:[]};if(d.result){const[f,g]=d.result;return this.scheduler?this.scheduler.add(()=>{u(f,g)},i):u(f,g),()=>{}}return d.callbacks.push(u),d.cancel||(d.cancel=s((f,g)=>{d.result=[f,g];for(const v of d.callbacks)this.scheduler?this.scheduler.add(()=>{v(f,g)},i):v(f,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(f=>f!==u),d.callbacks.length||(d.cancel(),delete this.entries[t]))}}}function Iz(r,t,i){const s=JSON.stringify(r.request);return r.data&&(this.deduped.entries[s]={result:[null,r.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},u=>{const d=si(r.request,(f,g,v,b)=>{f?u(f):g&&u(null,{vectorTile:i?void 0:new Qw(new T0(g)),rawData:g,cacheControl:v,expires:b})});return()=>{d.cancel(),u()}},t)}var tg={workerUrl:"",workerClass:null,workerParams:void 0};function KU(){return tg.workerClass!=null?new tg.workerClass:new self.Worker(tg.workerUrl,tg.workerParams)}const CS="mapboxgl_preloaded_worker_pool";class rg{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<rg.workerCount;)this.workers.push(new KU);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[CS]}numActive(){return Object.keys(this.active).length}}let ng;function MS(){return ng||(ng=new rg),ng}rg.workerCount=2;let Q0,AS,Ea,kS=null;function zz(){return Ce()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:AS||L.DRACO_URL}const PS=5123,IS=5126,zS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[PS]:Uint16Array,5125:Uint32Array,[IS]:Float32Array},JU={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[PS]:"DT_UINT16",5125:"DT_UINT32",[IS]:"DT_FLOAT32"},RS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Rz(r,t,i){const s=i.json.bufferViews.length,u=i.buffers.length;t.bufferView=s,i.json.bufferViews[s]={buffer:u,byteLength:r.byteLength},i.buffers[u]=r}const DS="KHR_draco_mesh_compression";function QU(r,t){const i=r.extensions&&r.extensions[DS];if(!i)return;const s=new Ea.Decoder,u=Bz(t,i.bufferView),d=new Ea.Mesh;if(!s.DecodeArrayToMesh(u,u.byteLength,d))throw new Error("Failed to decode Draco mesh");const f=t.json.accessors[r.indices],g=zS[f.componentType],v=f.count*g.BYTES_PER_ELEMENT,b=Ea._malloc(v);g===Uint16Array?s.GetTrianglesUInt16Array(d,v,b):s.GetTrianglesUInt32Array(d,v,b),Rz(Ea.memory.buffer.slice(b,b+v),f,t),Ea._free(b);for(const T of Object.keys(i.attributes)){const M=s.GetAttributeByUniqueId(d,i.attributes[T]),k=t.json.accessors[r.attributes[T]],I=JU[k.componentType],R=k.count*RS[k.type]*zS[k.componentType].BYTES_PER_ELEMENT,B=Ea._malloc(R);s.GetAttributeDataArrayForAllPoints(d,M,Ea[I],R,B),Rz(Ea.memory.buffer.slice(B,B+R),k,t),Ea._free(B)}s.destroy(),d.destroy(),delete r.extensions[DS]}const Dz=1179937895,Lz=new TextDecoder("utf8");function Oz(r,t){return new URL(r,t).href}function e7(r,t,i,s){return fetch(Oz(r.uri,s)).then(u=>u.arrayBuffer()).then(u=>{t.buffers[i]=u})}function Bz(r,t){const i=r.json.bufferViews[t];return new Uint8Array(r.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function t7(r,t,i,s){if(r.uri){const u=Oz(r.uri,s);return fetch(u).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{t.images[i]=d})}if(r.bufferView!==void 0){const u=Bz(t,r.bufferView),d=new Blob([u],{type:r.mimeType});return createImageBitmap(d).then(f=>{t.images[i]=f})}}function Fz(r,t=0,i){const s={json:null,images:[],buffers:[]};if(new Uint32Array(r,t,1)[0]===Dz){const b=new Uint32Array(r,t);let T=2;const M=(b[T++]>>2)-3,k=b[T++]>>2;if(T++,s.json=JSON.parse(Lz.decode(b.subarray(T,T+k))),T+=k,T<M){const I=b[T++];T++;const R=t+(T<<2);s.buffers[0]=r.slice(R,R+I)}}else s.json=JSON.parse(Lz.decode(new Uint8Array(r,t)));const{buffers:u,images:d,meshes:f,extensionsUsed:g}=s.json;let v=Promise.resolve();if(u){const b=[];for(let T=0;T<u.length;T++){const M=u[T];M.uri?b.push(e7(M,s,T,i)):s.buffers[T]||(s.buffers[T]=null)}v=Promise.all(b)}return v.then(()=>{const b=[],T=g&&g.includes(DS);if(T&&b.push(function(){if(!Ea)return Q0||(Q0=function(M){let k,I=null;function R(){k=new Uint8Array(I.buffer)}function B(){throw new Error("Unexpected Draco error.")}const j={a:{a:B,d:function(U,J,ee){return k.copyWithin(U,J,J+ee)},c:function(U){const J=k.length,ee=Math.max(U>>>0,Math.ceil(1.2*J)),oe=Math.ceil((ee-J)/65536);try{return I.grow(oe),R(),!0}catch{return!1}},b:B}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,j):M.then(U=>U.arrayBuffer()).then(U=>WebAssembly.instantiate(U,j))).then(U=>{const{Rb:J,Qb:ee,P:oe,T:ue,X:fe,Ja:xe,La:Te,Qa:Ae,Va:Oe,Wa:Ie,eb:He,jb:lt,f:Ge,e:et,yb:Ue,zb:vt,Ab:Tt,Bb:ot,Db:Ut,Gb:At}=U.instance.exports;I=et;const yt=(()=>{let Gt=0,Lt=0,Nt=0,ft=0;return Kt=>{Nt&&(J(ft),J(Gt),Lt+=Nt,Nt=Gt=0),Gt||(Lt+=128,Gt=ee(Lt));const vr=Kt.length+7&-8;let rr=Gt;vr>=Lt&&(Nt=vr,rr=ft=ee(vr));for(let mr=0;mr<Kt.length;mr++)k[rr+mr]=Kt[mr];return rr}})();return R(),Ge(),{memory:et,_free:J,_malloc:ee,Mesh:class{constructor(){this.ptr=oe()}destroy(){ue(this.ptr)}},Decoder:class{constructor(){this.ptr=xe()}destroy(){lt(this.ptr)}DecodeArrayToMesh(Gt,Lt,Nt){const ft=yt(Gt),Kt=Te(this.ptr,ft,Lt,Nt.ptr);return!!fe(Kt)}GetAttributeByUniqueId(Gt,Lt){return{ptr:Ae(this.ptr,Gt.ptr,Lt)}}GetTrianglesUInt16Array(Gt,Lt,Nt){Oe(this.ptr,Gt.ptr,Lt,Nt)}GetTrianglesUInt32Array(Gt,Lt,Nt){Ie(this.ptr,Gt.ptr,Lt,Nt)}GetAttributeDataArrayForAllPoints(Gt,Lt,Nt,ft,Kt){He(this.ptr,Gt.ptr,Lt.ptr,Nt,ft,Kt)}},DT_INT8:Ue(),DT_UINT8:vt(),DT_INT16:Tt(),DT_UINT16:ot(),DT_UINT32:Ut(),DT_FLOAT32:At()}})}(fetch(zz())),Q0.then(M=>{Ea=M,Q0=void 0}))}()),d)for(let M=0;M<d.length;M++)b.push(t7(d[M],s,M,i));return(b.length?Promise.all(b):Promise.resolve()).then(()=>{if(T&&f)for(const{primitives:M}of f)for(const k of M)QU(k,s);return s})})}class Nz{constructor(t,i,s){if(this.triangleCount=i.length/3,this.min=new Pe(0,0),this.max=new Pe(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||s===0)return;const u=t.map(T=>T.x),d=t.map(T=>T.y);this.min=new Pe(Math.min(...u),Math.min(...d)),this.max=new Pe(Math.max(...u),Math.max(...d));const f=this.max.sub(this.min);f.x=Math.max(f.x,1),f.y=Math.max(f.y,1);const g=Math.max(f.x,f.y)/s;this.cellsX=Math.max(1,Math.ceil(f.x/g)),this.cellsY=Math.max(1,Math.ceil(f.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let T=0;T<this.triangleCount;T++){const M=t[i[3*T+0]].sub(this.min),k=t[i[3*T+1]].sub(this.min),I=t[i[3*T+2]].sub(this.min),R=cu(Math.floor(Math.min(M.x,k.x,I.x)),this.xScale,this.cellsX),B=cu(Math.floor(Math.max(M.x,k.x,I.x)),this.xScale,this.cellsX),j=cu(Math.floor(Math.min(M.y,k.y,I.y)),this.yScale,this.cellsY),U=cu(Math.floor(Math.max(M.y,k.y,I.y)),this.yScale,this.cellsY),J=new Pe(0,0),ee=new Pe(0,0),oe=new Pe(0,0),ue=new Pe(0,0);for(let fe=j;fe<=U;++fe){J.y=ee.y=fe*g,oe.y=ue.y=(fe+1)*g;for(let xe=R;xe<=B;++xe)J.x=oe.x=xe*g,ee.x=ue.x=(xe+1)*g,(Gw(M,k,I,J,ee,ue)||Gw(M,k,I,J,ue,oe))&&v.push({cellIdx:fe*this.cellsX+xe,triIdx:T})}}if(v.length===0)return;v.sort((T,M)=>T.cellIdx-M.cellIdx||T.triIdx-M.triIdx);let b=0;for(;b<v.length;){const T=v[b].cellIdx,M={start:this.payload.length,len:0};for(;b<v.length&&v[b].cellIdx===T;)++M.len,this.payload.push(v[b++].triIdx);this.cells[T]=M}}query(t,i,s){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>i.x||t.y>this.max.y||this.min.y>i.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const u=cu(t.x-this.min.x,this.xScale,this.cellsX),d=cu(i.x-this.min.x,this.xScale,this.cellsX),f=cu(t.y-this.min.y,this.yScale,this.cellsY),g=cu(i.y-this.min.y,this.yScale,this.cellsY);for(let v=f;v<=g;v++)for(let b=u;b<=d;b++){const T=this.cells[v*this.cellsX+b];if(T)for(let M=0;M<T.len;M++){const k=this.payload[T.start+M],I=Math.floor(k/8),R=1<<k%8;if(!(this.lookup[I]&R)&&(this.lookup[I]|=R,s.push(k),s.length===this.triangleCount))return}}}}function cu(r,t,i){return Math.max(0,Math.min(i-1,Math.floor(r*t)))}function Ch(r,t){const i=r.json.bufferViews[t.bufferView];return new zS[t.componentType](r.buffers[i.buffer],(t.byteOffset||0)+(i.byteOffset||0),t.count*RS[t.type])}function r7(r,t,i){const s=r.indices,u=r.attributes,d={};d.indexArray=new Zr;const f=t.json.accessors[s],g=f.count/3;d.indexArray.reserve(g);const v=Ch(t,f);for(let k=0;k<g;k++)d.indexArray.emplaceBack(v[3*k],v[3*k+1],v[3*k+2]);d.indexArray._trim(),d.vertexArray=new dh;const b=t.json.accessors[u.POSITION];d.vertexArray.reserve(b.count);const T=Ch(t,b);for(let k=0;k<b.count;k++)d.vertexArray.emplaceBack(T[3*k],T[3*k+1],T[3*k+2]);if(d.vertexArray._trim(),d.aabb=new Gn(b.min,b.max),d.centroid=function(k,I){const R=[0,0,0],B=k.length;if(B>0){for(let j=0;j<B;j++){const U=3*k[j];R[0]+=I[U],R[1]+=I[U+1],R[2]+=I[U+2]}R[0]/=B,R[1]/=B,R[2]/=B}return R}(v,T),u.COLOR_0!==void 0){const k=t.json.accessors[u.COLOR_0],I=RS[k.type];if(k.componentType===IS){d.colorArray=I===3?new dh:new Nr,d.colorArray.reserve(k.count);const R=Ch(t,k);if(I===3)for(let B=0;B<k.count;B++)d.colorArray.emplaceBack(R[3*B],R[3*B+1],R[3*B+2]);else for(let B=0;B<k.count;B++)d.colorArray.emplaceBack(R[4*B],R[4*B+1],R[4*B+2],R[4*B+3]);d.colorArray._trim()}else if(k.componentType===PS&&I===4){d.colorArray=new Nr,d.colorArray.resize(k.count);const R=Ch(t,k),B=1/65535,j=d.colorArray.float32;for(let U=0;U<4*R.length;++U)j[U]=R[U]*B}else kr(`glTF color buffer parsing for accessor ${JSON.stringify(k)} is not supported`)}if(u.NORMAL!==void 0){d.normalArray=new dh;const k=t.json.accessors[u.NORMAL];d.normalArray.reserve(k.count);const I=Ch(t,k);for(let R=0;R<k.count;R++)d.normalArray.emplaceBack(I[3*R],I[3*R+1],I[3*R+2]);d.normalArray._trim()}if(u.TEXCOORD_0!==void 0&&i.length>0){d.texcoordArray=new Em;const k=t.json.accessors[u.TEXCOORD_0];d.texcoordArray.reserve(k.count);const I=Ch(t,k);for(let R=0;R<k.count;R++)d.texcoordArray.emplaceBack(I[2*R],I[2*R+1]);d.texcoordArray._trim()}const M=r.material;return d.material=function(k,I){const{emissiveFactor:R=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:j=.5,normalTexture:U,occlusionTexture:J,emissiveTexture:ee,doubleSided:oe}=k,{baseColorFactor:ue=[1,1,1,1],metallicFactor:fe=1,roughnessFactor:xe=1,baseColorTexture:Te,metallicRoughnessTexture:Ae}=k.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new Hr(...ue),metallicFactor:fe,roughnessFactor:xe,baseColorTexture:Te?I[Te.index]:void 0,metallicRoughnessTexture:Ae?I[Ae.index]:void 0},doubleSided:oe,emissiveFactor:R,alphaMode:B,alphaCutoff:j,normalTexture:U?I[U.index]:void 0,occlusionTexture:J?I[J.index]:void 0,emissionTexture:ee?I[ee.index]:void 0,defined:k.defined===void 0}}(M!==void 0?t.json.materials[M]:{defined:!1},i),u._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(Ch(t,t.json.accessors[u._FEATURE_RGBA4444]).buffer)),d}function jz(r,t,i){const{matrix:s,rotation:u,translation:d,scale:f,mesh:g,extras:v,children:b}=r,T={};if(T.matrix=s||a.m.fromRotationTranslationScale([],u||[0,0,0,1],d||[0,0,0],f||[1,1,1]),g!==void 0){T.meshes=i[g];const M=T.anchor=[0,0];for(const k of T.meshes){const{min:I,max:R}=k.aabb;M[0]+=I[0]+R[0],M[1]+=I[1]+R[1]}M[0]=Math.floor(M[0]/T.meshes.length/2),M[1]=Math.floor(M[1]/T.meshes.length/2)}if(v&&(v.id&&(T.id=v.id),v.lights&&(T.lights=function(M){if(!M.length)return[];const k=function(U){const J=atob(U),ee=new Uint8Array(J.length);for(let oe=0;oe<J.length;oe++)ee[oe]=J.codePointAt(oe);return ee}(M),I=[],R=k.length/24,B=new Uint16Array(k.buffer),j=new Float32Array(k.buffer);for(let U=0;U<R;U++){const J=B[2*U*6]/30,ee=B[2*U*6+1]/30,oe=B[2*U*6+10]/100,ue=j[6*U+1],fe=j[6*U+2],xe=j[6*U+3],Te=j[6*U+4],Ae=xe-ue,Oe=Te-fe,Ie=Math.hypot(Ae,Oe);I.push({pos:[ue+.5*Ae,fe+.5*Oe,ee],normal:[Oe/Ie,-Ae/Ie,0],width:Ie,height:J,depth:oe,points:[ue,fe,xe,Te]})}return I}(v.lights))),b){const M=[];for(const k of b)M.push(jz(t.json.nodes[k],t,i));T.children=M}return T}function n7(r){if(r.vertices.length===0||r.indices.length===0)return null;const[t,i]=[r.vertices[0].clone(),r.vertices[0].clone()];for(let f=1;f<r.vertices.length;++f){const g=r.vertices[f];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),i.x=Math.max(i.x,g.x),i.y=Math.max(i.y,g.y)}const s=Math.ceil(Math.max(i.x-t.x,i.y-t.y)/256),u=Math.max(8,s),d=new Nz(r.vertices,r.indices,u);return{vertices:r.vertices,indices:r.indices,grid:d,min:t,max:i}}function i7(r){if(!r.extras||!r.extras.ground)return null;const t=r.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const i=t[0];if(!i||!Array.isArray(i)||i.length===0)return null;const s=[];for(const f of i){if(!Array.isArray(f)||f.length!==2)continue;const g=f[0],v=f[1];typeof g=="number"&&typeof v=="number"&&s.push(new Pe(g,v))}if(s.length<3)return null;s.length>1&&s[s.length-1].equals(s[0])&&s.pop();let u=0;for(let f=0;f<s.length;f++){const g=s[f],v=s[(f+1)%s.length],b=s[(f+2)%s.length];u+=(g.x-v.x)*(b.y-v.y)-(b.x-v.x)*(g.y-v.y)}u>0&&s.reverse();const d=_0(s.flatMap(f=>[f.x,f.y]),[]);return d.length===0?null:{vertices:s,indices:d}}function o7(r){const t=[],i=[];let s=0;for(const u of r){s=t.length;const d=u.vertexArray.float32,f=u.indexArray.uint16;for(let g=0;g<u.vertexArray.length;g++)t.push(new Pe(d[3*g+0],d[3*g+1]));for(let g=0;g<3*u.indexArray.length;g++)i.push(f[g]+s)}if(i.length%3!=0)return null;for(let u=0;u<i.length;u+=3){const d=t[i[u+0]],f=t[i[u+1]],g=t[i[u+2]];(d.x-f.x)*(g.y-f.y)-(g.x-f.x)*(d.y-f.y)>0&&([i[u+1],i[u+2]]=[i[u+2],i[u+1]])}return{vertices:t,indices:i}}function Vz(r){const t=function(v,b){const T=[],M=WebGL2RenderingContext;if(v.json.textures)for(const k of v.json.textures){const I={magFilter:M.LINEAR,minFilter:M.NEAREST,wrapS:M.REPEAT,wrapT:M.REPEAT};k.sampler!==void 0&&Object.assign(I,v.json.samplers[k.sampler]),T.push({image:b[k.source],sampler:I,uploaded:!1})}return T}(r,r.images),i=function(v,b){const T=[];for(const M of v.json.meshes){const k=[];for(const I of M.primitives)k.push(r7(I,v,b));T.push(k)}return T}(r,t),{scenes:s,scene:u,nodes:d}=r.json,f=s?s[u||0].nodes:d,g=[];for(const v of f)g.push(jz(d[v],r,i));return function(v,b,T){const M={},k=new Set;for(let I=0;I<v.length;I++){const R=T[b[I]];if(!R.extras)continue;const B=R.extras["mapbox:footprint:version"],j=R.extras["mapbox:footprint:id"];(B||j)&&k.add(I),B==="1.0.0"&&j&&(M[j]=I)}for(let I=0;I<v.length;I++){if(k.has(I))continue;const R=v[I],B=T[b[I]];if(!B.extras)continue;let j=null;R.id in M&&(j=o7(v[M[R.id]].meshes)),j||(j=i7(B)),j&&(R.footprint=n7(j))}if(k.size>0){const I=Array.from(k.values()).sort((R,B)=>R-B);for(let R=I.length-1;R>=0;R--)v.splice(I[R],1)}}(g,f,r.json.nodes),g}function s7(r){r.heightmap=new Float32Array(4096),r.heightmap.fill(-1);const t=r.vertexArray.float32,i=r.aabb.min[0]-1,s=r.aabb.min[1]-1,u=Th/(r.aabb.max[0]-i+2),d=Th/(r.aabb.max[1]-s+2);for(let f=0;f<t.length;f+=3){const g=t[f+2],v=(t[f+0]-i)*u|0,b=(t[f+1]-s)*d|0;g>r.heightmap[b*Th+v]&&(r.heightmap[b*Th+v]=g)}}function a7(r,t){const i={};i.indexArray=new Zr,i.indexArray.reserve(4*r.length),i.vertexArray=new dh,i.vertexArray.reserve(10*r.length),i.colorArray=new Nr,i.vertexArray.reserve(10*r.length);let s=0;for(const f of r){const g=Math.min(10,Math.max(4,1.3*f.height))*t,v=[-f.normal[1],f.normal[0],0],b=Math.min(.29,.1*f.width/f.depth),T=f.width-2*f.depth*t*(b+.01),M=a.v.scaleAndAdd([],f.pos,v,T/2),k=a.v.scaleAndAdd([],f.pos,v,-T/2),I=[M[0],M[1],M[2]+f.height],R=[k[0],k[1],k[2]+f.height],B=a.v.scaleAndAdd([],f.normal,v,b);a.v.scale(B,B,g);const j=a.v.scaleAndAdd([],f.normal,v,-b);a.v.scale(j,j,g),a.v.add(B,M,B),a.v.add(j,k,j),M[2]+=.1,k[2]+=.1,i.vertexArray.emplaceBack(B[0],B[1],B[2]),i.vertexArray.emplaceBack(j[0],j[1],j[2]),i.vertexArray.emplaceBack(M[0],M[1],M[2]),i.vertexArray.emplaceBack(k[0],k[1],k[2]),i.vertexArray.emplaceBack(I[0],I[1],I[2]),i.vertexArray.emplaceBack(R[0],R[1],R[2]),i.vertexArray.emplaceBack(M[0],M[1],M[2]),i.vertexArray.emplaceBack(k[0],k[1],k[2]),i.vertexArray.emplaceBack(B[0],B[1],B[2]),i.vertexArray.emplaceBack(j[0],j[1],j[2]);const U=T/g/2;i.colorArray.emplaceBack(-U-b,-1,U,.8),i.colorArray.emplaceBack(U+b,-1,U,.8),i.colorArray.emplaceBack(-U,0,U,1.3),i.colorArray.emplaceBack(U,0,U,1.3),i.colorArray.emplaceBack(U+b,-.8,U,.7),i.colorArray.emplaceBack(U+b,-.8,U,.7),i.colorArray.emplaceBack(0,0,U,1.3),i.colorArray.emplaceBack(0,0,U,1.3),i.colorArray.emplaceBack(U+b,-1.2,U,.8),i.colorArray.emplaceBack(U+b,-1.2,U,.8),i.indexArray.emplaceBack(6+s,4+s,8+s),i.indexArray.emplaceBack(7+s,9+s,5+s),i.indexArray.emplaceBack(0+s,1+s,2+s),i.indexArray.emplaceBack(1+s,3+s,2+s),s+=10}const u={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=Hr.white,u.pbrMetallicRoughness=d,i.material=u,i.aabb=new Gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}Ct(Nz,"TriangleGridIndex");const $z=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class LS{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,s]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=s>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const d=$z[15&s];if(!d)throw new Error("Unrecognized array type.");const[f]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new LS(g,f,d,t)}constructor(t,i=64,s=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const d=$z.indexOf(this.ArrayType),f=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+f+g+v),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=i,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return OS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:f,nodeSize:g}=this,v=[0,d.length-1,0],b=[];for(;v.length;){const T=v.pop()||0,M=v.pop()||0,k=v.pop()||0;if(M-k<=g){for(let j=k;j<=M;j++){const U=f[2*j],J=f[2*j+1];U>=t&&U<=s&&J>=i&&J<=u&&b.push(d[j])}continue}const I=k+M>>1,R=f[2*I],B=f[2*I+1];R>=t&&R<=s&&B>=i&&B<=u&&b.push(d[I]),(T===0?t<=R:i<=B)&&(v.push(k),v.push(I-1),v.push(1-T)),(T===0?s>=R:u>=B)&&(v.push(I+1),v.push(M),v.push(1-T))}return b}within(t,i,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:d,nodeSize:f}=this,g=[0,u.length-1,0],v=[],b=s*s;for(;g.length;){const T=g.pop()||0,M=g.pop()||0,k=g.pop()||0;if(M-k<=f){for(let j=k;j<=M;j++)Gz(d[2*j],d[2*j+1],t,i)<=b&&v.push(u[j]);continue}const I=k+M>>1,R=d[2*I],B=d[2*I+1];Gz(R,B,t,i)<=b&&v.push(u[I]),(T===0?t-s<=R:i-s<=B)&&(g.push(k),g.push(I-1),g.push(1-T)),(T===0?t+s>=R:i+s>=B)&&(g.push(I+1),g.push(M),g.push(1-T))}return v}}function OS(r,t,i,s,u,d){if(u-s<=i)return;const f=s+u>>1;Uz(r,t,f,s,u,d),OS(r,t,i,s,f-1,1-d),OS(r,t,i,f+1,u,1-d)}function Uz(r,t,i,s,u,d){for(;u>s;){if(u-s>600){const b=u-s+1,T=i-s+1,M=Math.log(b),k=.5*Math.exp(2*M/3),I=.5*Math.sqrt(M*k*(b-k)/b)*(T-b/2<0?-1:1);Uz(r,t,i,Math.max(s,Math.floor(i-T*k/b+I)),Math.min(u,Math.floor(i+(b-T)*k/b+I)),d)}const f=t[2*i+d];let g=s,v=u;for(ig(r,t,s,i),t[2*u+d]>f&&ig(r,t,s,u);g<v;){for(ig(r,t,g,v),g++,v--;t[2*g+d]<f;)g++;for(;t[2*v+d]>f;)v--}t[2*s+d]===f?ig(r,t,s,v):(v++,ig(r,t,v,u)),v<=i&&(s=v+1),i<=v&&(u=v-1)}}function ig(r,t,i,s){BS(r,i,s),BS(t,2*i,2*s),BS(t,2*i+1,2*s+1)}function BS(r,t,i){const s=r[t];r[t]=r[i],r[i]=s}function Gz(r,t,i,s){const u=r-i,d=t-s;return u*u+d*d}a.$=45,a.A=Nn,a.B=function(r){const t=a.m.identity(new Float64Array(16));a.m.multiply(t,r.pixelMatrix,r.globeMatrix);const i=[0,Ws,0],s=[0,qs,0];return a.v.transformMat4(i,i,t),a.v.transformMat4(s,s,t),[i[0]>0&&i[0]<=r.width&&i[1]>0&&i[1]<=r.height&&!Lw(r,new jr(r.center.lat,90)),s[0]>0&&s[0]<=r.width&&s[1]>0&&s[1]<=r.height&&!Lw(r,new jr(r.center.lat,-90))]},a.C=Hr,a.D=Yc,a.E=cl,a.F=Aw,a.G=sI,a.H=ul,a.I=wh,a.J=_t,a.K=function(r,t){const{scale:i}=r.tileTransform,s=i*_t/(r.tileSize*Math.pow(2,t.zoom-r.tileID.overscaledZ+r.tileID.canonical.z));return a.h.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[s,s])},a.L=jr,a.M=Gi,a.N=G0,a.O=Mi,a.P=Pe,a.Q=B3,a.R=Cw,a.S=function(r){const t=B3(r,!0);return a.h.invert([],[t[0],t[1],t[4],t[5]])},a.T=Mw,a.U=rI,a.V=function(r){const{x:t,y:i}=r.point,{lng:s,lat:u}=r._center;return fI(t,i,r.worldSize,s,u)},a.W=Ss,a.X=kr,a.Y=ar,a.Z=kw,a._=function(r){const t=Math.round((r+45+360)%360/90)%4;return Bn[t]},a.a=Zs,a.a$=e0,a.a0=Bw,a.a1=function(r,t){return jo(Lr(r,{type:"json"}),t)},a.a2=kn,a.a3=Ye,a.a4=Di,a.a5=ws,a.a6=Uo,a.a7=ha,a.a8=po,a.a9=ac,a.aA=xh,a.aB=vI,a.aC=bs,a.aD=Pz,a.aE=wt,a.aF=Iz,a.aG=function(r){Jn++,Jn>Fr&&(r.getActor().send("enforceCacheSizeLimit",Zt),Jn=0)},a.aH=Tn,a.aI=Gu,a.aJ=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},a.aK=Ez,a.aL=function(r,t){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let s=0;s<r.length;s++){const u=document.createElement("source");Vo(r[s])||(i.crossOrigin="Anonymous"),u.src=r[s],i.appendChild(u)}return{cancel:()=>{}}},a.aM=Pt,a.aN=V0,a.aO=function(r){return fetch(r).then(t=>t.arrayBuffer()).then(t=>Fz(t,0,r))},a.aP=Vz,a.aQ=class{constructor(r,t,i,s){this.id=r,this.position=t!=null?new jr(t[0],t[1]):new jr(0,0),this.orientation=i??[0,0,0],this.nodes=s,this.uploaded=!1,this.aabb=new Gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(r,t){if(a.m.multiply(r.matrix,t,r.matrix),r.meshes)for(const i of r.meshes){const s=Gn.applyTransform(i.aabb,r.matrix);this.aabb.encapsulate(s)}if(r.children)for(const i of r.children)this._applyTransformations(i,r.matrix)}computeBoundsAndApplyParent(){const r=a.m.identity([]);for(const t of this.nodes)this._applyTransformations(t,r)}_positionModelOnTerrain(r,t){const i=r.elevation;if(!i)return 0;const s=Gn.projectAabbCorners(this.aabb,this.matrix),u=bo(1,this.position.lat)*r.worldSize,d=function(j,U){const J=[0,0,1],ee=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const oe of ee){const ue=j[oe.corners[0]],fe=j[oe.corners[1]],xe=j[oe.corners[2]],Te=[fe[0]-ue[0],fe[1]-ue[1],U*(fe[2]-ue[2])],Ae=a.v.cross(Te,Te,[xe[0]-ue[0],xe[1]-ue[1],U*(xe[2]-ue[2])]);a.v.normalize(Ae,Ae),oe.dotProductWithUp=a.v.dot(Ae,J)}return ee.sort((oe,ue)=>oe.dotProductWithUp-ue.dotProductWithUp),ee[0].corners}(s,u),f=s[d[0]],g=s[d[1]],v=s[d[2]],b=s[d[3]],T=i.getAtPointOrZero(new Gi(f[0]/r.worldSize,f[1]/r.worldSize),0),M=i.getAtPointOrZero(new Gi(g[0]/r.worldSize,g[1]/r.worldSize),0),k=i.getAtPointOrZero(new Gi(v[0]/r.worldSize,v[1]/r.worldSize),0),I=i.getAtPointOrZero(new Gi(b[0]/r.worldSize,b[1]/r.worldSize),0),R=(T+I)/2,B=(M+k)/2;return R>B?M<k?W0(t,g,b,f,M,I,T,u):W0(t,v,f,b,k,T,I,u):T<I?W0(t,f,g,v,T,M,k,u):W0(t,b,v,g,I,k,M,u),Math.max(R,B)}computeModelMatrix(r,t,i,s,u,d,f=!1){const g=r.transform,v=g.zoom,b=g.project(this.position),T=vh(this.position.lat,v),M=1/T;a.m.identity(this.matrix),a.m.translate(this.matrix,this.matrix,[b.x+s[0]*M,b.y+s[1]*M,s[2]]);let k=1,I=1;const R=g.worldSize;if(f){if(g.projection.name==="mercator"){let J=0;g.elevation&&(J=g.elevation.getAtPointOrZero(new Gi(b.x/R,b.y/R),0));const ee=a.e.transformMat4([],[b.x,b.y,J,1],g.projMatrix)[3]/g.cameraToCenterDistance;k=ee,I=ee*vh(g.center.lat,v)}else if(g.projection.name==="globe"){const J=U3(this.matrix,g),ee=a.m.multiply([],g.projMatrix,J),oe=[0,0,0,1];a.e.transformMat4(oe,oe,ee);const ue=oe[3]/g.cameraToCenterDistance,fe=nc(v),xe=g.projection.pixelsPerMeter(this.position.lat,R)*vh(this.position.lat,v),Te=g.projection.pixelsPerMeter(g.center.lat,R)*vh(g.center.lat,v);k=ue/ur(xe,_I(g.center.lat),fe),I=ue*T/xe,k*=Te,I*=Te}}else k=M;a.m.scale(this.matrix,this.matrix,[k,k,I]);const B=[...this.matrix],j=this.orientation,U=[];if($3(U,[j[0]+t[0],j[1]+t[1],j[2]+t[2]],i),a.m.multiply(this.matrix,B,U),u&&g.elevation){let J=0;const ee=[];if(d&&g.elevation){J=this._positionModelOnTerrain(g,ee);const oe=a.m.fromQuat([],ee),ue=a.m.multiply([],oe,U);a.m.multiply(this.matrix,B,ue)}else J=g.elevation.getAtPointOrZero(new Gi(b.x/R,b.y/R),0);J!==0&&(this.matrix[14]+=J)}}upload(r){if(!this.uploaded){for(const t of this.nodes)bS(t,r);for(const t of this.nodes)H0(t);this.uploaded=!0}}destroy(){for(const r of this.nodes)Z0(r)}},a.aR=Ti,a.aS=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.aT=_3,a.aU=bI,a.aV=Ni,a.aW=S3,a.aX=uS,a.aY=oS,a.aZ=LS,a.a_=Mm,a.aa=sS,a.ab=aS,a.ac=Ke,a.ad=he,a.ae=ze,a.af=class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return me(r.expression.evaluate(t))}interpolate(r,t,i){return{x:ur(r.x,t.x,i),y:ur(r.y,t.y,i),z:ur(r.z,t.z,i),azimuthal:ur(r.azimuthal,t.azimuthal,i),polar:ur(r.polar,t.polar,i)}}},a.ag=De,a.ah=r=>gs(vm(r)),a.ai=Yy,a.aj=Sm,a.ak=Lr,a.al=ve,a.am=ah,a.an=Jt,a.ao=nc,a.ap=r=>gs(wm(r)),a.aq=Dd,a.ar=Xe,a.as=class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return function([i,s]){const u=me([1,i,s]);return{x:u.x,y:u.y,z:u.z}}(r.expression.evaluate(t))}interpolate(r,t,i){return{x:ur(r.x,t.x,i),y:ur(r.y,t.y,i),z:ur(r.z,t.z,i)}}},a.at=function(r,t,i=0,s=!0){const u=new Pe(i,i),d=r.sub(u),f=t.add(u),g=[d,new Pe(f.x,d.y),f,new Pe(d.x,f.y)];return s&&g.push(d.clone()),g},a.au=function(r,t){const i=[];for(let s=0;s<r.length;s++){const u=qt(s-1,-1,r.length-1),d=qt(s+1,-1,r.length-1),f=r[s],g=r[d],v=r[u].sub(f).unit(),b=g.sub(f).unit(),T=b.angleWithSep(v.x,v.y),M=v.add(b).unit().mult(-1*t/Math.sin(T/2));i.push(f.add(M))}return i},a.av=M3,a.aw=EI,a.ax=function(r,t,i=0){return a.v.fromValues(((t.x-i)*r.scale-r.x)*_t,(t.y*r.scale-r.y)*_t,gI(t.z,t.y))},a.ay=V3,a.az=function(r){let t=1/0,i=1/0,s=-1/0,u=-1/0;for(const d of r)t=Math.min(t,d.x),i=Math.min(i,d.y),s=Math.max(s,d.x),u=Math.max(u,d.y);return{min:new Pe(t,i),max:new Pe(s,u)}},a.b=bo,a.b$=0,a.b0=fh,a.b1=Nk,a.b2=xo,a.b3=function(r,t,i){const s=Math.sqrt(r*r+t*t+i*i),u=s>0?Math.acos(i/s)*or:0;let d=r!==0||t!==0?Math.atan2(-t,-r)*or+90:0;return d<0&&(d+=360),[s,d,u]},a.b4=pf,a.b5=Ta,a.b6=_S,a.b7=lw,a.b8=class extends Yl{constructor(r){super(r),this.current=O8}set(r,t,i){if(this.fetchUniformLocation(r,t)){for(let s=0;s<9;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},a.b9=Fk,a.bA=function(r,t){const i=[0,0,0],s=Rm(ll(t.canonical));return a.v.transformMat4(i,i,s),a.v.transformMat4(i,i,r),i},a.bB=r=>({u_camera_to_center_distance:new xo(r),u_extrude_scale:new cw(r),u_device_pixel_ratio:new xo(r),u_matrix:new Mm(r),u_inv_rot_matrix:new Mm(r),u_merc_center:new fh(r),u_tile_id:new lw(r),u_zoom_transition:new xo(r),u_up_dir:new lw(r),u_emissive_strength:new xo(r)}),a.bC=r=>({u_matrix:new Mm(r),u_pixels_to_tile_units:new cw(r),u_device_pixel_ratio:new xo(r),u_units_to_pixels:new fh(r),u_dash_image:new e0(r),u_gradient_image:new e0(r),u_image_height:new xo(r),u_texsize:new fh(r),u_tile_units_to_pixels:new xo(r),u_alpha_discard_threshold:new xo(r),u_trim_offset:new fh(r),u_emissive_strength:new xo(r)}),a.bD=r=>({u_matrix:new Mm(r),u_texsize:new fh(r),u_pixels_to_tile_units:new cw(r),u_device_pixel_ratio:new xo(r),u_image:new e0(r),u_units_to_pixels:new fh(r),u_tile_units_to_pixels:new xo(r),u_alpha_discard_threshold:new xo(r)}),a.bE=_a,a.bF=k$,a.bG=P$,a.bH=AI,a.bI=(r,t,i,s,u,d)=>{const f=r.transform,g=f.projection.name==="globe";let v;if(d.paint.get("circle-pitch-alignment")==="map")if(g){const T=dI(f.zoom,t.canonical)*f._pixelsPerMercatorPixel;v=Float32Array.from([T,0,0,T])}else v=f.calculatePixelsToTileUnitsMatrix(i);else v=new Float32Array([f.pixelsToGLUnits[0],0,0,f.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:r.transform.getCameraToCenterDistance(f.projection),u_matrix:r.translatePosMatrix(t.projMatrix,i,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Di.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:EV,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=s,b.u_merc_center=u,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=nc(f.zoom);const T=u[0]*_t,M=u[1]*_t;b.u_up_dir=f.projection.upVector(new _h(0,0,0),T,M)}return b},a.bJ=xz,a.bK=(r,t,i,s,u)=>{const d=r.transform;return{u_matrix:vz(r,t,i,s),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:d.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:yz(t,d),u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}},a.bL=(r,t,i,s,u,d,f)=>{const g=r.transform,v=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:vz(r,t,i,s),u_pixels_to_tile_units:v,u_device_pixel_ratio:d,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:bz(i)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:yz(t,r.transform),u_alpha_discard_threshold:0,u_trim_offset:f,u_emissive_strength:i.paint.get("line-emissive-strength")}},a.bM=Si,a.bN=d0,a.bO=fz,a.bP=cV,a.bQ=Jm,a.bR=lu,a.bS=450,a.bT=7,a.bU=lI,a.bV=Rw,a.bW=Dt,a.bX=dh,a.bY=hh,a.bZ=1,a.b_=771,a.ba=Mr,a.bb=function(r,t,i){const s=nc(i.zoom),u=r.style.map._antialias,d=t.options.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return s===0&&!u&&!d},a.bc=function(r){const t=r.pixelsPerMeter,i=t/bo(1,r.center.lat),s=a.m.identity(new Float64Array(16));return a.m.translate(s,s,[r.point.x,r.point.y,0]),a.m.scale(s,s,[i,i,t]),Float32Array.from(s)},a.bd=Po,a.be=s0,a.bf=function(r){const t=Nn-5;r=ct(r,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(st(r))),3);return Math.round(i*(Pw.length-1))},a.bg=function(r,t,i,s){const u=t.getNorth(),d=t.getSouth(),f=t.getWest(),g=t.getEast(),v=1<<r.z,b=g-f,T=u-d,M=b/Jd,k=-T/Pw[i],I=[0,M,0,k,0,0,u,f,0];if(r.z>0){const R=180/s;a.bx.multiply(I,I,[R/b+1,0,0,0,R/T+1,0,-.5*R/M,.5*R/k,1])}return I[2]=v,I[5]=r.x,I[8]=r.y,I},a.bh=Rm,a.bi=ll,a.bj=function(r,t,i){const s=a.m.identity(new Float64Array(16)),u=(t/(1<<r)-.5)*Math.PI*2;return a.m.rotateY(s,i.globeMatrix,u),Float32Array.from(s)},a.bk=class{isDataAvailableAtPoint(r){const t=this._source();if(this.isUsingMockSource()||!t||r.y<0||r.y>1)return!1;const i=t.getSource().maxzoom,s=1<<i,u=Math.floor(r.x),d=Math.floor((r.x-u)*s),f=Math.floor(r.y*s),g=this.findDEMTileFor(new Mi(i,u,i,d,f));return!(!g||!g.dem)}getAtPointOrZero(r,t=0){return this.getAtPoint(r,t)||0}getAtPoint(r,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const s=this._source();if(!s||r.y<0||r.y>1)return t;const u=s.getSource().maxzoom,d=1<<u,f=Math.floor(r.x),g=r.x-f,v=new Mi(u,f,u,Math.floor(g*d),Math.floor(r.y*d)),b=this.findDEMTileFor(v);if(!b||!b.dem)return t;const T=b.dem,M=1<<b.tileID.canonical.z,k=(g*M-b.tileID.canonical.x)*T.dim,I=(r.y*M-b.tileID.canonical.y)*T.dim,R=Math.floor(k),B=Math.floor(I);return(i?this.exaggeration():1)*ur(ur(T.get(R,B),T.get(R,B+1),I-B),ur(T.get(R+1,B),T.get(R+1,B+1),I-B),k-R)}getAtTileOffset(r,t,i){const s=1<<r.canonical.z;return this.getAtPointOrZero(new Gi(r.wrap+(r.canonical.x+t/_t)/s,(r.canonical.y+i/_t)/s))}getAtTileOffsetFunc(r,t,i,s){return u=>{const d=this.getAtTileOffset(r,u.x,u.y),f=s.upVector(r.canonical,u.x,u.y),g=s.upVectorScale(r.canonical,t,i).metersToTile;return a.v.scale(f,f,d*g),f}}getForTilePoints(r,t,i,s){if(this.isUsingMockSource())return!1;const u=af.create(this,r,s);return!!u&&(t.forEach(d=>{d[2]=this.exaggeration()*u.getElevationAt(d[0],d[1],i)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(r);if(!t||!t.dem)return null;const i=t.dem.tree,s=t.tileID,u=1<<r.canonical.z-s.canonical.z;let d=r.canonical.x/u-s.canonical.x,f=r.canonical.y/u-s.canonical.y,g=0;for(let v=0;v<r.canonical.z-s.canonical.z&&!i.leaves[g];v++){d*=2,f*=2;const b=2*Math.floor(f)+Math.floor(d);g=i.childOffsets[g]+b,d%=1,f%=1}return{min:this.exaggeration()*i.minimums[g],max:this.exaggeration()*i.maximums[g]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const r=this.visibleDemTiles;if(r.length===0)return null;let t=!1,i=Number.MAX_VALUE,s=Number.MIN_VALUE;for(const u of r){const d=this.getMinMaxForTile(u.tileID);d&&(i=Math.min(i,d.min),s=Math.max(s,d.max),t=!0)}return t?{min:i,max:s}:null}},a.bl=km,a.bm=wn,a.bn=o0,a.bo=tr,a.bp=Zr,a.bq=Sh,a.br=eg,a.bs=MS,a.bt=mS,a.bu=DI,a.bv=function(r,t){return[Math.pow(r[0],2.2)*t,Math.pow(r[1],2.2)*t,Math.pow(r[2],2.2)*t]},a.bw=function(r){return[Math.pow(r[0],1/2.2),Math.pow(r[1],1/2.2),Math.pow(r[2],1/2.2)]},a.by=dI,a.bz=256,a.c=ct,a.c$=P,a.c0=tw,a.c1=function(r,t,i,s,u){return ct((r-t)/(i-t)*(u-s)+s,s,u)},a.c2=th,a.c3=Gn,a.c4=vh,a.c5=U3,a.c6=[1,1,1],a.c7=af,a.c8=q0,a.c9=Ji,a.cA=cs,a.cB=r=>gs(bm(r)),a.cC=ne,a.cD=jo,a.cE=xn,a.cF=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.cG=Ot,a.cH=yI,a.cI=yh,a.cJ=function([r,t,i]){const s=Math.hypot(r,t,i),u=Math.atan2(r,i),d=.5*Math.PI-Math.acos(-t/s);return new jr(ar(u),ar(d))},a.cK=Xo,a.cL=Dm,a.cM=L,a.cN=Lw,a.cO=pI,a.cP=function(r){const t=[0,0,0],i=a.m.identity(new Float64Array(16));return a.m.multiply(i,r.pixelMatrix,r.globeMatrix),a.v.transformMat4(t,t,i),new Pe(t[0],t[1])},a.cQ=function(r){const t=r.navigator?r.navigator.userAgent:null;return!!function(i){if(Qe==null){const s=i.navigator?i.navigator.userAgent:null;Qe=!!i.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Qe}(r)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.cR=sn,a.cS=class{constructor(r,t,i){this._transformRequestFn=r,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const r=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",se,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,t){return this._transformRequestFn&&this._transformRequestFn(r,t)||{url:r}}normalizeStyleURL(r,t){if(!ut(r))return r;const i=dt(r);return i.params.push(`sdk=js-${P}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(r,t){if(!ut(r))return r;const i=dt(r);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeModelURL(r,t){if(!ut(r))return r;const i=dt(r);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(r,t,i,s){if(!ut(r))return r;const u=dt(r);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),i&&u.params.push(`language=${i}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||t)}normalizeSpriteURL(r,t,i,s){const u=dt(r);return ut(r)?(u.path=`/styles/v1${u.path}/sprite${t}${i}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${t}${i}`,Qt(u))}normalizeTileURL(r,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!ut(r))return r;const s=dt(r);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&s.authority!=="raster"&&i===512?"@2x":""}${F.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${L.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${L.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(d){for(const f of d){const g=f.match(/^access_token=(.*)$/);if(g)return g[1]}return null}(s.params)||L.ACCESS_TOKEN;return L.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(r,t){const i=dt(r);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return r;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${L.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${L.TILE_URL_VERSION}/`,"")}`;let u=i.params;return t&&(u=u.filter(d=>!d.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(r,t){const i=!!t&&ut(t),s=[];for(const u of r.tiles||[])pt(u)?s.push(this.canonicalizeTileURL(u,i)):s.push(u);return s}_makeAPIURL(r,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=dt(L.API_URL);if(r.protocol=s.protocol,r.authority=s.authority,r.protocol==="http"){const u=r.params.indexOf("secure");u>=0&&r.params.splice(u,1)}if(s.path!=="/"&&(r.path=`${s.path}${r.path}`),!L.REQUIRE_ACCESS_TOKEN)return Qt(r);if(t=t||L.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return r.params=r.params.filter(u=>u.indexOf("access_token")===-1),r.params.push(`access_token=${t||""}`),Qt(r)}},a.cT=function(r,t){t?Ui.add(r):Ui.delete(r)},a.cU=F,a.cV=fo,a.cW=di,a.cX=at,a.cY=hi,a.cZ=function(r){Ui.delete(r)},a.c_=_r,a.ca=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(r){const t=Q3(new Pe(0,0),new Pe(_t,_t),r),i=[];for(const s of this._activeRegions){if(s.hiddenByOverlap||!J3(t,s))continue;const u=CU(s.min,s.max,r);i.push({min:u.min,max:u.max,sourceId:this._sourceIds[s.priority],footprint:s.footprint,footprintTileId:s.tileId})}return i}setSources(r){this._setSources(r.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const i=[];for(const s of t.cache.getVisibleCoordinates()){const u=t.cache.getTile(s).buckets[t.layer];if(u)for(const d of u.getNodesInfo()){const f=d.node;f.footprint&&i.push({footprint:f.footprint,id:s.toUnwrapped()})}}return i}})))}_addSource(r){const t=r.getFootprints();if(t.length!==0){for(const i of t){if(!i.footprint)continue;const s=Q3(i.footprint.min,i.footprint.max,i.id);this._activeRegions.push({min:s.min,max:s.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:i.id,footprint:i.footprint})}this._sourceIds.push(r.getSourceId())}}_computeReplacement(){this._activeRegions.sort((t,i)=>t.priority-i.priority||X0(t.min,i.min)||X0(t.max,i.max));let r=this._activeRegions.length!==this._prevRegions.length;if(!r){let t=0,i=0;for(;!r&&t!==this._activeRegions.length;){const s=this._activeRegions[t],u=this._prevRegions[i];r=s.priority!==u.priority||!K3(s,u),++t,++i}}if(r){++this._updateTime;const t=i=>{const s=this._activeRegions;if(i>=s.length)return i;const u=s[i].priority;for(;i<s.length&&s[i].priority===u;)++i;return i};if(this._sourceIds.length>1){let i=0,s=t(i);for(;i!==s;){let u=i;const d=i;for(;u!==s;){const f=this._activeRegions[u];f.hiddenByOverlap=!1;for(let g=0;g<d;g++){const v=this._activeRegions[g];if(!v.hiddenByOverlap&&J3(f,v)&&(f.hiddenByOverlap=tz(f.footprint,f.tileId,v.footprint,v.tileId),f.hiddenByOverlap))break}++u}i=s,s=t(i)}}}}_setSources(r){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=r.length-1;t>=0;t--)this._addSource(r[t]);this._computeReplacement()}},a.cb=Gr,a.cc=U0,a.cd=Tm,a.ce=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy()}_fillGridMeshWithLods(r,t){const i=new tr,s=new Zr,u=[],d=r+1+2,f=t[0]+1,g=t[0]+1+(1+t.length),v=(b,T,M)=>{let k=b===d-1?b-2:b===0?b:b-1;return k+=M?24575:0,[k,T]};for(let b=0;b<d;++b)i.emplaceBack(...v(b,0,!0));for(let b=0;b<f;++b)for(let T=0;T<d;++T)i.emplaceBack(...v(T,b,(T===0||T===d-1)&&!0));for(let b=0;b<t.length;++b){const T=t[b];for(let M=0;M<d;++M)i.emplaceBack(...v(M,T,!0))}for(let b=0;b<t.length;++b){const T=s.length,M=t[b]+1+2,k=new Zr;for(let B=0;B<M-1;B++){const j=B===M-2,U=j?d*(g-t.length+b-B):d;for(let J=0;J<d-1;J++){const ee=B*d+J;B===0||j||J===0||J===d-2?(k.emplaceBack(ee+1,ee,ee+U),k.emplaceBack(ee+U,ee+U+1,ee+1)):(s.emplaceBack(ee+1,ee,ee+U),s.emplaceBack(ee+U,ee+U+1,ee+1))}}const I=wn.simpleSegment(0,T,i.length,s.length-T);for(let B=0;B<k.uint16.length;B+=3)s.emplaceBack(k.uint16[B],k.uint16[B+1],k.uint16[B+2]);const R=wn.simpleSegment(0,T,i.length,s.length-T);u.push({withoutSkirts:I,withSkirts:R})}return{vertices:i,indices:s,segments:u}}_createGrid(r){const t=this._fillGridMeshWithLods(Jd,Pw);this._gridSegments=t.segments,this._gridBuffer=r.createVertexBuffer(t.vertices,km.members),this._gridIndexBuffer=r.createIndexBuffer(t.indices,!0)}_createPoles(r){const t=new Zr;for(let f=0;f<=Jd;f++)t.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=r.createIndexBuffer(t,!0);const i=new hh,s=new hh,u=new hh,d=new hh;this._poleSegments=[];for(let f=0,g=0;f<kw;f++){const v=360/(1<<f);i.emplaceBack(0,-bs,0,.5,0),s.emplaceBack(0,-bs,0,.5,1),u.emplaceBack(0,-bs,0,.5,.5),d.emplaceBack(0,-bs,0,.5,.5);for(let b=0;b<=Jd;b++){let T=b/Jd,M=0;const k=ur(0,v,T),[I,R,B]=Qd(fV,pV,k,bs);i.emplaceBack(I,R,B,T,M),s.emplaceBack(I,R,B,T,1-M);const j=st(k);T=.5+.5*Math.sin(j),M=.5+.5*Math.cos(j),u.emplaceBack(I,R,B,T,M),d.emplaceBack(I,R,B,T,1-M)}this._poleSegments.push(wn.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(i,i0,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(s,i0,!1),this._texturedPoleNorthVertexBuffer=r.createVertexBuffer(u,i0,!1),this._texturedPoleSouthVertexBuffer=r.createVertexBuffer(d,i0,!1)}getGridBuffers(r,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}},a.cf=function(r){return Ui.has(r)},a.cg=l0,a.ch=me,a.ci=function(r){return r({pluginStatus:Z,pluginURL:ae}),ne.on("pluginStateChange",r),r},a.cj=uf,a.ck=lS,a.cl=Ri,a.cm=pe,a.cn=ut,a.co=Zi,a.cp=function(r,t,i){return r.type==="custom"?new UU(r,t):new HU[r.type](r,t,i)},a.cq=function(r){const t=r.indexOf(Mt);return t>=0?r.slice(0,t):r},a.cr=r=>gs(Zy(r)),a.cs=r=>gs(qy(r)),a.ct=r=>gs(xm(r)),a.cu=function(r){return r.indexOf(Mt)>=0},a.cv=function(r){const t=r.indexOf(Mt);return t>=0?r.slice(t+1):""},a.cw=oh,a.cx=function(r){const t=[],i=r.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},a.cy=r=>gs(Wy(r)),a.cz=r=>gs(ym(r)),a.d=st,a.d0=function(r,t){Zt=r,Fr=t},a.d1=function(r,t,i=!1){if(Z===W||Z===X||Z===K)throw new Error("setRTLTextPlugin cannot be called multiple times.");ae=Di.resolveURL(r),Z=W,Y=t,ge(),i||_e()},a.d2=ce,a.d3=function(){MS().acquire(CS)},a.d4=function(){const r=ng;r&&(r.isPreloaded()&&r.numActive()===1?(r.release(CS),ng=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.d5=rg,a.d6=function(r){const t=Jr();if(!t)return;const i=t.delete(Ht);r&&i.catch(r).then(()=>r())},a.d7=tg,a.d8=zz,a.d9=function(r){AS=Di.resolveURL(r),kS||(kS=new eg(MS(),new Uo)),kS.broadcast("setDracoUrl",AS)},a.da=wr,a.db=E0,a.dc=be,a.dd=x0,a.de=v0,a.df=Ze,a.dg=UI,a.dh=class extends Uo{constructor(r,t,i,s,u,d){super(),this.actor=r,this.layerIndex=t,this.availableImages=i,this.loadVectorData=u||Iz,this.loading={},this.loaded={},this.deduped=new Pz(r.scheduler),this.isSpriteLoaded=s,this.scheduler=r.scheduler,this.brightness=d}loadTile(r,t){const i=r.uid,s=r&&r.request,u=s&&s.collectResourceTiming,d=this.loading[i]=new YU(r);d.abort=this.loadVectorData(r,(f,g)=>{const v=!this.loading[i];if(delete this.loading[i],v||f||!g)return d.status="done",v||(this.loaded[i]=d),t(f);const b=g.rawData,T={};g.expires&&(T.expires=g.expires),g.cacheControl&&(T.cacheControl=g.cacheControl),d.vectorTile=g.vectorTile||new Qw(new T0(b));const M=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(k,I)=>{if(k||!I)return t(k);const R={};if(u){const B=Dl(s);B.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(B)))}t(null,Lr({rawTileData:b.slice(0)},I,T,R))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[i]=d})}reloadTile(r,t){const i=this.loaded,s=r.uid,u=this;if(i&&i[s]){const d=i[s];d.showCollisionBoxes=r.showCollisionBoxes,d.projection=r.projection,d.brightness=r.brightness,d.tileTransform=nu(r.tileID.canonical,r.projection),d.extraShadowCaster=r.extraShadowCaster;const f=(g,v)=>{const b=d.reloadCallback;b&&(delete d.reloadCallback,d.parse(d.vectorTile,u.layerIndex,this.availableImages,u.actor,b)),t(g,v)};d.status==="parsing"?d.reloadCallback=f:d.status==="done"&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,f):f())}else t(null,void 0)}abortTile(r,t){const i=r.uid,s=this.loading[i];s&&(s.abort&&s.abort(),delete this.loading[i]),t()}removeTile(r,t){const i=this.loaded,s=r.uid;i&&i[s]&&delete i[s],t()}},a.di=Dl,a.dj=si,a.dk=tS,a.dl=function(r){let t=0;if(new Uint32Array(r,0,1)[0]!==Dz){const i=new Uint32Array(r,0,7),[,,s,u,d,f]=i;t=i.byteLength+u+d+f+d,(s!==r.byteLength||t>=r.byteLength)&&kr("Invalid b3dm header information.")}return Fz(r,t)},a.dm=function(r,t){const i=Vz(r);for(const s of i){for(const u of s.meshes)s7(u);s.lights&&(s.lightMeshIndex=s.meshes.length,s.meshes.push(a7(s.lights,t)))}return i},a.dn=Y3,a.dp=Cz,a.dq=we,a.dr=function(r){tn(),en&&en.then(t=>{t.keys().then(i=>{for(let s=0;s<i.length-r;s++)t.delete(i[s])})})},a.f=function(r,t){const{x:i,y:s}=r.point,u=fI(i,s,r.worldSize/r._pixelsPerMercatorPixel,0,0);return a.m.multiply(u,u,Rw(ll(t)))},a.g=zt,a.i=lf,a.j=C0,a.k=F0,a.l=Fi,a.n=ur,a.o=z3,a.p=function(r,t){const i={};for(let s=0;s<t.length;s++){const u=t[s];u in r&&(i[u]=r[u])}return i},a.r=F3,a.s=function(r,t,i){r[4*t+0]=i[0],r[4*t+1]=i[1],r[4*t+2]=i[2],r[4*t+3]=i[3]},a.t=_h,a.u=function(r,t,i,s,u){const d=5*t+2;r.float32[d+0]=i,r.float32[d+1]=s,r.float32[d+2]=u},a.w=qt,a.x=uI,a.y=function(r,t,i,s,u,d,f,g,v){if(v.name==="globe")return uI(r,t,new _h(i,s,u),!1);const b=nu({z:i,x:s,y:u},v);return new Gn([(d+b.x/b.scale)*t,t*(b.y/b.scale),f],[(d+b.x2/b.scale)*t,t*(b.y2/b.scale),g])},a.z=function(r,t,i){let s=0;for(let u=0;u<2;++u){const d=i?i[u]:0;r[u]>d&&(s+=(r[u]-d)*(r[u]-d)),t[u]<d&&(s+=(d-t[u])*(d-t[u]))}return s}}),w(["./shared"],function(a){function P(tt){if(typeof tt=="number"||typeof tt=="boolean"||typeof tt=="string"||tt==null)return JSON.stringify(tt);if(Array.isArray(tt)){let me="[";for(const Ce of tt)me+=`${P(Ce)},`;return`${me}]`}let de="{";for(const me of Object.keys(tt).sort())de+=`${me}:${P(tt[me])},`;return`${de}}`}function D(tt){let de="";for(const me of a.aS)de+=`/${P(tt[me])}`;return de}class L{constructor(de){this.keyCache={},this._layers={},this._layerConfigs={},de&&this.replace(de)}replace(de,me){this._layerConfigs={},this._layers={},this.update(de,[],me)}update(de,me,Ce){this._options=Ce;for(const Qe of de)this._layerConfigs[Qe.id]=Qe,(this._layers[Qe.id]=a.cp(Qe,this.scope,this._options)).compileFilter(),this.keyCache[Qe.id]&&delete this.keyCache[Qe.id];for(const Qe of me)delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe];this.familiesBySource={};const rt=function(Qe,bt){const zt={};for(let jt=0;jt<Qe.length;jt++){const Ht=bt&&bt[Qe[jt].id]||D(Qe[jt]);bt&&(bt[Qe[jt].id]=Ht);let Zt=zt[Ht];Zt||(Zt=zt[Ht]=[]),Zt.push(Qe[jt])}const it=[];for(const jt in zt)it.push(zt[jt]);return it}(a.da(this._layerConfigs),this.keyCache);for(const Qe of rt){const bt=Qe.map(Fr=>this._layers[Fr.id]),zt=bt[0];if(zt.visibility==="none")continue;const it=zt.source||"";let jt=this.familiesBySource[it];jt||(jt=this.familiesBySource[it]={});const Ht=zt.sourceLayer||"_geojsonTileLayer";let Zt=jt[Ht];Zt||(Zt=jt[Ht]=[]),Zt.push(bt)}}}class F{loadTile(de,me){const{uid:Ce,encoding:rt,rawImageData:Qe,padding:bt}=de,zt=ImageBitmap&&Qe instanceof ImageBitmap?this.getImageData(Qe,bt):Qe;me(null,new a.db(Ce,zt,rt,bt<1))}getImageData(de,me){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(de.width,de.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=de.width,this.offscreenCanvas.height=de.height,this.offscreenCanvasContext.drawImage(de,0,0,de.width,de.height);const Ce=this.offscreenCanvasContext.getImageData(-me,-me,de.width+2*me,de.height+2*me);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ce}}function $(tt,de){if(tt.length!==0){H(tt[0],de);for(var me=1;me<tt.length;me++)H(tt[me],!de)}}function H(tt,de){for(var me=0,Ce=0,rt=0,Qe=tt.length,bt=Qe-1;rt<Qe;bt=rt++){var zt=(tt[rt][0]-tt[bt][0])*(tt[bt][1]+tt[rt][1]),it=me+zt;Ce+=Math.abs(me)>=Math.abs(zt)?me-it+zt:zt-it+me,me=it}me+Ce>=0!=!!de&&tt.reverse()}var q=a.dc(function tt(de,me){var Ce,rt=de&&de.type;if(rt==="FeatureCollection")for(Ce=0;Ce<de.features.length;Ce++)tt(de.features[Ce],me);else if(rt==="GeometryCollection")for(Ce=0;Ce<de.geometries.length;Ce++)tt(de.geometries[Ce],me);else if(rt==="Feature")tt(de.geometry,me);else if(rt==="Polygon")$(de.coordinates,me);else if(rt==="MultiPolygon")for(Ce=0;Ce<de.coordinates.length;Ce++)$(de.coordinates[Ce],me);return de});const le=a.dd.prototype.toGeoJSON;var ie={exports:{}},te=a.df,se=a.de.VectorTileFeature,be=Ee;function Ee(tt,de){this.options=de||{},this.features=tt,this.length=tt.length}function je(tt,de){this.id=typeof tt.id=="number"?tt.id:void 0,this.type=tt.type,this.rawGeometry=tt.type===1?[tt.geometry]:tt.geometry,this.properties=tt.tags,this.extent=de||4096}Ee.prototype.feature=function(tt){return new je(this.features[tt],this.options.extent)},je.prototype.loadGeometry=function(){var tt=this.rawGeometry;this.geometry=[];for(var de=0;de<tt.length;de++){for(var me=tt[de],Ce=[],rt=0;rt<me.length;rt++)Ce.push(new te(me[rt][0],me[rt][1]));this.geometry.push(Ce)}return this.geometry},je.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var tt=this.geometry,de=1/0,me=-1/0,Ce=1/0,rt=-1/0,Qe=0;Qe<tt.length;Qe++)for(var bt=tt[Qe],zt=0;zt<bt.length;zt++){var it=bt[zt];de=Math.min(de,it.x),me=Math.max(me,it.x),Ce=Math.min(Ce,it.y),rt=Math.max(rt,it.y)}return[de,Ce,me,rt]},je.prototype.toGeoJSON=se.prototype.toGeoJSON;var Be=a.dg,Ze=be;function ht(tt){var de=new Be;return function(me,Ce){for(var rt in me.layers)Ce.writeMessage(3,Pe,me.layers[rt])}(tt,de),de.finish()}function Pe(tt,de){var me;de.writeVarintField(15,tt.version||1),de.writeStringField(1,tt.name||""),de.writeVarintField(5,tt.extent||4096);var Ce={keys:[],values:[],keycache:{},valuecache:{}};for(me=0;me<tt.length;me++)Ce.feature=tt.feature(me),de.writeMessage(2,Et,Ce);var rt=Ce.keys;for(me=0;me<rt.length;me++)de.writeStringField(3,rt[me]);var Qe=Ce.values;for(me=0;me<Qe.length;me++)de.writeMessage(4,Mr,Qe[me])}function Et(tt,de){var me=tt.feature;me.id!==void 0&&de.writeVarintField(1,me.id),de.writeMessage(2,or,tt),de.writeVarintField(3,me.type),de.writeMessage(4,Bn,me)}function or(tt,de){var me=tt.feature,Ce=tt.keys,rt=tt.values,Qe=tt.keycache,bt=tt.valuecache;for(var zt in me.properties){var it=me.properties[zt],jt=Qe[zt];if(it!==null){jt===void 0&&(Ce.push(zt),Qe[zt]=jt=Ce.length-1),de.writeVarint(jt);var Ht=typeof it;Ht!=="string"&&Ht!=="boolean"&&Ht!=="number"&&(it=JSON.stringify(it));var Zt=Ht+":"+it,Fr=bt[Zt];Fr===void 0&&(rt.push(it),bt[Zt]=Fr=rt.length-1),de.writeVarint(Fr)}}}function st(tt,de){return(de<<3)+(7&tt)}function ar(tt){return tt<<1^tt>>31}function Bn(tt,de){for(var me=tt.loadGeometry(),Ce=tt.type,rt=0,Qe=0,bt=me.length,zt=0;zt<bt;zt++){var it=me[zt],jt=1;Ce===1&&(jt=it.length),de.writeVarint(st(1,jt));for(var Ht=Ce===3?it.length-1:it.length,Zt=0;Zt<Ht;Zt++){Zt===1&&Ce!==1&&de.writeVarint(st(2,Ht-1));var Fr=it[Zt].x-rt,en=it[Zt].y-Qe;de.writeVarint(ar(Fr)),de.writeVarint(ar(en)),rt+=Fr,Qe+=en}Ce===3&&de.writeVarint(st(7,1))}}function Mr(tt,de){var me=typeof tt;me==="string"?de.writeStringField(1,tt):me==="boolean"?de.writeBooleanField(7,tt):me==="number"&&(tt%1!=0?de.writeDoubleField(3,tt):tt<0?de.writeSVarintField(6,tt):de.writeVarintField(5,tt))}ie.exports=ht,ie.exports.fromVectorTileJs=ht,ie.exports.fromGeojsonVt=function(tt,de){de=de||{};var me={};for(var Ce in tt)me[Ce]=new Ze(tt[Ce].features,de),me[Ce].name=Ce,me[Ce].version=de.version,me[Ce].extent=de.extent;return ht({layers:me})},ie.exports.GeoJSONWrapper=Ze;var xn=a.dc(ie.exports);const Ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:tt=>tt},ct=Math.fround||(Jt=new Float32Array(1),tt=>(Jt[0]=+tt,Jt[0]));var Jt;const qt=3,_r=5,wr=6;class Lr{constructor(de){this.options=Object.assign(Object.create(Ot),de),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(de){const{log:me,minZoom:Ce,maxZoom:rt}=this.options;me&&console.time("total time");const Qe=`prepare ${de.length} points`;me&&console.time(Qe),this.points=de;const bt=[];for(let it=0;it<de.length;it++){const jt=de[it];if(!jt.geometry)continue;const[Ht,Zt]=jt.geometry.coordinates,Fr=ct(Xn(Ht)),en=ct(Si(Zt));bt.push(Fr,en,1/0,it,-1,1),this.options.reduce&&bt.push(0)}let zt=this.trees[rt+1]=this._createTree(bt);me&&console.timeEnd(Qe);for(let it=rt;it>=Ce;it--){const jt=+Date.now();zt=this.trees[it]=this._createTree(this._cluster(zt,it)),me&&console.log("z%d: %d clusters in %dms",it,zt.numItems,+Date.now()-jt)}return me&&console.timeEnd("total time"),this}getClusters(de,me){let Ce=((de[0]+180)%360+360)%360-180;const rt=Math.max(-90,Math.min(90,de[1]));let Qe=de[2]===180?180:((de[2]+180)%360+360)%360-180;const bt=Math.max(-90,Math.min(90,de[3]));if(de[2]-de[0]>=360)Ce=-180,Qe=180;else if(Ce>Qe){const Zt=this.getClusters([Ce,rt,180,bt],me),Fr=this.getClusters([-180,rt,Qe,bt],me);return Zt.concat(Fr)}const zt=this.trees[this._limitZoom(me)],it=zt.range(Xn(Ce),Si(bt),Xn(Qe),Si(rt)),jt=zt.data,Ht=[];for(const Zt of it){const Fr=this.stride*Zt;Ht.push(jt[Fr+_r]>1?wi(jt,Fr,this.clusterProps):this.points[jt[Fr+qt]])}return Ht}getChildren(de){const me=this._getOriginId(de),Ce=this._getOriginZoom(de),rt="No cluster with the specified id.",Qe=this.trees[Ce];if(!Qe)throw new Error(rt);const bt=Qe.data;if(me*this.stride>=bt.length)throw new Error(rt);const zt=this.options.radius/(this.options.extent*Math.pow(2,Ce-1)),it=Qe.within(bt[me*this.stride],bt[me*this.stride+1],zt),jt=[];for(const Ht of it){const Zt=Ht*this.stride;bt[Zt+4]===de&&jt.push(bt[Zt+_r]>1?wi(bt,Zt,this.clusterProps):this.points[bt[Zt+qt]])}if(jt.length===0)throw new Error(rt);return jt}getLeaves(de,me,Ce){const rt=[];return this._appendLeaves(rt,de,me=me||10,Ce=Ce||0,0),rt}getTile(de,me,Ce){const rt=this.trees[this._limitZoom(de)],Qe=Math.pow(2,de),{extent:bt,radius:zt}=this.options,it=zt/bt,jt=(Ce-it)/Qe,Ht=(Ce+1+it)/Qe,Zt={features:[]};return this._addTileFeatures(rt.range((me-it)/Qe,jt,(me+1+it)/Qe,Ht),rt.data,me,Ce,Qe,Zt),me===0&&this._addTileFeatures(rt.range(1-it/Qe,jt,1,Ht),rt.data,Qe,Ce,Qe,Zt),me===Qe-1&&this._addTileFeatures(rt.range(0,jt,it/Qe,Ht),rt.data,-1,Ce,Qe,Zt),Zt.features.length?Zt:null}getClusterExpansionZoom(de){let me=this._getOriginZoom(de)-1;for(;me<=this.options.maxZoom;){const Ce=this.getChildren(de);if(me++,Ce.length!==1)break;de=Ce[0].properties.cluster_id}return me}_appendLeaves(de,me,Ce,rt,Qe){const bt=this.getChildren(me);for(const zt of bt){const it=zt.properties;if(it&&it.cluster?Qe+it.point_count<=rt?Qe+=it.point_count:Qe=this._appendLeaves(de,it.cluster_id,Ce,rt,Qe):Qe<rt?Qe++:de.push(zt),de.length===Ce)break}return Qe}_createTree(de){const me=new a.aZ(de.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ce=0;Ce<de.length;Ce+=this.stride)me.add(de[Ce],de[Ce+1]);return me.finish(),me.data=de,me}_addTileFeatures(de,me,Ce,rt,Qe,bt){for(const zt of de){const it=zt*this.stride,jt=me[it+_r]>1;let Ht,Zt,Fr;if(jt)Ht=sn(me,it,this.clusterProps),Zt=me[it],Fr=me[it+1];else{const Jr=this.points[me[it+qt]];Ht=Jr.properties;const[tn,Ur]=Jr.geometry.coordinates;Zt=Xn(tn),Fr=Si(Ur)}const en={type:1,geometry:[[Math.round(this.options.extent*(Zt*Qe-Ce)),Math.round(this.options.extent*(Fr*Qe-rt))]],tags:Ht};let In;In=jt||this.options.generateId?me[it+qt]:this.points[me[it+qt]].id,In!==void 0&&(en.id=In),bt.features.push(en)}}_limitZoom(de){return Math.max(this.options.minZoom,Math.min(Math.floor(+de),this.options.maxZoom+1))}_cluster(de,me){const{radius:Ce,extent:rt,reduce:Qe,minPoints:bt}=this.options,zt=Ce/(rt*Math.pow(2,me)),it=de.data,jt=[],Ht=this.stride;for(let Zt=0;Zt<it.length;Zt+=Ht){if(it[Zt+2]<=me)continue;it[Zt+2]=me;const Fr=it[Zt],en=it[Zt+1],In=de.within(it[Zt],it[Zt+1],zt),Jr=it[Zt+_r];let tn=Jr;for(const Ur of In){const Jn=Ur*Ht;it[Jn+2]>me&&(tn+=it[Jn+_r])}if(tn>Jr&&tn>=bt){let Ur,Jn=Fr*Jr,kn=en*Jr,zi=-1;const Ri=((Zt/Ht|0)<<5)+(me+1)+this.points.length;for(const jo of In){const si=jo*Ht;if(it[si+2]<=me)continue;it[si+2]=me;const Vo=it[si+_r];Jn+=it[si]*Vo,kn+=it[si+1]*Vo,it[si+4]=Ri,Qe&&(Ur||(Ur=this._map(it,Zt,!0),zi=this.clusterProps.length,this.clusterProps.push(Ur)),Qe(Ur,this._map(it,si)))}it[Zt+4]=Ri,jt.push(Jn/tn,kn/tn,1/0,Ri,-1,tn),Qe&&jt.push(zi)}else{for(let Ur=0;Ur<Ht;Ur++)jt.push(it[Zt+Ur]);if(tn>1)for(const Ur of In){const Jn=Ur*Ht;if(!(it[Jn+2]<=me)){it[Jn+2]=me;for(let kn=0;kn<Ht;kn++)jt.push(it[Jn+kn])}}}}return jt}_getOriginId(de){return de-this.points.length>>5}_getOriginZoom(de){return(de-this.points.length)%32}_map(de,me,Ce){if(de[me+_r]>1){const bt=this.clusterProps[de[me+wr]];return Ce?Object.assign({},bt):bt}const rt=this.points[de[me+qt]].properties,Qe=this.options.map(rt);return Ce&&Qe===rt?Object.assign({},Qe):Qe}}function wi(tt,de,me){return{type:"Feature",id:tt[de+qt],properties:sn(tt,de,me),geometry:{type:"Point",coordinates:[(Ce=tt[de],360*(Ce-.5)),uo(tt[de+1])]}};var Ce}function sn(tt,de,me){const Ce=tt[de+_r],rt=Ce>=1e4?`${Math.round(Ce/1e3)}k`:Ce>=1e3?Math.round(Ce/100)/10+"k":Ce,Qe=tt[de+wr],bt=Qe===-1?{}:Object.assign({},me[Qe]);return Object.assign(bt,{cluster:!0,cluster_id:tt[de+qt],point_count:Ce,point_count_abbreviated:rt})}function Xn(tt){return tt/360+.5}function Si(tt){const de=Math.sin(tt*Math.PI/180),me=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return me<0?0:me>1?1:me}function uo(tt){const de=(180-360*tt)*Math.PI/180;return 360*Math.atan(Math.exp(de))/Math.PI-90}var Ti={exports:{}};Ti.exports=function(){function tt($e,Ye,at,ut){for(var pt,xt=ut,mt=at-Ye>>1,gt=at-Ye,kt=$e[Ye],dt=$e[Ye+1],Qt=$e[at],Pr=$e[at+1],Bt=Ye+3;Bt<at;Bt+=3){var Or=de($e[Bt],$e[Bt+1],kt,dt,Qt,Pr);if(Or>xt)pt=Bt,xt=Or;else if(Or===xt){var bn=Math.abs(Bt-mt);bn<gt&&(pt=Bt,gt=bn)}}xt>ut&&(pt-Ye>3&&tt($e,Ye,pt,ut),$e[pt+2]=xt,at-pt>3&&tt($e,pt,at,ut))}function de($e,Ye,at,ut,pt,xt){var mt=pt-at,gt=xt-ut;if(mt!==0||gt!==0){var kt=(($e-at)*mt+(Ye-ut)*gt)/(mt*mt+gt*gt);kt>1?(at=pt,ut=xt):kt>0&&(at+=mt*kt,ut+=gt*kt)}return(mt=$e-at)*mt+(gt=Ye-ut)*gt}function me($e,Ye,at,ut){var pt={id:$e===void 0?null:$e,type:Ye,geometry:at,tags:ut,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xt){var mt=xt.geometry,gt=xt.type;if(gt==="Point"||gt==="MultiPoint"||gt==="LineString")Ce(xt,mt);else if(gt==="Polygon"||gt==="MultiLineString")for(var kt=0;kt<mt.length;kt++)Ce(xt,mt[kt]);else if(gt==="MultiPolygon")for(kt=0;kt<mt.length;kt++)for(var dt=0;dt<mt[kt].length;dt++)Ce(xt,mt[kt][dt])}(pt),pt}function Ce($e,Ye){for(var at=0;at<Ye.length;at+=3)$e.minX=Math.min($e.minX,Ye[at]),$e.minY=Math.min($e.minY,Ye[at+1]),$e.maxX=Math.max($e.maxX,Ye[at]),$e.maxY=Math.max($e.maxY,Ye[at+1])}function rt($e,Ye,at,ut){if(Ye.geometry){var pt=Ye.geometry.coordinates,xt=Ye.geometry.type,mt=Math.pow(at.tolerance/((1<<at.maxZoom)*at.extent),2),gt=[],kt=Ye.id;if(at.promoteId?kt=Ye.properties[at.promoteId]:at.generateId&&(kt=ut||0),xt==="Point")Qe(pt,gt);else if(xt==="MultiPoint")for(var dt=0;dt<pt.length;dt++)Qe(pt[dt],gt);else if(xt==="LineString")bt(pt,gt,mt,!1);else if(xt==="MultiLineString"){if(at.lineMetrics){for(dt=0;dt<pt.length;dt++)bt(pt[dt],gt=[],mt,!1),$e.push(me(kt,"LineString",gt,Ye.properties));return}zt(pt,gt,mt,!1)}else if(xt==="Polygon")zt(pt,gt,mt,!0);else{if(xt!=="MultiPolygon"){if(xt==="GeometryCollection"){for(dt=0;dt<Ye.geometry.geometries.length;dt++)rt($e,{id:kt,geometry:Ye.geometry.geometries[dt],properties:Ye.properties},at,ut);return}throw new Error("Input data is not a valid GeoJSON object.")}for(dt=0;dt<pt.length;dt++){var Qt=[];zt(pt[dt],Qt,mt,!0),gt.push(Qt)}}$e.push(me(kt,xt,gt,Ye.properties))}}function Qe($e,Ye){Ye.push(it($e[0])),Ye.push(jt($e[1])),Ye.push(0)}function bt($e,Ye,at,ut){for(var pt,xt,mt=0,gt=0;gt<$e.length;gt++){var kt=it($e[gt][0]),dt=jt($e[gt][1]);Ye.push(kt),Ye.push(dt),Ye.push(0),gt>0&&(mt+=ut?(pt*dt-kt*xt)/2:Math.sqrt(Math.pow(kt-pt,2)+Math.pow(dt-xt,2))),pt=kt,xt=dt}var Qt=Ye.length-3;Ye[2]=1,tt(Ye,0,Qt,at),Ye[Qt+2]=1,Ye.size=Math.abs(mt),Ye.start=0,Ye.end=Ye.size}function zt($e,Ye,at,ut){for(var pt=0;pt<$e.length;pt++){var xt=[];bt($e[pt],xt,at,ut),Ye.push(xt)}}function it($e){return $e/360+.5}function jt($e){var Ye=Math.sin($e*Math.PI/180),at=.5-.25*Math.log((1+Ye)/(1-Ye))/Math.PI;return at<0?0:at>1?1:at}function Ht($e,Ye,at,ut,pt,xt,mt,gt){if(ut/=Ye,xt>=(at/=Ye)&&mt<ut)return $e;if(mt<at||xt>=ut)return null;for(var kt=[],dt=0;dt<$e.length;dt++){var Qt=$e[dt],Pr=Qt.geometry,Bt=Qt.type,Or=pt===0?Qt.minX:Qt.minY,bn=pt===0?Qt.maxX:Qt.maxY;if(Or>=at&&bn<ut)kt.push(Qt);else if(!(bn<at||Or>=ut)){var Tn=[];if(Bt==="Point"||Bt==="MultiPoint")Zt(Pr,Tn,at,ut,pt);else if(Bt==="LineString")Fr(Pr,Tn,at,ut,pt,!1,gt.lineMetrics);else if(Bt==="MultiLineString")In(Pr,Tn,at,ut,pt,!1);else if(Bt==="Polygon")In(Pr,Tn,at,ut,pt,!0);else if(Bt==="MultiPolygon")for(var zn=0;zn<Pr.length;zn++){var hi=[];In(Pr[zn],hi,at,ut,pt,!0),hi.length&&Tn.push(hi)}if(Tn.length){if(gt.lineMetrics&&Bt==="LineString"){for(zn=0;zn<Tn.length;zn++)kt.push(me(Qt.id,Bt,Tn[zn],Qt.tags));continue}Bt!=="LineString"&&Bt!=="MultiLineString"||(Tn.length===1?(Bt="LineString",Tn=Tn[0]):Bt="MultiLineString"),Bt!=="Point"&&Bt!=="MultiPoint"||(Bt=Tn.length===3?"Point":"MultiPoint"),kt.push(me(Qt.id,Bt,Tn,Qt.tags))}}}return kt.length?kt:null}function Zt($e,Ye,at,ut,pt){for(var xt=0;xt<$e.length;xt+=3){var mt=$e[xt+pt];mt>=at&&mt<=ut&&(Ye.push($e[xt]),Ye.push($e[xt+1]),Ye.push($e[xt+2]))}}function Fr($e,Ye,at,ut,pt,xt,mt){for(var gt,kt,dt=en($e),Qt=pt===0?tn:Ur,Pr=$e.start,Bt=0;Bt<$e.length-3;Bt+=3){var Or=$e[Bt],bn=$e[Bt+1],Tn=$e[Bt+2],zn=$e[Bt+3],hi=$e[Bt+4],li=pt===0?Or:bn,fo=pt===0?zn:hi,Xi=!1;mt&&(gt=Math.sqrt(Math.pow(Or-zn,2)+Math.pow(bn-hi,2))),li<at?fo>at&&(kt=Qt(dt,Or,bn,zn,hi,at),mt&&(dt.start=Pr+gt*kt)):li>ut?fo<ut&&(kt=Qt(dt,Or,bn,zn,hi,ut),mt&&(dt.start=Pr+gt*kt)):Jr(dt,Or,bn,Tn),fo<at&&li>=at&&(kt=Qt(dt,Or,bn,zn,hi,at),Xi=!0),fo>ut&&li<=ut&&(kt=Qt(dt,Or,bn,zn,hi,ut),Xi=!0),!xt&&Xi&&(mt&&(dt.end=Pr+gt*kt),Ye.push(dt),dt=en($e)),mt&&(Pr+=gt)}var di=$e.length-3;Or=$e[di],bn=$e[di+1],Tn=$e[di+2],(li=pt===0?Or:bn)>=at&&li<=ut&&Jr(dt,Or,bn,Tn),di=dt.length-3,xt&&di>=3&&(dt[di]!==dt[0]||dt[di+1]!==dt[1])&&Jr(dt,dt[0],dt[1],dt[2]),dt.length&&Ye.push(dt)}function en($e){var Ye=[];return Ye.size=$e.size,Ye.start=$e.start,Ye.end=$e.end,Ye}function In($e,Ye,at,ut,pt,xt){for(var mt=0;mt<$e.length;mt++)Fr($e[mt],Ye,at,ut,pt,xt,!1)}function Jr($e,Ye,at,ut){$e.push(Ye),$e.push(at),$e.push(ut)}function tn($e,Ye,at,ut,pt,xt){var mt=(xt-Ye)/(ut-Ye);return $e.push(xt),$e.push(at+(pt-at)*mt),$e.push(1),mt}function Ur($e,Ye,at,ut,pt,xt){var mt=(xt-at)/(pt-at);return $e.push(Ye+(ut-Ye)*mt),$e.push(xt),$e.push(1),mt}function Jn($e,Ye){for(var at=[],ut=0;ut<$e.length;ut++){var pt,xt=$e[ut],mt=xt.type;if(mt==="Point"||mt==="MultiPoint"||mt==="LineString")pt=kn(xt.geometry,Ye);else if(mt==="MultiLineString"||mt==="Polygon"){pt=[];for(var gt=0;gt<xt.geometry.length;gt++)pt.push(kn(xt.geometry[gt],Ye))}else if(mt==="MultiPolygon")for(pt=[],gt=0;gt<xt.geometry.length;gt++){for(var kt=[],dt=0;dt<xt.geometry[gt].length;dt++)kt.push(kn(xt.geometry[gt][dt],Ye));pt.push(kt)}at.push(me(xt.id,mt,pt,xt.tags))}return at}function kn($e,Ye){var at=[];at.size=$e.size,$e.start!==void 0&&(at.start=$e.start,at.end=$e.end);for(var ut=0;ut<$e.length;ut+=3)at.push($e[ut]+Ye,$e[ut+1],$e[ut+2]);return at}function zi($e,Ye){if($e.transformed)return $e;var at,ut,pt,xt=1<<$e.z,mt=$e.x,gt=$e.y;for(at=0;at<$e.features.length;at++){var kt=$e.features[at],dt=kt.geometry,Qt=kt.type;if(kt.geometry=[],Qt===1)for(ut=0;ut<dt.length;ut+=2)kt.geometry.push(Ri(dt[ut],dt[ut+1],Ye,xt,mt,gt));else for(ut=0;ut<dt.length;ut++){var Pr=[];for(pt=0;pt<dt[ut].length;pt+=2)Pr.push(Ri(dt[ut][pt],dt[ut][pt+1],Ye,xt,mt,gt));kt.geometry.push(Pr)}}return $e.transformed=!0,$e}function Ri($e,Ye,at,ut,pt,xt){return[Math.round(at*($e*ut-pt)),Math.round(at*(Ye*ut-xt))]}function jo($e,Ye,at,ut,pt){for(var xt=Ye===pt.maxZoom?0:pt.tolerance/((1<<Ye)*pt.extent),mt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:at,y:ut,z:Ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},gt=0;gt<$e.length;gt++){mt.numFeatures++,si(mt,$e[gt],xt,pt);var kt=$e[gt].minX,dt=$e[gt].minY,Qt=$e[gt].maxX,Pr=$e[gt].maxY;kt<mt.minX&&(mt.minX=kt),dt<mt.minY&&(mt.minY=dt),Qt>mt.maxX&&(mt.maxX=Qt),Pr>mt.maxY&&(mt.maxY=Pr)}return mt}function si($e,Ye,at,ut){var pt=Ye.geometry,xt=Ye.type,mt=[];if(xt==="Point"||xt==="MultiPoint")for(var gt=0;gt<pt.length;gt+=3)mt.push(pt[gt]),mt.push(pt[gt+1]),$e.numPoints++,$e.numSimplified++;else if(xt==="LineString")Vo(mt,pt,$e,at,!1,!1);else if(xt==="MultiLineString"||xt==="Polygon")for(gt=0;gt<pt.length;gt++)Vo(mt,pt[gt],$e,at,xt==="Polygon",gt===0);else if(xt==="MultiPolygon")for(var kt=0;kt<pt.length;kt++){var dt=pt[kt];for(gt=0;gt<dt.length;gt++)Vo(mt,dt[gt],$e,at,!0,gt===0)}if(mt.length){var Qt=Ye.tags||null;if(xt==="LineString"&&ut.lineMetrics){for(var Pr in Qt={},Ye.tags)Qt[Pr]=Ye.tags[Pr];Qt.mapbox_clip_start=pt.start/pt.size,Qt.mapbox_clip_end=pt.end/pt.size}var Bt={geometry:mt,type:xt==="Polygon"||xt==="MultiPolygon"?3:xt==="LineString"||xt==="MultiLineString"?2:1,tags:Qt};Ye.id!==null&&(Bt.id=Ye.id),$e.features.push(Bt)}}function Vo($e,Ye,at,ut,pt,xt){var mt=ut*ut;if(ut>0&&Ye.size<(pt?mt:ut))at.numPoints+=Ye.length/3;else{for(var gt=[],kt=0;kt<Ye.length;kt+=3)(ut===0||Ye[kt+2]>mt)&&(at.numSimplified++,gt.push(Ye[kt]),gt.push(Ye[kt+1])),at.numPoints++;pt&&function(dt,Qt){for(var Pr=0,Bt=0,Or=dt.length,bn=Or-2;Bt<Or;bn=Bt,Bt+=2)Pr+=(dt[Bt]-dt[bn])*(dt[Bt+1]+dt[bn+1]);if(Pr>0===Qt)for(Bt=0,Or=dt.length;Bt<Or/2;Bt+=2){var Tn=dt[Bt],zn=dt[Bt+1];dt[Bt]=dt[Or-2-Bt],dt[Bt+1]=dt[Or-1-Bt],dt[Or-2-Bt]=Tn,dt[Or-1-Bt]=zn}}(gt,xt),$e.push(gt)}}function ho($e,Ye){var at=(Ye=this.options=function(pt,xt){for(var mt in xt)pt[mt]=xt[mt];return pt}(Object.create(this.options),Ye)).debug;if(at&&console.time("preprocess data"),Ye.maxZoom<0||Ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ye.promoteId&&Ye.generateId)throw new Error("promoteId and generateId cannot be used together.");var ut=function(pt,xt){var mt=[];if(pt.type==="FeatureCollection")for(var gt=0;gt<pt.features.length;gt++)rt(mt,pt.features[gt],xt,gt);else rt(mt,pt.type==="Feature"?pt:{geometry:pt},xt);return mt}($e,Ye);this.tiles={},this.tileCoords=[],at&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ye.indexMaxZoom,Ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ut=function(pt,xt){var mt=xt.buffer/xt.extent,gt=pt,kt=Ht(pt,1,-1-mt,mt,0,-1,2,xt),dt=Ht(pt,1,1-mt,2+mt,0,-1,2,xt);return(kt||dt)&&(gt=Ht(pt,1,-mt,1+mt,0,-1,2,xt)||[],kt&&(gt=Jn(kt,1).concat(gt)),dt&&(gt=gt.concat(Jn(dt,-1)))),gt}(ut,Ye)).length&&this.splitTile(ut,0,0,0),at&&(ut.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai($e,Ye,at){return 32*((1<<$e)*at+Ye)+$e}return ho.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ho.prototype.splitTile=function($e,Ye,at,ut,pt,xt,mt){for(var gt=[$e,Ye,at,ut],kt=this.options,dt=kt.debug;gt.length;){ut=gt.pop(),at=gt.pop(),Ye=gt.pop(),$e=gt.pop();var Qt=1<<Ye,Pr=ai(Ye,at,ut),Bt=this.tiles[Pr];if(!Bt&&(dt>1&&console.time("creation"),Bt=this.tiles[Pr]=jo($e,Ye,at,ut,kt),this.tileCoords.push({z:Ye,x:at,y:ut}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ye,at,ut,Bt.numFeatures,Bt.numPoints,Bt.numSimplified),console.timeEnd("creation"));var Or="z"+Ye;this.stats[Or]=(this.stats[Or]||0)+1,this.total++}if(Bt.source=$e,pt){if(Ye===kt.maxZoom||Ye===pt)continue;var bn=1<<pt-Ye;if(at!==Math.floor(xt/bn)||ut!==Math.floor(mt/bn))continue}else if(Ye===kt.indexMaxZoom||Bt.numPoints<=kt.indexMaxPoints)continue;if(Bt.source=null,$e.length!==0){dt>1&&console.time("clipping");var Tn,zn,hi,li,fo,Xi,di=.5*kt.buffer/kt.extent,Ui=.5-di,us=.5+di,Va=1+di;Tn=zn=hi=li=null,fo=Ht($e,Qt,at-di,at+us,0,Bt.minX,Bt.maxX,kt),Xi=Ht($e,Qt,at+Ui,at+Va,0,Bt.minX,Bt.maxX,kt),$e=null,fo&&(Tn=Ht(fo,Qt,ut-di,ut+us,1,Bt.minY,Bt.maxY,kt),zn=Ht(fo,Qt,ut+Ui,ut+Va,1,Bt.minY,Bt.maxY,kt),fo=null),Xi&&(hi=Ht(Xi,Qt,ut-di,ut+us,1,Bt.minY,Bt.maxY,kt),li=Ht(Xi,Qt,ut+Ui,ut+Va,1,Bt.minY,Bt.maxY,kt),Xi=null),dt>1&&console.timeEnd("clipping"),gt.push(Tn||[],Ye+1,2*at,2*ut),gt.push(zn||[],Ye+1,2*at,2*ut+1),gt.push(hi||[],Ye+1,2*at+1,2*ut),gt.push(li||[],Ye+1,2*at+1,2*ut+1)}}},ho.prototype.getTile=function($e,Ye,at){var ut=this.options,pt=ut.extent,xt=ut.debug;if($e<0||$e>24)return null;var mt=1<<$e,gt=ai($e,Ye=(Ye%mt+mt)%mt,at);if(this.tiles[gt])return zi(this.tiles[gt],pt);xt>1&&console.log("drilling down to z%d-%d-%d",$e,Ye,at);for(var kt,dt=$e,Qt=Ye,Pr=at;!kt&&dt>0;)dt--,Qt=Math.floor(Qt/2),Pr=Math.floor(Pr/2),kt=this.tiles[ai(dt,Qt,Pr)];return kt&&kt.source?(xt>1&&console.log("found parent tile z%d-%d-%d",dt,Qt,Pr),xt>1&&console.time("drilling down"),this.splitTile(kt.source,dt,Qt,Pr,$e,Ye,at),xt>1&&console.timeEnd("drilling down"),this.tiles[gt]?zi(this.tiles[gt],pt):null):null},function($e,Ye){return new ho($e,Ye)}}();var Tr=a.dc(Ti.exports);function oi(tt,de){const me=tt.tileID.canonical;if(!this._geoJSONIndex)return de(null,null);const Ce=this._geoJSONIndex.getTile(me.z,me.x,me.y);if(!Ce)return de(null,null);const rt=new class{constructor(bt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.J,this.length=bt.length,this._features=bt}feature(bt){return new class{constructor(zt){this._feature=zt,this.extent=a.J,this.type=zt.type,this.properties=zt.tags,"id"in zt&&!isNaN(zt.id)&&(this.id=parseInt(zt.id,10))}loadGeometry(){if(this._feature.type===1){const zt=[];for(const it of this._feature.geometry)zt.push([new a.P(it[0],it[1])]);return zt}{const zt=[];for(const it of this._feature.geometry){const jt=[];for(const Ht of it)jt.push(new a.P(Ht[0],Ht[1]));zt.push(jt)}return zt}}toGeoJSON(zt,it,jt){return le.call(this,zt,it,jt)}}(this._features[bt])}}(Ce.features);let Qe=xn(rt);Qe.byteOffset===0&&Qe.byteLength===Qe.buffer.byteLength||(Qe=new Uint8Array(Qe)),de(null,{vectorTile:rt,rawData:Qe.buffer})}class cs extends a.dh{constructor(de,me,Ce,rt,Qe,bt){super(de,me,Ce,rt,oi,bt),Qe&&(this.loadGeoJSON=Qe)}loadData(de,me){const Ce=de&&de.request,rt=Ce&&Ce.collectResourceTiming;this.loadGeoJSON(de,(Qe,bt)=>{if(Qe||!bt)return me(Qe);if(typeof bt!="object")return me(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));{q(bt,!0);try{if(de.filter){const it=a.cw(de.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(it.result==="error")throw new Error(it.value.map(Ht=>`${Ht.key}: ${Ht.message}`).join(", "));bt={type:"FeatureCollection",features:bt.features.filter(Ht=>it.value.evaluate({zoom:0},Ht))}}this._geoJSONIndex=de.cluster?new Lr(function({superclusterOptions:it,clusterProperties:jt}){if(!jt||!it)return it;const Ht={},Zt={},Fr={accumulated:null,zoom:0},en={properties:null},In=Object.keys(jt);for(const Jr of In){const[tn,Ur]=jt[Jr],Jn=a.cw(Ur),kn=a.cw(typeof tn=="string"?[tn,["accumulated"],["get",Jr]]:tn);Ht[Jr]=Jn.value,Zt[Jr]=kn.value}return it.map=Jr=>{en.properties=Jr;const tn={};for(const Ur of In)tn[Ur]=Ht[Ur].evaluate(Fr,en);return tn},it.reduce=(Jr,tn)=>{en.properties=tn;for(const Ur of In)Fr.accumulated=Jr[Ur],Jr[Ur]=Zt[Ur].evaluate(Fr,en)},it}(de)).load(bt.features):Tr(bt,de.geojsonVtOptions)}catch(it){return me(it)}this.loaded={};const zt={};if(rt){const it=a.di(Ce);it&&(zt.resourceTiming={},zt.resourceTiming[de.source]=JSON.parse(JSON.stringify(it)))}me(null,zt)}})}reloadTile(de,me){const Ce=this.loaded;return Ce&&Ce[de.uid]?super.reloadTile(de,me):this.loadTile(de,me)}loadGeoJSON(de,me){if(de.request)a.a1(de.request,me);else{if(typeof de.data!="string")return me(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));try{return me(null,JSON.parse(de.data))}catch{return me(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(de,me){try{me(null,this._geoJSONIndex.getClusterExpansionZoom(de.clusterId))}catch(Ce){me(Ce)}}getClusterChildren(de,me){try{me(null,this._geoJSONIndex.getChildren(de.clusterId))}catch(Ce){me(Ce)}}getClusterLeaves(de,me){try{me(null,this._geoJSONIndex.getLeaves(de.clusterId,de.limit,de.offset))}catch(Ce){me(Ce)}}}class Zi{constructor(de,me){this.tileID=new a.O(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.tileZoom=de.tileZoom,this.uid=de.uid,this.zoom=de.zoom,this.canonical=de.tileID.canonical,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=de.projection,this.brightness=me}parse(de,me,Ce,rt){this.status="parsing";const Qe=new a.O(Ce.tileID.overscaledZ,Ce.tileID.wrap,Ce.tileID.canonical.z,Ce.tileID.canonical.x,Ce.tileID.canonical.y),bt={},zt=me.familiesBySource[Ce.source],it=new a.dk(Qe,Ce.promoteId);return it.bucketLayerIDs=[],a.dl(de).then(jt=>{if(!jt)return rt(new Error("Could not parse tile"));const Ht=a.dm(jt,1/a.cg(Ce.tileID.canonical)),Zt=jt.json.extensionsUsed&&jt.json.extensionsUsed.includes("MAPBOX_mesh_features"),Fr=new a.al(this.zoom,{brightness:this.brightness});for(const en in zt)for(const In of zt[en]){const Jr=In[0],tn=jt.json.extensionsUsed;Jr.recalculate(Fr,[]);const Ur=new a.dn(Ht,Qe,tn&&tn.includes("MAPBOX_mesh_features"),this.brightness);Zt||(Ur.needsUpload=!0),bt[Jr.fqid]=Ur,Ur.evaluate(Jr)}this.status="done",rt(null,{buckets:bt,featureIndex:it})}).catch(jt=>rt(new Error(jt.message)))}}class ja{constructor(de,me,Ce,rt,Qe,bt){this.actor=de,this.layerIndex=me,this.brightness=bt,this.loading={},this.loaded={}}loadTile(de,me){const Ce=de.uid,rt=this.loading[Ce]=new Zi(de,this.brightness);a.dj(de.request,(Qe,bt)=>{const zt=!this.loading[Ce];return delete this.loading[Ce],zt||Qe?(rt.status="done",zt||(this.loaded[Ce]=rt),me(Qe)):bt&&bt.byteLength!==0?void rt.parse(bt,this.layerIndex,de,(it,jt)=>{rt.status="done",this.loaded=this.loaded||{},this.loaded[Ce]=rt,it||!jt?me(it):me(null,jt)}):(rt.status="done",this.loaded[Ce]=rt,me())})}reloadTile(de,me){const Ce=this.loaded,rt=de.uid;if(Ce&&Ce[rt]){const Qe=Ce[rt];Qe.projection=de.projection,Qe.brightness=de.brightness;const bt=(zt,it)=>{Qe.reloadCallback&&(delete Qe.reloadCallback,this.loadTile(de,me)),me(zt,it)};Qe.status==="parsing"?Qe.reloadCallback=bt:Qe.status==="done"&&this.loadTile(de,me)}}abortTile(de,me){const Ce=de.uid;this.loading[Ce]&&delete this.loading[Ce],me()}removeTile(de,me){const Ce=this.loaded,rt=de.uid;Ce&&Ce[rt]&&delete Ce[rt],me()}}class kr{constructor(de){this.self=de,this.actor=new a.dp(de,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.o({name:"mercator"}),this.workerSourceTypes={vector:a.dh,geojson:cs,"batched-model":ja},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(me,Ce)=>{if(this.workerSourceTypes[me])throw new Error(`Worker source with name "${me}" already registered.`);this.workerSourceTypes[me]=Ce},this.self.registerRTLTextPlugin=me=>{if(a.dq.isParsed())throw new Error("RTL text plugin already registered.");a.dq.applyArabicShaping=me.applyArabicShaping,a.dq.processBidirectionalText=me.processBidirectionalText,a.dq.processStyledBidirectionalText=me.processStyledBidirectionalText}}clearCaches(de,me,Ce){delete this.layerIndexes[de],delete this.availableImages[de],delete this.workerSources[de],delete this.demWorkerSources[de],Ce()}checkIfReady(de,me,Ce){Ce()}setReferrer(de,me){this.referrer=me}spriteLoaded(de,{scope:me,isLoaded:Ce}){if(this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={}),this.isSpriteLoaded[de][me]=Ce,this.workerSources[de]&&this.workerSources[de][me])for(const rt in this.workerSources[de][me]){const Qe=this.workerSources[de][me][rt];for(const bt in Qe)Qe[bt]instanceof a.dh&&(Qe[bt].isSpriteLoaded=Ce,Qe[bt].fire(new a.a8("isSpriteLoaded")))}}setImages(de,{scope:me,images:Ce},rt){if(this.availableImages[de]||(this.availableImages[de]={}),this.availableImages[de][me]=Ce,this.workerSources[de]&&this.workerSources[de][me]){for(const Qe in this.workerSources[de][me]){const bt=this.workerSources[de][me][Qe];for(const zt in bt)bt[zt].availableImages=Ce}rt()}else rt()}setProjection(de,me){this.projections[de]=a.o(me)}setBrightness(de,me,Ce){this.brightness=me,Ce()}setLayers(de,me,Ce){this.getLayerIndex(de,me.scope).replace(me.layers,me.options),Ce()}updateLayers(de,me,Ce){this.getLayerIndex(de,me.scope).update(me.layers,me.removedIds,me.options),Ce()}loadTile(de,me,Ce){me.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,me.type,me.source,me.scope).loadTile(me,Ce)}loadDEMTile(de,me,Ce){this.getDEMWorkerSource(de,me.source,me.scope).loadTile(me,Ce)}reloadTile(de,me,Ce){me.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,me.type,me.source,me.scope).reloadTile(me,Ce)}abortTile(de,me,Ce){this.getWorkerSource(de,me.type,me.source,me.scope).abortTile(me,Ce)}removeTile(de,me,Ce){this.getWorkerSource(de,me.type,me.source,me.scope).removeTile(me,Ce)}removeSource(de,me,Ce){if(!(this.workerSources[de]&&this.workerSources[de][me.scope]&&this.workerSources[de][me.scope][me.type]&&this.workerSources[de][me.scope][me.type][me.source]))return;const rt=this.workerSources[de][me.scope][me.type][me.source];delete this.workerSources[de][me.scope][me.type][me.source],rt.removeSource!==void 0?rt.removeSource(me,Ce):Ce()}loadWorkerSource(de,me,Ce){try{this.self.importScripts(me.url),Ce()}catch(rt){Ce(rt.toString())}}syncRTLPluginState(de,me,Ce){try{a.dq.setState(me);const rt=a.dq.getPluginURL();if(a.dq.isLoaded()&&!a.dq.isParsed()&&rt!=null){this.self.importScripts(rt);const Qe=a.dq.isParsed();Ce(Qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${rt}`),Qe)}}catch(rt){Ce(rt.toString())}}setDracoUrl(de,me){this.dracoUrl=me}getAvailableImages(de,me){this.availableImages[de]||(this.availableImages[de]={});let Ce=this.availableImages[de][me];return Ce||(Ce=[]),Ce}getLayerIndex(de,me){this.layerIndexes[de]||(this.layerIndexes[de]={});let Ce=this.layerIndexes[de][me];return Ce||(Ce=this.layerIndexes[de][me]=new L,Ce.scope=me),Ce}getWorkerSource(de,me,Ce,rt){if(this.workerSources[de]||(this.workerSources[de]={}),this.workerSources[de][rt]||(this.workerSources[de][rt]={}),this.workerSources[de][rt][me]||(this.workerSources[de][rt][me]={}),this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={}),!this.workerSources[de][rt][me][Ce]){const Qe={send:(bt,zt,it,jt,Ht,Zt)=>{this.actor.send(bt,zt,it,de,Ht,Zt)},scheduler:this.actor.scheduler};this.workerSources[de][rt][me][Ce]=new this.workerSourceTypes[me](Qe,this.getLayerIndex(de,rt),this.getAvailableImages(de,rt),this.isSpriteLoaded[de][rt],void 0,this.brightness)}return this.workerSources[de][rt][me][Ce]}getDEMWorkerSource(de,me,Ce){return this.demWorkerSources[de]||(this.demWorkerSources[de]={}),this.demWorkerSources[de][Ce]||(this.demWorkerSources[de][Ce]={}),this.demWorkerSources[de][Ce][me]||(this.demWorkerSources[de][Ce][me]=new F),this.demWorkerSources[de][Ce][me]}enforceCacheSizeLimit(de,me){a.dr(me)}getWorkerPerformanceMetrics(de,me,Ce){Ce(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new kr(self)),kr}),w(["./shared"],function(a){function P(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let h=0;h<m.length;h++)if(!P(m[h],l[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&l!==null){if(typeof l!="object"||Object.keys(m).length!==Object.keys(l).length)return!1;for(const h in m)if(!P(m[h],l[h]))return!1;return!0}return m===l}var D=L;function L(m){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,x,S=new Blob([""],{type:"text/javascript"}),C=URL.createObjectURL(S);try{x=new Worker(C),_=!0}catch{_=!1}return x&&x.terminate(),URL.revokeObjectURL(C),_}()?function(){var _=document.createElement("canvas");_.width=_.height=1;var x=_.getContext("2d");if(!x)return!1;var S=x.getImageData(0,0,1,1);return S&&S.width===_.width}()?(F[h=l&&l.failIfMajorPerformanceCaveat]===void 0&&(F[h]=function(_){var x,S=function(C){var A=document.createElement("canvas"),z=Object.create(L.webGLContextAttributes);return z.failIfMajorPerformanceCaveat=C,A.getContext("webgl2",z)}(_);if(!S)return!1;try{x=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!x||S.isContextLost())&&(S.shaderSource(x,"void main() {}"),S.compileShader(x),S.getShaderParameter(x,S.COMPILE_STATUS)===!0)}(h)),F[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var h}(m)}var F={};function $(m,l,h){const _=document.createElement(m);return l!=null&&(_.className=l),h&&h.appendChild(_),_}function H(m,l,h){const _=document.createElementNS("http://www.w3.org/2000/svg",m);for(const x of Object.keys(l))_.setAttributeNS(null,x,String(l[x]));return h&&h.appendChild(_),_}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const q=typeof document<"u"?document.documentElement&&document.documentElement.style:null,le=q&&q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ie;function te(){q&&le&&(ie=q[le],q[le]="none")}function se(){q&&le&&(q[le]=ie)}function be(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",be,!0)}function Ee(){window.addEventListener("click",be,!0),window.setTimeout(()=>{window.removeEventListener("click",be,!0)},0)}function je(m,l){const h=m.getBoundingClientRect();return ht(m,h,l)}function Be(m,l){const h=m.getBoundingClientRect(),_=[];for(let x=0;x<l.length;x++)_.push(ht(m,h,l[x]));return _}function Ze(m){return window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function ht(m,l,h){const _=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new a.P((h.clientX-l.left)*_,(h.clientY-l.top)*_)}class Pe{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(l,h){this._updatedSourceCaches[l]=h,this.setDirty()}discardSourceCacheUpdate(l){delete this._updatedSourceCaches[l]}updateLayer(l){const h=l.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(l.id),this.setDirty()}removeLayer(l){const h=l.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][l.id]=l,this._updatedLayers[h].delete(l.id),this._updatedPaintProps.delete(l.fqid),this.setDirty()}getRemovedLayer(l){return this._removedLayers[l.scope]?this._removedLayers[l.scope][l.id]:null}discardLayerRemoval(l){this._removedLayers[l.scope]&&delete this._removedLayers[l.scope][l.id]}getLayerUpdatesByScope(){const l={};for(const h in this._updatedLayers)l[h]=l[h]||{},l[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)l[h]=l[h]||{},l[h].removedIds=Object.keys(this._removedLayers[h]);return l}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(l){this._updatedPaintProps.add(l.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(l){this._updatedImages.add(l),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const Et={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class or{constructor(l,h,_,x,S,C){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.instanceCount=C,this.context=l;const A=l.gl;this.buffer=A.createBuffer(),l.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||S||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,h){for(let _=0;_<this.attributes.length;_++){const x=h.attributes[this.attributes[_].name];x!==void 0&&l.enableVertexAttribArray(x)}}setVertexAttribPointers(l,h,_){for(let x=0;x<this.attributes.length;x++){const S=this.attributes[x],C=h.attributes[S.name];C!==void 0&&l.vertexAttribPointer(C,S.components,l[Et[S.type]],!1,this.itemSize,S.offset+this.itemSize*(_||0))}}setVertexAttribDivisor(l,h,_){for(let x=0;x<this.attributes.length;x++){const S=h.attributes[this.attributes[x].name];S!==void 0&&this.instanceCount&&this.instanceCount>0&&l.vertexAttribDivisor(S,_)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class st{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ar extends st{getDefault(){return a.C.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Bn extends st{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Mr extends st{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class xn extends st{getDefault(){return[!0,!0,!0,!0]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ot extends st{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class ct extends st{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Jt extends st{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const h=this.current;(l.func!==h.func||l.ref!==h.ref||l.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class qt extends st{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class _r extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=l,this.dirty=!1}}class wr extends st{getDefault(){return[0,1]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Lr extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=l,this.dirty=!1}}class wi extends st{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class sn extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.BLEND):h.disable(h.BLEND),this.current=l,this.dirty=!1}}class Xn extends st{getDefault(){const l=this.gl;return[l.ONE,l.ZERO,l.ONE,l.ZERO]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Si extends st{getDefault(){return a.C.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class uo extends st{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(l,l),this.current=l,this.dirty=!1)}}class Ti extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=l,this.dirty=!1}}class Tr extends st{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class oi extends st{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let cs=class extends st{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Zi extends st{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class ja extends st{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class kr extends st{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class tt extends st{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class de extends st{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class me extends st{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ce extends st{getDefault(){return null}set(l){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class rt extends st{getDefault(){return null}set(l){this.gl&&(l!==this.current||this.dirty)&&(this.gl.bindVertexArray(l),this.current=l,this.dirty=!1)}}class Qe extends st{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class bt extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class zt extends st{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class it extends st{constructor(l,h){super(l),this.context=l,this.parent=h}getDefault(){return null}}class jt extends it{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Ht extends it{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Zt extends it{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Fr extends Ht{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class en{constructor(l,h,_,x,S){this.context=l,this.width=h,this.height=_;const C=this.framebuffer=l.gl.createFramebuffer();x&&(this.colorAttachment=new jt(l,C)),S&&(this.depthAttachmentType=S,this.depthAttachment=S==="renderbuffer"?new Ht(l,C):new Zt(l,C))}destroy(){const l=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&l.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&l.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&l.deleteTexture(h)}l.deleteFramebuffer(this.framebuffer)}}class In{constructor(l,h){this.gl=l,this.clearColor=new ar(this),this.clearDepth=new Bn(this),this.clearStencil=new Mr(this),this.colorMask=new xn(this),this.depthMask=new Ot(this),this.stencilMask=new ct(this),this.stencilFunc=new Jt(this),this.stencilOp=new qt(this),this.stencilTest=new _r(this),this.depthRange=new wr(this),this.depthTest=new Lr(this),this.depthFunc=new wi(this),this.blend=new sn(this),this.blendFunc=new Xn(this),this.blendColor=new Si(this),this.blendEquation=new uo(this),this.cullFace=new Ti(this),this.cullFaceSide=new Tr(this),this.frontFace=new oi(this),this.program=new cs(this),this.activeTexture=new Zi(this),this.viewport=new ja(this),this.bindFramebuffer=new kr(this),this.bindRenderbuffer=new tt(this),this.bindTexture=new de(this),this.bindVertexBuffer=new me(this),this.bindElementBuffer=new Ce(this),this.bindVertexArrayOES=new rt(this),this.pixelStoreUnpack=new Qe(this),this.pixelStoreUnpackPremultiplyAlpha=new bt(this),this.pixelStoreUnpackFlipY=new zt(this),this.options=h?{...h}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=l.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,h,_){return new a.I(this,l,h,_)}createVertexBuffer(l,h,_,x,S){return new or(this,l,h,_,x,S)}createRenderbuffer(l,h,_){const x=this.gl,S=x.createRenderbuffer();return this.bindRenderbuffer.set(S),x.renderbufferStorage(x.RENDERBUFFER,l,h,_),this.bindRenderbuffer.set(null),S}createFramebuffer(l,h,_,x){return new en(this,l,h,_,x)}clear({color:l,depth:h,stencil:_,colorMask:x}){const S=this.gl;let C=0;l&&(C|=S.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set(x||[!0,!0,!0,!0])),h!==void 0&&(C|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),_!==void 0&&(C|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),S.clear(C)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){P(l.blendFunction,a.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor),l.blendEquation?this.blendEquation.set(l.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(l.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Jr{constructor(l=0,h=0,_=0,x=0){if(isNaN(l)||l<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=h,this.left=_,this.right=x}interpolate(l,h,_){return h.top!=null&&l.top!=null&&(this.top=a.n(l.top,h.top,_)),h.bottom!=null&&l.bottom!=null&&(this.bottom=a.n(l.bottom,h.bottom,_)),h.left!=null&&l.left!=null&&(this.left=a.n(l.left,h.left,_)),h.right!=null&&l.right!=null&&(this.right=a.n(l.right,h.right,_)),this}getCenter(l,h){const _=a.c((this.left+l-this.right)/2,0,l),x=a.c((this.top+h-this.bottom)/2,0,h);return new a.P(_,x)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Jr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function tn(m,l){const h=a.g(m,3);a.m.fromQuat(m,l),a.s(m,3,h)}function Ur(m,l){const h=a.q.identity([]);return a.q.rotateZ(h,h,-l),a.q.rotateX(h,h,-m),h}function Jn(m,l){const h=[m[0],m[1],0],_=[l[0],l[1],0];if(a.v.length(h)>=1e-15){const C=a.v.normalize([],h);a.v.scale(_,C,a.v.dot(_,C)),l[0]=_[0],l[1]=_[1]}const x=a.v.cross([],l,m);if(a.v.len(x)<1e-15)return null;const S=Math.atan2(-x[1],x[0]);return Ur(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}class kn{constructor(l,h){this.position=l,this.orientation=h}get position(){return this._position}set position(l){if(l){const h=l instanceof a.M?l:new a.M(l[0],l[1],l[2]);this._renderWorldCopies&&(h.x=a.w(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(l,h){if(this.orientation=null,!this.position)return;const _=this.position,x=this._elevation?this._elevation.getAtPointOrZero(a.M.fromLngLat(l)):0,S=a.M.fromLngLat(l,x),C=[S.x-_.x,S.y-_.y,S.z-_.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Jn(C,h)}setPitchBearing(l,h){this.orientation=Ur(a.d(l),a.d(-h))}}class zi{constructor(l,h){this._transform=a.m.identity([]),this.orientation=h,this.position=l}get mercatorPosition(){const l=this.position;return new a.M(l[0],l[1],l[2])}get position(){const l=a.g(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var h;l&&a.s(this._transform,3,[(h=l)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||a.q.identity([]),l&&tn(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,h){this._orientation=Ur(l,h),tn(this._transform,this._orientation)}forward(){const l=a.g(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=a.g(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=a.g(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,h){const _=new Float64Array(16);return a.m.invert(_,this.getWorldToCamera(l,h)),_}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(l,h,_){const x=this.position;a.v.scale(x,x,-l);const S=new Float64Array(16);return a.m.fromScaling(S,[_,_,_]),a.m.translate(S,S,x),S[10]*=h,S}getWorldToCamera(l,h){const _=new Float64Array(16),x=new Float64Array(4),S=this.position;return a.q.conjugate(x,this._orientation),a.v.scale(S,S,-l),a.m.fromQuat(_,x),a.m.translate(_,_,S),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(l,h,_,x){const S=new Float64Array(16);return a.m.perspective(S,l,h,_,x),S}getCameraToClipOrthographic(l,h,_,x,S,C){const A=new Float64Array(16);return a.m.ortho(A,l,h,_,x,S,C),A}getDistanceToElevation(l,h=!1){const _=l===0?0:a.b(l,h?a.l(this.position[1]):this.position[1]),x=this.forward();return(_-this.position[2])/x[2]}clone(){return new zi([...this.position],[...this.orientation])}}const Ri={unknown:0,flipRequired:1,flipNotRequired:2},jo=Math.tan(85*Math.PI/180);function si(m,l,h,_,x,S,C){const A=a.m.create();if(h)if(S.name==="globe"){const z=a.f(x,l);a.m.multiply(A,A,z)}else{const z=a.h.invert([],C);A[0]=z[0],A[1]=z[1],A[4]=z[2],A[5]=z[3],_||a.m.rotateZ(A,A,x.angle)}else a.m.multiply(A,x.labelPlaneMatrix,m);return A}function Vo(m,l,h,_,x,S,C){const A=si(m,l,h,_,x,S,C);return S.name==="globe"&&h||(A[2]=A[6]=A[10]=A[14]=0),A}function ho(m,l,h,_,x,S,C){if(h){if(S.name==="globe"){const A=si(m,l,h,_,x,S,C);return a.m.invert(A,A),a.m.multiply(A,m,A),A}{const A=a.m.clone(m),z=a.m.identity([]);return z[0]=C[0],z[1]=C[1],z[4]=C[2],z[5]=C[3],a.m.multiply(A,A,z),_||a.m.rotateZ(A,A,-x.angle),A}}return x.glCoordMatrix}function ai(m,l,h,_){const x=[m,l,h,1];h?a.e.transformMat4(x,x,_):Qt(x,x,_);const S=x[3];return x[0]/=S,x[1]/=S,x[2]/=S,x}function $e(m,l){return Math.min(.5+m/l*.5,1.5)}function Ye(m,l){const h=m[0]/m[3],_=m[1]/m[3];return h>=-l[0]&&h<=l[0]&&_>=-l[1]&&_<=l[1]}function at(m,l,h,_,x,S,C,A,z,O){const N=h.transform,V=_?m.textSizeData:m.iconSizeData,G=a.i(V,h.transform.zoom),W=N.projection.name==="globe",X=[256/h.width*2+1,256/h.height*2+1],K=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;K.clear();let Y=null;W&&(Y=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const Z=m.lineVertexArray,ae=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,pe=h.transform.width/h.transform.height;let ge,ne=!1;for(let ce=0;ce<ae.length;ce++){const _e=ae.get(ce),{numGlyphs:we,writingMode:ve}=_e;if(ve!==a.W.vertical||ne||ge===a.W.horizontal||(ne=!0),ge=ve,(_e.hidden||ve===a.W.vertical)&&!ne){dt(we,K);continue}ne=!1;const Se=new a.P(_e.tileAnchorX,_e.tileAnchorY);let{x:qe,y:De,z:Ne}=N.projection.projectTilePoint(Se.x,Se.y,O.canonical);if(z){const[wt,Ft,St]=z(Se);qe+=wt,De+=Ft,Ne+=St}const Me=[qe,De,Ne,1];if(a.e.transformMat4(Me,Me,l),!Ye(Me,X)){dt(we,K);continue}const We=Me[3],Fe=$e(h.transform.getCameraToCenterDistance(N.projection),We),Xe=a.j(V,G,_e),he=C?Xe/Fe:Xe*Fe,ke=ai(qe,De,Ne,x);if(ke[3]<=0){dt(we,K);continue}let nt={};const Ke=C?null:z,Mt=xt(_e,he,!1,A,l,x,S,m.glyphOffsetArray,Z,K,Y,ke,Se,nt,pe,Ke,N.projection,O,C);ne=Mt.useVertical,Ke&&Mt.needsFlipping&&(nt={}),(Mt.notEnoughRoom||ne||Mt.needsFlipping&&xt(_e,he,!0,A,l,x,S,m.glyphOffsetArray,Z,K,Y,ke,Se,nt,pe,Ke,N.projection,O,C).notEnoughRoom)&&dt(we,K)}_?(m.text.dynamicLayoutVertexBuffer.updateData(K),Y&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(Y)):(m.icon.dynamicLayoutVertexBuffer.updateData(K),Y&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(Y))}function ut(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K){const{lineStartIndex:Y,glyphStartIndex:Z,segment:ae}=A,pe=Z+A.numGlyphs,ge=Y+A.lineLength,ne=l.getoffsetX(Z),ce=l.getoffsetX(pe-1),_e=kt(m*ne,h,_,x,S,C,ae,Y,ge,z,O,N,V,G,!0,W,X,K);if(!_e)return null;const we=kt(m*ce,h,_,x,S,C,ae,Y,ge,z,O,N,V,G,!0,W,X,K);return we?{first:_e,last:we}:null}function pt(m,l,h,_){return m===a.W.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:m===a.W.vertical?_>0?{needsFlipping:!0}:null:l!==Ri.unknown&&function(x,S){return x===0||Math.abs(S/x)>jo}(h,_)?l===Ri.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function xt(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z,ae){const pe=l/24,ge=m.lineOffsetX*pe,ne=m.lineOffsetY*pe,{lineStartIndex:ce,glyphStartIndex:_e,numGlyphs:we,segment:ve,writingMode:Se,flipState:qe}=m,De=ce+m.lineLength,Ne=Me=>{if(N){const[he,ke,nt]=Me.up,Ke=O.length;a.u(N,Ke+0,he,ke,nt),a.u(N,Ke+1,he,ke,nt),a.u(N,Ke+2,he,ke,nt),a.u(N,Ke+3,he,ke,nt)}const[We,Fe,Xe]=Me.point;a.k(O,We,Fe,Xe,Me.angle)};if(we>1){const Me=ut(pe,A,ge,ne,h,V,G,m,z,S,W,K,!1,Y,Z,ae);if(!Me)return{notEnoughRoom:!0};if(_&&!h){let[We,Fe,Xe]=Me.first.point,[he,ke,nt]=Me.last.point;[We,Fe]=ai(We,Fe,Xe,C),[he,ke]=ai(he,ke,nt,C);const Ke=pt(Se,qe,(he-We)*X,ke-Fe);if(m.flipState=Ke&&Ke.needsFlipping?Ri.flipRequired:Ri.flipNotRequired,Ke)return Ke}Ne(Me.first);for(let We=_e+1;We<_e+we-1;We++){const Fe=kt(pe*A.getoffsetX(We),ge,ne,h,V,G,ve,ce,De,z,S,W,K,!1,!1,Y,Z,ae);if(!Fe)return O.length-=4*(We-_e),{notEnoughRoom:!0};Ne(Fe)}Ne(Me.last)}else{if(_&&!h){const We=ai(G.x,G.y,0,x),Fe=ce+ve+1,Xe=new a.P(z.getx(Fe),z.gety(Fe)),he=ai(Xe.x,Xe.y,0,x),ke=he[3]>0?he:gt(G,Xe,We,1,x,void 0,Y,Z.canonical),nt=pt(Se,qe,(ke[0]-We[0])*X,ke[1]-We[1]);if(m.flipState=nt&&nt.needsFlipping?Ri.flipRequired:Ri.flipNotRequired,nt)return nt}const Me=kt(pe*A.getoffsetX(_e),ge,ne,h,V,G,ve,ce,De,z,S,W,K,!1,!1,Y,Z,ae);if(!Me)return{notEnoughRoom:!0};Ne(Me)}return{}}function mt(m,l,h,_,x){const{x:S,y:C,z:A}=_.projectTilePoint(m.x,m.y,l);if(!x)return ai(S,C,A,h);const[z,O,N]=x(m);return ai(S+z,C+O,A+N,h)}function gt(m,l,h,_,x,S,C,A){const z=mt(m.sub(l)._unit()._add(m),A,x,C,S);return a.v.sub(z,h,z),a.v.normalize(z,z),a.v.scaleAndAdd(z,h,z,_)}function kt(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z){const ae=_?m-l:m+l;let pe=ae>0?1:-1,ge=0;_&&(pe*=-1,ge=Math.PI),pe<0&&(ge+=Math.PI);let ne=A+C+(pe>0?0:1)|0,ce=x,_e=x,we=0,ve=0;const Se=Math.abs(ae),qe=[],De=[];let Ne=S,Me=Ne;const We=()=>gt(Me,Ne,_e,Se-we+1,N,G,K,Y.canonical);for(;we+ve<=Se;){if(ne+=pe,ne<A||ne>=z)return null;if(_e=ce,Me=Ne,qe.push(_e),W&&De.push(Me),Ne=new a.P(O.getx(ne),O.gety(ne)),ce=V[ne],!ce){const Ft=mt(Ne,Y.canonical,N,K,G);ce=Ft[3]>0?V[ne]=Ft:We()}we+=ve,ve=a.v.distance(_e,ce)}X&&G&&(V[ne]&&(ce=We(),ve=a.v.distance(_e,ce)),V[ne]=ce);const Fe=(Se-we)/ve,Xe=Ne.sub(Me)._mult(Fe)._add(Me),he=a.v.sub([],ce,_e),ke=a.v.scaleAndAdd([],_e,he,Fe);let nt=[0,0,1],Ke=he[0],Mt=he[1];if(Z&&(nt=K.upVector(Y.canonical,Xe.x,Xe.y),nt[0]!==0||nt[1]!==0||nt[2]!==1)){const Ft=[nt[2],0,-nt[0]],St=a.v.cross([],nt,Ft);a.v.normalize(Ft,Ft),a.v.normalize(St,St),Ke=a.v.dot(he,Ft),Mt=a.v.dot(he,St)}if(h){const Ft=a.v.cross([],nt,he);a.v.normalize(Ft,Ft),a.v.scaleAndAdd(ke,ke,Ft,h*pe)}const wt=ge+Math.atan2(Mt,Ke);return qe.push(ke),W&&De.push(Xe),{point:ke,angle:wt,path:qe,tilePath:De,up:nt}}function dt(m,l){const h=l.length,_=h+4*m;l.resize(_),l.float32.fill(-1/0,4*h,4*_)}function Qt(m,l,h){const _=l[0],x=l[1];return m[0]=h[0]*_+h[4]*x+h[12],m[1]=h[1]*_+h[5]*x+h[13],m[3]=h[3]*_+h[7]*x+h[15],m}const Pr=(m,l,h)=>(1-h)*m+h*l,Bt=m=>m*m*m*m*m;class Or{constructor(l,h,_,x,S,C,A){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=l||0,this._maxZoom=h||22,this._minPitch=_??0,this._maxPitch=x??60,this.setProjection(C),this.setMaxBounds(A),this.width=0,this.height=0,this._center=new a.L(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Jr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new zi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const l=new Or(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(l,h=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(l||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return a.p(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=a.o(this.projectionOptions);const _=!P(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(l){return this._orthographicProjectionAtLowPitch!==l&&(this._orthographicProjectionAtLowPitch=l,this._calcMatrices(),!0)}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.o({name:"mercator"});const h=l!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.b(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.w(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const h=-l*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=a.h.create(),a.h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const h=a.c(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=a.d(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const h=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){const l=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&l===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||l===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const _=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&_.exaggeration()&&this._centerAltitudeValidForExaggeration!==_.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*_.exaggeration(),this._centerAltitudeValidForExaggeration=_.exaggeration()):(this._centerAltitude=l||0,this._centerAltitudeValidForExaggeration=_.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let x=0,S=0;for(let C=0;C<h.length;C++){const A=new a.P(h[C][0]*this.width,_+h[C][1]*(this.height-_)),z=l.pointCoordinate(A);if(!z)continue;const O=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);x+=z[3]*O,S+=O}return S===0?NaN:x/S}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const l=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(l),S=this._mercatorZfromZoom(this._maxZoom),C=Math.max(x-_,S);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let _;_=l.z<this._camera.position[2]?[h.x,h.y,h.z]:[l.x,l.y,l.z];const x=a.v.length(a.v.sub([],this._camera.position,_));return a.c(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let h=!1;if(l.orientation&&!a.q.exactEquals(l.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(l.orientation)),l.position){const _=[l.position.x,l.position.y,l.position.z];a.v.exactEquals(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,h=new kn;return h.position=new a.M(l[0],l[1],l[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(l){if(!a.q.length(l))return!1;a.q.normalize(l,l);const h=a.v.transformQuat([],[0,0,-1],l),_=a.v.transformQuat([],[0,-1,0],l);if(_[2]<0)return!1;const x=Jn(h,_);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(l){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;l[2]=a.c(l[2],x/_,x/h),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,h,_){this._unmodified=!1,this._edgeInsets.interpolate(l,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const h=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(l){const h=[new a.U(0,l)];if(this.renderWorldCopies){const _=this.pointCoordinate(new a.P(0,0)),x=this.pointCoordinate(new a.P(this.width,0)),S=this.pointCoordinate(new a.P(this.width,this.height)),C=this.pointCoordinate(new a.P(0,this.height)),A=Math.floor(Math.min(_.x,x.x,S.x,C.x)),z=Math.floor(Math.max(_.x,x.x,S.x,C.x)),O=1;for(let N=A-O;N<=z+O;N++)N!==0&&h.push(new a.U(N,l))}return h}isLODDisabled(l){return(!l||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(l,h,_){let x=[];if(h[0]===0&&h[1]===0)return x;for(const C of l){const A=C.canonical,z=C.overscaledZ,O=C.wrap,N=1<<A.z,V=A.x+1<N,G=A.x>0,W=A.y+1<N,X=A.y>0,K=C.wrap-(G?0:1),Y=C.wrap+(V?0:1),Z=G?A.x-1:N-1,ae=V?A.x+1:0;h[0]<0?(x.push(new a.O(z,Y,A.z,ae,A.y)),h[1]<0&&W&&(x.push(new a.O(z,O,A.z,A.x,A.y+1)),x.push(new a.O(z,Y,A.z,ae,A.y+1))),h[1]>0&&X&&(x.push(new a.O(z,O,A.z,A.x,A.y-1)),x.push(new a.O(z,Y,A.z,ae,A.y-1)))):h[0]>0?(x.push(new a.O(z,K,A.z,Z,A.y)),h[1]<0&&W&&(x.push(new a.O(z,O,A.z,A.x,A.y+1)),x.push(new a.O(z,K,A.z,Z,A.y+1))),h[1]>0&&X&&(x.push(new a.O(z,O,A.z,A.x,A.y-1)),x.push(new a.O(z,K,A.z,Z,A.y-1)))):h[1]<0&&W?x.push(new a.O(z,O,A.z,A.x,A.y+1)):X&&x.push(new a.O(z,O,A.z,A.x,A.y-1))}if(x.length>1){x.sort((z,O)=>z.overscaledZ-O.overscaledZ||z.wrap-O.wrap||z.canonical.z-O.canonical.z||z.canonical.x-O.canonical.x||z.canonical.y-O.canonical.y);let C=0,A=0;for(;A<x.length;)x[A].equals(x[C])?++A:x[++C]=x[A++];x.length=C+1}const S=[];for(const C of x)x.some(A=>C.isChildOf(A))||S.push(C);return x=S.filter(C=>!l.some(A=>!!(C.overscaledZ<_&&A.isChildOf(C))||C.equals(A)||C.isChildOf(A))),x}coveringTiles(l){let h=this.coveringZoomLevel(l);const _=h,x=this.elevation&&this.elevation.exaggeration(),S=x&&!l.isTerrainDEM,C=this.projection.name==="mercator";if(l.minzoom!==void 0&&h<l.minzoom)return[];l.maxzoom!==void 0&&h>l.maxzoom&&(h=l.maxzoom);const A=this.locationCoordinate(this.center),z=this.center.lat,O=1<<h,N=[O*A.x,O*A.y,0],V=this.projection.name==="globe",G=!V,W=a.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,G),X=V?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=O*a.b(1,this.center.lat),Y=this._camera.position[2]/a.b(1,this.center.lat),Z=[O*X.x,O*X.y,Y*(G?1:K)],ae=V||x,pe=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),ge=this.isLODDisabled(!0)?h:0;let ne;if(this._elevation&&l.isTerrainDEM)ne=1e4*this._elevation.exaggeration();else if(this._elevation){const he=this._elevation.getMinMaxForVisibleTiles();ne=he?he.max:this._centerAltitude}else ne=this._centerAltitude;const ce=l.isTerrainDEM?-ne:this._elevation?this._elevation.getMinElevationBelowMSL():0,_e=this.projection.isReprojectedInTileSpace?a.r(this):1,we=he=>{const nt=new a.M(he.x+25e-6,he.y,he.z),Ke=new a.M(he.x,he.y+25e-6,he.z),Mt=he.toLngLat(),wt=nt.toLngLat(),Ft=Ke.toLngLat(),St=this.locationCoordinate(Mt),Vt=this.locationCoordinate(wt),$t=this.locationCoordinate(Ft),Rt=Math.hypot(Vt.x-St.x,Vt.y-St.y),Dt=Math.hypot($t.x-St.x,$t.y-St.y);return Math.sqrt(Rt*Dt)*_e/25e-6},ve=he=>{const ke=ne,nt=ce;return{aabb:a.y(this,O,0,0,0,he,nt,ke,this.projection),zoom:0,x:0,y:0,minZ:nt,maxZ:ke,wrap:he,fullyVisible:!1}},Se=[];let qe=[];const De=h,Ne=l.reparseOverscaled?_:h,Me=he=>he*he,We=Me((Y-this._centerAltitude)*K),Fe=he=>{if(!this._elevation||!he.tileID||!C)return;const ke=this._elevation.getMinMaxForTile(he.tileID),nt=he.aabb;ke?(nt.min[2]=ke.min,nt.max[2]=ke.max,nt.center[2]=(nt.min[2]+nt.max[2])/2):(he.shouldSplit=Xe(he),he.shouldSplit||(nt.min[2]=nt.max[2]=nt.center[2]=this._centerAltitude))},Xe=he=>{if(he.zoom<ge)return!0;if(he.zoom===De)return!1;if(he.shouldSplit!=null)return he.shouldSplit;const ke=he.aabb.distanceX(Z),nt=he.aabb.distanceY(Z);let Ke=We,Mt=1;if(V){Ke=Me(he.aabb.distanceZ(Z));const St=Math.pow(2,he.zoom),Vt=a.l((he.y+1)/St),$t=a.l(he.y/St),Rt=Math.min(Math.max(z,Vt),$t),Dt=a.a0(Rt)/a.a0(z);if(Mt=Rt===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Dt/this._mercatorScaleRatio),this.zoom<=a.Z&&he.zoom===De-1&&Dt>=.9)return!0}else if(S&&(Ke=Me(he.aabb.distanceZ(Z)*K)),this.projection.isReprojectedInTileSpace&&_<=5){const St=Math.pow(2,he.zoom),Vt=we(new a.M((he.x+.5)/St,(he.y+.5)/St));Mt=Vt>.85?1:Vt}const wt=ke*ke+nt*nt+Ke,Ft=Me((1<<De-he.zoom)*pe*Mt*((St,Vt)=>{if(Vt*Me(.707)<St)return 1;const $t=Math.sqrt(Vt/St);return $t/(1.4144271570014144+(Math.pow(1.1,$t-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ke,We),wt));return wt<Ft};if(this.renderWorldCopies)for(let he=1;he<=3;he++)Se.push(ve(-he)),Se.push(ve(he));for(Se.push(ve(0));Se.length>0;){const he=Se.pop(),ke=he.x,nt=he.y;let Ke=he.fullyVisible;const Mt=()=>this.projection.name==="globe"&&(he.y===0||he.y===(1<<he.zoom)-1);if(!Ke){let wt=ae?he.aabb.intersects(W):he.aabb.intersectsFlat(W);if(wt===0&&Mt()){const Ft=new a.t(he.zoom,ke,nt);wt=a.x(this,O,Ft,!0).intersects(W)}if(wt===0)continue;Ke=wt===2}if(he.zoom!==De&&Xe(he))for(let wt=0;wt<4;wt++){const Ft=(ke<<1)+wt%2,St=(nt<<1)+(wt>>1),Vt={aabb:C?he.aabb.quadrant(wt):a.y(this,O,he.zoom+1,Ft,St,he.wrap,he.minZ,he.maxZ,this.projection),zoom:he.zoom+1,x:Ft,y:St,wrap:he.wrap,fullyVisible:Ke,tileID:void 0,shouldSplit:void 0,minZ:he.minZ,maxZ:he.maxZ};S&&!V&&(Vt.tileID=new a.O(he.zoom+1===De?Ne:he.zoom+1,he.wrap,he.zoom+1,Ft,St),Fe(Vt)),Se.push(Vt)}else{const wt=he.zoom===De?Ne:he.zoom;if(l.minzoom&&l.minzoom>wt)continue;if(!Ke){let $t=ae?he.aabb.intersectsPrecise(W):he.aabb.intersectsPreciseFlat(W);if($t===0&&Mt()){const Rt=new a.t(he.zoom,ke,nt);$t=a.x(this,O,Rt,!0).intersectsPrecise(W)}if($t===0)continue}const Ft=N[0]-(.5+ke+(he.wrap<<he.zoom))*(1<<h-he.zoom),St=N[1]-.5-nt,Vt=he.tileID?he.tileID:new a.O(wt,he.wrap,he.zoom,ke,nt);qe.push({tileID:Vt,distanceSq:Ft*Ft+St*St})}}if(this.fogCullDistSq){const he=this.fogCullDistSq,ke=this.horizonLineFromTop();qe=qe.filter(nt=>{const Ke=[0,0,0,1],Mt=[a.J,a.J,0,1],wt=this.calculateFogTileMatrix(nt.tileID.toUnwrapped());a.e.transformMat4(Ke,Ke,wt),a.e.transformMat4(Mt,Mt,wt);const Ft=a.e.min([],Ke,Mt),St=a.e.max([],Ke,Mt),Vt=a.z(Ft,St);if(Vt===0)return!0;let $t=!1;const Rt=this._elevation;if(Rt&&Vt>he&&ke!==0){const Dt=this.calculateProjMatrix(nt.tileID.toUnwrapped());let Sr;l.isTerrainDEM||(Sr=Rt.getMinMaxForTile(nt.tileID)),Sr||(Sr={min:ce,max:ne});const tr=a._(this.rotation),rn=[tr[0]*a.J,tr[1]*a.J,Sr.max];a.v.transformMat4(rn,rn,Dt),$t=(1-rn[1])*this.height*.5<ke}return Vt<he||$t})}return qe.sort((he,ke)=>he.distanceSq-ke.distanceSq).map(he=>he.tileID)}resize(l,h){this.width=l,this.height=h,this.pixelsToGLUnits=[2/l,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const h=a.c(l.lat,-a.A,a.A),_=this.projection.project(l.lng,h);return new a.P(_.x*this.worldSize,_.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.b(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,h){let _,x;const S=this.centerPoint;if(this.projection.name==="globe"){const A=this.worldSize;_=(h.x-S.x)/A,x=(h.y-S.y)/A}else{const A=this.pointCoordinate(h),z=this.pointCoordinate(S);_=A.x-z.x,x=A.y-z.y}const C=this.locationCoordinate(l);this.setLocation(new a.M(C.x-_,C.y-x))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,h){const _=h?a.b(h,l.lat):void 0,x=this.projection.project(l.lng,l.lat);return new a.M(x.x,x.y,_)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,h){const _=h??this._centerAltitude,x=[l.x,l.y,0,1],S=[l.x,l.y,1,1];a.e.transformMat4(x,x,this.pixelMatrixInverse),a.e.transformMat4(S,S,this.pixelMatrixInverse);const C=S[3];a.e.scale(x,x,1/x[3]),a.e.scale(S,S,1/C);const A=x[2],z=S[2];return{p0:x,p1:S,t:A===z?0:(_-A)/(z-A)}}screenPointToMercatorRay(l){const h=[l.x,l.y,0,1],_=[l.x,l.y,1,1];return a.e.transformMat4(h,h,this.pixelMatrixInverse),a.e.transformMat4(_,_,this.pixelMatrixInverse),a.e.scale(h,h,1/h[3]),a.e.scale(_,_,1/_[3]),h[2]=a.b(h[2],this._center.lat)*this.worldSize,_[2]=a.b(_[2],this._center.lat)*this.worldSize,a.e.scale(h,h,1/this.worldSize),a.e.scale(_,_,1/this.worldSize),new a.R([h[0],h[1],h[2]],a.v.normalize([],a.v.sub([],_,h)))}rayIntersectionCoordinate(l){const{p0:h,p1:_,t:x}=l,S=a.b(h[2],this._center.lat),C=a.b(_[2],this._center.lat);return new a.M(a.n(h[0],_[0],x)/this.worldSize,a.n(h[1],_[1],x)/this.worldSize,a.n(S,C,x))}pointCoordinate(l,h=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,h)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let h=this.projection.pointCoordinate3D(this,l.x,l.y);if(h)return new a.M(h[0],h[1],h[2]);let _=0,x=this.horizonLineFromTop();if(l.y>x)return this.pointCoordinate(l);const S=.02*x,C=l.clone();for(let A=0;A<10&&x-_>S;A++){C.y=a.n(_,x,.66);const z=this.projection.pointCoordinate3D(this,C.x,C.y);z?(x=C.y,h=z):_=C.y}return h?new a.M(h[0],h[1],h[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=a.G)return!this.isPointAboveHorizon(l);const h=this.pointCoordinate(l);return h.y>=0&&h.y<=1}_coordinatePoint(l,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,x=[l.x*this.worldSize,l.y*this.worldSize,_+l.toAltitude(),1];return a.e.transformMat4(x,x,this.pixelMatrix),x[3]>0?new a.P(x[0]/x[3],x[1]/x[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,S=this.pointLocation3D(new a.P(h,l)),C=this.pointLocation3D(new a.P(x,l)),A=this.pointLocation3D(new a.P(x,_)),z=this.pointLocation3D(new a.P(h,_));let O=Math.min(S.lng,C.lng,A.lng,z.lng),N=Math.max(S.lng,C.lng,A.lng,z.lng),V=Math.min(S.lat,C.lat,A.lat,z.lat),G=Math.max(S.lat,C.lat,A.lat,z.lat);const W=Math.pow(2,-this.zoom)/16*270,X=this.projection.name==="globe"?1:4,K=(Y,Z,ae,pe,ge)=>{const ne=(Y+ae)/2,ce=(Z+pe)/2,_e=new a.P(ne,ce),{lng:we,lat:ve}=this.pointLocation3D(_e),Se=Math.max(0,O-we,V-ve,we-N,ve-G);O=Math.min(O,we),N=Math.max(N,we),V=Math.min(V,ve),G=Math.max(G,ve),(ge<X||Se>W)&&(K(Y,Z,ne,ce,ge+1),K(ne,ce,ae,pe,ge+1))};if(K(h,l,x,l,1),K(x,l,x,_,1),K(x,_,h,_,1),K(h,_,h,l,1),this.projection.name==="globe"){const[Y,Z]=a.B(this);Y?(G=90,N=180,O=-180):Z&&(V=-90,N=180,O=-180)}return new a.D(new a.L(O,V),new a.L(N,G))}_getBoundsRectangular(l,h){const{top:_,left:x}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,A=new a.P(x,_),z=new a.P(C,_),O=new a.P(C,S),N=new a.P(x,S);let V=this.pointCoordinate(A,l),G=this.pointCoordinate(z,l);const W=this.pointCoordinate(O,h),X=this.pointCoordinate(N,h),K=(Y,Z)=>(Z.y-Y.y)/(Z.x-Y.x);return V.y>1&&G.y>=0?V=new a.M((1-X.y)/K(X,V)+X.x,1):V.y<0&&G.y<=1&&(V=new a.M(-X.y/K(X,V)+X.x,0)),G.y>1&&V.y>=0?G=new a.M((1-W.y)/K(W,G)+W.x,1):G.y<0&&V.y<=1&&(G=new a.M(-W.y/K(W,G)+W.x,0)),new a.D().extend(this.coordinateLocation(V)).extend(this.coordinateLocation(G)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(W))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=l.visibleDemTiles.reduce((_,x)=>{if(x.dem){const S=x.dem.tree;_.min=Math.min(_.min,S.minimums[0]),_.max=Math.max(_.max,S.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*l.exaggeration(),h.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return l?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-a.A,this.maxLat=a.A,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.E(this.minLng)*this.tileSize,this.worldMaxX=a.E(this.maxLng)*this.tileSize,this.worldMinY=a.H(this.maxLat)*this.tileSize,this.worldMaxY=a.H(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,h){return this.projection.createTileMatrix(this,h,l)}calculateDistanceTileData(l){const h=l.key,_=this._distanceTileDataCache;if(_[h])return _[h];const x=l.canonical,S=1/this.height,C=this.cameraWorldSize,A=C/this.zoomScale(x.z),z=(x.x+Math.pow(2,x.z)*l.wrap)*A,O=x.y*A,N=this.point;N.x*=C/this.worldSize,N.y*=C/this.worldSize;const V=this.angle,G=Math.sin(-V),W=-Math.cos(-V);return _[h]={bearing:[G,W],center:[(N.x-z)*S,(N.y-O)*S],scale:A/a.J*S},_[h]}calculateFogTileMatrix(l){const h=l.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return a.m.multiply(x,this.worldToFogMatrix,x),_[h]=new Float32Array(x),_[h]}calculateProjMatrix(l,h=!1,_=!1){const x=l.key;let S;if(S=_?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,S[x])return S[x];const C=this.calculatePosMatrix(l,this.worldSize);let A;return A=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:_?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,a.m.multiply(C,A,C),S[x]=new Float32Array(C),S[x]}calculatePixelsToTileUnitsMatrix(l){const h=l.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const x=a.K(l,this);return _[h]=x,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const l=1/this.worldSize,h=a.m.fromScaling([],[l,l,l]);return a.m.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const l=this._elevation;this._updateCameraState();const h=a.b(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),x=this._camera.forward(),S=a.b(1,this._center.lat);_[2]/=S,x[2]/=S,a.v.normalize(x,x);const C=l.raycast(_,x,l.exaggeration());if(C){const A=a.v.scaleAndAdd([],_,x,C),z=new a.M(A[0],A[1],a.b(A[2],a.l(A[1]))),O=(z.z+a.v.length([z.x-_[0],z.y-_[1],z.z-_[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const h=this._elevation,_=a.b(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(_),S=h.getAtPointOrZero(new a.M(...x)),C=this.pixelsPerMeter/this.worldSize*S,A=this._minimumHeightOverTerrain(),z=x[2]-C;if(z<=A)if(z<0||l){const O=this.locationCoordinate(this._center,this._centerAltitude),N=[x[0],x[1],O.z-x[2]],V=a.v.length(N);N[2]-=(A-z)/this._pixelsPerMercatorPixel;const G=a.v.length(N);if(G===0)return;a.v.scale(N,N,V/G*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],O.z*this._pixelsPerMercatorPixel-N[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const G=this.center;return G.lat=a.c(G.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(G.lng=a.c(G.lng,this.minLng,this.maxLng)),this.center=G,void(this._constraining=!1)}const h=this._unmodified,{x:_,y:x}=this.point;let S=0,C=_,A=x;const z=this.width/2,O=this.height/2,N=this.worldMinY*this.scale,V=this.worldMaxY*this.scale;if(x-O<N&&(A=N+O),x+O>V&&(A=V-O),V-N<this.height&&(S=Math.max(S,this.height/(V-N)),A=(V+N)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const G=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,X=this.worldSize/2-(G+W)/2;C=(_+X+this.worldSize)%this.worldSize-X,C-z<G&&(C=G+z),C+z>W&&(C=W-z),W-G<this.width&&(S=Math.max(S,this.width/(W-G)),C=(W+G)/2)}C===_&&A===x||(this.center=this.unproject(new a.P(C,A))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,h=this.projection.name==="globe",_=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.b(1,this.center.lat)/a.b(1,a.$));const x=a.N(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?_:1,C=this._camera.getWorldToCamera(this.worldSize,S);let A;const z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(z[8]=2*-l.x/this.width,z[9]=2*l.y/this.height,this.isOrthographic){let ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Se=ve*this.aspect,qe=-Se,De=-ve;Se-=l.x,qe-=l.x,ve+=l.y,De+=l.y,A=this._camera.getCameraToClipOrthographic(qe,Se,De,ve,this._nearZ,this._farZ),((Ne,Me,We,Fe)=>{for(let Xe=0;Xe<16;Xe++)Ne[Xe]=Pr(Me[Xe],We[Xe],Fe)})(A,A,z,Bt(this.pitch>=15?1:this.pitch/15))}else A=z;const O=a.m.mul([],z,C);let N=a.m.mul([],A,C);if(this.projection.isReprojectedInTileSpace){const ve=this.locationCoordinate(this.center),Se=a.m.identity([]);a.m.translate(Se,Se,[ve.x*this.worldSize,ve.y*this.worldSize,0]),a.m.multiply(Se,Se,a.Q(this)),a.m.translate(Se,Se,[-ve.x*this.worldSize,-ve.y*this.worldSize,0]),a.m.multiply(N,N,Se),a.m.multiply(O,O,Se),this.inverseAdjustmentMatrix=a.S(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.m.scale([],N,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=N,this.invProjMatrix=a.m.invert(new Float64Array(16),this.projMatrix),h){const ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ve[8]=2*-l.x/this.width,ve[9]=2*l.y/this.height,this.expandedFarZProjMatrix=a.m.mul([],ve,C)}else this.expandedFarZProjMatrix=this.projMatrix;const V=a.m.invert([],A);this.frustumCorners=a.T.fromInvProjectionMatrix(V,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const G=new Float32Array(16);a.m.identity(G),a.m.scale(G,G,[1,-1,1]),a.m.rotateX(G,G,this._pitch),a.m.rotateZ(G,G,this.angle);const W=a.m.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.m.clone(W);const X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-l.x/this.width,W[9]=2*(l.y+X)/this.height,this.skyboxMatrix=a.m.multiply(G,W,G);const K=this.point,Y=K.x,Z=K.y,ae=this.width%2/2,pe=this.height%2/2,ge=Math.cos(this.angle),ne=Math.sin(this.angle),ce=Y-Math.round(Y)+ge*ae+ne*pe,_e=Z-Math.round(Z)+ge*pe+ne*ae,we=new Float64Array(N);if(a.m.translate(we,we,[ce>.5?ce-1:ce,_e>.5?_e-1:_e,0]),this.alignedProjMatrix=we,N=a.m.create(),a.m.scale(N,N,[this.width/2,-this.height/2,1]),a.m.translate(N,N,[1,-1,0]),this.labelPlaneMatrix=N,N=a.m.create(),a.m.scale(N,N,[1,-1,1]),a.m.translate(N,N,[-1,-1,0]),a.m.scale(N,N,[2/this.width,2/this.height,1]),this.glCoordMatrix=N,this.pixelMatrix=a.m.multiply(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},N=a.m.invert(new Float64Array(16),this.pixelMatrix),!N)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=N,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.V(this);const ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.v.transformMat4(ve,ve,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=N;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,S=[l,l,h];a.v.scale(S,S,x),a.v.scale(_,_,-1),a.v.multiply(_,_,S);const C=a.m.create();a.m.translate(C,C,_),a.m.scale(C,C,S),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,h,x)}_computeCameraPosition(l){const h=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),x=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-l/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-_[0]*S,x.y/this.worldSize-_[1]*S,l/this.worldSize*this._centerAltitude-_[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],x=l[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(S=Math.min((h-_)/x,1)),this._camera.position=a.v.scaleAndAdd([],this._camera.position,l,S),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:x}=this._camera.getPitchBearing(),S=a.b(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.d(this._maxPitch)),A=Math.max((l[2]-S)/Math.cos(_),C),z=this._zoomFromMercatorZ(A);a.v.scaleAndAdd(l,l,h,A),this._pitch=a.c(_,a.d(this.minPitch),a.d(this.maxPitch)),this.angle=a.w(x,-Math.PI,Math.PI),this._setZoom(a.c(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.M(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let h=0,_=a.G,x=0,S=1/0;for(;_-h>1e-6&&_>h;){const C=h+.5*(_-h),A=this.tileSize*Math.pow(2,C),z=this.getCameraToCenterDistance(this.projection,C,A),O=this.scaleZoom(z/(l*this.tileSize)),N=Math.abs(C-O);N<S&&(S=N,x=C),C<O?h=C:_=C}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.X("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,h){const _=Math.min(l.x,h.x),x=Math.max(l.x,h.x),S=Math.min(l.y,h.y),C=Math.max(l.y,h.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const A=[new a.P(_,S),new a.P(x,C),new a.P(_,C),new a.P(x,S)],z=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(const N of A){const V=this.pointRayIntersection(N);if(V.t<0)return!0;const G=this.rayIntersectionCoordinate(V);if(G.x<z||G.y<0||G.x>O||G.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.Y(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(l,h){const _=a.v.length(a.v.sub([],this._camera.position,l)),x=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const l=function([h,_,x],S){const C=[h,_,x,1];a.e.transformMat4(C,C,S);const A=C[3]=Math.max(C[3],1e-6);return C[0]/=A,C[1]/=A,C[2]/=A,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,l))}}getCameraToCenterDistance(l,h=this.zoom,_=this.worldSize){const x=a.N(l,h,this.width,this.height,1024),S=l.pixelSpaceConversion(this.center.lat,_,x);let C=.5/Math.tan(.5*this._fov)*this.height*S;return this.isOrthographic&&(C=Pr(1,C,Bt(this.pitch>=15?1:this.pitch/15))),C}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.m.multiply(l,l,this.globeMatrix),l}getFrustum(l){return a.F.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,this.projection.zAxisUnit==="meters")}}function bn(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class Tn extends a.a6{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(l){this.images[l]={},this.loaded[l]=!1,this.updatedImages[l]={},this.patterns[l]={},this.callbackDispatchedThisFrame[l]={},this.atlasImage[l]=new a.a5({width:1,height:1})}isLoaded(){for(const l in this.loaded)if(!this.loaded[l])return!1;return!0}setLoaded(l,h){if(this.loaded[h]!==l&&(this.loaded[h]=l,l)){for(const{ids:_,callback:x}of this.requestors)this._notify(_,h,x);this.requestors=[]}}hasImage(l,h){return!!this.getImage(l,h)}getImage(l,h){return this.images[h][l]}addImage(l,h,_){this._validate(l,_)&&(this.images[h][l]=_)}_validate(l,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.a7(new Error(`Image "${l}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.a7(new Error(`Image "${l}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new a.a7(new Error(`Image "${l}" has invalid "content" value`))),_=!1),_}_validateStretch(l,h){if(!l)return!0;let _=0;for(const x of l){if(x[0]<_||x[1]<x[0]||h<x[1])return!1;_=x[1]}return!0}_validateContent(l,h){return!(l&&(l.length!==4||l[0]<0||h.data.width<l[0]||l[1]<0||h.data.height<l[1]||l[2]<0||h.data.width<l[2]||l[3]<0||h.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,h,_){_.version=this.images[h][l].version+1,this.images[h][l]=_,this.updatedImages[h][l]=!0}removeImage(l,h){const _=this.images[h][l];delete this.images[h][l],delete this.patterns[h][l],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(l){return Object.keys(this.images[l])}getImages(l,h,_){let x=!0;const S=!!this.loaded[h];if(!S)for(const C of l)this.images[h][C]||(x=!1);S||x?this._notify(l,h,_):this.requestors.push({ids:l,scope:h,callback:_})}getUpdatedImages(l){return this.updatedImages[l]}_notify(l,h,_){const x={};for(const S of l){this.images[h][S]||this.fire(new a.a8("styleimagemissing",{id:S}));const C=this.images[h][S];C?x[S]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:a.X(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,x)}getPixelSize(l){const{width:h,height:_}=this.atlasImage[l];return{width:h,height:_}}getPattern(l,h){const _=this.patterns[h][l],x=this.getImage(l,h);if(!x)return null;if(_&&_.position.version===x.version)return _.position;if(_)_.position.version=x.version;else{const S={w:x.data.width+2,h:x.data.height+2,x:0,y:0},C=new a.ab(S,x);this.patterns[h][l]={bin:S,position:C}}return this._updatePatternAtlas(h),this.patterns[h][l].position}bind(l,h){const _=l.gl;let x=this.atlasTexture[h];x?this.dirty&&(x.update(this.atlasImage[h]),this.dirty=!1):(x=new a.a9(l,this.atlasImage[h],_.RGBA),this.atlasTexture[h]=x),x.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(l){const h=[];for(const C in this.patterns[l])h.push(this.patterns[l][C].bin);const{w:_,h:x}=a.aa(h),S=this.atlasImage[l];S.resize({width:_||1,height:x||1});for(const C in this.patterns[l]){const{bin:A}=this.patterns[l][C],z=A.x+1,O=A.y+1,N=this.images[l][C].data,V=N.width,G=N.height;a.a5.copy(N,S,{x:0,y:0},{x:z,y:O},{width:V,height:G}),a.a5.copy(N,S,{x:0,y:G-1},{x:z,y:O-1},{width:V,height:1}),a.a5.copy(N,S,{x:0,y:0},{x:z,y:O+G},{width:V,height:1}),a.a5.copy(N,S,{x:V-1,y:0},{x:z-1,y:O},{width:1,height:G}),a.a5.copy(N,S,{x:0,y:0},{x:z+V,y:O},{width:1,height:G})}this.dirty=!0}beginFrame(){for(const l in this.images)this.callbackDispatchedThisFrame[l]={}}dispatchRenderCallbacks(l,h){for(const _ of l){if(this.callbackDispatchedThisFrame[h][_])continue;this.callbackDispatchedThisFrame[h][_]=!0;const x=this.images[h][_];bn(x)&&this.updateImage(_,h,x)}}}const zn=new a.ac({anchor:new a.ad(a.ae.light.anchor),position:new a.af(a.ae.light.position),color:new a.ad(a.ae.light.color),intensity:new a.ad(a.ae.light.intensity)});class hi extends a.a6{constructor(l,h="flat"){super(),this._transitionable=new a.ag(zn),this.setLight(l,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,h,_={}){this._validate(a.ah,l,_)||(this._transitionable.setTransitionOrValue(l),this.id=h)}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||_.validate!==!1)&&a.ai(this,l.call(a.aj,a.ak({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.ae})))}}const li=new a.ac({source:new a.ad(a.ae.terrain.source),exaggeration:new a.ad(a.ae.terrain.exaggeration)});let fo=class extends a.a6{constructor(m,l,h,_){super(),this.scope=h,this._transitionable=new a.ag(li,h,_),this._transitionable.setTransitionOrValue(m,_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(m,l){this._transitionable.setTransitionOrValue(m,l)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new a.al(m)).get("exaggeration")}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof a.am}};const Xi=45,di=65,Ui=.05;function us(m,l,h,_){const x=a.an(Xi,di,h),[S,C]=Va(m,_);let A=1-Math.min(1,Math.exp((l-S)/(C-S)*-6));return A*=A*A,A=Math.min(1,1.00747*A),A*x*m.alpha}function Va(m,l){const h=.5/Math.tan(.5*l);return[m.range[0]+h,m.range[1]+h]}function Dl(m,l,h,_,x){const S=a.v.transformMat4([],[l,h,_],x.mercatorFogMatrix);return us(m,a.v.length(S),x.pitch,x._fov)}function Oc(m,l,h,_,x,S,C){const A=[[h,_,0],[x,_,0],[x,S,0],[h,S,0]];let z=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(const N of A){const V=a.v.transformMat4([],N,l),G=a.v.length(V);z=Math.min(z,G),O=Math.max(O,G)}return[us(m,z,C.pitch,C._fov),us(m,O,C.pitch,C._fov)]}const ca=new a.ac({range:new a.ad(a.ae.fog.range),color:new a.ad(a.ae.fog.color),"high-color":new a.ad(a.ae.fog["high-color"]),"space-color":new a.ad(a.ae.fog["space-color"]),"horizon-blend":new a.ad(a.ae.fog["horizon-blend"]),"star-intensity":new a.ad(a.ae.fog["star-intensity"]),"vertical-range":new a.ad(a.ae.fog["vertical-range"])});class Ll extends a.a6{constructor(l,h){super(),this._transitionable=new a.ag(ca),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const l=this._transform,h=l.projection.name==="globe",_=a.ao(l.zoom),x=this.properties.get("range"),S=[.5,3];return{range:h?[a.n(S[0],x[0],_),a.n(S[1],x[1],_)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,h={}){if(this._validate(a.ap,l,h))return;const _=a.ak({},l);for(const x of Object.keys(a.ae.fog))_[x]===void 0&&(_[x]=a.ae.fog[x].default);this._transitionable.setTransitionOrValue(_)}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.an(Xi,di,l))*h.a}getOpacityAtLatLng(l,h){return this._transform.projection.supportsFog?function(_,x,S){const C=a.M.fromLngLat(x),A=S.elevation?S.elevation.getAtPointOrZero(C):0;return Dl(_,C.x,C.y,A,S)}(this.state,l,h):0}getOpacityForTile(l){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(l.toUnwrapped());return Oc(this.state,h,0,0,a.J,a.J,this._transform)}getOpacityForBounds(l,h,_,x,S){return this._transform.projection.supportsFog?Oc(this.state,l,h,_,x,S,this._transform):[1,1]}getFovAdjustedRange(l){return this._transform.projection.supportsFog?Va(this.state,l):[0,1]}isVisibleOnFrustum(l){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const _ of h){const x=l.points[_];let S;if(x[2]>=0)S=x;else{const C=l.points[_-4];S=a.aq(C,x,C[2]/(C[2]-x[2]))}if(Dl(this.state,S[0],S[1],0,this._transform)>=Ui)return!0}return!1}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||_.validate!==!1)&&a.ai(this,l.call(a.aj,a.ak({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.ae})))}}class Ol extends a.a6{constructor(l,h,_,x){super(),this.scope=_,this._options=l,this.properties=new a.ar(h),this._transitionable=new a.ag(h,_,new Map(x)),this._transitionable.setTransitionOrValue(l.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(l){this._transitionable.setTransitionOrValue(this._options.properties,new Map(l))}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(l,h){this._options=l,this._transitionable.setTransitionOrValue(l.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const $o=new a.ac({color:new a.ad(a.ae.properties_light_ambient.color),intensity:new a.ad(a.ae.properties_light_ambient.intensity)}),Gu=new a.ac({direction:new a.as(a.ae.properties_light_directional.direction),color:new a.ad(a.ae.properties_light_directional.color),intensity:new a.ad(a.ae.properties_light_directional.intensity),"cast-shadows":new a.ad(a.ae.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.ad(a.ae.properties_light_directional["shadow-intensity"])});class Di{constructor(l,h,_,x){this.screenBounds=l,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(l,h){let _,x;if(l instanceof a.P||typeof l[0]=="number"){const S=a.P.convert(l);_=[S],x=h.isPointAboveHorizon(S)}else{const S=a.P.convert(l[0]),C=a.P.convert(l[1]);_=[S,C],x=a.at(S,C).every(A=>h.isPointAboveHorizon(A))}return new Di(_,h.getCameraPoint(),x,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return a.at(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],x=a.at(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),a.au(x,l)}bufferedCameraGeometryGlobe(l){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],x=a.at(h,_,l),S=this.cameraPoint.clone();switch(3*((S.y>h.y)+(S.y>_.y))+((S.x>h.x)+(S.x>_.x))){case 0:x[0]=S,x[4]=S.clone();break;case 1:x.splice(1,0,S);break;case 2:x[1]=S;break;case 3:x.splice(4,0,S);break;case 5:x.splice(2,0,S);break;case 6:x[3]=S;break;case 7:x.splice(3,0,S);break;case 8:x[2]=S}return x}containsTile(l,h,_,x=0){const S=l.queryPadding/h._pixelsPerMercatorPixel+1,C=_?this._bufferedCameraMercator(S,h):this._bufferedScreenMercator(S,h);let A=l.tileID.wrap+(C.unwrapped?x:0);const z=C.polygon.map(Y=>a.av(l.tileTransform,Y,A));if(!a.aw(z,0,0,a.J,a.J))return;A=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const O=this.screenGeometryMercator.polygon.map(Y=>a.ax(l.tileTransform,Y,A)),N=O.map(Y=>new a.P(Y[0],Y[1])),V=h.getFreeCameraOptions().position||new a.M(0,0,0),G=a.ax(l.tileTransform,V,A),W=O.map(Y=>{const Z=a.v.sub(Y,Y,G);return a.v.normalize(Z,Z),new a.R(G,Z)}),X=a.ay(l,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:N,tilespaceRays:W,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(K=a.az(z),K.min.x=a.c(K.min.x,0,a.J),K.min.y=a.c(K.min.y,0,a.J),K.max.x=a.c(K.max.x,0,a.J),K.max.y=a.c(K.max.y,0,a.J),K),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:X};var K}_bufferedScreenMercator(l,h){const _=po(l);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),h):{polygon:this.bufferedScreenGeometry(l).map(S=>h.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[_]=x,x}}_bufferedCameraMercator(l,h){const _=po(l);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),h):{polygon:this.bufferedCameraGeometry(l).map(S=>h.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[_]=x,x}}_projectAndResample(l,h){const _=function(S,C){const A=a.m.multiply([],C.pixelMatrix,C.globeMatrix),z=[0,-a.aC,0,1],O=[0,a.aC,0,1],N=[0,0,0,1];a.e.transformMat4(z,z,A),a.e.transformMat4(O,O,A),a.e.transformMat4(N,N,A);const V=new a.P(z[0]/z[3],z[1]/z[3]),G=new a.P(O[0]/O[3],O[1]/O[3]),W=a.aA(S,V)&&z[3]<N[3],X=a.aA(S,G)&&O[3]<N[3];if(!W&&!X)return null;const K=function(_e,we,ve){for(let Se=1;Se<_e.length;Se++){const qe=ua(we.pointCoordinate3D(_e[Se-1]).x),De=ua(we.pointCoordinate3D(_e[Se]).x);if(ve<0){if(qe<De)return{idx:Se,t:-qe/(De-1-qe)}}else if(De<qe)return{idx:Se,t:(1-qe)/(De+1-qe)}}return null}(S,C,W?-1:1);if(!K)return null;const{idx:Y,t:Z}=K;let ae=Y>1?Bc(S.slice(0,Y),C):[],pe=Y<S.length?Bc(S.slice(Y),C):[];ae=ae.map(_e=>new a.P(ua(_e.x),_e.y)),pe=pe.map(_e=>new a.P(ua(_e.x),_e.y));const ge=[...ae];ge.length===0&&ge.push(pe[pe.length-1]);const ne=a.n(ge[ge.length-1].y,(pe.length===0?ae[0]:pe[0]).y,Z);let ce;return ce=W?[new a.P(0,ne),new a.P(0,0),new a.P(1,0),new a.P(1,ne)]:[new a.P(1,ne),new a.P(1,1),new a.P(0,1),new a.P(0,ne)],ge.push(...ce),pe.length===0?ge.push(ae[0]):ge.push(...pe),{polygon:ge.map(_e=>new a.M(_e.x,_e.y)),unwrapped:!1}}(l,h);if(_)return _;const x=function(S,C){let A=!1,z=-1/0,O=0;for(let V=0;V<S.length-1;V++)S[V].x>z&&(z=S[V].x,O=V);for(let V=0;V<S.length-1;V++){const G=(O+V)%(S.length-1),W=S[G],X=S[G+1];Math.abs(W.x-X.x)>.5&&(W.x<X.x?(W.x+=1,G===0&&(S[S.length-1].x+=1)):(X.x+=1,G+1===S.length-1&&(S[0].x+=1)),A=!0)}const N=a.E(C.center.lng);return A&&N<Math.abs(N-1)&&S.forEach(V=>{V.x-=1}),{polygon:S,unwrapped:A}}(Bc(l,h).map(S=>new a.P(ua(S.x),S.y)),h);return{polygon:x.polygon.map(S=>new a.M(S.x,S.y)),unwrapped:x.unwrapped}}}function Bc(m,l){return a.aB(m,h=>{const _=l.pointCoordinate3D(h);h.x=_.x,h.y=_.y},1/256)}function ua(m){return m<0?1+m%1:m%1}function po(m){return 100*m|0}function ha(m,l,h,_,x){const S=function(C,A){if(C)return x(C);if(A){m.url&&A.tiles&&m.tiles&&delete m.tiles;const z=a.p(a.ak(A,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);A.vector_layers&&(z.vectorLayers=A.vector_layers,z.vectorLayerIds=z.vectorLayers.map(O=>O.id)),z.tiles=l.canonicalizeTileset(z,m.url),x(null,z)}};return m.url?a.a1(l.transformRequest(l.normalizeSourceURL(m.url,null,h,_),a.a2.Source),S):a.a4.frame(()=>S(null,m))}class Uo{constructor(l,h,_){this.bounds=a.D.convert(this.validateBounds(l)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const h=Math.pow(2,l.z),_=Math.floor(a.E(this.bounds.getWest())*h),x=Math.floor(a.H(this.bounds.getNorth())*h),S=Math.ceil(a.E(this.bounds.getEast())*h),C=Math.ceil(a.H(this.bounds.getSouth())*h);return l.x>=_&&l.x<S&&l.y>=x&&l.y<C}}class ze extends a.a6{constructor(l,h,_,x){if(super(),this.id=l,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.ak(this,a.p(h,["url","scheme","tileSize","promoteId"])),this._options=a.ak({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new a.aD}load(l){this._loaded=!1,this.fire(new a.a8("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=ha(this._options,this.map._requestManager,h,_,(x,S)=>{this._tileJSONRequest=null,this._loaded=!0,x?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new a.a7(x))):S&&(a.ak(this,S),S.bounds&&(this.tileBounds=new Uo(S.bounds,this.minzoom,this.maxzoom)),a.aH(S.tiles,this.map._requestManager._customAccessToken),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"content"}))),l&&l(x)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.aE(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.ak({},this._options)}loadTile(l,h){const _=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(_,a.a2.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.a4.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:l.isExtraShadowCaster};if(x.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=h:l.request=l.actor.send("reloadTile",x,S.bind(this));else if(l.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",x,S.bind(this),void 0,!0);else{const C=a.aF.call({deduped:this._deduped},x,(A,z)=>{A||!z?S.call(this,A):(x.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},l.actor&&l.actor.send("loadTile",x,S.bind(this),void 0,!0))},!0);l.request={cancel:C}}function S(C,A){return delete l.request,l.aborted?h(null):C&&C.status!==404?h(C):(A&&A.resourceTiming&&(l.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&l.setExpiryData(A),l.loadVectorData(A,this.map.painter),a.aG(this.dispatcher),h(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(l){l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id,scope:this.scope}),l.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Pt extends a.a6{constructor(l,h,_,x){super(),this.id=l,this.dispatcher=_,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.ak({type:"raster"},h),a.ak(this,a.p(h,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new a.a8("dataloading",{dataType:"source"})),this._tileJSONRequest=ha(this._options,this.map._requestManager,null,null,(h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new a.a7(h)):_&&(a.ak(this,_),_.bounds&&(this.tileBounds=new Uo(_.bounds,this.minzoom,this.maxzoom)),a.aH(_.tiles),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"content"}))),l&&l(h)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest();const l=a.aE(this.id,this.scope);this.load(()=>this.map.style.clearSource(l))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.ak({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,h){const _=a.a4.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);l.request=a.a3(this.map._requestManager.transformRequest(x,a.a2.Tile),(S,C,A,z)=>(delete l.request,l.aborted?(l.state="unloaded",h(null)):S?(l.state="errored",h(S)):C?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:A,expires:z}),l.setTexture(C,this.map.painter),l.state="loaded",a.aG(this.dispatcher),void h(null)):h(null)))}abortTile(l,h){l.request&&(l.request.cancel(),delete l.request),h()}unloadTile(l,h){l.texture&&l.texture instanceof a.a9?(l.destroy(!0),l.texture&&l.texture instanceof a.a9&&this.map.painter.saveTileTexture(l.texture)):l.destroy(),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const Go={vector:ze,raster:Pt,"raster-dem":class extends Pt{constructor(m,l,h,_){super(m,l,h,_),this.type="raster-dem",this.maxzoom=22,this._options=a.ak({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(x,S){x&&(m.state="errored",l(x)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=a.a3(this.map._requestManager.transformRequest(h,a.a2.Tile),(function(x,S,C,A){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(x)m.state="errored",l(x);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:C,expires:A});const z=ImageBitmap&&S instanceof ImageBitmap&&a.aI(),O=1-(S.width-a.aJ(S.width))/2;O<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const N=z?S:a.a4.getImageData(S,O),V={uid:m.uid,coord:m.tileID,source:this.id,scope:this.scope,rawImageData:N,encoding:this.encoding,padding:O};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",V,_.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const l=m.canonical,h=Math.pow(2,l.z),_=(l.x-1+h)%h,x=l.x===0?m.wrap-1:m.wrap,S=(l.x+1+h)%h,C=l.x+1===h?m.wrap+1:m.wrap,A={};return A[new a.O(m.overscaledZ,x,l.z,_,l.y).key]={backfilled:!1},A[new a.O(m.overscaledZ,C,l.z,S,l.y).key]={backfilled:!1},l.y>0&&(A[new a.O(m.overscaledZ,x,l.z,_,l.y-1).key]={backfilled:!1},A[new a.O(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},A[new a.O(m.overscaledZ,C,l.z,S,l.y-1).key]={backfilled:!1}),l.y+1<h&&(A[new a.O(m.overscaledZ,x,l.z,_,l.y+1).key]={backfilled:!1},A[new a.O(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},A[new a.O(m.overscaledZ,C,l.z,S,l.y+1).key]={backfilled:!1}),A}},geojson:class extends a.a6{constructor(m,l,h,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=l.data,this._options=a.ak({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const x=a.J/this.tileSize;this.workerOptions=a.ak({source:this.id,scope:this.scope,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*x,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*x,extent:a.J,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:a.J,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*x,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},l),this}getClusterLeaves(m,l,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:l,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.a8("dataloading",{dataType:"source"})),this._loaded=!1;const m=a.ak({},this.workerOptions);m.scope=this.scope;const l=this._data;typeof l=="string"?(m.request=this.map._requestManager.transformRequest(a.a4.resolveURL(l),a.a2.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new a.a7(h));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),this.fire(new a.a8("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const _={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:a.a4.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};m.request=this.actor.send(h,_,(x,S)=>(delete m.request,m.destroy(),m.aborted?l(null):x?l(x):(m.loadVectorData(S,this.map.painter,h==="reloadTile"),l(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.ak({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aK{constructor(m,l,h,_){super(m,l,h,_),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,a.a2.Source).url);a.aL(this.urls,(l,h)=>{this._loaded=!0,l?this.fire(new a.a7(l)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new a.a7(new a.aM(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new a.a9(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aK,model:class extends a.a6{constructor(m,l,h,_){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=l}load(){const m=[];for(const l in this._options.models){const h=this._options.models[l],_=a.aO(this.map._requestManager.transformRequest(h.uri,a.a2.Model).url).then(x=>{if(!x)return;const S=a.aP(x),C=new a.aQ(l,h.position,h.orientation,S);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(x=>{this.fire(new a.a7(new Error(`Could not load model ${l} from ${h.uri}: ${x.message}`)))});m.push(_)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new a.a8("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(l=>{this.fire(new a.a7(new Error(`Could not load models: ${l.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,l){}serialize(){return{type:"model"}}},"batched-model":class extends a.a6{constructor(m,l,h,_){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=l,this.tiles=this._options.tiles,this.maxzoom=l.maxzoom||19,this.minzoom=l.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(_)}onAdd(m){this.map=m,this.load()}load(m){this._loaded=!1,this.fire(new a.a8("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map._worldview;this._tileJSONRequest=ha(this._options,this.map._requestManager,l,h,(_,x)=>{this._tileJSONRequest=null,this._loaded=!0,_?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new a.a7(_))):x&&(a.ak(this,x),x.bounds&&(this.tileBounds=new Uo(x.bounds,this.minzoom,this.maxzoom)),a.aH(x.tiles,this.map._requestManager._customAccessToken),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"content"}))),m&&m(_)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,l){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(h,a.a2.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=l;else{if(m.buckets){const S=Object.values(m.buckets);for(const C of S)C.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",_,x.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",_,x.bind(this),void 0,!0);function x(S,C){return m.aborted?l(null):S&&S.status!==404?l(S):(C&&(C.resourceTiming&&(m.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&m.setExpiryData(C),m.buckets={...m.buckets,...C.buckets}),m.state="loaded",void l(null))}}serialize(){return a.ak({},this._options)}},canvas:class extends a.aK{constructor(m,l,h,_){super(m,l,h,_),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new a.a7(new a.aM(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.a7(new a.aM(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new a.a7(new a.aM(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof HTMLCanvasElement||this.fire(new a.a7(new a.aM(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.a7(new a.aM(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.a7(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const l=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof a.aN||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.a9(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends a.a6{constructor(m,l,h,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=l,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.a7(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.a7(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Uo(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),a.ak(this,a.p(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.p(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.a8("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.a8("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new a.a8("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:l,y:h,z:_}=m.canonical;return this._implementation.hasTile({x:l,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){const{x:h,y:_,z:x}=m.tileID.canonical,S=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:x},{signal:S.signal})).then((function(C){return delete m.request,m.aborted?(m.state="unloaded",l(null)):C===void 0?(m.state="errored",l(null)):C===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):function(A){return A instanceof ImageData||A instanceof HTMLCanvasElement||A instanceof ImageBitmap||A instanceof HTMLImageElement}(C)?(this.loadTileData(m,C),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.code!==20&&(m.state="errored",l(C))}),m.request.cancel=()=>S.abort()}loadTileData(m,l){m.setTexture(l,this._map.painter)}unloadTile(m,l){if(m.texture&&m.texture instanceof a.a9?(m.destroy(!0),m.texture&&m.texture instanceof a.a9&&this._map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:h,y:_,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:x})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=a.aE(this.id,this.scope);this._map.style.clearSource(m)}_update(){this.fire(new a.a8("data",{dataType:"source",sourceDataType:"content"}))}}},Po=function(m,l,h,_){const x=new Go[l.type](m,l,h,_);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return a.aR(["load","abort","unload","serialize","prepare"],x),x};function Rn(m,l){const h=a.m.identity([]);return a.m.scale(h,h,[.5*m.width,.5*-m.height,1]),a.m.translate(h,h,[1,-1,0]),a.m.multiply(h,h,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(h)}function hs(m,l,h,_,x,S,C,A=!1){const z=m.tilesIn(_,C,A);z.sort(Io);const O=[];for(const V of z)O.push({wrappedTileID:V.tile.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(l,h,m._state,V,x,S,Rn(m.transform,V.tile.tileID),A)});const N=function(V){const G={},W={};for(const X of V){const K=X.queryResults,Y=X.wrappedTileID,Z=W[Y]=W[Y]||{};for(const ae in K){const pe=K[ae],ge=Z[ae]=Z[ae]||{},ne=G[ae]=G[ae]||[];for(const ce of pe)ge[ce.featureIndex]||(ge[ce.featureIndex]=!0,ne.push(ce))}}return G}(O);for(const V in N)N[V].forEach(G=>{const W=G.feature,X=W.layer;X&&X.type!=="background"&&X.type!=="sky"&&X.type!=="slot"&&(W.source=X.source,X["source-layer"]&&(W.sourceLayer=X["source-layer"]),W.state=W.id!==void 0?m.getFeatureState(X["source-layer"],W.id):{})});return N}function Lp(m,l){const h=m.getRenderableIds().map(S=>m.getTileByID(S)),_=[],x={};for(let S=0;S<h.length;S++){const C=h[S],A=C.tileID.canonical.key;x[A]||(x[A]=!0,C.querySourceFeatures(_,l))}return _}function Io(m,l){const h=m.tileID,_=l.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}class $a{constructor(l){this.style=l}processLayersChanged(){this.layers=[];for(const l in this.style._mergedLayers){const h=this.style._mergedLayers[l];if(h.type==="fill-extrusion")this.layers.push(h);else if(h.type==="model"){const _=this.style.getLayerSource(h);_&&_.type==="batched-model"&&this.layers.push(h)}}}updateZOffset(l,h){this.currentBuildingBuckets=[];for(let x=0;x<this.layers.length;++x){const S=this.layers[x],C=this.style.getLayerSourceCache(S);let A=1;S.type==="fill-extrusion"&&(A=S.paint.get("fill-extrusion-opacity")>0?S.paint.get("fill-extrusion-vertical-scale"):0);let z=C?C.getTile(h):null;if(!z&&C&&h.canonical.z>C.getSource().minzoom){let O=h.scaledTo(Math.min(C.getSource().maxzoom,h.overscaledZ-1));for(;O.overscaledZ>=C.getSource().minzoom&&(z=C.getTile(O),!z&&O.overscaledZ!==0);)O=O.scaledTo(O.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:z?z.getBucket(S):null,tileID:z?z.tileID:h,verticalScale:A})}l.hasAnyZOffset=!1;let _=!1;for(let x=0;x<l.symbolInstances.length;x++){const S=l.symbolInstances.get(x),C=S.zOffset,A=this._getHeightAtTileOffset(h,S.tileAnchorX,S.tileAnchorY);S.zOffset=A!==-1?A:C,_||C===S.zOffset||(_=!0),l.hasAnyZOffset||S.zOffset===0||(l.hasAnyZOffset=!0)}_&&(l.zOffsetBuffersNeedUpload=!0,l.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(l,h,_,x){let S=h,C=_;if(l.canonical.z!==x.canonical.z){const A=x.canonical,z=1/(1<<l.canonical.z-A.z);S=(h+l.canonical.x*a.J)*z-A.x*a.J|0,C=(_+l.canonical.y*a.J)*z-A.y*a.J|0}return{tileX:S,tileY:C}}_getHeightAtTileOffset(l,h,_){let x,S;for(let C=0;C<this.layers.length;++C){if(this.layers[C].type!=="fill-extrusion")continue;const{bucket:A,tileID:z,verticalScale:O}=this.currentBuildingBuckets[C];if(!A)continue;const{tileX:N,tileY:V}=this._mapCoordToOverlappingTile(l,h,_,z),G=A.getHeightAtTileCoord(N,V);G&&G.height!==void 0&&(G.hidden?x=G.height:S=Math.max(G.height*O,S||0))}if(S!==void 0)return S;for(let C=0;C<this.layers.length;++C){if(this.layers[C].type!=="model")continue;const{bucket:A,tileID:z}=this.currentBuildingBuckets[C];if(!A)continue;const{tileX:O,tileY:N}=this._mapCoordToOverlappingTile(l,h,_,z),V=A.getHeightAtTileCoord(O,N);if(V&&!V.hidden)return V.height===void 0&&x!==void 0?Math.min(V.maxHeight,x)*V.verticalScale:(V.height||0)*V.verticalScale}return-1}}function Wu(m,l){const h={};for(const _ in m)_!=="ref"&&(h[_]=m[_]);return a.aS.forEach(_=>{_ in l&&(h[_]=l[_])}),h}function da(m){m=m.slice();const l=Object.create(null);for(let h=0;h<m.length;h++)l[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=Wu(m[h],l[m[h].ref]));return m}const Je={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function pr(m,l,h){h.push({command:Je.addSource,args:[m,l[m]]})}function Er(m,l,h){l.push({command:Je.removeSource,args:[m]}),h[m]=!0}function mo(m,l,h,_){Er(m,h,_),pr(m,l,h)}function Ua(m,l,h){let _;for(_ in m[h])if(m[h].hasOwnProperty(_)&&_!=="data"&&!P(m[h][_],l[h][_]))return!1;for(_ in l[h])if(l[h].hasOwnProperty(_)&&_!=="data"&&!P(m[h][_],l[h][_]))return!1;return!0}function cr(m,l,h,_,x,S){let C;for(C in l=l||{},m=m||{})m.hasOwnProperty(C)&&(P(m[C],l[C])||h.push({command:S,args:[_,C,l[C],x]}));for(C in l)l.hasOwnProperty(C)&&!m.hasOwnProperty(C)&&(P(m[C],l[C])||h.push({command:S,args:[_,C,l[C],x]}))}function fa(m){return m.id}function Bs(m,l){return m[l.id]=l,m}class Bl{constructor(l,h){this.reset(l,h)}reset(l,h){this.points=l||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=a.c(l,0,1);let h=1,_=this._distances[h];const x=l*this.paddedLength+this.padding;for(;_<x&&h<this._distances.length;)_=this._distances[++h];const S=h-1,C=this._distances[S],A=_-C,z=A>0?(x-C)/A:0;return this.points[S].mult(1-z).add(this.points[h].mult(z))}}class fi{constructor(l,h,_){const x=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(l/_),this.yCellCount=Math.ceil(h/_);for(let C=0;C<this.xCellCount*this.yCellCount;C++)x.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=h,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,h,_,x,S){this._forEachCell(h,_,x,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(S)}insertCircle(l,h,_,x){this._forEachCell(h-x,_-x,h+x,_+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(h),this.circles.push(_),this.circles.push(x)}_insertBoxCell(l,h,_,x,S,C){this.boxCells[S].push(C)}_insertCircleCell(l,h,_,x,S,C){this.circleCells[S].push(C)}_query(l,h,_,x,S,C){if(_<0||l>this.width||x<0||h>this.height)return!S&&[];const A=[];if(l<=0&&h<=0&&this.width<=_&&this.height<=x){if(S)return!0;for(let z=0;z<this.boxKeys.length;z++)A.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const O=this.circles[3*z],N=this.circles[3*z+1],V=this.circles[3*z+2];A.push({key:this.circleKeys[z],x1:O-V,y1:N-V,x2:O+V,y2:N+V})}return C?A.filter(C):A}return this._forEachCell(l,h,_,x,this._queryCell,A,{hitTest:S,seenUids:{box:{},circle:{}}},C),S?A.length>0:A}_queryCircle(l,h,_,x,S){const C=l-_,A=l+_,z=h-_,O=h+_;if(A<0||C>this.width||O<0||z>this.height)return!x&&[];const N=[];return this._forEachCell(C,z,A,O,this._queryCellCircle,N,{hitTest:x,circle:{x:l,y:h,radius:_},seenUids:{box:{},circle:{}}},S),x?N.length>0:N}query(l,h,_,x,S){return this._query(l,h,_,x,!1,S)}hitTest(l,h,_,x,S){return this._query(l,h,_,x,!0,S)}hitTestCircle(l,h,_,x){return this._queryCircle(l,h,_,!0,x)}_queryCell(l,h,_,x,S,C,A,z){const O=A.seenUids,N=this.boxCells[S];if(N!==null){const G=this.bboxes;for(const W of N)if(!O.box[W]){O.box[W]=!0;const X=4*W;if(l<=G[X+2]&&h<=G[X+3]&&_>=G[X+0]&&x>=G[X+1]&&(!z||z(this.boxKeys[W]))){if(A.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[W],x1:G[X],y1:G[X+1],x2:G[X+2],y2:G[X+3]})}}}const V=this.circleCells[S];if(V!==null){const G=this.circles;for(const W of V)if(!O.circle[W]){O.circle[W]=!0;const X=3*W;if(this._circleAndRectCollide(G[X],G[X+1],G[X+2],l,h,_,x)&&(!z||z(this.circleKeys[W]))){if(A.hitTest)return C.push(!0),!0;{const K=G[X],Y=G[X+1],Z=G[X+2];C.push({key:this.circleKeys[W],x1:K-Z,y1:Y-Z,x2:K+Z,y2:Y+Z})}}}}}_queryCellCircle(l,h,_,x,S,C,A,z){const O=A.circle,N=A.seenUids,V=this.boxCells[S];if(V!==null){const W=this.bboxes;for(const X of V)if(!N.box[X]){N.box[X]=!0;const K=4*X;if(this._circleAndRectCollide(O.x,O.y,O.radius,W[K+0],W[K+1],W[K+2],W[K+3])&&(!z||z(this.boxKeys[X])))return C.push(!0),!0}}const G=this.circleCells[S];if(G!==null){const W=this.circles;for(const X of G)if(!N.circle[X]){N.circle[X]=!0;const K=3*X;if(this._circlesCollide(W[K],W[K+1],W[K+2],O.x,O.y,O.radius)&&(!z||z(this.circleKeys[X])))return C.push(!0),!0}}}_forEachCell(l,h,_,x,S,C,A,z){const O=this._convertToXCellCoord(l),N=this._convertToYCellCoord(h),V=this._convertToXCellCoord(_),G=this._convertToYCellCoord(x);for(let W=O;W<=V;W++)for(let X=N;X<=G;X++)if(S.call(this,l,h,_,x,this.xCellCount*X+W,C,A,z))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,h,_,x,S,C){const A=x-l,z=S-h,O=_+C;return O*O>A*A+z*z}_circleAndRectCollide(l,h,_,x,S,C,A){const z=(C-x)/2,O=Math.abs(l-(x+z));if(O>z+_)return!1;const N=(A-S)/2,V=Math.abs(h-(S+N));if(V>N+_)return!1;if(O<=z||V<=N)return!0;const G=O-z,W=V-N;return G*G+W*W<=_*_}}const qr=100;class Op{constructor(l,h,_=new fi(l.width+200,l.height+200,25),x=new fi(l.width+200,l.height+200,25)){this.transform=l,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+qr,this.screenBottomBoundary=l.height+qr,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=h}placeCollisionBox(l,h,_,x,S,C,A,z){let O=_.projectedAnchorX,N=_.projectedAnchorY,V=_.projectedAnchorZ;const G=_.elevation,W=_.tileID,X=l.getProjection();if(G&&W){const[ce,_e,we]=X.upVector(W.canonical,_.tileAnchorX,_.tileAnchorY),ve=X.upVectorScale(W.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;O+=ce*G*ve,N+=_e*G*ve,V+=we*G*ve}const K=this.projectAndGetPerspectiveRatio(A,O,N,V,_.tileID,X.name==="globe"||!!G||this.transform.pitch>0,X),Y=C*K.perspectiveRatio,Z=(_.x1*h+x.x-_.padding)*Y+K.point.x,ae=(_.y1*h+x.y-_.padding)*Y+K.point.y,pe=(_.x2*h+x.x+_.padding)*Y+K.point.x,ge=(_.y2*h+x.y+_.padding)*Y+K.point.y,ne=K.perspectiveRatio<=.55||K.occluded;return!this.isInsideGrid(Z,ae,pe,ge)||!S&&this.grid.hitTest(Z,ae,pe,ge,z)||ne?{box:[],offscreen:!1,occluded:K.occluded}:{box:[Z,ae,pe,ge],offscreen:this.isOffscreen(Z,ae,pe,ge),occluded:!1}}placeCollisionCircles(l,h,_,x,S,C,A,z,O,N,V,G,W,X,K){const Y=[],Z=this.transform.elevation,ae=l.getProjection(),pe=Z?Z.getAtTileOffsetFunc(K,this.transform.center.lat,this.transform.worldSize,ae):null,ge=new a.P(_.tileAnchorX,_.tileAnchorY);let{x:ne,y:ce,z:_e}=ae.projectTilePoint(ge.x,ge.y,K.canonical);if(pe){const[Xe,he,ke]=pe(ge);ne+=Xe,ce+=he,_e+=ke}const we=ae.name==="globe",ve=this.projectAndGetPerspectiveRatio(A,ne,ce,_e,K,we||!!Z||this.transform.pitch>0,ae),{perspectiveRatio:Se}=ve,qe=(V?C/Se:C*Se)/a.aV,De=ai(ne,ce,_e,z),Ne=ve.signedDistanceFromCamera>0?ut(qe,S,_.lineOffsetX*qe,_.lineOffsetY*qe,!1,De,ge,_,x,z,{},Z&&!V?pe:null,V&&!!Z,ae,K,V):null;let Me=!1,We=!1,Fe=!0;if(Ne&&!ve.occluded){const Xe=.5*W*Se+X,he=new a.P(-100,-100),ke=new a.P(this.screenRightBoundary,this.screenBottomBoundary),nt=new Bl,{first:Ke,last:Mt}=Ne,wt=Ke.path.length;let Ft=[];for(let $t=wt-1;$t>=1;$t--)Ft.push(Ke.path[$t]);for(let $t=1;$t<Mt.path.length;$t++)Ft.push(Mt.path[$t]);const St=2.5*Xe;O&&(Ft=Ft.map(([$t,Rt,Dt],Sr)=>(pe&&!we&&(Dt=pe(Sr<wt-1?Ke.tilePath[wt-1-Sr]:Mt.tilePath[Sr-wt+2])[2]),ai($t,Rt,Dt,O))),Ft.some($t=>$t[3]<=0)&&(Ft=[]));let Vt=[];if(Ft.length>0){let $t=1/0,Rt=-1/0,Dt=1/0,Sr=-1/0;for(const tr of Ft)$t=Math.min($t,tr[0]),Dt=Math.min(Dt,tr[1]),Rt=Math.max(Rt,tr[0]),Sr=Math.max(Sr,tr[1]);Rt>=he.x&&$t<=ke.x&&Sr>=he.y&&Dt<=ke.y&&(Vt=[Ft.map(tr=>new a.P(tr[0],tr[1]))],($t<he.x||Rt>ke.x||Dt<he.y||Sr>ke.y)&&(Vt=a.aT(Vt,he.x,he.y,ke.x,ke.y)))}for(const $t of Vt){nt.reset($t,.25*Xe);let Rt=0;Rt=nt.length<=.5*Xe?1:Math.ceil(nt.paddedLength/St)+1;for(let Dt=0;Dt<Rt;Dt++){const Sr=Dt/Math.max(Rt-1,1),tr=nt.lerp(Sr),rn=tr.x+qr,Gr=tr.y+qr;Y.push(rn,Gr,Xe,0);const Ki=rn-Xe,Ho=Gr-Xe,Nr=rn+Xe,Cr=Gr+Xe;if(Fe=Fe&&this.isOffscreen(Ki,Ho,Nr,Cr),We=We||this.isInsideGrid(Ki,Ho,Nr,Cr),!h&&this.grid.hitTestCircle(rn,Gr,Xe,G)&&(Me=!0,!N))return{circles:[],offscreen:!1,collisionDetected:Me,occluded:!1}}}}return{circles:!N&&Me||!We?[]:Y,offscreen:Fe,collisionDetected:Me,occluded:ve.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let _=1/0,x=1/0,S=-1/0,C=-1/0;for(const N of l){const V=new a.P(N.x+qr,N.y+qr);_=Math.min(_,V.x),x=Math.min(x,V.y),S=Math.max(S,V.x),C=Math.max(C,V.y),h.push(V)}const A=this.grid.query(_,x,S,C).concat(this.ignoredGrid.query(_,x,S,C)),z={},O={};for(const N of A){const V=N.key;if(z[V.bucketInstanceId]===void 0&&(z[V.bucketInstanceId]={}),z[V.bucketInstanceId][V.featureIndex])continue;const G=[new a.P(N.x1,N.y1),new a.P(N.x2,N.y1),new a.P(N.x2,N.y2),new a.P(N.x1,N.y2)];a.aU(h,G)&&(z[V.bucketInstanceId][V.featureIndex]=!0,O[V.bucketInstanceId]===void 0&&(O[V.bucketInstanceId]=[]),O[V.bucketInstanceId].push(V.featureIndex))}return O}insertCollisionBox(l,h,_,x,S){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:S},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,h,_,x,S){const C=h?this.ignoredGrid:this.grid,A={bucketInstanceId:_,featureIndex:x,collisionGroupID:S};for(let z=0;z<l.length;z+=4)C.insertCircle(A,l[z],l[z+1],l[z+2])}projectAndGetPerspectiveRatio(l,h,_,x,S,C,A){const z=[h,_,x,1];let O=!1;x||this.transform.pitch>0?(a.e.transformMat4(z,z,l),this.fogState&&S&&A.name!=="globe"&&(O=function(G,W,X,K,Y,Z){const ae=Z.calculateFogTileMatrix(Y),pe=[W,X,K];return a.v.transformMat4(pe,pe,ae),us(G,a.v.length(pe),Z.pitch,Z._fov)}(this.fogState,h,_,x,S.toUnwrapped(),this.transform)>.9)):Qt(z,z,l);const N=z[3];return{point:new a.P((z[0]/N+1)/2*this.transform.width+qr,(-z[1]/N+1)/2*this.transform.height+qr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(A)/N*.5,1.5),signedDistanceFromCamera:N,occluded:C&&z[2]>N||O}}isOffscreen(l,h,_,x){return _<qr||l>=this.screenRightBoundary||x<qr||h>this.screenBottomBoundary}isInsideGrid(l,h,_,x){return _>=0&&l<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const l=a.m.identity([]);return a.m.translate(l,l,[-100,-100,0]),l}}function pa(m,l,h){const _=l.createTileMatrix(m,m.worldSize,h.toUnwrapped());return a.m.multiply(new Float32Array(16),m.projMatrix,_)}function Ga(m,l,h){if(l.projection.name===h.projection.name)return m.projMatrix;const _=h.clone();return _.setProjection(l.projection),pa(_,l.getProjection(),m)}function ds(m,l,h){return l.name===h.projection.name?m.projMatrix:pa(h,l,m)}class Wa{constructor(l,h,_,x){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?h:-h))):x&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Fs{constructor(l,h,_,x,S,C=!1){this.text=new Wa(l?l.text:null,h,_,S),this.icon=new Wa(l?l.icon:null,h,x,S),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qa{constructor(l,h,_,x=!1){this.text=l,this.icon=h,this.skipFade=_,this.clipped=x}}class Fc{constructor(){this.invProjMatrix=a.m.create(),this.viewportMatrix=a.m.create(),this.circles=[]}}class Ha{constructor(l,h,_,x,S){this.bucketInstanceId=l,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=x,this.tileID=S}}class Nc{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const h=++this.maxGroupID;this.collisionGroups[l]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[l]}}function Un(m,l,h,_,x){const{horizontalAlign:S,verticalAlign:C}=a.aY(m),A=-(S-.5)*l,z=-(C-.5)*h,O=a.aW(m,_);return new a.P(A+O[0]*x,z+O[1]*x)}function Hr(m,l,h,_,x){const S=new a.P(m,l);return h&&S._rotate(_?x:-x),S}class qu{constructor(l,h,_,x,S,C){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new Op(this.transform,S),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Nc(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,h,_,x){const S=_.getBucket(h),C=_.latestFeatureIndex;if(!S||!C||h.fqid!==S.layerIds[0])return;const A=S.layers[0].layout,z=_.collisionBoxArray,O=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),N=_.tileSize/a.J,V=_.tileID.toUnwrapped();this.transform.setProjection(S.projection);const G=(W=_.tileID,X=S.getProjection(),K=this.transform,X.name===this.projection?K.calculateProjMatrix(W.toUnwrapped()):pa(K,X,W));var W,X,K;const Y=A.get("text-pitch-alignment")==="map",Z=A.get("text-rotation-alignment")==="map";h.compileFilter();const ae=h.dynamicFilter(),pe=h.dynamicFilterNeedsFeature(),ge=this.transform.calculatePixelsToTileUnitsMatrix(_),ne=Vo(G,_.tileID.canonical,Y,Z,this.transform,S.getProjection(),ge);let ce=null;if(Y){const ve=ho(G,_.tileID.canonical,Y,Z,this.transform,S.getProjection(),ge);ce=a.m.multiply([],this.transform.labelPlaneMatrix,ve)}let _e=null;ae&&_.latestFeatureIndex&&(_e={unwrappedTileID:V,dynamicFilter:ae,dynamicFilterNeedsFeature:pe,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new Ha(S.bucketInstanceId,C,S.sourceLayerIndex,S.index,_.tileID);const we={bucket:S,layout:A,posMatrix:G,textLabelPlaneMatrix:ne,labelToScreenMatrix:ce,clippingData:_e,scale:O,textPixelRatio:N,holdingForFade:_.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:a.i(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.i(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(x)for(const ve of S.sortKeyRanges){const{sortKey:Se,symbolInstanceStart:qe,symbolInstanceEnd:De}=ve;l.push({sortKey:Se,symbolInstanceStart:qe,symbolInstanceEnd:De,parameters:we})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:we})}attemptAnchorPlacement(l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z,ae){const{textOffset0:pe,textOffset1:ge,crossTileID:ne}=G,ce=[pe,ge],_e=Un(l,_,x,ce,S),we=this.collisionIndex.placeCollisionBox(X,S,h,Hr(_e.x,_e.y,C,A,this.transform.angle),V,z,O,N.predicate);if(Y){const ve=X.getSymbolInstanceIconSize(ae,this.transform.zoom,G.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(X,ve,Y,Hr(_e.x,_e.y,C,A,this.transform.angle),V,z,O,N.predicate).box.length===0)return}if(we.box.length>0){let ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[ne]&&this.prevPlacement.placements[ne]&&this.prevPlacement.placements[ne].text&&(ve=this.prevPlacement.variableOffsets[ne].anchor),this.variableOffsets[ne]={textOffset:ce,width:_,height:x,anchor:l,textScale:S,prevAnchor:ve},this.markUsedJustification(X,l,G,K),X.allowVerticalPlacement&&(this.markUsedOrientation(X,K,G),this.placedOrientations[ne]=K),{shift:_e,placedGlyphBoxes:we}}}placeLayerBucketPart(l,h,_,x){const{bucket:S,layout:C,posMatrix:A,textLabelPlaneMatrix:z,labelToScreenMatrix:O,clippingData:N,textPixelRatio:V,holdingForFade:G,collisionBoxArray:W,partiallyEvaluatedTextSize:X,partiallyEvaluatedIconSize:K,collisionGroup:Y}=l.parameters,Z=C.get("text-optional"),ae=C.get("icon-optional"),pe=C.get("text-allow-overlap"),ge=C.get("icon-allow-overlap"),ne=C.get("text-rotation-alignment")==="map",ce=C.get("text-pitch-alignment")==="map",_e=C.get("symbol-z-order")==="viewport-y",we=C.get("symbol-z-elevate");this.transform.setProjection(S.projection);let ve=pe&&(ge||!S.hasIconData()||ae),Se=ge&&(pe||!S.hasTextData()||Z);!S.collisionArrays&&W&&S.deserializeCollisionBoxes(W),_&&x&&S.updateCollisionDebugBuffers(this.transform.zoom,W);const qe=(De,Ne,Me)=>{const{crossTileID:We,numVerticalGlyphVertices:Fe}=De;if(N){const Nr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Cr=null;if(N.dynamicFilterNeedsFeature){const Ir=this.retainedQueryData[S.bucketInstanceId];Cr=N.featureIndex.loadFeature({featureIndex:De.featureIndex,bucketIndex:Ir.bucketIndex,sourceLayerIndex:Ir.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,N.dynamicFilter)(Nr,Cr,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new a.P(De.tileAnchorX,De.tileAnchorY),this.transform.calculateDistanceTileData(N.unwrappedTileID)))return this.placements[We]=new qa(!1,!1,!1,!0),void h.add(We)}if(h.has(We))return;if(G)return void(this.placements[We]=new qa(!1,!1,!1));let Xe=!1,he=!1,ke=!0,nt=!1,Ke=!1,Mt=null,wt={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},St=null,Vt=null,$t=null,Rt=0,Dt=0,Sr=0;Me.textFeatureIndex?Rt=Me.textFeatureIndex:De.useRuntimeCollisionCircles&&(Rt=De.featureIndex),Me.verticalTextFeatureIndex&&(Dt=Me.verticalTextFeatureIndex);const tr=Nr=>{Nr.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const Cr=this.transform.elevation;Nr.elevation=De.zOffset+(Cr?Cr.getAtTileOffset(Nr.tileID,Nr.tileAnchorX,Nr.tileAnchorY):0)},rn=Me.textBox;if(rn){tr(rn);const Nr=Ir=>{let un=a.W.horizontal;if(S.allowVerticalPlacement&&!Ir&&this.prevPlacement){const pi=this.prevPlacement.placedOrientations[We];pi&&(this.placedOrientations[We]=pi,un=pi,this.markUsedOrientation(S,un,De))}return un},Cr=(Ir,un)=>{if(S.allowVerticalPlacement&&Fe>0&&Me.verticalTextBox){for(const pi of S.writingModes)if(pi===a.W.vertical?(wt=un(),Ft=wt):wt=Ir(),wt&&wt.box&&wt.box.length)break}else wt=Ir()};if(C.get("text-variable-anchor")){let Ir=C.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[We]){const an=this.prevPlacement.variableOffsets[We];Ir.indexOf(an.anchor)>0&&(Ir=Ir.filter(Oi=>Oi!==an.anchor),Ir.unshift(an.anchor))}const un=(an,Oi,Ji)=>{const Bi=S.getSymbolInstanceTextSize(X,De,this.transform.zoom,Ne),Zo=(an.x2-an.x1)*Bi+2*an.padding,_a=(an.y2-an.y1)*Bi+2*an.padding,_s=De.hasIconTextFit&&!ge?Oi:null;_s&&tr(_s);let Zr={box:[],offscreen:!1,occluded:!1};const ys=pe?2*Ir.length:Ir.length;for(let Us=0;Us<ys;++Us){const ya=this.attemptAnchorPlacement(Ir[Us%Ir.length],an,Zo,_a,Bi,ne,ce,V,A,Y,Us>=Ir.length,De,Ne,S,Ji,_s,X,K);if(ya&&(Zr=ya.placedGlyphBoxes,Zr&&Zr.box&&Zr.box.length)){Xe=!0,Mt=ya.shift;break}}return Zr};Cr(()=>un(rn,Me.iconBox,a.W.horizontal),()=>{const an=Me.verticalTextBox;return an&&tr(an),S.allowVerticalPlacement&&!(wt&&wt.box&&wt.box.length)&&Fe>0&&an?un(an,Me.verticalIconBox,a.W.vertical):{box:null,offscreen:null,occluded:null}}),wt&&(Xe=wt.box,ke=wt.offscreen,nt=wt.occluded);const pi=Nr(!(!wt||!wt.box));if(!Xe&&this.prevPlacement){const an=this.prevPlacement.variableOffsets[We];an&&(this.variableOffsets[We]=an,this.markUsedJustification(S,an.anchor,De,pi))}}else{const Ir=(un,pi)=>{const an=S.getSymbolInstanceTextSize(X,De,this.transform.zoom,Ne),Oi=this.collisionIndex.placeCollisionBox(S,an,un,new a.P(0,0),pe,V,A,Y.predicate);return Oi&&Oi.box&&Oi.box.length&&(this.markUsedOrientation(S,pi,De),this.placedOrientations[We]=pi),Oi};Cr(()=>Ir(rn,a.W.horizontal),()=>{const un=Me.verticalTextBox;return S.allowVerticalPlacement&&Fe>0&&un?(tr(un),Ir(un,a.W.vertical)):{box:null,offscreen:null,occluded:null}}),Nr(!!(wt&&wt.box&&wt.box.length))}}if(St=wt,Xe=St&&St.box&&St.box.length>0,ke=St&&St.offscreen,nt=St&&St.occluded,De.useRuntimeCollisionCircles){const Nr=S.text.placedSymbolArray.get(De.centerJustifiedTextSymbolIndex>=0?De.centerJustifiedTextSymbolIndex:De.verticalPlacedTextSymbolIndex),Cr=a.j(S.textSizeData,X,Nr),Ir=C.get("text-padding");Vt=this.collisionIndex.placeCollisionCircles(S,pe,Nr,S.lineVertexArray,S.glyphOffsetArray,Cr,A,z,O,_,ce,Y.predicate,De.collisionCircleDiameter*Cr/a.aV,Ir,this.retainedQueryData[S.bucketInstanceId].tileID),Xe=pe||Vt.circles.length>0&&!Vt.collisionDetected,ke=ke&&Vt.offscreen,nt=Vt.occluded}if(Me.iconFeatureIndex&&(Sr=Me.iconFeatureIndex),Me.iconBox){const Nr=Cr=>{tr(Cr);const Ir=De.hasIconTextFit&&Mt?Hr(Mt.x,Mt.y,ne,ce,this.transform.angle):new a.P(0,0),un=S.getSymbolInstanceIconSize(K,this.transform.zoom,De.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,un,Cr,Ir,ge,V,A,Y.predicate)};Ft&&Ft.box&&Ft.box.length&&Me.verticalIconBox?($t=Nr(Me.verticalIconBox),he=$t.box.length>0):($t=Nr(Me.iconBox),he=$t.box.length>0),ke=ke&&$t.offscreen,Ke=$t.occluded}const Gr=Z||De.numHorizontalGlyphVertices===0&&Fe===0,Ki=ae||De.numIconVertices===0;if(Gr||Ki?Ki?Gr||(he=he&&Xe):Xe=he&&Xe:he=Xe=he&&Xe,Xe&&St&&St.box&&this.collisionIndex.insertCollisionBox(St.box,C.get("text-ignore-placement"),S.bucketInstanceId,Ft&&Ft.box&&Dt?Dt:Rt,Y.ID),he&&$t&&this.collisionIndex.insertCollisionBox($t.box,C.get("icon-ignore-placement"),S.bucketInstanceId,Sr,Y.ID),Vt&&(Xe&&this.collisionIndex.insertCollisionCircles(Vt.circles,C.get("text-ignore-placement"),S.bucketInstanceId,Rt,Y.ID),_)){const Nr=S.bucketInstanceId;let Cr=this.collisionCircleArrays[Nr];Cr===void 0&&(Cr=this.collisionCircleArrays[Nr]=new Fc);for(let Ir=0;Ir<Vt.circles.length;Ir+=4)Cr.circles.push(Vt.circles[Ir+0]),Cr.circles.push(Vt.circles[Ir+1]),Cr.circles.push(Vt.circles[Ir+2]),Cr.circles.push(Vt.collisionDetected?1:0)}const Ho=S.projection.name!=="globe";ve=ve&&(Ho||!nt),Se=Se&&(Ho||!Ke),this.placements[We]=new qa(Xe||ve,he||Se,ke||S.justReloaded),h.add(We)};if(we&&this.buildingIndex&&(this.buildingIndex.updateZOffset(S,this.retainedQueryData[S.bucketInstanceId].tileID),S.updateZOffset()),_e){const De=S.getSortedSymbolIndexes(this.transform.angle);for(let Ne=De.length-1;Ne>=0;--Ne){const Me=De[Ne];qe(S.symbolInstances.get(Me),Me,S.collisionArrays[Me])}S.hasAnyZOffset&&a.X(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const De=S.getSortedIndexesByZOffset();for(let Ne=0;Ne<De.length;++Ne){const Me=De[Ne];qe(S.symbolInstances.get(Me),Me,S.collisionArrays[Me])}}else for(let De=l.symbolInstanceStart;De<l.symbolInstanceEnd;De++)qe(S.symbolInstances.get(De),De,S.collisionArrays[De]);if(_&&S.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[S.bucketInstanceId];a.m.invert(De.invProjMatrix,A),De.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(l,h,_,x){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:A,verticalPlacedTextSymbolIndex:z,crossTileID:O}=_,N=a.aX(h),V=x===a.W.vertical?z:N==="left"?S:N==="center"?C:N==="right"?A:-1;S>=0&&(l.text.placedSymbolArray.get(S).crossTileID=V>=0&&S!==V?0:O),C>=0&&(l.text.placedSymbolArray.get(C).crossTileID=V>=0&&C!==V?0:O),A>=0&&(l.text.placedSymbolArray.get(A).crossTileID=V>=0&&A!==V?0:O),z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=V>=0&&z!==V?0:O)}markUsedOrientation(l,h,_){const x=h===a.W.horizontal||h===a.W.horizontalOnly?h:0,S=h===a.W.vertical?h:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:O}=_,N=l.text.placedSymbolArray;C>=0&&(N.get(C).placedOrientation=x),A>=0&&(N.get(A).placedOrientation=x),z>=0&&(N.get(z).placedOrientation=x),O>=0&&(N.get(O).placedOrientation=S)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(l):1,S=h?h.opacities:{},C=h?h.variableOffsets:{},A=h?h.placedOrientations:{};for(const z in this.placements){const O=this.placements[z],N=S[z];N?(this.opacities[z]=new Fs(N,x,O.text,O.icon,null,O.clipped),_=_||O.text!==N.text.placed||O.icon!==N.icon.placed):(this.opacities[z]=new Fs(null,x,O.text,O.icon,O.skipFade,O.clipped),_=_||O.text||O.icon)}for(const z in S){const O=S[z];if(!this.opacities[z]){const N=new Fs(O,x,!1,!1);N.isHidden()||(this.opacities[z]=N,_=_||O.text.placed||O.icon.placed)}}for(const z in C)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=C[z]);for(const z in A)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=A[z]);_?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:l)}updateLayerOpacities(l,h){const _=new Set;for(const x of h){const S=x.getBucket(l);S&&x.latestFeatureIndex&&l.fqid===S.layerIds[0]&&(this.updateBucketOpacities(S,_,x.collisionBoxArray),S.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(S,x.tileID),S.updateZOffset()))}}updateBucketOpacities(l,h,_){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const x=l.layers[0].layout,S=!!l.layers[0].dynamicFilter(),C=new Fs(null,0,!1,!1,!0),A=x.get("text-allow-overlap"),z=x.get("icon-allow-overlap"),O=x.get("text-variable-anchor"),N=x.get("text-rotation-alignment")==="map",V=x.get("text-pitch-alignment")==="map",G=new Fs(null,0,A&&(z||!l.hasIconData()||x.get("icon-optional")),z&&(A||!l.hasTextData()||x.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);const W=(K,Y,Z)=>{for(let ae=0;ae<Y/4;ae++)K.opacityVertexArray.emplaceBack(Z)};let X=0;for(let K=0;K<l.symbolInstances.length;K++){const Y=l.symbolInstances.get(K),{numHorizontalGlyphVertices:Z,numVerticalGlyphVertices:ae,crossTileID:pe,numIconVertices:ge}=Y,ne=h.has(pe);let ce=this.opacities[pe];ne?ce=C:ce||(ce=G,this.opacities[pe]=ce),h.add(pe);const _e=Z>0||ae>0,we=ge>0,ve=this.placedOrientations[pe],Se=ve===a.W.vertical,qe=ve===a.W.horizontal||ve===a.W.horizontalOnly;if(!_e&&!we||ce.isHidden()||X++,_e){const De=Re(ce.text);W(l.text,Z,Se?Ve:De),W(l.text,ae,qe?Ve:De);const Ne=ce.text.isHidden(),{leftJustifiedTextSymbolIndex:Me,centerJustifiedTextSymbolIndex:We,rightJustifiedTextSymbolIndex:Fe,verticalPlacedTextSymbolIndex:Xe}=Y,he=l.text.placedSymbolArray,ke=Ne||Se?1:0;Me>=0&&(he.get(Me).hidden=ke),We>=0&&(he.get(We).hidden=ke),Fe>=0&&(he.get(Fe).hidden=ke),Xe>=0&&(he.get(Xe).hidden=Ne||qe?1:0);const nt=this.variableOffsets[pe];nt&&this.markUsedJustification(l,nt.anchor,Y,ve);const Ke=this.placedOrientations[pe];Ke&&(this.markUsedJustification(l,"left",Y,Ke),this.markUsedOrientation(l,Ke,Y))}if(we){const De=Re(ce.icon),{placedIconSymbolIndex:Ne,verticalPlacedIconSymbolIndex:Me}=Y,We=l.icon.placedSymbolArray,Fe=ce.icon.isHidden()?1:0;Ne>=0&&(W(l.icon,ge,Se?Ve:De),We.get(Ne).hidden=Fe),Me>=0&&(W(l.icon,Y.numVerticalIconVertices,qe?Ve:De),We.get(Me).hidden=Fe)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const De=l.collisionArrays[K];if(De){let Ne=new a.P(0,0),Me=!0;if(De.textBox||De.verticalTextBox){if(O){const Fe=this.variableOffsets[pe];Fe?(Ne=Un(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textScale),N&&Ne._rotate(V?this.transform.angle:-this.transform.angle)):Me=!1}S&&(Me=!ce.clipped),De.textBox&&Ns(l.textCollisionBox.collisionVertexArray,ce.text.placed,!Me||Se,Ne.x,Ne.y),De.verticalTextBox&&Ns(l.textCollisionBox.collisionVertexArray,ce.text.placed,!Me||qe,Ne.x,Ne.y)}const We=Me&&!!(!qe&&De.verticalIconBox);De.iconBox&&Ns(l.iconCollisionBox.collisionVertexArray,ce.icon.placed,We,Y.hasIconTextFit?Ne.x:0,Y.hasIconTextFit?Ne.y:0),De.verticalIconBox&&Ns(l.iconCollisionBox.collisionVertexArray,ce.icon.placed,!We,Y.hasIconTextFit?Ne.x:0,Y.hasIconTextFit?Ne.y:0)}}}if(l.fullyClipped=X===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const K=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=K.invProjMatrix,l.placementViewportMatrix=K.viewportMatrix,l.collisionCircleArray=K.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>l}setStale(){this.stale=!0}}function Ns(m,l,h,_,x){m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0)}const Li=Math.pow(2,25),Yi=Math.pow(2,24),yd=Math.pow(2,17),Za=Math.pow(2,16),Fn=Math.pow(2,9),Fl=Math.pow(2,8),ye=Math.pow(2,1);function Re(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const l=m.placed?1:0,h=Math.floor(127*m.opacity);return h*Li+l*Yi+h*yd+l*Za+h*Fn+l*Fl+h*ye+l}const Ve=0;class Wt{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,h,_,x,S){const C=this._bucketParts;for(;this._currentTileIndex<l.length;)if(h.getBucketParts(C,x,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,C.sort((A,z)=>A.sortKey-z.sortKey));this._currentPartIndex<C.length;){const A=C[this._currentPartIndex];if(h.placeLayerBucketPart(A,this._seenCrossTileIDs,_,A.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Br{constructor(l,h,_,x,S,C,A,z,O){this.placement=new qu(l,S,C,A,z,O),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(l,h,_,x){const S=a.a4.now(),C=()=>{const A=a.a4.now()-S;return!this._forceFullPlacement&&A>2};for(;this._currentPlacementIndex>=0;){const A=h[l[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=z)&&(!A.maxzoom||A.maxzoom>z)){const O=A,N=O.layout.get("symbol-z-elevate"),V=this._inProgressLayer=this._inProgressLayer||new Wt(O),G=a.aE(A.source,A.scope);if(V.continuePlacement(N?x[G]:_[G],this.placement,this._showCollisionBoxes,A,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Dr=512/a.J/2;class cn{constructor(l,h,_){this.tileID=l,this.bucketInstanceId=_,this.index=new a.aZ(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=l.canonical.x*a.J,S=l.canonical.y*a.J;for(let C=0;C<h.length;C++){const{key:A,crossTileID:z,tileAnchorX:O,tileAnchorY:N}=h.get(C),V=Math.floor((x+O)*Dr),G=Math.floor((S+N)*Dr);this.index.add(V,G),this.keys.push(A),this.crossTileIDs.push(z)}this.index.finish()}findMatches(l,h,_){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),S=Dr/Math.pow(2,h.canonical.z-this.tileID.canonical.z),C=h.canonical.x*a.J,A=h.canonical.y*a.J;for(let z=0;z<l.length;z++){const O=l.get(z);if(O.crossTileID)continue;const{key:N,tileAnchorX:V,tileAnchorY:G}=O,W=Math.floor((C+V)*S),X=Math.floor((A+G)*S),K=this.index.range(W-x,X-x,W+x,X+x);for(const Y of K){const Z=this.crossTileIDs[Y];if(this.keys[Y]===N&&!_.has(Z)){_.add(Z),O.crossTileID=Z;break}}}}}class Ar{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const h=Math.round((l-this.lng)/360);if(h!==0)for(const _ in this.indexes){const x=this.indexes[_],S={};for(const C in x){const A=x[C];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+h),S[A.tileID.key]=A}this.indexes[_]=S}this.lng=l}addBucket(l,h,_){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let S=0;S<h.symbolInstances.length;S++)h.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const x=this.usedCrossTileIDs[l.overscaledZ];for(const S in this.indexes){const C=this.indexes[S];if(Number(S)>l.overscaledZ)for(const A in C){const z=C[A];z.tileID.isChildOf(l)&&z.findMatches(h.symbolInstances,l,x)}else{const A=C[l.scaledTo(Number(S)).key];A&&A.findMatches(h.symbolInstances,l,x)}}for(let S=0;S<h.symbolInstances.length;S++){const C=h.symbolInstances.get(S);C.crossTileID||(C.crossTileID=_.generate(),x.add(C.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new cn(l,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(l,h){for(const _ of h.crossTileIDs)this.usedCrossTileIDs[l].delete(_)}removeStaleBuckets(l){let h=!1;for(const _ in this.indexes){const x=this.indexes[_];for(const S in x)l[x[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,x[S]),delete x[S],h=!0)}return h}}class go{constructor(){this.layerIndexes={},this.crossTileIDs=new Ar,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,h,_,x){let S=this.layerIndexes[l.fqid];S===void 0&&(S=this.layerIndexes[l.fqid]=new Xt);let C=!1;const A={};x.name!=="globe"&&S.handleWrapJump(_);for(const z of h){const O=z.getBucket(l);O&&l.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(z.tileID,O,this.crossTileIDs)&&(C=!0),A[O.bucketInstanceId]=!0)}return S.removeStaleBuckets(A)&&(C=!0),C}pruneUnusedLayers(l){const h={};l.forEach(_=>{h[_]=!0});for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}var Ei=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,_o=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}`,jc=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Nl="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",fs=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,cy=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ps=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Hu=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Bp=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,uy=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const vd=[];ma(Ei,vd),ma(jc,vd),ma(_o,vd);const Xa={"_prelude_fog.vertex.glsl":cy,"_prelude_terrain.vertex.glsl":fs,"_prelude_shadow.vertex.glsl":Bp,"_prelude_fog.fragment.glsl":ps,"_prelude_shadow.fragment.glsl":uy,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Hu},Ya={};gr("",fs),gr(ps,cy),gr(uy,Bp),gr(Hu,"");const hy=gr(_o,jc),jl=Ei;var Fp={background:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:gr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:gr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:gr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:gr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),symbolIcon:gr(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:gr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:gr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:gr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:gr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Nl),skyboxGradient:gr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Nl),skyboxCapture:gr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:gr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:gr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:gr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function ma(m,l){const h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of h)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=_.split(" ");for(const S of x)l.includes(S)||l.push(S)}}function gr(m,l){const h=/#include\s+"([^"]+)"/g,_=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=l.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(O=>{const N=O.split(" ");return N[N.length-1]}),x=[...new Set(x)]);const S={},C=[],A=[];if(m=m.replace(h,(O,N)=>(A.push(N),"")),(l=l.replace(h,(O,N)=>(C.push(N),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let z=[...vd];ma(m,z),ma(l,z);for(const O of[...C,...A])Xa[O]||console.error(`Undefined include: ${O}`),Ya[O]||(Ya[O]=[],ma(Xa[O],Ya[O])),z=[...z,...Ya[O]];return{fragmentSource:m=m.replace(_,(O,N,V,G,W)=>(S[W]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${V} ${G} ${W};
#else
uniform ${V} ${G} u_${W};
#endif
`:N==="initialize"?`
#ifdef HAS_UNIFORM_u_${W}
    ${V} ${G} ${W} = u_${W};
#endif
`:N==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${V} ${G} ${W};
#endif
`:N==="initialize-attribute"?"":void 0)),vertexSource:l=l.replace(_,(O,N,V,G,W)=>{const X=G==="float"?"vec2":G,K=W.match(/color/)?"color":X;return N==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${W}
in ${V} ${G} a_${W};
#endif
`:S[W]?N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${V} ${X} a_${W};
out ${V} ${G} ${W};
#else
uniform ${V} ${G} u_${W};
#endif
`:N==="initialize"?K==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${V} ${G} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${K}(a_${W}, u_${W}_t);
#else
    ${V} ${G} ${W} = u_${W};
#endif
`:N==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${V} ${G} a_${W};
    out ${V} ${G} ${W};
#endif
`:N==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${W} = a_${W};
#endif
`:void 0:N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${V} ${X} a_${W};
#else
uniform ${V} ${G} u_${W};
#endif
`:N==="define-instanced"?K==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${W}0;
in vec4 a_${W}1;
in vec4 a_${W}2;
in vec4 a_${W}3;
#else
uniform ${V} ${G} u_${W};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${V} ${X} a_${W};
#else
uniform ${V} ${G} u_${W};
#endif
`:N==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${V} ${G} ${W} = a_${W};
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${G} ${W} = a_${W};
#else
    ${V} ${G} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${G} ${W} = unpack_mix_${K}(a_${W}, u_${W}_t);
#else
    ${V} ${G} ${W} = u_${W};
#endif
`}),staticAttributes:x,usedDefines:z,vertexIncludes:C,fragmentIncludes:A}}class kb{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,h,_,x,S,C,A,z){this.context=l;let O=this.boundPaintVertexBuffers.length!==x.length;for(let V=0;!O&&V<x.length;V++)this.boundPaintVertexBuffers[V]!==x[V]&&(O=!0);let N=this.boundDynamicVertexBuffers.length!==A.length;for(let V=0;!N&&V<A.length;V++)this.boundDynamicVertexBuffers[V]!==A[V]&&(N=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||O||N||this.boundIndexBuffer!==S||this.boundVertexOffset!==C)this.freshBind(h,_,x,S,C,A,z);else{l.bindVertexArrayOES.set(this.vao);for(const V of A)V&&(V.bind(),z&&V.instanceCount&&V.setVertexAttribDivisor(l.gl,h,z));S&&S.dynamicDraw&&S.bind()}}freshBind(l,h,_,x,S,C,A){const z=l.numAttributes,O=this.context,N=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=x,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=C,h.enableAttributes(N,l),h.bind(),h.setVertexAttribPointers(N,l,S);for(const V of _)V.enableAttributes(N,l),V.bind(),V.setVertexAttribPointers(N,l,S);for(const V of C)V&&(V.enableAttributes(N,l),V.bind(),V.setVertexAttribPointers(N,l,S),A&&V.instanceCount&&V.setVertexAttribDivisor(N,l,A));x&&x.bind(),O.currentNumAttributes=z}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Pb(m,l){const h=Math.pow(2,l.canonical.z),_=l.canonical.y;return[new a.M(0,_/h).toLngLat().lat,new a.M(0,(_+1)/h).toLngLat().lat]}function Ib(m,l,h,_,x,S,C){const A=m.context,z=A.gl,O=h.hillshadeFBO;if(!O)return;m.prepareDrawTile();const N=m.isTileAffectedByFog(l),V=m.getOrCreateProgram("hillshade",{overrideFog:N});A.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,O.colorAttachment.get());const G=((Y,Z,ae,pe)=>{const ge=ae.paint.get("hillshade-shadow-color"),ne=ae.paint.get("hillshade-highlight-color"),ce=ae.paint.get("hillshade-accent-color"),_e=ae.paint.get("hillshade-emissive-strength");let we=a.d(ae.paint.get("hillshade-illumination-direction"));if(ae.paint.get("hillshade-illumination-anchor")==="viewport")we-=Y.transform.angle;else if(Y.style&&Y.style.enable3dLights()&&Y.style.directionalLight){const Se=Y.style.directionalLight.properties.get("direction"),qe=a.b3(Se.x,Se.y,Se.z);we=a.d(qe[1])}const ve=!Y.options.moving;return{u_matrix:pe||Y.transform.calculateProjMatrix(Z.tileID.toUnwrapped(),ve),u_image:0,u_latrange:Pb(0,Z.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),we],u_shadow:ge,u_highlight:ne,u_emissive_strength:_e,u_accent:ce}})(m,h,_,m.terrain?l.projMatrix:null);m.uploadCommonUniforms(A,V,l.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:X,tileBoundsSegments:K}=m.getTileBoundsBuffers(h);V.draw(m,z.TRIANGLES,x,S,C,a.b5.disabled,G,_.id,W,X,K)}function Np(m,l,h){if(!l.needsDEMTextureUpload)return;const _=m.context,x=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(h.stride);const S=h.getPixels();l.demTexture?l.demTexture.update(S,{premultiply:!1}):l.demTexture=new a.a9(_,S,x.R32F,{premultiply:!1}),l.needsDEMTextureUpload=!1}function zb(m,l,h){const _=m.context,x=_.gl;if(!l.dem)return;const S=l.dem;if(_.activeTexture.set(x.TEXTURE1),Np(m,l,S),!l.demTexture)return;l.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const C=S.dim;_.activeTexture.set(x.TEXTURE0);let A=l.hillshadeFBO;if(!A){const G=new a.a9(_,{width:C,height:C,data:null},x.RGBA);G.bind(x.LINEAR,x.CLAMP_TO_EDGE),A=l.hillshadeFBO=_.createFramebuffer(C,C,!0,"renderbuffer"),A.colorAttachment.set(G.texture)}_.bindFramebuffer.set(A.framebuffer),_.viewport.set([0,0,C,C]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:O,tileBoundsSegments:N}=m.getMercatorTileBoundsBuffers(),V=[];m.linearFloatFilteringSupported()&&V.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:V}).draw(m,x.TRIANGLES,a.b4.disabled,a.b6.disabled,a.a.unblended,a.b5.disabled,((G,W)=>{const X=W.stride,K=a.m.create();return a.m.ortho(K,0,a.J,-a.J,0,0,1),a.m.translate(K,K,[0,-a.J,0]),{u_matrix:K,u_image:1,u_dimension:[X,X],u_zoom:G.overscaledZ}})(l.tileID,S),h.id,z,O,N),l.needsHillshadePrepare=!1}const xd=m=>({u_matrix:new a.a_(m),u_image0:new a.a$(m),u_skirt_height:new a.b2(m),u_ground_shadow_factor:new a.b7(m)}),jp=(m,l,h)=>({u_matrix:m,u_image0:0,u_skirt_height:l,u_ground_shadow_factor:h}),Vp=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:S,u_image0:0,u_frustum_tl:C,u_frustum_tr:A,u_frustum_br:z,u_frustum_bl:O,u_globe_pos:N,u_globe_radius:V,u_viewport:G,u_grid_matrix:X?Float32Array.from(X):new Float32Array(9),u_skirt_height:W}),Vl=(m,l)=>{if(l>0&&m.terrain&&a.X("Cutoff is currently disabled on terrain"),l<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=m.transform,_=Math.max(Math.abs(h._zoom-(m.minCutoffZoom-1)),1),x=h.isLODDisabled(!1)?a.an(60,45,h.pitch):a.an(30,15,h.pitch),S=h._farZ-h._nearZ,C=l*h.height,A=((1-(z=x))*h.cameraToCenterDistance+z*(h._farZ+C))*_;var z;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(A-h._nearZ)/S,(A-C-h._nearZ)/S]}}};function $p(m,l){return m!=null&&l!=null&&!(!m.hasData()||!l.hasData())&&m.demTexture!=null&&l.demTexture!=null&&m.tileID.key!==l.tileID.key}const js=new class{constructor(){this.operations={}}newMorphing(m,l,h,_,x){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==h.tileID.key&&(S.queued=h)}else this.operations[m]={startTime:_,phase:0,duration:x,from:l,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(const l in this.operations){const h=this.operations[l];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},bd={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Up(m,l,h){if(l===0)return 0;const _=l<1&&h===514?.25/l:1;return 6*Math.pow(1.5,22-m)*Math.max(l,1)*_}function Gp(m,l){const h=1<<m.z;return!l&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}const wd=m=>({u_matrix:m});function Sd(m,l,h,_,x){if(x>0){const S=a.a4.now(),C=(S-m.timeAdded)/x,A=l?(S-l.timeAdded)/x:-1,z=h.getSource(),O=_.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),N=!l||Math.abs(l.tileID.overscaledZ-O)>Math.abs(m.tileID.overscaledZ-O),V=N&&m.refreshedUponExpiration?1:a.c(N?C:1-A,0,1);return m.refreshedUponExpiration&&C>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}class _t extends a.bq{constructor(l){const h={type:"raster-dem",maxzoom:l.transform.maxZoom},_=new a.br(a.bs(),null),x=Po("mock-dem",h,_,l.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,h){l.state="loaded",h(null)}}class dy extends a.bq{constructor(l){const h=Po("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new a.br(a.bs(),null),l.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,h,_){if(l.freezeTileCoverage)return;this.transform=l;const x=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,C)=>{if(S[C.key]="",!this._tiles[C.key]){const A=new a.bt(C,this._source.tileSize*C.overscaleFactor(),l.tileZoom);A.state="loaded",this._tiles[C.key]=A}return S},{});for(const S in this._tiles)S in x||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(l){const h=this.proxyCachedFBO[l];if(h!==void 0){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Td extends a.O{constructor(l,h,_){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class Wp extends a.bk{constructor(l,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},l.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),l.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,x,S]=function(z){const O=new a.bo,N=new a.bp,V=131;O.reserve(17161),N.reserve(33800);const G=a.J/128,W=a.J+G/2,X=W+G;for(let Y=-G;Y<X;Y+=G)for(let Z=-G;Z<X;Z+=G){const ae=Z<0||Z>W||Y<0||Y>W?24575:0,pe=a.c(Math.round(Z),0,a.J),ge=a.c(Math.round(Y),0,a.J);O.emplaceBack(pe+ae,ge)}const K=(Y,Z)=>{const ae=Z*V+Y;N.emplaceBack(ae+1,ae,ae+V),N.emplaceBack(ae+V,ae+V+1,ae+1)};for(let Y=1;Y<129;Y++)for(let Z=1;Z<129;Z++)K(Z,Y);return[0,129].forEach(Y=>{for(let Z=0;Z<130;Z++)K(Z,Y),K(Y,Z)}),[O,N,32768]}(),C=l.context;this.gridBuffer=C.createVertexBuffer(_,a.bl.members),this.gridIndexBuffer=C.createIndexBuffer(x),this.gridSegments=a.bm.simpleSegment(0,0,_.length,x.length),this.gridNoSkirtSegments=a.bm.simpleSegment(0,0,_.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new dy(h.map),this.orthoMatrix=a.m.create(),a.m.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.J,0,a.J,0,1);const A=C.gl;this._overlapStencilMode=new a.b6({func:A.GEQUAL,mask:255},0,255,A.KEEP,A.KEEP,A.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new _t(h.map),this._pendingGroundEffectLayers=[]}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),this._style=l,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,h,_){if(l&&l.terrain){this._style!==l&&(this.style=l,this._evaluationZoom=void 0);const x=l.terrain.properties,S=l.terrain.drapeRenderMode===0,C=l.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.a4.now();const A=l.terrain&&l.terrain.scope,z=x.get("source"),O=S?this._mockSourceCache:l.getSourceCache(z,A);if(!O)return void a.X(`Couldn't find terrain source "${z}".`);if(this.sourceCache=O,this._exaggeration=C?this.calculateExaggeration(h):x.get("exaggeration"),!h.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const N=()=>{this.sourceCache.used&&a.X(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const V=this.getScaledDemTileSize();this.sourceCache.update(h,V,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,N(),this._initializing=!0),N(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(l){const h=this._previousCameraAltitude,_=l.getFreeCameraOptions().position.z/l.pixelsPerMeter*l.worldSize;this._previousCameraAltitude=_;const x=h!=null?_-h:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const S=l.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(S);let A=S-this._previousZoom;const z=this._previousUpdateTimestamp;let O=S;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(S-O)>.5&&(A=.5*(S-O+A)),A*x<0&&(O+=A)),this._evaluationZoom=O;const N=C.getExaggeration(O),V=N===C.getExaggeration(Math.max(0,O-.1));if(V&&Math.abs(N-this._exaggeration)<.01)return N;let G=Math.min(.1,.00375*(this._updateTimestamp-z));return(V||N<.1||Math.abs(A)<1e-4)&&(G=Math.min(.2,4*G)),a.n(this._exaggeration,N,G)}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._mergedSourceCaches)this._style._mergedSourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(a.M.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(z=>{const O=h.getTileByID(z).tileID;return O.projMatrix=_.calculateProjMatrix(O.toUnwrapped()),O});(function(z,O){const N=O.transform.pointCoordinate(O.transform.getCameraPoint()),V=new a.P(N.x,N.y);z.sort((G,W)=>{if(W.overscaledZ-G.overscaledZ)return W.overscaledZ-G.overscaledZ;const X=new a.P(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),K=new a.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),Y=V.mult(1<<G.canonical.z);return Y.x-=.5,Y.y-=.5,Y.distSqr(X)-Y.distSqr(K)})})(x,this.painter);const S=this.proxyToSource||{};this.proxyToSource={},x.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const z in C){const O=C[z];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,l[z],S),O.usedForTerrain))continue;const N=l[z];O.getSource().reparseOverscaled&&this._assignTerrainTiles(N)}this.proxiedCoords[h.id]=x.map(z=>new Td(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1;const A={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const O=this.terrainTileForTile[z.key];if(!O)continue;const N=O.tileID.key;N in A||(this._visibleDemTiles.push(O),A[N]=N)}}_assignTerrainTiles(l){this._initializing||l.forEach(h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){const l=this.painter.context,h=l.gl;for(const _ in this.terrainTileForTile){const x=this.terrainTileForTile[_],S=x.dem;!S||x.demTexture&&!x.needsDEMTextureUpload||(l.activeTexture.set(h.TEXTURE1),Np(this.painter,x,S))}}_prepareDemTileUniforms(l,h,_,x){if(!h||h.demTexture==null)return!1;const S=l.tileID.canonical,C=Math.pow(2,h.tileID.canonical.z-S.z),A=x||"";return _[`u_dem_tl${A}`]=[S.x*C%1,S.y*C%1],_[`u_dem_scale${A}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,h=l.gl;if(!this._emptyDepthBufferTexture){const _=new a.a5({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.a9(l,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const h=this._visibleDemTiles.reduce((_,x)=>{if(!x.dem)return _;const S=x.dem.tree.minimums[0];return S>0&&l++,_+S},0);return l?h/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,h=l.gl;l.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),[x,S]=(()=>{const A=new a.bu({width:1,height:1},new Float32Array([_]));return[h.R32F,A]})();this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(S,{premultiply:!1}):C=this._emptyDEMTexture=new a.a9(l,S,x,{premultiply:!1}),C}setupElevationDraw(l,h,_){const x=this.painter.context,S=x.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};C.u_exaggeration=this.exaggeration();let A=null,z=null,O=1;if(_&&_.morphing&&this._useVertexMorphing){const G=_.morphing.srcDemTile,W=_.morphing.dstDemTile;O=_.morphing.phase,G&&W&&(this._prepareDemTileUniforms(l,G,C,"_prev")&&(z=G),this._prepareDemTileUniforms(l,W,C)&&(A=W))}const N=G=>G&&G.demTexture&&this.painter.linearFloatFilteringSupported()?S.LINEAR:S.NEAREST,V=G=>{C.u_dem_size=G.size[0]===1?1:G.size[0]-2};if(z&&A)x.activeTexture.set(S.TEXTURE2),A.demTexture.bind(N(A),S.CLAMP_TO_EDGE),x.activeTexture.set(S.TEXTURE4),z.demTexture.bind(N(z),S.CLAMP_TO_EDGE),A.demTexture&&V(A.demTexture),C.u_dem_lerp=O;else{A=this.terrainTileForTile[l.tileID.key],x.activeTexture.set(S.TEXTURE2);const G=this._prepareDemTileUniforms(l,A,C)?A.demTexture:this.emptyDEMTexture;G.bind(N(A),S.CLAMP_TO_EDGE),V(G)}if(x.activeTexture.set(S.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(C.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),C.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&A){const G=(1<<A.tileID.canonical.z)*a.b(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=G}if(_&&_.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(x,C),this.painter.transform.projection.name==="globe"){const G=this.globeUniformValues(this.painter.transform,l.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,G)}}globeUniformValues(l,h,_){const x=l.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,a.J,0),u_tile_br_up:x.upVector(h,a.J,a.J),u_tile_bl_up:x.upVector(h,0,a.J),u_tile_up_scale:_?a.bn(1):x.upVectorScale(h,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const h=this.painter,_=this.painter.context;l.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,S,C,A,z){if(x.transform.projection.name==="globe")(function(O,N,V,G,W){const X=O.context,K=X.gl;let Y,Z;const ae=O.transform,pe=a.bb(O,X,ae),ge=(Ne,Me)=>{if(Z===Me)return;const We=[bd[Me],"PROJECTION_GLOBE_VIEW"];pe&&We.push("CUSTOM_ANTIALIASING");const Fe=O.isTileAffectedByFog(Ne);Y=O.getOrCreateProgram("globeRaster",{defines:We,overrideFog:Fe}),Z=Me},ne=O.colorModeForRenderPass(),ce=new a.b4(K.LEQUAL,a.b4.ReadWrite,O.depthRangeFor3D);js.update(W);const _e=a.bc(ae),we=[a.E(ae.center.lng),a.H(ae.center.lat)],ve=O.globeSharedBuffers,Se=[ae.width*a.a4.devicePixelRatio,ae.height*a.a4.devicePixelRatio],qe=Float32Array.from(ae.globeMatrix),De={useDenormalizedUpVectorScale:!0};{const Ne=O.transform,Me=Up(Ne.zoom,N.exaggeration(),N.sourceCache._source.tileSize);Z=-1;const We=K.TRIANGLES;for(const Fe of G){const Xe=V.getTile(Fe),he=a.b6.disabled,ke=N.prevTerrainTileForTile[Fe.key],nt=N.terrainTileForTile[Fe.key];$p(ke,nt)&&js.newMorphing(Fe.key,ke,nt,W,250),X.activeTexture.set(K.TEXTURE0),Xe.texture&&Xe.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);const Ke=js.getMorphValuesForProxy(Fe.key),Mt=Ke?1:0;Ke&&a.bd(De,{morphing:{srcDemTile:Ke.from,dstDemTile:Ke.to,phase:a.ba(Ke.phase)}});const wt=a.be(Fe.canonical),Ft=a.bf(wt.getCenter().lat),St=a.bg(Fe.canonical,wt,Ft,Ne.worldSize/Ne._pixelsPerMercatorPixel),Vt=a.bh(a.bi(Fe.canonical)),$t=Vp(Ne.expandedFarZProjMatrix,qe,_e,Vt,a.ao(Ne.zoom),we,Ne.frustumCorners.TL,Ne.frustumCorners.TR,Ne.frustumCorners.BR,Ne.frustumCorners.BL,Ne.globeCenterInViewSpace,Ne.globeRadius,Se,Me,St);if(ge(Fe,Mt),Y&&(N.setupElevationDraw(Xe,Y,De),O.uploadCommonUniforms(X,Y,Fe.toUnwrapped()),ve)){const[Rt,Dt,Sr]=ve.getGridBuffers(Ft,Me!==0);Y.draw(O,We,ce,he,ne,a.b5.backCCW,$t,"globe_raster",Rt,Dt,Sr)}}}if(ve&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){const Ne=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];pe&&Ne.push("CUSTOM_ANTIALIASING"),Y=O.getOrCreateProgram("globeRaster",{defines:Ne});for(const Me of G){const{x:We,y:Fe,z:Xe}=Me.canonical,he=Fe===0,ke=Fe===(1<<Xe)-1,[nt,Ke,Mt,wt]=ve.getPoleBuffers(Xe,!1);if(wt&&(he||ke)){const Ft=V.getTile(Me);X.activeTexture.set(K.TEXTURE0),Ft.texture&&Ft.texture.bind(K.LINEAR,K.CLAMP_TO_EDGE);let St=a.bj(Xe,We,ae);const Vt=a.bh(a.bi(Me.canonical)),$t=(Rt,Dt)=>Rt.draw(O,K.TRIANGLES,ce,a.b6.disabled,ne,a.b5.disabled,Vp(ae.expandedFarZProjMatrix,St,St,Vt,0,we,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Se,0),"globe_pole_raster",Dt,Mt,wt);N.setupElevationDraw(Ft,Y,De),O.uploadCommonUniforms(X,Y,Me.toUnwrapped()),he&&O.renderDefaultNorthPole&&$t(Y,nt),ke&&O.renderDefaultSouthPole&&(St=a.m.scale(a.m.create(),St,[1,-1,1]),$t(Y,Ke))}}}})(x,S,C,A,z);else{const O=x.context,N=O.gl;let V,G;const W=x.shadowRenderer,X=Vl(x,x.longestCutoffRange),K=ne=>{if(G===ne)return;const ce=[];ce.push(bd[ne]),X.shouldRenderCutoff&&ce.push("RENDER_CUTOFF"),V=x.getOrCreateProgram("terrainRaster",{defines:ce}),G=ne},Y=x.colorModeForRenderPass(),Z=new a.b4(N.LEQUAL,a.b4.ReadWrite,x.depthRangeFor3D);js.update(z);const ae=x.transform,pe=Up(ae.zoom,S.exaggeration(),S.sourceCache._source.tileSize);let ge=[0,0,0];if(W){const ne=x.style.directionalLight,ce=x.style.ambientLight;ne&&ce&&(ge=Bd(ne,ce))}{G=-1;const ne=N.TRIANGLES,[ce,_e]=[S.gridIndexBuffer,S.gridSegments];for(const we of A){const ve=C.getTile(we),Se=a.b6.disabled,qe=S.prevTerrainTileForTile[we.key],De=S.terrainTileForTile[we.key];$p(qe,De)&&js.newMorphing(we.key,qe,De,z,250),O.activeTexture.set(N.TEXTURE0),ve.texture&&ve.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE);const Ne=js.getMorphValuesForProxy(we.key),Me=Ne?1:0;let We;Ne&&(We={morphing:{srcDemTile:Ne.from,dstDemTile:Ne.to,phase:a.ba(Ne.phase)}});const Fe=jp(we.projMatrix,Gp(we.canonical,ae.renderWorldCopies)?pe/10:pe,ge);if(K(Me),!V)continue;S.setupElevationDraw(ve,V,We);const Xe=we.toUnwrapped();W&&W.setupShadows(Xe,V),x.uploadCommonUniforms(O,V,Xe,null,X),V.draw(x,ne,Z,Se,Y,a.b5.backCCW,Fe,"terrain_raster",S.gridBuffer,ce,_e)}}}}(h,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,x=this.proxySourceCache,S=this.proxiedCoords[x.id],C=this._drapedRenderBatches.shift(),A=h.style.order,z=[];let O=0;for(const N of S){const V=x.getTileByID(N.proxyTileKey),G=x.proxyCachedFBO[N.key]?x.proxyCachedFBO[N.key][l]:void 0,W=G!==void 0?x.renderCache[G]:this.pool[O++],X=G!==void 0;if(V.texture=W.tex,X&&!W.dirty){z.push(V.tileID);continue}let K;_.bindFramebuffer.set(W.fb.framebuffer),this.renderedToTile=!1,W.dirty&&(_.clear({color:a.C.transparent,stencil:0}),W.dirty=!1);for(let Y=C.start;Y<=C.end;++Y){const Z=h.style._mergedLayers[A[Y]];if(Z.isHidden(h.transform.zoom))continue;const ae=h.style.getLayerSourceCache(Z),pe=ae?this.proxyToSource[N.key][ae.id]:[N];if(!pe)continue;const ge=pe;_.viewport.set([0,0,W.fb.width,W.fb.height]),K!==(ae?ae.id:null)&&(this._setupStencil(W,pe,Z,ae),K=ae?ae.id:null),h.renderLayer(h,ae,Z,ge)}if(this._drapedRenderBatches.length===0)for(const Y of this._pendingGroundEffectLayers){const Z=h.style._mergedLayers[A[Y]];if(Z.isHidden(h.transform.zoom))continue;const ae=h.style.getLayerSourceCache(Z),pe=ae?this.proxyToSource[N.key][ae.id]:[N];if(!pe)continue;const ge=pe;_.viewport.set([0,0,W.fb.width,W.fb.height]),K!==(ae?ae.id:null)&&(this._setupStencil(W,pe,Z,ae),K=ae?ae.id:null),h.renderLayer(h,ae,Z,ge)}this.renderedToTile?(W.dirty=!0,z.push(V.tileID)):X||--O,O===5&&(O=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),C.end+1}postRender(){}isLayerOrderingCorrect(l){const h=l.order.length;let _=-1,x=h;for(let S=0;S<h;++S)this._style.isLayerDraped(l._mergedLayers[l.order[S]])?_=Math.max(_,S):x=Math.min(x,S);return x>_}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{l=Math.min(l,h.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,h,_){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const C=S.tileID,A=1<<C.overscaledZ,{x:z,y:O}=C.canonical,N=z/A,V=(z+1)/A,G=O/A,W=(O+1)/A;return{minx:N,miny:G,maxx:V,maxy:W,t:S.dem.tree.raycastRoot(N,G,V,W,l,h,_),tile:S}});x.sort((S,C)=>(S.t!==null?S.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const S of x){if(S.t==null)return null;const C=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,l,h,_);if(C!=null)return C}return null}_createFBO(){const l=this.painter.context,h=l.gl,_=this.drapeBufferSize;l.activeTexture.set(h.TEXTURE0);const x=new a.a9(l,{width:_[0],height:_[1],data:null},h.RGBA);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const S=l.createFramebuffer(_[0],_[1],!0,null);return S.colorAttachment.set(x.texture),S.depthAttachment=new Fr(l,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:S,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const h=this._style._mergedLayers[l],_=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!_&&h.shouldRedrape():!_&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const _ of this._style.getSources())if(_ instanceof ze){l=!0;break}if(!l)return;const h={};for(let _=0;_<this._style.order.length;++_){const x=this._style._mergedLayers[this._style.order[_]],S=this._style.getLayerSourceCache(x);if(S&&!h[S.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof a.am){h[S.id]=!0;for(const C of this.proxyCoords){const A=this.proxyToSource[C.key][S.id];if(A)for(const z of A)this._clearRenderCacheForTile(S.id,z)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const _ in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[_]._source instanceof Pt){l=!0;break}if(!l)return;const h={};for(let _=0;_<this._style.order.length;++_){const x=this._style._mergedLayers[this._style.order[_]],S=this._style.getLayerSourceCache(x);if(!S||h[S.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const C=x.paint.get("raster-fade-duration");for(const A of this.proxyCoords){const z=this.proxyToSource[A.key][S.id];if(z)for(const O of z){const N=Sd(S.getTile(O),S.findLoadedParent(O,0),S,this.painter.transform,C);(N.opacity!==1||N.mix!==0)&&this._clearRenderCacheForTile(S.id,O)}}}}_setupDrapedRenderBatches(){const l=this._style.order,h=l.length;if(h===0)return;const _=[];this._pendingGroundEffectLayers=[];let x,S=0,C=this._style._mergedLayers[l[S]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++S<h;)C=this._style._mergedLayers[l[S]];for(;S<h;++S){const A=this._style._mergedLayers[l[S]];A.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(A)?x===void 0&&(x=S):(A.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(S),x!==void 0&&(_.push({start:x,end:S-1}),x=void 0)))}if(x!==void 0&&_.push({start:x,end:S-1}),_.length!==0){const A=_[_.length-1];this._pendingGroundEffectLayers.every(z=>z>A.end)||a.X("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=_}_setupRenderCache(l){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const C=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let A=0;A<C.length;++A){const z=Object.values(C[A]);h.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,x=this._tilesDirty;for(let C=_.length-1;C>=0;C--){const A=_[C];if(h.getTileByID(A.key),h.proxyCachedFBO[A.key]!==void 0){const z=l[A.key],O=this.proxyToSource[A.key];let N=0;for(const V in O){const G=O[V],W=z[V];if(!W||W.length!==G.length||G.some((X,K)=>X!==W[K]||x[V]&&x[V].hasOwnProperty(X.key))){N=-1;break}++N}for(const V in h.proxyCachedFBO[A.key])h.renderCache[h.proxyCachedFBO[A.key][V]].dirty=N<0||N!==Object.values(z).length}}const S=[...this._drapedRenderBatches];S.sort((C,A)=>A.end-A.start-(C.end-C.start));for(const C of S)for(const A of _){if(h.proxyCachedFBO[A.key])continue;let z=h.renderCachePool.pop();z===void 0&&h.renderCache.length<50&&(z=h.renderCache.length,h.renderCache.push(this._createFBO())),z!==void 0&&(h.proxyCachedFBO[A.key]={},h.proxyCachedFBO[A.key][C.start]=z,h.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(l,h,_,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,C=S.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let A;if(_.isTileClipped())A=h.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);A=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+A>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=A,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):a.b6.disabled}_renderTileClippingMasks(l,h){const _=this.painter,x=this.painter.context,S=x.gl;_._tileClippingMaskIDs={},x.setColorMode(a.a.disabled),x.setDepthMode(a.b4.disabled);const C=_.getOrCreateProgram("clippingMask");for(const A of l){const z=_._tileClippingMaskIDs[A.key]=--h;C.draw(_,S.TRIANGLES,a.b4.disabled,new a.b6({func:S.ALWAYS,mask:0},z,255,S.KEEP,S.KEEP,S.REPLACE),a.a.disabled,a.b5.disabled,wd(A.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(l){const h=this.painter.transform;if(l.x<0||l.x>h.width||l.y<0||l.y>h.height)return null;const _=[l.x,l.y,1,1];a.e.transformMat4(_,_,h.pixelMatrixInverse),a.e.scale(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const x=h._camera.position,S=a.b(1,h.center.lat),C=[x[0],x[1],x[2]/S,0],A=a.v.subtract([],_.slice(0,3),C);a.v.normalize(A,A);const z=this.raycast(C,A,this._exaggeration);return z!==null&&z?(a.v.scaleAndAdd(C,C,A,z),C[3]=C[2],C[2]*=S,C):null}drawDepth(){const l=this.painter,h=l.context,_=this.proxySourceCache,x=Math.ceil(l.width),S=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const C=h.gl,A=h.createFramebuffer(x,S,!0,"renderbuffer");h.activeTexture.set(C.TEXTURE0);const z=new a.a9(h,{width:x,height:S,data:null},C.RGBA);z.bind(C.NEAREST,C.CLAMP_TO_EDGE),A.colorAttachment.set(z.texture);const O=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,x,S);A.depthAttachment.set(O),this._depthFBO=A,this._depthTexture=z}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,x,S]),function(C,A,z,O){if(C.transform.projection.name==="globe")return;const N=C.context,V=N.gl;N.clear({depth:1});const G=C.getOrCreateProgram("terrainDepth"),W=new a.b4(V.LESS,a.b4.ReadWrite,C.depthRangeFor3D);for(const X of O){const K=z.getTile(X),Y=jp(X.projMatrix,0,[0,0,0]);A.setupElevationDraw(K,G),G.draw(C,V.TRIANGLES,W,a.b6.disabled,a.a.unblended,a.b5.backCCW,Y,"terrain_depth",A.gridBuffer,A.gridIndexBuffer,A.gridNoSkirtSegments)}}(l,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,h,_){if(l.getSource()instanceof a.aK)return this._setupProxiedCoordsForImageSource(l,h,_);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const x=this.proxiedCoords[l.id]=[],S=this.proxyCoords;for(let z=0;z<S.length;z++){const O=S[z],N=this._findTileCoveringTileID(O,l);if(N){const V=this._createProxiedId(O,N,_[O.key]&&_[O.key][l.id]);x.push(V),this.proxyToSource[O.key][l.id]=[V]}}let C=!1;const A=new Set;for(let z=0;z<h.length;z++){const O=l.getTile(h[z]);if(!O||!O.hasData())continue;const N=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==O.tileID.canonical.z){const V=this.proxyToSource[N.tileID.key][l.id],G=this._createProxiedId(N.tileID,O,_[N.tileID.key]&&_[N.tileID.key][l.id]);V?V.splice(V.length-1,0,G):this.proxyToSource[N.tileID.key][l.id]=[G];const W=this.proxyToSource[N.tileID.key][l.id];A.has(W)||A.add(W),x.push(G),C=!0}}if(this._sourceTilesOverlap[l.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const z of A)z.sort((O,N)=>N.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(l,h,_){if(!l.getSource().loaded())return;const x=this.proxiedCoords[l.id]=[],S=this.proxyCoords,C=l.getSource(),A=C.tileID;if(!A)return;const z=new a.P(A.x,A.y)._div(1<<A.z),O=C.coordinates.map(a.M.fromLngLat).reduce((V,G)=>(V.min.x=Math.min(V.min.x,G.x-z.x),V.min.y=Math.min(V.min.y,G.y-z.y),V.max.x=Math.max(V.max.x,G.x-z.x),V.max.y=Math.max(V.max.y,G.y-z.y),V),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(V,G)=>{const W=V.wrap+V.canonical.x/(1<<V.canonical.z),X=V.canonical.y/(1<<V.canonical.z),K=a.J/(1<<V.canonical.z),Y=G.wrap+G.canonical.x/(1<<G.canonical.z),Z=G.canonical.y/(1<<G.canonical.z);return W+K<Y+O.min.x||W>Y+O.max.x||X+K<Z+O.min.y||X>Z+O.max.y};for(let V=0;V<S.length;V++){const G=S[V];for(let W=0;W<h.length;W++){const X=l.getTile(h[W]);if(!X||!X.hasData()||N(G,X.tileID))continue;const K=this._createProxiedId(G,X,_[G.key]&&_[G.key][l.id]),Y=this.proxyToSource[G.key][l.id];Y?Y.push(K):this.proxyToSource[G.key][l.id]=[K],x.push(K)}}}_createProxiedId(l,h,_){let x=this.orthoMatrix;if(_){const S=_.find(C=>C.key===h.tileID.key);if(S)return S}if(h.tileID.key!==l.key){const S=l.canonical.z-h.tileID.canonical.z;let C,A,z;x=a.m.create();const O=h.tileID.wrap-l.wrap<<l.overscaledZ;S>0?(C=a.J>>S,A=C*((h.tileID.canonical.x<<S)-l.canonical.x+O),z=C*((h.tileID.canonical.y<<S)-l.canonical.y)):(C=a.J<<-S,A=a.J*(h.tileID.canonical.x-(l.canonical.x+O<<-S)),z=a.J*(h.tileID.canonical.y-(l.canonical.y<<-S))),a.m.ortho(x,0,C,0,C,0,1),a.m.translate(x,x,[A,z,0])}return new Td(h.tileID,l.key,x)}_findTileCoveringTileID(l,h){let _=h.getTile(l);if(_&&_.hasData())return _;const x=this._findCoveringTileCache[h.id],S=x[l.key];if(_=S?h.getTileByID(S):null,_&&_.hasData()||S===null)return _;let C=_?_.tileID:l,A=C.overscaledZ;const z=h.getSource().minzoom,O=[];if(!S){const V=h.getSource().maxzoom;if(l.canonical.z>=V){const G=l.canonical.z-V;h.getSource().reparseOverscaled?(A=Math.max(l.canonical.z+2,h.transform.tileZoom),C=new a.O(A,l.wrap,V,l.canonical.x>>G,l.canonical.y>>G)):G!==0&&(A=V,C=new a.O(A,l.wrap,V,l.canonical.x>>G,l.canonical.y>>G))}C.key!==l.key&&(O.push(C.key),_=h.getTile(C))}const N=V=>{O.forEach(G=>{x[G]=V}),O.length=0};for(A-=1;A>=z&&(!_||!_.hasData());A--){_&&N(_.tileID.key);const V=C.calculateScaledKey(A);if(_=h.getTileByID(V),_&&_.hasData())break;const G=x[V];if(G===null)break;G===void 0?O.push(V):_=h.getTileByID(G)}return N(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,h){let _=this._tilesDirty[l];_||(_=this._tilesDirty[l]={}),_[h.key]=!0}}function fy(m,l,h){const _=function(A,z,O){const N=a.v.dot(z,A),V=a.v.dot(O,[.2126,.7152,.0722]),G=(X,K,Y)=>(1-Y)*X+Y*K,W=G(1-.3*Math.min(V,1),1,Math.min(N+1,1));return G(.92,1,Math.asin(a.c(z[2],-1,1))/Math.PI+.5)*W}(m,[0,0,1],l),x=[0,0,0];a.v.scale(x,h.slice(0,3),_);const S=[0,0,0];a.v.scale(S,l.slice(0,3),m[2]);const C=[0,0,0];return a.v.add(C,x,S),a.bw(C)}const Ed=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],ga=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Cd{static cacheKey(l,h,_,x){let S=`${h}${x?x.cacheKey:""}`;for(const C of _)l.usedDefines.includes(C)&&(S+=`/${C}`);return S}constructor(l,h,_,x,S,C){const A=l.gl;this.program=A.createProgram(),this.configuration=x,this.name=h,this.fixedDefines=[...C];const z=x?x.getBinderAttributes():[],O=(_.staticAttributes||[]).concat(z);let N=x?x.defines():[];N=N.concat(C.map(Y=>`#define ${Y}`));const V=`#version 300 es
`;let G=V+N.concat("precision mediump float;",jl,hy.fragmentSource).join(`
`);for(const Y of _.fragmentIncludes)G+=`
${Xa[Y]}`;G+=`
${_.fragmentSource}`;let W=V+N.concat("precision highp float;",jl,hy.vertexSource).join(`
`);for(const Y of _.vertexIncludes)W+=`
${Xa[Y]}`;W+=`
${_.vertexSource}`;const X=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(X,G),A.compileShader(X),A.attachShader(this.program,X);const K=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(K,W),A.compileShader(K),A.attachShader(this.program,K),this.attributes={},this.numAttributes=O.length;for(let Y=0;Y<this.numAttributes;Y++)if(O[Y]){const Z=O[Y].startsWith("a_")?O[Y]:`a_${O[Y]}`;A.bindAttribLocation(this.program,Y,Z),this.attributes[Z]=Y}A.linkProgram(this.program),A.deleteShader(K),A.deleteShader(X),this.fixedUniforms=S(l),this.binderUniforms=x?x.getUniforms(l):[],C.includes("TERRAIN")&&(this.terrainUniforms=(Y=>({u_dem:new a.a$(Y),u_dem_prev:new a.a$(Y),u_dem_tl:new a.b0(Y),u_dem_scale:new a.b2(Y),u_dem_tl_prev:new a.b0(Y),u_dem_scale_prev:new a.b2(Y),u_dem_size:new a.b2(Y),u_dem_lerp:new a.b2(Y),u_exaggeration:new a.b2(Y),u_depth:new a.a$(Y),u_depth_size_inv:new a.b0(Y),u_meter_to_dem:new a.b2(Y),u_label_plane_matrix_inv:new a.a_(Y)}))(l)),C.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new a.b7(Y),u_tile_tr_up:new a.b7(Y),u_tile_br_up:new a.b7(Y),u_tile_bl_up:new a.b7(Y),u_tile_up_scale:new a.b2(Y)}))(l)),C.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new a.a_(Y),u_fog_range:new a.b0(Y),u_fog_color:new a.b9(Y),u_fog_horizon_blend:new a.b2(Y),u_fog_vertical_limit:new a.b0(Y),u_fog_temporal_offset:new a.b2(Y),u_frustum_tl:new a.b7(Y),u_frustum_tr:new a.b7(Y),u_frustum_br:new a.b7(Y),u_frustum_bl:new a.b7(Y),u_globe_pos:new a.b7(Y),u_globe_radius:new a.b2(Y),u_globe_transition:new a.b2(Y),u_is_globe:new a.a$(Y),u_viewport:new a.b0(Y)}))(l)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Y=>({u_cutoff_params:new a.b9(Y)}))(l)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Y=>({u_lighting_ambient_color:new a.b7(Y),u_lighting_directional_dir:new a.b7(Y),u_lighting_directional_color:new a.b7(Y),u_ground_radiance:new a.b7(Y)}))(l)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Y=>({u_light_matrix_0:new a.a_(Y),u_light_matrix_1:new a.a_(Y),u_fade_range:new a.b0(Y),u_shadow_normal_offset:new a.b7(Y),u_shadow_intensity:new a.b2(Y),u_shadow_texel_size:new a.b2(Y),u_shadow_map_resolution:new a.b2(Y),u_shadow_direction:new a.b7(Y),u_shadow_bias:new a.b7(Y),u_shadowmap_0:new a.a$(Y),u_shadowmap_1:new a.a$(Y)}))(l))}}setTerrainUniformValues(l,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x]&&_[x].set(this.program,x,h[x])}}setGlobeUniformValues(l,h){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x]&&_[x].set(this.program,x,h[x])}}setFogUniformValues(l,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x].set(this.program,x,h[x])}}setCutoffUniformValues(l,h){if(!this.cutoffUniforms)return;const _=this.cutoffUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x].set(this.program,x,h[x])}}setLightsUniformValues(l,h){if(!this.lightsUniforms)return;const _=this.lightsUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x].set(this.program,x,h[x])}}setShadowUniformValues(l,h){if(this.failedToCreate||!this.shadowUniforms)return;const _=this.shadowUniforms;l.program.set(this.program);for(const x in h)_[x].set(this.program,x,h[x])}_drawDebugWireframe(l,h,_,x,S,C,A,z,O,N){const V=l.options.wireframe;if(V.terrain===!1&&V.layers2D===!1&&V.layers3D===!1)return;const G=l.context;if(!(!(!V.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!V.layers2D||l._terrain&&l._terrain.renderingToTexture||!Ed.includes(this.name))||!(!V.layers3D||!ga.includes(this.name))))return;const W=G.gl,X=l.wireframeDebugCache.getLinesFromTrianglesBuffer(l.frameCounter,S,G);if(!X)return;const K=[...this.fixedDefines];K.push("DEBUG_WIREFRAME");const Y=l.getOrCreateProgram(this.name,{config:this.configuration,defines:K});G.program.set(Y.program);const Z=(ge,ne,ce)=>{if(ne[ge]&&ce[ge])for(const _e in ne[ge])ce[ge][_e]&&ce[ge][_e].set(ce.program,_e,ne[ge][_e].current)};O&&O.setUniforms(Y.program,G,Y.binderUniforms,A,{zoom:z}),Z("fixedUniforms",this,Y),Z("terrainUniforms",this,Y),Z("globeUniforms",this,Y),Z("fogUniforms",this,Y),Z("lightsUniforms",this,Y),Z("shadowUniforms",this,Y),X.bind(),G.setColorMode(new a.a([W.ONE,W.ONE_MINUS_SRC_ALPHA,W.ZERO,W.ONE],a.C.transparent,[!0,!0,!0,!1])),G.setDepthMode(new a.b4(h.func===W.LESS?W.LEQUAL:h.func,a.b4.ReadOnly,h.range)),G.setStencilMode(a.b6.disabled);const ae=3*C.primitiveLength*2,pe=3*C.primitiveOffset*2*2;N&&N>1?W.drawElementsInstanced(W.LINES,ae,W.UNSIGNED_SHORT,pe,N):W.drawElements(W.LINES,ae,W.UNSIGNED_SHORT,pe),S.bind(),G.program.set(this.program),G.setDepthMode(h),G.setStencilMode(_),G.setColorMode(x)}draw(l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y){const Z=l.context,ae=Z.gl;if(this.failedToCreate)return;Z.program.set(this.program),Z.setDepthMode(_),Z.setStencilMode(x),Z.setColorMode(S),Z.setCullFace(C);for(const ne of Object.keys(this.fixedUniforms))this.fixedUniforms[ne].set(this.program,ne,A[ne]);X&&X.setUniforms(this.program,Z,this.binderUniforms,G,{zoom:W});const pe={[ae.LINES]:2,[ae.TRIANGLES]:3,[ae.LINE_STRIP]:1}[h],ge=Y&&Y>0?1:void 0;for(const ne of V.get()){const ce=ne.vaos||(ne.vaos={});(ce[z]||(ce[z]=new kb)).bind(Z,this,O,X?X.getPaintVertexBuffers():[],N,ne.vertexOffset,K||[],ge),Y&&Y>1?ae.drawElementsInstanced(h,ne.primitiveLength*pe,ae.UNSIGNED_SHORT,ne.primitiveOffset*pe*2,Y):ae.drawElements(h,ne.primitiveLength*pe,ae.UNSIGNED_SHORT,ne.primitiveOffset*pe*2),h===ae.TRIANGLES&&this._drawDebugWireframe(l,_,x,S,N,ne,G,W,X,Y)}}}function Ka(m,l){const h=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,m.transform.tileZoom)/h,x=_*(l.tileID.canonical.x+l.tileID.wrap*h),S=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture?l.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.ay(l,1,m.transform.tileZoom),u_pixel_coord_upper:[x>>16,S>>16],u_pixel_coord_lower:[65535&x,65535&S]}}const Md=a.m.create(),$l=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K)=>{const Y=l.style.light,Z=Y.properties.get("position"),ae=[Z.x,Z.y,Z.z],pe=a.bx.create();Y.properties.get("anchor")==="viewport"&&(a.bx.fromRotation(pe,-l.transform.angle),a.v.transformMat3(ae,ae,pe));const ge=Y.properties.get("color"),ne=l.transform,ce={u_matrix:m,u_lightpos:ae,u_lightintensity:Y.properties.get("intensity"),u_lightcolor:[ge.r,ge.g,ge.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Md,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:S,u_flood_light_color:V,u_vertical_scale:G,u_flood_light_intensity:W,u_ground_shadow_factor:X,u_emissive_strength:K};return ne.projection.name==="globe"&&(ce.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],ce.u_zoom_transition=z,ce.u_inv_rot_matrix=N,ce.u_merc_center=O,ce.u_up_dir=ne.projection.upVector(new a.t(0,0,0),O[0]*a.J,O[1]*a.J),ce.u_height_lift=A),ce},qp=(m,l,h)=>({u_matrix:m,u_edge_radius:l,u_vertical_scale:h}),Rb=(m,l,h,_,x,S,C,A,z,O,N,V,G,W)=>{const X=$l(m,l,h,_,x,S,C,z,O,N,V,G,W,1,[0,0,0],0),K={u_height_factor:-Math.pow(2,C.overscaledZ)/A.tileSize/8};return a.ak(X,Ka(l,A),K)},Hp=(m,l)=>({u_matrix:m,u_emissive_strength:l}),Zp=(m,l,h,_)=>a.ak(Hp(m,l),Ka(h,_)),Xp=(m,l,h)=>({u_matrix:m,u_world:h,u_emissive_strength:l}),Db=(m,l,h,_,x)=>a.ak(Zp(m,l,h,_),{u_world:x}),Lb=(m,l,h,_)=>{const x=a.J/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(_),u_extrude_scale:[l.pixelsToGLUnits[0]/x,l.pixelsToGLUnits[1]/x]}},py=(m,l,h=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:h}),Ob=a.m.create(),my=(m,l,h,_,x,S,C)=>{const A=m.transform,z=A.projection.name==="globe",O=z?a.by(A.zoom,l.canonical)*A._pixelsPerMercatorPixel:a.ay(h,1,S),N={u_matrix:l.projMatrix,u_extrude_scale:O,u_intensity:C,u_inv_rot_matrix:Ob,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){N.u_inv_rot_matrix=_,N.u_merc_center=x,N.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],N.u_zoom_transition=a.ao(A.zoom);const V=x[0]*a.J,G=x[1]*a.J;N.u_up_dir=A.projection.upVector(new a.t(0,0,0),V,G)}return N},gy=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z,ae,pe,ge)=>{return{u_matrix:m,u_normalize_matrix:l,u_globe_matrix:h,u_merc_matrix:_,u_grid_matrix:x,u_tl_parent:S,u_scale_parent:O,u_fade_t:N.mix,u_opacity:N.opacity*V.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:V.paint.get("raster-brightness-min"),u_brightness_high:V.paint.get("raster-brightness-max"),u_saturation_factor:(ce=V.paint.get("raster-saturation"),ce>0?1-1/(1.001-ce):-ce),u_contrast_factor:(ne=V.paint.get("raster-contrast"),ne>0?1/(1-ne):1+ne),u_spin_weights:Ad(V.paint.get("raster-hue-rotate")),u_perspective_transform:G,u_raster_elevation:W,u_zoom_transition:C,u_merc_center:A,u_cutoff_params:z,u_colorization_mix:Bb(K,Z),u_colorization_offset:_y(Y,Z),u_color_ramp:X,u_texture_offset:[pe/(ae+2*pe),ae/(ae+2*pe)],u_texture_res:[ae+2*pe,ae+2*pe],u_emissive_strength:ge};var ne,ce};function Ad(m){m*=Math.PI/180;const l=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*l-h+1)/3,(Math.sqrt(3)*l-h+1)/3]}function Bb([m,l,h,_],[x,S]){if(x===S)return[0,0,0,0];const C=(a.bz+3)/(a.bz+1)/(S-x);return[m*C,l*C,h*C,_*C]}function _y(m,[l,h]){return l===h?0:((m-l)/(h-l)*(a.bz+3)-1)/(a.bz+1)}const kd=a.m.create(),Zu=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z)=>{const ae=x.transform,pe={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:ae.getCameraToCenterDistance(K),u_rotate_symbol:+h,u_aspect_ratio:ae.width/ae.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:C,u_coord_matrix:A,u_is_text:+z,u_pitch_with_map:+_,u_texsize:O,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:kd,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:kd,u_up_vector:[0,-1,0],u_icon_transition:Z||0,u_icon_saturation:Y};return K.name==="globe"&&(pe.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],pe.u_zoom_transition=V,pe.u_inv_rot_matrix=W,pe.u_merc_center=G,pe.u_camera_forward=ae._camera.forward(),pe.u_ecef_origin=a.bA(ae.globeMatrix,N.toUnwrapped()),pe.u_tile_matrix=Float32Array.from(ae.globeMatrix),pe.u_up_vector=X),pe},Pd=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y)=>a.ak(Zu(m,l,h,_,x,S,C,A,z,O,V,G,W,X,K,Y,1),{u_gamma_scale:_?x.transform.getCameraToCenterDistance(Y)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:a.a4.devicePixelRatio,u_is_halo:+N,undefined:void 0}),Xu=(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K)=>a.ak(Pd(m,l,h,_,x,S,C,A,!0,z,!0,N,V,G,W,X,K),{u_texsize_icon:O,u_texture_icon:1}),Yp=(m,l,h,_)=>({u_matrix:m,u_emissive_strength:l,u_opacity:h,u_color:_}),Vc=(m,l,h,_,x,S,C)=>a.ak(function(A,z,O,N){const V=O.imageManager.getPattern(A.toString(),z),{width:G,height:W}=O.imageManager.getPixelSize(z),X=Math.pow(2,N.tileID.overscaledZ),K=N.tileSize*Math.pow(2,O.transform.tileZoom)/X,Y=K*(N.tileID.canonical.x+N.tileID.wrap*X),Z=K*N.tileID.canonical.y;return{u_image:0,u_pattern_tl:V.tl,u_pattern_br:V.br,u_texsize:[G,W],u_pattern_size:V.displaySize,u_tile_units_to_pixels:1/a.ay(N,1,O.transform.tileZoom),u_pixel_coord_upper:[Y>>16,Z>>16],u_pixel_coord_lower:[65535&Y,65535&Z]}}(x,S,_,C),{u_matrix:m,u_emissive_strength:l,u_opacity:h}),Ci={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Yu=(m,l,h,_,x,S,C,A,z,O,N,V,G=[0,0,0])=>{const W=_.style.light,X=W.properties.get("position"),K=[-X.x,-X.y,X.z],Y=a.bx.create();W.properties.get("anchor")==="viewport"&&(a.bx.fromRotation(Y,-_.transform.angle),a.v.transformMat3(K,K,Y));const Z=O.alphaMode==="MASK",ae=W.properties.get("color"),pe=V.paint.get("model-ambient-occlusion-intensity"),ge=V.paint.get("model-color").constantOr(a.C.white),ne=V.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:l,u_normal_matrix:h,u_lightpos:K,u_lightintensity:W.properties.get("intensity"),u_lightcolor:[ae.r,ae.g,ae.b],u_camera_pos:G,u_opacity:x,u_baseTextureIsAlpha:0,u_alphaMask:+Z,u_alphaCutoff:O.alphaCutoff,u_baseColorFactor:[S.r,S.g,S.b,S.a],u_emissiveFactor:[C[0],C[1],C[2],1],u_metallicFactor:A,u_roughnessFactor:z,u_baseColorTexture:Ci.BaseColor,u_metallicRoughnessTexture:Ci.MetallicRoughness,u_normalTexture:Ci.Normal,u_occlusionTexture:Ci.Occlusion,u_emissionTexture:Ci.Emission,u_color_mix:[ge.r,ge.g,ge.b,ne],u_aoIntensity:pe,u_emissive_strength:N}},Ul=new Float32Array(16),Id=(m,l=Ul,h=Ul)=>({u_matrix:m,u_instance:l,u_node_matrix:h}),yy={fillExtrusion:m=>({u_matrix:new a.a_(m),u_lightpos:new a.b7(m),u_lightintensity:new a.b2(m),u_lightcolor:new a.b7(m),u_vertical_gradient:new a.b2(m),u_opacity:new a.b2(m),u_edge_radius:new a.b2(m),u_ao:new a.b0(m),u_tile_id:new a.b7(m),u_zoom_transition:new a.b2(m),u_inv_rot_matrix:new a.a_(m),u_merc_center:new a.b0(m),u_up_dir:new a.b7(m),u_height_lift:new a.b2(m),u_flood_light_color:new a.b7(m),u_vertical_scale:new a.b2(m),u_flood_light_intensity:new a.b2(m),u_ground_shadow_factor:new a.b7(m),u_emissive_strength:new a.b2(m)}),fillExtrusionDepth:m=>({u_matrix:new a.a_(m),u_edge_radius:new a.b2(m),u_vertical_scale:new a.b2(m)}),fillExtrusionPattern:m=>({u_matrix:new a.a_(m),u_lightpos:new a.b7(m),u_lightintensity:new a.b2(m),u_lightcolor:new a.b7(m),u_vertical_gradient:new a.b2(m),u_height_factor:new a.b2(m),u_edge_radius:new a.b2(m),u_ao:new a.b0(m),u_tile_id:new a.b7(m),u_zoom_transition:new a.b2(m),u_inv_rot_matrix:new a.a_(m),u_merc_center:new a.b0(m),u_up_dir:new a.b7(m),u_height_lift:new a.b2(m),u_image:new a.a$(m),u_texsize:new a.b0(m),u_pixel_coord_upper:new a.b0(m),u_pixel_coord_lower:new a.b0(m),u_tile_units_to_pixels:new a.b2(m),u_opacity:new a.b2(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new a.a_(m),u_opacity:new a.b2(m),u_ao_pass:new a.b2(m),u_meter_to_tile:new a.b2(m),u_ao:new a.b0(m),u_flood_light_intensity:new a.b2(m),u_flood_light_color:new a.b7(m),u_attenuation:new a.b2(m),u_edge_radius:new a.b2(m),u_fb:new a.a$(m),u_fb_size:new a.b2(m)}),fill:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m)}),fillPattern:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m),u_image:new a.a$(m),u_texsize:new a.b0(m),u_pixel_coord_upper:new a.b0(m),u_pixel_coord_lower:new a.b0(m),u_tile_units_to_pixels:new a.b2(m)}),fillOutline:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m),u_world:new a.b0(m)}),fillOutlinePattern:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m),u_world:new a.b0(m),u_image:new a.a$(m),u_texsize:new a.b0(m),u_pixel_coord_upper:new a.b0(m),u_pixel_coord_lower:new a.b0(m),u_tile_units_to_pixels:new a.b2(m)}),circle:a.bB,collisionBox:m=>({u_matrix:new a.a_(m),u_camera_to_center_distance:new a.b2(m),u_extrude_scale:new a.b0(m)}),collisionCircle:m=>({u_matrix:new a.a_(m),u_inv_matrix:new a.a_(m),u_camera_to_center_distance:new a.b2(m),u_viewport_size:new a.b0(m)}),debug:m=>({u_color:new a.b1(m),u_matrix:new a.a_(m),u_overlay:new a.a$(m),u_overlay_scale:new a.b2(m)}),clippingMask:m=>({u_matrix:new a.a_(m)}),heatmap:m=>({u_extrude_scale:new a.b2(m),u_intensity:new a.b2(m),u_matrix:new a.a_(m),u_inv_rot_matrix:new a.a_(m),u_merc_center:new a.b0(m),u_tile_id:new a.b7(m),u_zoom_transition:new a.b2(m),u_up_dir:new a.b7(m)}),heatmapTexture:m=>({u_image:new a.a$(m),u_color_ramp:new a.a$(m),u_opacity:new a.b2(m)}),hillshade:m=>({u_matrix:new a.a_(m),u_image:new a.a$(m),u_latrange:new a.b0(m),u_light:new a.b0(m),u_shadow:new a.b1(m),u_highlight:new a.b1(m),u_emissive_strength:new a.b2(m),u_accent:new a.b1(m)}),hillshadePrepare:m=>({u_matrix:new a.a_(m),u_image:new a.a$(m),u_dimension:new a.b0(m),u_zoom:new a.b2(m)}),line:a.bC,linePattern:a.bD,raster:m=>({u_matrix:new a.a_(m),u_normalize_matrix:new a.a_(m),u_globe_matrix:new a.a_(m),u_merc_matrix:new a.a_(m),u_grid_matrix:new a.b8(m),u_tl_parent:new a.b0(m),u_scale_parent:new a.b2(m),u_fade_t:new a.b2(m),u_opacity:new a.b2(m),u_image0:new a.a$(m),u_image1:new a.a$(m),u_brightness_low:new a.b2(m),u_brightness_high:new a.b2(m),u_saturation_factor:new a.b2(m),u_contrast_factor:new a.b2(m),u_spin_weights:new a.b7(m),u_perspective_transform:new a.b0(m),u_raster_elevation:new a.b2(m),u_zoom_transition:new a.b2(m),u_merc_center:new a.b0(m),u_cutoff_params:new a.b9(m),u_colorization_mix:new a.b9(m),u_colorization_offset:new a.b2(m),u_color_ramp:new a.a$(m),u_texture_offset:new a.b0(m),u_texture_res:new a.b0(m),u_emissive_strength:new a.b2(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new a.a$(m),u_is_size_feature_constant:new a.a$(m),u_size_t:new a.b2(m),u_size:new a.b2(m),u_camera_to_center_distance:new a.b2(m),u_rotate_symbol:new a.a$(m),u_aspect_ratio:new a.b2(m),u_fade_change:new a.b2(m),u_matrix:new a.a_(m),u_label_plane_matrix:new a.a_(m),u_coord_matrix:new a.a_(m),u_is_text:new a.a$(m),u_pitch_with_map:new a.a$(m),u_texsize:new a.b0(m),u_tile_id:new a.b7(m),u_zoom_transition:new a.b2(m),u_inv_rot_matrix:new a.a_(m),u_merc_center:new a.b0(m),u_camera_forward:new a.b7(m),u_tile_matrix:new a.a_(m),u_up_vector:new a.b7(m),u_ecef_origin:new a.b7(m),u_texture:new a.a$(m),u_icon_transition:new a.b2(m),u_icon_saturation:new a.b2(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new a.a$(m),u_is_size_feature_constant:new a.a$(m),u_size_t:new a.b2(m),u_size:new a.b2(m),u_camera_to_center_distance:new a.b2(m),u_rotate_symbol:new a.a$(m),u_aspect_ratio:new a.b2(m),u_fade_change:new a.b2(m),u_matrix:new a.a_(m),u_label_plane_matrix:new a.a_(m),u_coord_matrix:new a.a_(m),u_is_text:new a.a$(m),u_pitch_with_map:new a.a$(m),u_texsize:new a.b0(m),u_texture:new a.a$(m),u_gamma_scale:new a.b2(m),u_device_pixel_ratio:new a.b2(m),u_tile_id:new a.b7(m),u_zoom_transition:new a.b2(m),u_inv_rot_matrix:new a.a_(m),u_merc_center:new a.b0(m),u_camera_forward:new a.b7(m),u_tile_matrix:new a.a_(m),u_up_vector:new a.b7(m),u_ecef_origin:new a.b7(m),u_is_halo:new a.a$(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new a.a$(m),u_is_size_feature_constant:new a.a$(m),u_size_t:new a.b2(m),u_size:new a.b2(m),u_camera_to_center_distance:new a.b2(m),u_rotate_symbol:new a.a$(m),u_aspect_ratio:new a.b2(m),u_fade_change:new a.b2(m),u_matrix:new a.a_(m),u_label_plane_matrix:new a.a_(m),u_coord_matrix:new a.a_(m),u_is_text:new a.a$(m),u_pitch_with_map:new a.a$(m),u_texsize:new a.b0(m),u_texsize_icon:new a.b0(m),u_texture:new a.a$(m),u_texture_icon:new a.a$(m),u_gamma_scale:new a.b2(m),u_device_pixel_ratio:new a.b2(m),u_is_halo:new a.a$(m)}),background:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m),u_opacity:new a.b2(m),u_color:new a.b1(m)}),backgroundPattern:m=>({u_matrix:new a.a_(m),u_emissive_strength:new a.b2(m),u_opacity:new a.b2(m),u_image:new a.a$(m),u_pattern_tl:new a.b0(m),u_pattern_br:new a.b0(m),u_texsize:new a.b0(m),u_pattern_size:new a.b0(m),u_pixel_coord_upper:new a.b0(m),u_pixel_coord_lower:new a.b0(m),u_tile_units_to_pixels:new a.b2(m)}),terrainRaster:xd,terrainDepth:xd,skybox:m=>({u_matrix:new a.a_(m),u_sun_direction:new a.b7(m),u_cubemap:new a.a$(m),u_opacity:new a.b2(m),u_temporal_offset:new a.b2(m)}),skyboxGradient:m=>({u_matrix:new a.a_(m),u_color_ramp:new a.a$(m),u_center_direction:new a.b7(m),u_radius:new a.b2(m),u_opacity:new a.b2(m),u_temporal_offset:new a.b2(m)}),skyboxCapture:m=>({u_matrix_3f:new a.b8(m),u_sun_direction:new a.b7(m),u_sun_intensity:new a.b2(m),u_color_tint_r:new a.b9(m),u_color_tint_m:new a.b9(m),u_luminance:new a.b2(m)}),globeRaster:m=>({u_proj_matrix:new a.a_(m),u_globe_matrix:new a.a_(m),u_normalize_matrix:new a.a_(m),u_merc_matrix:new a.a_(m),u_zoom_transition:new a.b2(m),u_merc_center:new a.b0(m),u_image0:new a.a$(m),u_grid_matrix:new a.b8(m),u_skirt_height:new a.b2(m),u_frustum_tl:new a.b7(m),u_frustum_tr:new a.b7(m),u_frustum_br:new a.b7(m),u_frustum_bl:new a.b7(m),u_globe_pos:new a.b7(m),u_globe_radius:new a.b2(m),u_viewport:new a.b0(m)}),globeAtmosphere:m=>({u_frustum_tl:new a.b7(m),u_frustum_tr:new a.b7(m),u_frustum_br:new a.b7(m),u_frustum_bl:new a.b7(m),u_horizon:new a.b2(m),u_transition:new a.b2(m),u_fadeout_range:new a.b2(m),u_color:new a.b9(m),u_high_color:new a.b9(m),u_space_color:new a.b9(m),u_temporal_offset:new a.b2(m),u_horizon_angle:new a.b2(m)}),model:m=>({u_matrix:new a.a_(m),u_lighting_matrix:new a.a_(m),u_normal_matrix:new a.a_(m),u_lightpos:new a.b7(m),u_lightintensity:new a.b2(m),u_lightcolor:new a.b7(m),u_camera_pos:new a.b7(m),u_opacity:new a.b2(m),u_baseColorFactor:new a.b9(m),u_emissiveFactor:new a.b9(m),u_metallicFactor:new a.b2(m),u_roughnessFactor:new a.b2(m),u_baseTextureIsAlpha:new a.a$(m),u_alphaMask:new a.a$(m),u_alphaCutoff:new a.b2(m),u_baseColorTexture:new a.a$(m),u_metallicRoughnessTexture:new a.a$(m),u_normalTexture:new a.a$(m),u_occlusionTexture:new a.a$(m),u_emissionTexture:new a.a$(m),u_color_mix:new a.b9(m),u_aoIntensity:new a.b2(m),u_emissive_strength:new a.b2(m)}),modelDepth:m=>({u_matrix:new a.a_(m),u_instance:new a.a_(m),u_node_matrix:new a.a_(m)}),groundShadow:m=>({u_matrix:new a.a_(m),u_ground_shadow_factor:new a.b7(m)}),stars:m=>({u_matrix:new a.a_(m),u_up:new a.b7(m),u_right:new a.b7(m),u_intensity_multiplier:new a.b2(m)})};let $c;function Kp(m,l,h,_,x,S,C){const A=m.context,z=A.gl,O=m.transform,N=m.getOrCreateProgram("collisionBox"),V=[];let G=0,W=0;for(let ge=0;ge<_.length;ge++){const ne=_[ge],ce=l.getTile(ne),_e=ce.getBucket(h);if(!_e)continue;const we=Ga(ne,_e,O);let ve=we;x[0]===0&&x[1]===0||(ve=m.translatePosMatrix(we,ce,x,S));const Se=C?_e.textCollisionBox:_e.iconCollisionBox,qe=_e.collisionCircleArray;if(qe.length>0){const De=a.m.create(),Ne=ve;a.m.mul(De,_e.placementInvProjMatrix,O.glCoordMatrix),a.m.mul(De,De,_e.placementViewportMatrix),V.push({circleArray:qe,circleOffset:W,transform:Ne,invTransform:De,projection:_e.getProjection()}),G+=qe.length/4,W=G}Se&&(m.terrain&&m.terrain.setupElevationDraw(ce,N),N.draw(m,z.LINES,a.b4.disabled,a.b6.disabled,m.colorModeForRenderPass(),a.b5.disabled,Lb(ve,O,ce,_e.getProjection()),h.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,null,O.zoom,null,[Se.collisionVertexBuffer,Se.collisionVertexBufferExt]))}if(!C||!V.length)return;const X=m.getOrCreateProgram("collisionCircle"),K=new a.bE;K.resize(4*G),K._trim();let Y=0;for(const ge of V)for(let ne=0;ne<ge.circleArray.length/4;ne++){const ce=4*ne,_e=ge.circleArray[ce+0],we=ge.circleArray[ce+1],ve=ge.circleArray[ce+2],Se=ge.circleArray[ce+3];K.emplace(Y++,_e,we,ve,Se,0),K.emplace(Y++,_e,we,ve,Se,1),K.emplace(Y++,_e,we,ve,Se,2),K.emplace(Y++,_e,we,ve,Se,3)}(!$c||$c.length<2*G)&&($c=function(ge){const ne=2*ge,ce=new a.bp;ce.resize(ne),ce._trim();for(let _e=0;_e<ne;_e++){const we=6*_e;ce.uint16[we+0]=4*_e+0,ce.uint16[we+1]=4*_e+1,ce.uint16[we+2]=4*_e+2,ce.uint16[we+3]=4*_e+2,ce.uint16[we+4]=4*_e+3,ce.uint16[we+5]=4*_e+0}return ce}(G));const Z=A.createIndexBuffer($c,!0),ae=A.createVertexBuffer(K,a.bF.members,!0);for(const ge of V){const ne={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(pe=O).getCameraToCenterDistance(ge.projection),u_viewport_size:[pe.width,pe.height]};X.draw(m,z.TRIANGLES,a.b4.disabled,a.b6.disabled,m.colorModeForRenderPass(),a.b5.disabled,ne,h.id,ae,Z,a.bm.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,O.zoom)}var pe;ae.destroy(),Z.destroy()}const zd=a.m.create();function Rd({width:m,height:l,anchor:h,textOffset:_,textScale:x},S){const{horizontalAlign:C,verticalAlign:A}=a.aY(h),z=-(C-.5)*m,O=-(A-.5)*l,N=a.aW(h,_);return new a.P((z/x+N[0])*S,(O/x+N[1])*S)}function Jp(m,l,h,_,x,S,C,A,z,O,N){const V=m.text.placedSymbolArray,G=m.text.dynamicLayoutVertexArray,W=m.icon.dynamicLayoutVertexArray,X={},K=m.getProjection(),Y=ds(A,K,S),Z=S.elevation,ae=K.upVectorScale(A.canonical,S.center.lat,S.worldSize).metersToTile;G.clear();for(let pe=0;pe<V.length;pe++){const ge=V.get(pe),{tileAnchorX:ne,tileAnchorY:ce,numGlyphs:_e}=ge,we=ge.hidden||!ge.crossTileID||m.allowVerticalPlacement&&!ge.placedOrientation?null:_[ge.crossTileID];if(we){let ve=0,Se=0,qe=0;if(Z){const nt=Z?Z.getAtTileOffset(A,ne,ce):0,[Ke,Mt,wt]=K.upVector(A.canonical,ne,ce);ve=nt*Ke*ae,Se=nt*Mt*ae,qe=nt*wt*ae}let[De,Ne,Me,We]=ai(ge.projectedAnchorX+ve,ge.projectedAnchorY+Se,ge.projectedAnchorZ+qe,h?Y:C);const Fe=$e(S.getCameraToCenterDistance(K),We);let Xe=x.evaluateSizeForFeature(m.textSizeData,O,ge)*Fe/a.aV;h&&(Xe*=m.tilePixelRatio/z);const he=Rd(we,Xe);h?({x:De,y:Ne,z:Me}=K.projectTilePoint(ne+he.x,ce+he.y,A.canonical),[De,Ne,Me]=ai(De+ve,Ne+Se,Me+qe,C)):(l&&he._rotate(-S.angle),De+=he.x,Ne+=he.y,Me=0);const ke=m.allowVerticalPlacement&&ge.placedOrientation===a.W.vertical?Math.PI/2:0;for(let nt=0;nt<_e;nt++)a.k(G,De,Ne,Me,ke);N&&ge.associatedIconIndex>=0&&(X[ge.associatedIconIndex]={x:De,y:Ne,z:Me,angle:ke})}else dt(_e,G)}if(N){W.clear();const pe=m.icon.placedSymbolArray;for(let ge=0;ge<pe.length;ge++){const ne=pe.get(ge),{numGlyphs:ce}=ne,_e=X[ge];if(ne.hidden||!_e)dt(ce,W);else{const{x:we,y:ve,z:Se,angle:qe}=_e;for(let De=0;De<ce;De++)a.k(W,we,ve,Se,qe)}}m.icon.dynamicLayoutVertexBuffer.updateData(W)}m.text.dynamicLayoutVertexBuffer.updateData(G)}function Qp(m,l,h){return h.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function ur(m,l,h,_,x,S,C,A,z,O,N,V,G){const W=m.context,X=W.gl,K=m.transform,Y=A==="map",Z=z==="map",ae=Y&&h.layout.get("symbol-placement")!=="point",pe=Y&&!Z&&!ae,ge=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ne=!1;const ce=m.depthModeForSublayer(0,a.b4.ReadOnly),_e=[a.E(K.center.lng),a.H(K.center.lat)],we=h.layout.get("text-variable-anchor"),ve=K.projection.name==="globe",Se=[],qe=[0,-1,0];let De=qe;!ve&&!K.mercatorFromTransition||Y||(De=function(Ne){const Me=Ne._camera.getWorldToCamera(Ne.worldSize,1),We=a.m.multiply([],Me,Ne.globeMatrix);a.m.invert(We,We);const Fe=[0,0,0],Xe=[0,1,0,0];return a.e.transformMat4(Xe,Xe,We),Fe[0]=Xe[0],Fe[1]=Xe[1],Fe[2]=Xe[2],a.v.normalize(Fe,Fe),Fe}(K));for(const Ne of _){const Me=l.getTile(Ne),We=Me.getBucket(h);if(!We||We.projection.name==="mercator"&&ve)continue;const Fe=x?We.text:We.icon;if(!Fe||We.fullyClipped||!Fe.segments.get().length)continue;const Xe=Fe.programConfigurations.get(h.id),he=x||We.sdfIcons,ke=x?We.textSizeData:We.iconSizeData,nt=Z||K.pitch!==0,Ke=a.i(ke,K.zoom);let Mt,wt,Ft,St,Vt=[0,0],$t=null;if(x)wt=Me.glyphAtlasTexture?Me.glyphAtlasTexture:null,Ft=X.LINEAR,Mt=Me.glyphAtlasTexture?Me.glyphAtlasTexture.size:[0,0],We.iconsInText&&(Vt=Me.imageAtlasTexture?Me.imageAtlasTexture.size:[0,0],$t=Me.imageAtlasTexture?Me.imageAtlasTexture:null,St=nt||m.options.rotating||m.options.zooming||ke.kind==="composite"||ke.kind==="camera"?X.LINEAR:X.NEAREST);else{const Zr=h.layout.get("icon-size").constantOr(0)!==1||We.iconsNeedLinear;wt=Me.imageAtlasTexture?Me.imageAtlasTexture:null,Ft=he||m.options.rotating||m.options.zooming||Zr||nt?X.LINEAR:X.NEAREST,Mt=Me.imageAtlasTexture?Me.imageAtlasTexture.size:[0,0]}const Rt=We.projection.name==="globe",Dt=Rt?De:qe,Sr=Rt?a.ao(K.zoom):0,tr=ds(Ne,We.getProjection(),K),rn=K.calculatePixelsToTileUnitsMatrix(Me),Gr=si(tr,Me.tileID.canonical,Z,Y,K,We.getProjection(),rn),Ki=m.terrain&&Z&&ae?a.m.invert(a.m.create(),Gr):zd,Ho=ho(tr,Me.tileID.canonical,Z,Y,K,We.getProjection(),rn),Nr=we&&We.hasTextData(),Cr=We.hasIconTextFit()&&Nr&&We.hasIconData();if(ae){const Zr=K.elevation,ys=Zr?Zr.getAtTileOffsetFunc(Ne,K.center.lat,K.worldSize,We.getProjection()):null,Us=Vo(tr,Me.tileID.canonical,Z,Y,K,We.getProjection(),rn);at(We,tr,m,x,Us,Ho,Z,O,ys,Ne)}const Ir=ae||x&&we||Cr,un=m.translatePosMatrix(tr,Me,S,C),pi=Ir?zd:Gr,an=m.translatePosMatrix(Ho,Me,S,C,!0),Oi=We.getProjection().createInversionMatrix(K,Ne.canonical),Ji=h.paint.get("icon-image-cross-fade").constantOr(0),Bi=[];m.terrainRenderModeElevated()&&Z&&Bi.push("PITCH_WITH_MAP_TERRAIN"),Rt&&(Bi.push("PROJECTION_GLOBE_VIEW"),Ir&&Bi.push("PROJECTED_POS_ON_VIEWPORT")),Ji>0&&Bi.push("ICON_TRANSITION"),Fe.zOffsetVertexBuffer&&Bi.push("Z_OFFSET");const Zo=he&&h.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let _a;he?_a=We.iconsInText?Xu(ke.kind,Ke,pe,Z,m,un,pi,an,Mt,Vt,Ne,Sr,_e,Oi,Dt,We.getProjection()):Pd(ke.kind,Ke,pe,Z,m,un,pi,an,x,Mt,!0,Ne,Sr,_e,Oi,Dt,We.getProjection()):(N<1&&Bi.push("SATURATION"),_a=Zu(ke.kind,Ke,pe,Z,m,un,pi,an,x,Mt,Ne,Sr,_e,Oi,Dt,We.getProjection(),N,Ji));const _s={program:m.getOrCreateProgram(Qp(he,x,We),{config:Xe,defines:Bi}),buffers:Fe,uniformValues:_a,atlasTexture:wt,atlasTextureIcon:$t,atlasInterpolation:Ft,atlasInterpolationIcon:St,isSDF:he,hasHalo:Zo,tile:Me,labelPlaneMatrixInv:Ki};if(ge&&We.canOverlap){ne=!0;const Zr=Fe.segments.get();for(const ys of Zr)Se.push({segments:new a.bm([ys]),sortKey:ys.sortKey,state:_s})}else Se.push({segments:Fe.segments,sortKey:0,state:_s})}ne&&Se.sort((Ne,Me)=>Ne.sortKey-Me.sortKey);for(const Ne of Se){const Me=Ne.state;if(m.terrain&&m.terrain.setupElevationDraw(Me.tile,Me.program,{useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Me.labelPlaneMatrixInv}),W.activeTexture.set(X.TEXTURE0),Me.atlasTexture&&Me.atlasTexture.bind(Me.atlasInterpolation,X.CLAMP_TO_EDGE,!0),Me.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),Me.atlasTextureIcon&&Me.atlasTextureIcon.bind(Me.atlasInterpolationIcon,X.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,Me.program),Me.hasHalo){const We=Me.uniformValues;We.u_is_halo=1,Dd(Me.buffers,Ne.segments,h,m,Me.program,ce,V,G,We,2),We.u_is_halo=0}else{if(Me.isSDF){const We=Me.uniformValues;Me.hasHalo&&(We.u_is_halo=1,Dd(Me.buffers,Ne.segments,h,m,Me.program,ce,V,G,We,1)),We.u_is_halo=0}Dd(Me.buffers,Ne.segments,h,m,Me.program,ce,V,G,Me.uniformValues,1)}}}function Dd(m,l,h,_,x,S,C,A,z,O){const N=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];x.draw(_,_.context.gl.TRIANGLES,S,C,A,a.b5.disabled,z,h.id,m.layoutVertexBuffer,m.indexBuffer,l,h.paint,_.transform.zoom,m.programConfigurations.get(h.id),N,O)}function Ku(m,l,h,_,x,S,C){const A=m.context.gl,z=h.paint.get("fill-pattern"),O=z&&z.constantOr(1);let N,V,G,W,X;C?(V=O&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=A.LINES):(V=O?"fillPattern":"fill",N=A.TRIANGLES);for(const K of _){const Y=l.getTile(K);if(O&&!Y.patternsLoaded())continue;const Z=Y.getBucket(h);if(!Z)continue;m.prepareDrawTile();const ae=Z.programConfigurations.get(h.id),pe=m.isTileAffectedByFog(K),ge=m.getOrCreateProgram(V,{config:ae,overrideFog:pe});O&&(m.context.activeTexture.set(A.TEXTURE0),Y.imageAtlasTexture&&Y.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ae.updatePaintBuffers());const ne=z.constantOr(null);if(ne&&Y.imageAtlas){const we=Y.imageAtlas.patternPositions[ne.toString()];we&&ae.setConstantPatternPositions(we)}const ce=m.translatePosMatrix(K.projMatrix,Y,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor")),_e=h.paint.get("fill-emissive-strength");if(C){W=Z.indexBuffer2,X=Z.segments2;const we=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[A.drawingBufferWidth,A.drawingBufferHeight];G=V==="fillOutlinePattern"&&O?Db(ce,_e,m,Y,we):Xp(ce,_e,we)}else W=Z.indexBuffer,X=Z.segments,G=O?Zp(ce,_e,m,Y):Hp(ce,_e);m.uploadCommonUniforms(m.context,ge,K.toUnwrapped()),ge.draw(m,N,x,m.stencilModeForClipping(K),S,a.b5.disabled,G,h.id,Z.layoutVertexBuffer,W,X,h.paint,m.transform.zoom,ae,void 0)}}function Ju(m,l,h,_,x,S,C,A){h.resetLayerRenderingStats();const z=m.context,O=z.gl,N=m.transform,V=h.paint.get("fill-extrusion-pattern"),G=V.constantOr(1),W=h.paint.get("fill-extrusion-opacity"),X=m.style.enable3dLights(),K=h.paint.get(X&&!G?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Y=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),K],Z=h.layout.get("fill-extrusion-edge-radius"),ae=Z>0&&!h.paint.get("fill-extrusion-rounded-roof"),pe=ae?0:Z,ge=N.projection.name==="globe"?a.bO():0,ne=N.projection.name==="globe",ce=ne?a.ao(N.zoom):0,_e=[a.E(N.center.lng),a.H(N.center.lat)],we=h.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ve=h.paint.get("fill-extrusion-flood-light-intensity"),Se=h.paint.get("fill-extrusion-vertical-scale"),qe=Vl(m,h.paint.get("fill-extrusion-cutoff-fade-range")),De=h.paint.get("fill-extrusion-emissive-strength"),Ne=[];let Me;ne&&Ne.push("PROJECTION_GLOBE_VIEW"),Y[0]>0&&Ne.push("FAUX_AO"),ae&&Ne.push("ZERO_ROOF_RADIUS"),A&&Ne.push("HAS_CENTROID"),ve>0&&Ne.push("FLOOD_LIGHT"),qe.shouldRenderCutoff&&Ne.push("RENDER_CUTOFF");const We=m.renderPass==="shadow",Fe=m.shadowRenderer,Xe=We&&!!Fe;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let he=[0,0,0];if(Fe){const Ke=m.style.directionalLight,Mt=m.style.ambientLight;Ke&&Mt&&(he=Bd(Ke,Mt)),Me=Ne.concat(["SHADOWS_SINGLE_CASCADE"])}const ke=Xe?"fillExtrusionDepth":G?"fillExtrusionPattern":"fillExtrusion",nt=h.getLayerRenderingStats();for(const Ke of _){const Mt=l.getTile(Ke),wt=Mt.getBucket(h);if(!wt||wt.projection.name!==N.projection.name)continue;let Ft=!1;Fe&&(Ft=Fe.getMaxCascadeForTile(Ke.toUnwrapped())===0);const St=m.isTileAffectedByFog(Ke),Vt=wt.programConfigurations.get(h.id),$t=m.getOrCreateProgram(ke,{config:Vt,defines:Ft?Me:Ne,overrideFog:St});if(m.terrain&&m.terrain.setupElevationDraw(Mt,$t,{useMeterToDem:!0}),!wt.centroidVertexBuffer){const Gr=$t.attributes.a_centroid_pos;Gr!==void 0&&O.vertexAttrib2f(Gr,0,0)}!We&&Fe&&Fe.setupShadows(Mt.tileID.toUnwrapped(),$t,"vector-tile",Mt.tileID.overscaledZ),G&&(m.context.activeTexture.set(O.TEXTURE0),Mt.imageAtlasTexture&&Mt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Vt.updatePaintBuffers());const Rt=V.constantOr(null);if(Rt&&Mt.imageAtlas){const Gr=Mt.imageAtlas.patternPositions[Rt.toString()];Gr&&Vt.setConstantPatternPositions(Gr)}const Dt=h.paint.get("fill-extrusion-vertical-gradient");let Sr;if(We&&Fe){if(Nb(Mt.tileID,wt,m))continue;const Gr=Fe.calculateShadowPassMatrixFromTile(Mt.tileID.toUnwrapped());Sr=qp(Gr,pe,Se)}else{const Gr=m.translatePosMatrix(Ke.expandedProjMatrix,Mt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ki=N.projection.createInversionMatrix(N,Ke.canonical);Sr=G?Rb(Gr,m,Dt,W,Y,pe,Ke,Mt,ge,ce,_e,Ki,we,Se):$l(Gr,m,Dt,W,Y,pe,Ke,ge,ce,_e,Ki,we,Se,ve,he,De)}m.uploadCommonUniforms(z,$t,Ke.toUnwrapped(),null,qe);let tr=wt.segments;if(N.projection.name==="mercator"&&!We&&(tr=wt.getVisibleSegments(Mt.tileID,m.terrain,m.transform.getFrustum(0)),!tr.get().length))continue;if(nt)if(We)for(const Gr of tr.get())nt.numRenderedVerticesInShadowPass+=Gr.primitiveLength;else for(const Gr of tr.get())nt.numRenderedVerticesInTransparentPass+=Gr.primitiveLength;const rn=[];(m.terrain||A)&&rn.push(wt.centroidVertexBuffer),ne&&rn.push(wt.layoutVertexExtBuffer),$t.draw(m,z.gl.TRIANGLES,x,S,C,a.b5.backCCW,Sr,h.id,wt.layoutVertexBuffer,wt.indexBuffer,tr,h.paint,m.transform.zoom,Vt,rn)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Gl(m,l,h,_,x,S,C,A,z,O,N,V,G,W,X,K,Y,Z,ae){const pe=m.context,ge=pe.gl,ne=m.transform,ce=m.transform.zoom,_e=[],we=Vl(m,h.paint.get("fill-extrusion-cutoff-fade-range"));O==="clear"?(_e.push("CLEAR_SUBPASS"),ae&&(_e.push("CLEAR_FROM_TEXTURE"),pe.activeTexture.set(ge.TEXTURE0),ae.bind(ge.LINEAR,ge.CLAMP_TO_EDGE))):O==="sdf"&&_e.push("SDF_SUBPASS"),Y&&_e.push("HAS_CENTROID"),we.shouldRenderCutoff&&_e.push("RENDER_CUTOFF");const ve=h.layout.get("fill-extrusion-edge-radius"),Se=(qe,De,Ne,Me,We)=>{const Fe=De.programConfigurations.get(h.id),Xe=m.isTileAffectedByFog(qe),he=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:Fe,defines:_e,overrideFog:Xe}),ke=((Ke,Mt,wt,Ft,St,Vt,$t,Rt,Dt,Sr,tr)=>({u_matrix:Mt,u_opacity:wt,u_ao_pass:Ft?1:0,u_meter_to_tile:St,u_ao:Vt,u_flood_light_intensity:$t,u_flood_light_color:Rt,u_attenuation:Dt,u_edge_radius:Sr,u_fb:0,u_fb_size:tr}))(0,Me,N,z,We,[V,G*We],W,X,K,ce>=17?0:ve*We,ae?ae.size[0]:0),nt=[];Y&&nt.push(De.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(pe,he,qe.toUnwrapped(),null,we),he.draw(m,pe.gl.TRIANGLES,x,S,C,A,ke,h.id,De.vertexBuffer,De.indexBuffer,Ne,h.paint,ce,Fe,nt)};for(const qe of _){const De=l.getTile(qe),Ne=De.getBucket(h);if(!Ne||Ne.projection.name!==ne.projection.name||!Ne.groundEffect||Ne.groundEffect&&!Ne.groundEffect.hasData())continue;const Me=Ne.groundEffect,We=1/Ne.tileToMeter;{const Fe=m.translatePosMatrix(qe.projMatrix,De,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Xe=Me.getDefaultSegment();Se(qe,Me,Xe,Fe,We)}if(Z)for(let Fe=0;Fe<4;Fe++){const Xe=a.bP[Fe](qe),he=l.getTile(Xe);if(!he)continue;const ke=he.getBucket(h);if(!ke||ke.projection.name!==ne.projection.name||!ke.groundEffect||ke.groundEffect&&!ke.groundEffect.hasData())continue;const nt=ke.groundEffect;let Ke,Mt;Fe===0?(Ke=[-a.J,0,0],Mt=1):Fe===1?(Ke=[a.J,0,0],Mt=0):Fe===2?(Ke=[0,-a.J,0],Mt=3):(Ke=[0,a.J,0],Mt=2);const wt=nt.regionSegments[Mt];if(!wt)continue;const Ft=new Float32Array(16);a.m.translate(Ft,qe.projMatrix,Ke),Se(qe,nt,wt,m.translatePosMatrix(Ft,De,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),We)}}}function vy(m,l,h,_,x,S,C){_.centroidVertexArray.length===0&&_.createCentroidsBuffer();const A=S?S.findDEMTileFor(h):null;if(!(A&&A.dem||C))return;const z=Z=>new a.P(Math.ceil((Z+a.bS)*a.bT),0),O=Z=>{const ae=l.getSource().minzoom,pe=ne=>{const ce=l.getTileByID(ne);if(ce&&ce.hasData())return ce.getBucket(x)},ge=[0,-1,1];for(const ne of ge){if(Z.overscaledZ+ne<ae)continue;const ce=pe(Z.calculateScaledKey(Z.overscaledZ+ne));if(ce)return ce}},N=[0,0,0],V=(Z,ae)=>(N[0]=Math.min(Z.min.y,ae.min.y),N[1]=Math.max(Z.max.y,ae.max.y),N[2]=a.J-ae.min.x>Z.max.x?ae.min.x-a.J:Z.max.x,N),G=(Z,ae)=>(N[0]=Math.min(Z.min.x,ae.min.x),N[1]=Math.max(Z.max.x,ae.max.x),N[2]=a.J-ae.min.y>Z.max.y?ae.min.y-a.J:Z.max.y,N),W=[(Z,ae)=>V(Z,ae),(Z,ae)=>V(ae,Z),(Z,ae)=>G(Z,ae),(Z,ae)=>G(ae,Z)],X=(Z,ae,pe,ge,ne,ce,_e)=>{if(!S)return 0;const we=[[ce?pe:Z,ce?Z:pe,0],[ce?pe:ae,ce?ae:pe,0]],ve=_e<0?a.J+_e:_e,Se=[ce?ve:(Z+ae)/2,ce?(Z+ae)/2:ve,0];return pe===0&&_e<0||pe!==0&&_e>0?S.getForTilePoints(ne,[Se],!0,ge):we.push(Se),S.getForTilePoints(h,we,!0,A),Math.max(we[0][2],we[1][2],Se[2])/S.exaggeration()};for(let Z=0;Z<4;Z++){const ae=_.borderFeatureIndices[Z];if(ae.length===0)continue;const pe=a.bP[Z](h),ge=O(pe);if(!(ge&&ge instanceof a.bQ)||_.borderDoneWithNeighborZ[Z]===ge.canonical.z)continue;ge.centroidVertexArray.length===0&&ge.createCentroidsBuffer();const ne=S?S.findDEMTileFor(pe):null;if(!(ne&&ne.dem||C))continue;const ce=(Z<2?1:5)-Z,_e=ge.borderDoneWithNeighborZ[ce]!==_.canonical.z,we=ge.borderFeatureIndices[ce];let ve=0;if(_.canonical.z!==ge.canonical.z){for(const Se of ae)_.showCentroid(_.featuresOnBorder[Se]);if(_e)for(const Se of we)ge.showCentroid(ge.featuresOnBorder[Se]);_.borderDoneWithNeighborZ[Z]=ge.canonical.z,ge.borderDoneWithNeighborZ[ce]=_.canonical.z}for(const Se of ae){const qe=_.featuresOnBorder[Se],De=_.centroidData[qe.centroidDataIndex],Ne=qe.borders[Z];let Me;for(;ve<we.length;){Me=ge.featuresOnBorder[we[ve]];const We=Me.borders[ce];if(We[1]>Ne[0]+3||We[0]>Ne[0]-3)break;ge.showCentroid(Me),ve++}if(Me&&ve<we.length){const We=ve;let Fe=0;for(;!(Me.borders[ce][0]>Ne[1]-3)&&(Fe++,++ve!==we.length);)Me=ge.featuresOnBorder[we[ve]];if(Me=ge.featuresOnBorder[we[We]],Fe>1){const ke=Me.borders[ce];Math.abs(Ne[0]-ke[0])<3&&Math.abs(Ne[1]-ke[1])<3&&(Fe=1,ve=We+1)}else if(Fe===0){_.showCentroid(qe);continue}const Xe=ge.centroidData[Me.centroidDataIndex];C&&Fe===1&&(((K=De).flags|(Y=Xe).flags)&a.bR?(K.flags|=a.bR,Y.flags|=a.bR):(K.flags&=~a.bR,Y.flags&=~a.bR));const he=qe.intersectsCount()>1||Me.intersectsCount()>1;if(Fe>1)ve=We,De.centroidXY=Xe.centroidXY=new a.P(0,0);else if(ne&&ne.dem&&!he){const ke=W[Z](De,Xe),nt=Z%2?a.J-1:0,Ke=X(ke[0],Math.min(a.J-1,ke[1]),nt,ne,pe,Z<2,ke[2]);De.centroidXY=Xe.centroidXY=z(Ke)}else he?De.centroidXY=Xe.centroidXY=new a.P(0,0):(De.centroidXY=_.encodeBorderCentroid(qe),Xe.centroidXY=ge.encodeBorderCentroid(Me));_.writeCentroidToBuffer(De),ge.writeCentroidToBuffer(Xe)}else _.showCentroid(qe)}_.borderDoneWithNeighborZ[Z]=ge.canonical.z,ge.borderDoneWithNeighborZ[ce]=_.canonical.z}var K,Y;(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(m)}const Uc=[1,0,0],xy=[0,1,0],Fb=[0,0,1];function Nb(m,l,h){const _=h.transform,x=h.shadowRenderer;if(!x)return!0;const S=m.toUnwrapped(),C=_.tileSize*x._cascades[h.currentShadowCascade].scale;let A=l.maxHeight;if(_.elevation){const K=_.elevation.getMinMaxForTile(m);K&&(A+=K.max)}const z=[...x.shadowDirection];z[2]=-z[2];const O=x.computeSimplifiedTileShadowVolume(S,A,C,z);if(!O)return!1;const N=[Uc,xy,Fb,z,[z[0],0,z[2]],[0,z[1],z[2]]],V=_.projection.name==="globe",G=_.scaleZoom(C),W=a.F.fromInvProjectionMatrix(_.invProjMatrix,_.worldSize,G,!V),X=x.getCurrentCascadeFrustum();return W.intersectsPrecise(O.vertices,O.planes,N)===0||X.intersectsPrecise(O.vertices,O.planes,N)===0}function jb(m){const l=m._nearZ,h=m.projection.farthestPixelDistance(m),_=h-l,x=.2*m.height,S=l+x;return[l,h,(S-x-l)/_,(S-l)/_]}const em=new a.C(1,0,0,1),tm=new a.C(0,1,0,1),rm=new a.C(0,0,1,1),nm=new a.C(1,0,1,1),by=new a.C(0,1,1,1);function Wl(m,l,h,_,x,S){const C=m.context,A=m.transform,z=C.gl,O=A.projection.name==="globe",N=O?["PROJECTION_GLOBE_VIEW"]:[];let V=a.m.clone(h.projMatrix);if(O&&a.ao(A.zoom)>0){const Me=a.bU(h.canonical,A),We=a.bV(Me);V=a.m.multiply(new Float32Array(16),A.globeMatrix,We),a.m.multiply(V,A.projMatrix,V)}const G=a.m.create();G[12]+=2*x/(a.a4.devicePixelRatio*A.width),G[13]+=2*S/(a.a4.devicePixelRatio*A.height),a.m.multiply(V,G,V);const W=m.getOrCreateProgram("debug",{defines:N}),X=l.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(X,W);const K=a.b4.disabled,Y=a.b6.disabled,Z=m.colorModeForRenderPass(),ae="$debug";C.activeTexture.set(z.TEXTURE0),m.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),O?X._makeGlobeTileDebugBuffers(m.context,A):X._makeDebugTileBoundsBuffers(m.context,A.projection);const pe=X._tileDebugBuffer||m.debugBuffer,ge=X._tileDebugIndexBuffer||m.debugIndexBuffer,ne=X._tileDebugSegments||m.debugSegments;W.draw(m,z.LINE_STRIP,K,Y,Z,a.b5.disabled,py(V,_),ae,pe,ge,ne,null,null,null,[X._globeTileDebugBorderBuffer]);const ce=X.latestRawTileData,_e=Math.floor((ce&&ce.byteLength||0)/1024),we=l.getTile(h).tileSize,ve=512/Math.min(we,512)*(h.overscaledZ/A.zoom)*.5;let Se=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Se+=` => ${h.overscaledZ}`),Se+=` ${_e}kb`,function(Me,We){Me.initDebugOverlayCanvas();const Fe=Me.debugOverlayCanvas,Xe=Me.context.gl,he=Me.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,Fe.width,Fe.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(We,5,5),he.strokeText(We,5,5),Me.debugOverlayTexture.update(Fe),Me.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(m,Se);const qe=X._tileDebugTextBuffer||m.debugBuffer,De=X._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Ne=X._tileDebugTextSegments||m.debugSegments;W.draw(m,z.TRIANGLES,K,Y,a.a.alphaBlended,a.b5.disabled,py(V,a.C.transparent,ve),ae,qe,De,Ne,null,null,null,[X._globeTileDebugTextBuffer])}function wy(m,l,h,_){Ja(m,0,l+h/2,m.transform.width,h,_)}function Gc(m,l,h,_){Ja(m,l-h/2,0,h,m.transform.height,_)}function Ja(m,l,h,_,x,S){const C=m.context,A=C.gl;A.enable(A.SCISSOR_TEST),A.scissor(l*a.a4.devicePixelRatio,h*a.a4.devicePixelRatio,_*a.a4.devicePixelRatio,x*a.a4.devicePixelRatio),C.clear({color:S}),A.disable(A.SCISSOR_TEST)}const Sy=a.bW([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ld}=Sy;function Vs(m,l,h,_){m.emplaceBack(l,h,_)}class ms{constructor(l){this.vertexArray=new a.bX,this.indices=new a.bp,Vs(this.vertexArray,-1,-1,1),Vs(this.vertexArray,1,-1,1),Vs(this.vertexArray,-1,1,1),Vs(this.vertexArray,1,1,1),Vs(this.vertexArray,-1,-1,-1),Vs(this.vertexArray,1,-1,-1),Vs(this.vertexArray,-1,1,-1),Vs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Ld),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=a.bm.simpleSegment(0,0,36,12)}}function Qa(m,l,h,_,x,S){const C=m.context.gl,A=l.paint.get("sky-atmosphere-color"),z=l.paint.get("sky-atmosphere-halo-color"),O=l.paint.get("sky-atmosphere-sun-intensity"),N=((V,G,W,X,K)=>({u_matrix_3f:V,u_sun_direction:G,u_sun_intensity:W,u_color_tint_r:[X.r,X.g,X.b,X.a],u_color_tint_m:[K.r,K.g,K.b,K.a],u_luminance:5e-5}))(a.bx.fromMat4(a.bx.create(),_),x,O,A,z);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+S,l.skyboxTexture,0),h.draw(m,C.TRIANGLES,a.b4.disabled,a.b6.disabled,a.a.unblended,a.b5.frontCW,N,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const Ty=a.bW([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class im{constructor(l){const h=new a.bY;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const _=new a.bp;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(h,Ty.members),this.indexBuffer=l.createIndexBuffer(_),this.segments=a.bm.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ey=a.bW([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class om{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15}}class Vb{constructor(l){this.colorModeAlphaBlendedWriteRGB=new a.a([a.bZ,a.b_,a.bZ,a.b_],a.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new a.a([a.bZ,a.b$,a.bZ,a.b$],a.C.transparent,[!1,!1,!1,!0]),this.params=new om,this.allocatedStarsCount=0,l.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1}),l.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01})}update(l){const h=l.context;if(!this.atmosphereBuffer||this.allocatedStarsCount!==this.params.starsCount){this.atmosphereBuffer=new im(h),this.allocatedStarsCount=this.params.starsCount;const _=100,x=200,S=function(N){const V=a.c2(30),G=[];for(let W=0;W<N;++W){const X=2*Math.PI*V(),K=Math.acos(1-2*V())-.5*Math.PI;G.push(a.v.fromValues(Math.cos(K)*Math.cos(X),Math.cos(K)*Math.sin(X),Math.sin(K)))}return G}(this.allocatedStarsCount),C=a.c2(300),A=new a.c0,z=new a.bp;let O=0;for(let N=0;N<S.length;++N){const V=a.v.scale([],S[N],200),G=Math.max(0,1+.01*_*(1*C()-.5)),W=Math.max(0,1+.01*x*(1*C()-.5));A.emplaceBack(V[0],V[1],V[2],-1,-1,G,W),A.emplaceBack(V[0],V[1],V[2],1,-1,G,W),A.emplaceBack(V[0],V[1],V[2],1,1,G,W),A.emplaceBack(V[0],V[1],V[2],-1,1,G,W),z.emplaceBack(O+0,O+1,O+2),z.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=h.createVertexBuffer(A,Ey.members),this.starsIdx=h.createIndexBuffer(z),this.starsSegments=a.bm.simpleSegment(0,0,A.length,z.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(l,h){const _=l.context,x=_.gl,S=l.transform,C=new a.b4(x.LEQUAL,a.b4.ReadOnly,[0,1]),A=a.ao(S.zoom),z=h.properties.get("color").toArray01(),O=h.properties.get("high-color").toArray01(),N=h.properties.get("space-color").toArray01PremultipliedAlpha(),V=5e-4,G=a.c1(h.properties.get("horizon-blend"),0,1,V,.25),W=a.bb(l,_,S)&&G===V?S.worldSize/(2*Math.PI*1.025)-1:S.globeRadius,X=l.frameCounter/1e3%1,K=a.v.length(S.globeCenterInViewSpace),Y=Math.sqrt(Math.pow(K,2)-Math.pow(W,2)),Z=Math.acos(Y/K),ae=pe=>{const ge=S.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];pe&&ge.push("ALPHA_PASS");const ne=l.getOrCreateProgram("globeAtmosphere",{defines:ge}),ce=((we,ve,Se,qe,De,Ne,Me,We,Fe,Xe,he,ke)=>({u_frustum_tl:we,u_frustum_tr:ve,u_frustum_br:Se,u_frustum_bl:qe,u_horizon:De,u_transition:Ne,u_fadeout_range:Me,u_color:We,u_high_color:Fe,u_space_color:Xe,u_temporal_offset:he,u_horizon_angle:ke}))(S.frustumCorners.TL,S.frustumCorners.TR,S.frustumCorners.BR,S.frustumCorners.BL,S.frustumCorners.horizon,A,G,z,O,N,X,Z);l.uploadCommonUniforms(_,ne);const _e=this.atmosphereBuffer;_e&&ne.draw(l,x.TRIANGLES,C,a.b6.disabled,pe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,a.b5.backCW,ce,pe?"atmosphere_glow_alpha":"atmosphere_glow",_e.vertexBuffer,_e.indexBuffer,_e.segments)};ae(!1),ae(!0)}drawStars(l,h){const _=a.c(h.properties.get("star-intensity"),0,1);if(_===0)return;const x=l.context,S=x.gl,C=l.transform,A=l.getOrCreateProgram("stars"),z=a.q.identity([]);a.q.rotateX(z,z,-C._pitch),a.q.rotateZ(z,z,-C.angle),a.q.rotateX(z,z,a.d(C._center.lat)),a.q.rotateY(z,z,-a.d(C._center.lng));const O=a.m.fromQuat(new Float32Array(16),z),N=a.m.multiply([],C.starsProjMatrix,O),V=a.bx.fromMat4([],O),G=a.bx.invert([],V),W=[0,1,0];a.v.transformMat3(W,W,G),a.v.scale(W,W,this.params.sizeMultiplier);const X=[1,0,0];a.v.transformMat3(X,X,G),a.v.scale(X,X,this.params.sizeMultiplier);const K=(Y=W,Z=X,ae=_,{u_matrix:Float32Array.from(N),u_up:Y,u_right:Z,u_intensity_multiplier:ae});var Y,Z,ae;l.uploadCommonUniforms(x,A),this.starsVx&&this.starsIdx&&A.draw(l,S.TRIANGLES,a.b4.disabled,a.b6.disabled,this.colorModeAlphaBlendedWriteRGB,a.b5.disabled,K,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Od(m,l){const h=[...m],_=l.cameraWorldSizeForFog/l.worldSize,x=a.m.identity([]);return a.m.scale(x,x,[_,_,1]),a.m.multiply(h,x,h),a.m.multiply(h,l.worldToFogMatrix,h),h}function sm(m,l,h,_){const x=h.material,S=_.context,{baseColorTexture:C,metallicRoughnessTexture:A}=x.pbrMetallicRoughness,{normalTexture:z,occlusionTexture:O,emissionTexture:N}=x;function V(G,W,X){if(G&&(m.push(W),S.activeTexture.set(S.gl.TEXTURE0+X),G.gfxTexture)){const{minFilter:K,magFilter:Y,wrapS:Z,wrapT:ae}=G.sampler;G.gfxTexture.bindExtraParam(K,Y,Z,ae)}}V(C,"HAS_TEXTURE_u_baseColorTexture",Ci.BaseColor),V(A,"HAS_TEXTURE_u_metallicRoughnessTexture",Ci.MetallicRoughness),V(z,"HAS_TEXTURE_u_normalTexture",Ci.Normal),V(O,"HAS_TEXTURE_u_occlusionTexture",Ci.Occlusion),V(N,"HAS_TEXTURE_u_emissionTexture",Ci.Emission),h.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),l.push(h.texcoordBuffer)),h.colorBuffer&&(m.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),l.push(h.colorBuffer)),h.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),l.push(h.normalBuffer)),h.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),l.push(h.pbrBuffer)),x.alphaMode!=="OPAQUE"&&x.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),x.defined||m.push("DIFFUSE_SHADED"),m.push("USE_STANDARD_DERIVATIVES")}function ql(m,l,h,_,x,S){const C=h.paint.get("model-opacity"),A=l.context,z=new a.b4(l.context.gl.LEQUAL,a.b4.ReadWrite,l.depthRangeFor3D),O=l.transform,N=m.mesh,V=N.material,G=V.pbrMetallicRoughness,W=l.style.fog;let X;X=l.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:a.m.multiply([],_.zScaleMatrix,m.nodeModelMatrix),a.m.multiply(X,_.negCameraPosMatrix,X);const K=a.m.invert([],X);a.m.transpose(K,K);const Y=h.paint.get("model-emissive-strength").constantOr(0),Z=Yu(new Float32Array(m.worldViewProjection),new Float32Array(X),new Float32Array(K),l,C,G.baseColorFactor,V.emissiveFactor,G.metallicFactor,G.roughnessFactor,V,Y,h),ae={defines:[]},pe=[];sm(ae.defines,pe,N,l);const ge=l.shadowRenderer;ge&&(ge.useNormalOffset=!1);let ne=null;if(W){const we=Od(m.nodeModelMatrix,l.transform);if(ne=new Float32Array(we),O.projection.name!=="globe"){const ve=N.aabb.min,Se=N.aabb.max,[qe,De]=W.getOpacityForBounds(we,ve[0],ve[1],Se[0],Se[1]);ae.overrideFog=qe>=Ui||De>=Ui}}const ce=Vl(l,h.paint.get("model-cutoff-fade-range"));ce.shouldRenderCutoff&&ae.defines.push("RENDER_CUTOFF");const _e=l.getOrCreateProgram("model",ae);l.uploadCommonUniforms(A,_e,null,ne,ce),l.renderPass!=="shadow"&&ge&&ge.setupShadowsFromMatrix(m.nodeModelMatrix,_e),_e.draw(l,A.gl.TRIANGLES,z,x,S,N.material.doubleSided?a.b5.disabled:a.b5.backCCW,Z,h.id,N.vertexBuffer,N.indexBuffer,N.segments,h.paint,l.transform.zoom,void 0,pe)}function Cy(m,l,h,_,x,S,C){let A;A=m.projection.name==="globe"?a.c5(h,m):[...h],a.m.multiply(A,A,l.matrix);const z=a.m.multiply([],_,A);if(l.meshes)for(const O of l.meshes){if(O.material.alphaMode!=="BLEND"){C.push({mesh:O,depth:0,modelIndex:x,worldViewProjection:z,nodeModelMatrix:A});continue}const N=a.v.transformMat4([],O.centroid,z);N[2]>0&&S.push({mesh:O,depth:N[2],modelIndex:x,worldViewProjection:z,nodeModelMatrix:A})}if(l.children)for(const O of l.children)Cy(m,O,h,_,x,S,C)}function Qu(m,l,h,_){const x=h.shadowRenderer;if(!x)return;const S=x.getShadowPassDepthMode(),C=x.getShadowPassColorMode(),A=x.calculateShadowPassMatrixFromMatrix(l),z=Id(A);h.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,S,a.b6.disabled,C,a.b5.backCCW,z,_.id,m.vertexBuffer,m.indexBuffer,m.segments,_.paint,h.transform.zoom,void 0,void 0)}function $b(m,l,h){const _=l.updateZoomBasedPaintProperties(),x=function(S,C,A){let z,O,N,V=S.terrain?S.terrain.exaggeration():0;if(S.terrain&&V>0){const G=S.terrain,W=G.findDEMTileFor(A);W&&W.dem?z=a.c7.create(G,A,W):V=0}if(V===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),V===C.validForExaggeration&&(V===0||z&&z._demTile&&z._demTile.tileID===C.validForDEMTile.id&&z._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const G in C.instancesPerModel){const W=C.instancesPerModel[G];for(let X=0;X<W.instancedDataArray.length;++X){const K=(z?V*z.getElevationAt(0|W.instancedDataArray.float32[16*X],0|W.instancedDataArray.float32[16*X+1],!0,!0):0)+W.instancesEvaluatedElevation[X];W.instancedDataArray.float32[16*X+6]=K,O=O?Math.min(C.terrainElevationMin,K):K,N=N?Math.max(C.terrainElevationMax,K):K}}return C.terrainElevationMin=O||0,C.terrainElevationMax=N||0,C.validForExaggeration=V,C.validForDEMTile=z&&z._demTile?{id:z._demTile.tileID,timestamp:z._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,l,h);(_||x)&&(l.uploaded=!1,l.upload(m.context))}const Wo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.c3([0,0,0],[a.J,a.J,0])};function Ub(m,l){const h=1<<m.canonical.z,_=l.getFreeCameraOptions().position,x=l.elevation,S=m.canonical.x/h,C=(m.canonical.x+1)/h,A=m.canonical.y/h,z=(m.canonical.y+1)/h;let O=l._centerAltitude;if(x){const W=x.getMinMaxForTile(m);W&&W.max>O&&(O=W.max)}const N=a.c(_.x,S,C)-_.x,V=a.c(_.y,A,z)-_.y,G=a.b(O,l.center.lat)-_.z;return l._zoomFromMercatorZ(Math.sqrt(N*N+V*V+G*G))}function eh(m,l,h,_,x,S,C){const A=m.context,z=m.renderPass==="shadow",O=m.shadowRenderer,N=z&&O?O.getShadowPassDepthMode():new a.b4(A.gl.LEQUAL,a.b4.ReadWrite,m.depthRangeFor3D),V=m.isTileAffectedByFog(S);if(h.meshes)for(const G of h.meshes){const W=["MODEL_POSITION_ON_GPU"],X=[];let K,Y,Z;_.instancedDataArray.length>20&&W.push("INSTANCED_ARRAYS");const ae=Vl(m,l.paint.get("model-cutoff-fade-range"));if(ae.shouldRenderCutoff&&W.push("RENDER_CUTOFF"),z&&O)K=m.getOrCreateProgram("modelDepth",{defines:W}),Y=Id(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(h.matrix)),Z=O.getShadowPassColorMode();else{sm(W,X,G,m),K=m.getOrCreateProgram("model",{defines:W,overrideFog:V});const ge=G.material,ne=ge.pbrMetallicRoughness,ce=l.paint.get("model-opacity"),_e=l.paint.get("model-emissive-strength").constantOr(0);Y=Yu(S.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),m,ce,ne.baseColorFactor,ge.emissiveFactor,ne.metallicFactor,ne.roughnessFactor,ge,_e,l,x),O&&(C.shadowUniformsInitialized?K.setShadowUniformValues(A,O.getShadowUniformValues()):(O.setupShadows(S.toUnwrapped(),K,"model-tile",S.overscaledZ),C.shadowUniformsInitialized=!0)),Z=ae.shouldRenderCutoff||ce<1||ge.alphaMode!=="OPAQUE"?a.a.alphaBlended:a.a.unblended}m.uploadCommonUniforms(A,K,S.toUnwrapped(),null,ae);const pe=G.material.doubleSided?a.b5.disabled:a.b5.backCCW;if(_.instancedDataArray.length>20)X.push(_.instancedDataBuffer),K.draw(m,A.gl.TRIANGLES,N,a.b6.disabled,Z,pe,Y,l.id,G.vertexBuffer,G.indexBuffer,G.segments,l.paint,m.transform.zoom,void 0,X,_.instancedDataArray.length);else{const ge=z?"u_instance":"u_normal_matrix";for(let ne=0;ne<_.instancedDataArray.length;++ne)Y[ge]=new Float32Array(_.instancedDataArray.arrayBuffer,64*ne,16),K.draw(m,A.gl.TRIANGLES,N,a.b6.disabled,Z,pe,Y,l.id,G.vertexBuffer,G.indexBuffer,G.segments,l.paint,m.transform.zoom,void 0,X)}}if(h.children)for(const G of h.children)eh(m,l,G,_,x,S,C)}const Gb=[1,-1,1];function My(m,l,h,_){if(!h.modelManager)return!0;const x=h.modelManager;if(!h.shadowRenderer)return!0;const S=h.shadowRenderer,C=l.aabb;let A=!0,z=m.maxHeight;if(z===0){let N=0;for(const V in m.instancesPerModel){const G=x.getModel(V,_);G?N=Math.max(N,Math.max(Math.max(G.aabb.max[0],G.aabb.max[1]),G.aabb.max[2])):A=!1}z=m.maxScale*N*1.41+m.maxVerticalOffset,A&&(m.maxHeight=z)}C.max[2]=z,C.min[2]+=m.terrainElevationMin,C.max[2]+=m.terrainElevationMax,a.v.transformMat4(C.min,C.min,l.tileMatrix),a.v.transformMat4(C.max,C.max,l.tileMatrix);const O=C.intersects(S.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=O===2),O===0}class Ay{}class Wc{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(l,h,_){{const V=this._storage.get(h.id);if(V)return V.lastUsedFrameIdx=l,V.buf}const x=_.gl,S=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),C=new ArrayBuffer(S),A=new Int16Array(C);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const z=new a.c9;for(let V=0;V<S/2;V+=3){const G=A[V],W=A[V+1],X=A[V+2];z.emplaceBack(G,W),z.emplaceBack(W,X),z.emplaceBack(X,G)}const O=_.bindVertexArrayOES.current,N=new Ay;return N.buf=new a.I(_,z),N.lastUsedFrameIdx=l,this._storage.set(h.id,N),_.bindVertexArrayOES.set(O),N.buf}update(l){for(const[h,_]of this._storage)l-_.lastUsedFrameIdx>30&&(_.buf.destroy(),this._storage.delete(h))}destroy(){for(const[l,h]of this._storage)h.buf.destroy(),this._storage.delete(l)}}class ky{registerParameter(l,h,_,x,S){}registerButton(l,h,_){}}const am={symbol:function(m,l,h,_,x){if(m.renderPass!=="translucent")return;const S=a.b6.disabled,C=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(A,z,O,N,V,G,W){const X=z.transform,K=V==="map",Y=G==="map";for(const Z of A){const ae=N.getTile(Z),pe=ae.getBucket(O);if(!pe||!pe.text||!pe.text.segments.get().length)continue;const ge=a.i(pe.textSizeData,X.zoom),ne=ds(Z,pe.getProjection(),X),ce=X.calculatePixelsToTileUnitsMatrix(ae),_e=si(ne,ae.tileID.canonical,Y,K,X,pe.getProjection(),ce),we=pe.hasIconTextFit()&&pe.hasIconData();if(ge){const ve=Math.pow(2,X.zoom-ae.tileID.overscaledZ);Jp(pe,K,Y,W,a.bG,X,_e,Z,ve,ge,we)}}}(_,m,h,l,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x),h.paint.get("icon-opacity").constantOr(1)!==0&&ur(m,l,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),h.paint.get("icon-color-saturation"),S,C),h.paint.get("text-opacity").constantOr(1)!==0&&ur(m,l,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),h.paint.get("icon-color-saturation"),S,C),l.map.showCollisionBoxes&&(Kp(m,l,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Kp(m,l,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,h,_){if(m.renderPass!=="translucent")return;const x=h.paint.get("circle-opacity"),S=h.paint.get("circle-stroke-width"),C=h.paint.get("circle-stroke-opacity"),A=h.layout.get("circle-sort-key").constantOr(1)!==void 0,z=h.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(S.constantOr(1)===0||C.constantOr(1)===0))return;const O=m.context,N=O.gl,V=m.transform,G=m.depthModeForSublayer(0,a.b4.ReadOnly),W=a.b6.disabled,X=m.colorModeForDrapableLayerRenderPass(z),K=V.projection.name==="globe",Y=[a.E(V.center.lng),a.H(V.center.lat)],Z=[];for(let pe=0;pe<_.length;pe++){const ge=_[pe],ne=l.getTile(ge),ce=ne.getBucket(h);if(!ce||ce.projection.name!==V.projection.name)continue;const _e=ce.programConfigurations.get(h.id),we=a.bH(h),ve=m.isTileAffectedByFog(ge);K&&we.push("PROJECTION_GLOBE_VIEW");const Se=m.getOrCreateProgram("circle",{config:_e,defines:we,overrideFog:ve}),qe=ce.layoutVertexBuffer,De=ce.globeExtVertexBuffer,Ne=ce.indexBuffer,Me=V.projection.createInversionMatrix(V,ge.canonical),We={programConfiguration:_e,program:Se,layoutVertexBuffer:qe,globeExtVertexBuffer:De,indexBuffer:Ne,uniformValues:a.bI(m,ge,ne,Me,Y,h),tile:ne};if(A){const Fe=ce.segments.get();for(const Xe of Fe)Z.push({segments:new a.bm([Xe]),sortKey:Xe.sortKey,state:We})}else Z.push({segments:ce.segments,sortKey:0,state:We})}A&&Z.sort((pe,ge)=>pe.sortKey-ge.sortKey);const ae={useDepthForOcclusion:V.depthOcclusionForSymbolsAndCircles};for(const pe of Z){const{programConfiguration:ge,program:ne,layoutVertexBuffer:ce,globeExtVertexBuffer:_e,indexBuffer:we,uniformValues:ve,tile:Se}=pe.state,qe=pe.segments;m.terrain&&m.terrain.setupElevationDraw(Se,ne,ae),m.uploadCommonUniforms(O,ne,Se.tileID.toUnwrapped()),ne.draw(m,N.TRIANGLES,G,W,X,a.b5.disabled,ve,h.id,ce,we,qe,h.paint,V.zoom,ge,[_e])}},heatmap:function(m,l,h,_){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const x=m.context,S=x.gl,C=a.b6.disabled,A=new a.a([S.ONE,S.ONE,S.ONE,S.ONE],a.C.transparent,[!0,!0,!0,!0]);(function(W,X,K,Y){const Z=W.gl,ae=X.width*Y,pe=X.height*Y;W.activeTexture.set(Z.TEXTURE1),W.viewport.set([0,0,ae,pe]);let ge=K.heatmapFbo;if(!ge||ge&&(ge.width!==ae||ge.height!==pe)){ge&&ge.destroy();const ne=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,ne),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),ge=K.heatmapFbo=W.createFramebuffer(ae,pe,!0,null),function(ce,_e,we,ve,Se,qe){const De=ce.gl;De.texImage2D(De.TEXTURE_2D,0,ce.extRenderToTextureHalfFloat?De.RGBA16F:De.RGBA,Se,qe,0,De.RGBA,ce.extRenderToTextureHalfFloat?De.HALF_FLOAT:De.UNSIGNED_BYTE,null),ve.colorAttachment.set(we)}(W,0,ne,ge,ae,pe)}else Z.bindTexture(Z.TEXTURE_2D,ge.colorAttachment.get()),W.bindFramebuffer.set(ge.framebuffer)})(x,m,h,m.transform.projection.name==="globe"?.5:.25),x.clear({color:a.C.transparent});const z=m.transform,O=z.projection.name==="globe",N=O?["PROJECTION_GLOBE_VIEW"]:[],V=O?a.b5.frontCCW:a.b5.disabled,G=[a.E(z.center.lng),a.H(z.center.lat)];for(let W=0;W<_.length;W++){const X=_[W];if(l.hasRenderableParent(X))continue;const K=l.getTile(X),Y=K.getBucket(h);if(!Y||Y.projection.name!==z.projection.name)continue;const Z=m.isTileAffectedByFog(X),ae=Y.programConfigurations.get(h.id),pe=m.getOrCreateProgram("heatmap",{config:ae,defines:N,overrideFog:Z}),{zoom:ge}=m.transform;m.terrain&&m.terrain.setupElevationDraw(K,pe),m.uploadCommonUniforms(x,pe,X.toUnwrapped());const ne=z.projection.createInversionMatrix(z,X.canonical);pe.draw(m,S.TRIANGLES,a.b4.disabled,C,A,V,my(m,X,K,ne,G,ge,h.paint.get("heatmap-intensity")),h.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,h.paint,m.transform.zoom,ae,O?[Y.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,S){const C=x.context,A=C.gl,z=S.heatmapFbo;if(!z)return;C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,z.colorAttachment.get()),C.activeTexture.set(A.TEXTURE1);let O=S.colorRampTexture;O||(O=S.colorRampTexture=new a.a9(C,S.colorRamp,A.RGBA)),O.bind(A.LINEAR,A.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,A.TRIANGLES,a.b4.disabled,a.b6.disabled,x.colorModeForRenderPass(),a.b5.disabled,((N,V,G,W)=>({u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}))(0,S),S.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,S.paint,x.transform.zoom)}(m,h))},line:function(m,l,h,_){if(m.renderPass!=="translucent")return;const x=h.paint.get("line-opacity"),S=h.paint.get("line-width");if(x.constantOr(1)===0||S.constantOr(1)===0)return;const C=h.paint.get("line-emissive-strength"),A=m.depthModeForSublayer(0,a.b4.ReadOnly),z=m.colorModeForDrapableLayerRenderPass(C),O=m.terrain&&m.terrain.renderingToTexture?1:a.a4.devicePixelRatio,N=h.paint.get("line-dasharray"),V=N.constantOr(1),G=h.layout.get("line-cap"),W=h.paint.get("line-pattern"),X=W.constantOr(1),K=h.paint.get("line-pattern").constantOr(1),Y=h.paint.get("line-opacity").constantOr(1)!==1;let Z=!K&&Y;const ae=h.paint.get("line-gradient"),pe=X?"linePattern":"line",ge=m.context,ne=ge.gl,ce=a.bJ(h);m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Z=!1);for(const _e of _){const we=l.getTile(_e);if(X&&!we.patternsLoaded())continue;const ve=we.getBucket(h);if(!ve)continue;m.prepareDrawTile();const Se=ve.programConfigurations.get(h.id),qe=m.isTileAffectedByFog(_e),De=m.getOrCreateProgram(pe,{config:Se,defines:ce,overrideFog:qe}),Ne=W.constantOr(null);if(Ne&&we.imageAtlas){const Ke=we.imageAtlas.patternPositions[Ne.toString()];Ke&&Se.setConstantPatternPositions(Ke)}const Me=N.constantOr(null),We=G.constantOr(null);if(!X&&Me&&We&&we.lineAtlas){const Ke=we.lineAtlas.getDash(Me,We);Ke&&Se.setConstantPatternPositions(Ke)}let[Fe,Xe]=h.paint.get("line-trim-offset");(We==="round"||We==="square")&&Fe!==Xe&&(Fe===0&&(Fe-=1),Xe===1&&(Xe+=1));const he=m.terrain?_e.projMatrix:null,ke=X?a.bK(m,we,h,he,O):a.bL(m,we,h,he,ve.lineClipsArray.length,O,[Fe,Xe]);if(ae){const Ke=ve.gradients[h.id];let Mt=Ke.texture;if(h.gradientVersion!==Ke.version){let wt=256;if(h.stepInterpolant){const Ft=l.getSource().maxzoom,St=_e.canonical.z===Ft?Math.ceil(1<<m.transform.maxZoom-_e.canonical.z):1;wt=a.c(a.bM(ve.maxLineLength/a.J*1024*St),256,ge.maxTextureSize)}Ke.gradient=a.bN({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:Ke.gradient||void 0,clips:ve.lineClipsArray}),Ke.texture?Ke.texture.update(Ke.gradient):Ke.texture=new a.a9(ge,Ke.gradient,ne.RGBA),Ke.version=h.gradientVersion,Mt=Ke.texture}ge.activeTexture.set(ne.TEXTURE1),Mt.bind(h.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}V&&(ge.activeTexture.set(ne.TEXTURE0),we.lineAtlasTexture&&we.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),Se.updatePaintBuffers()),X&&(ge.activeTexture.set(ne.TEXTURE0),we.imageAtlasTexture&&we.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Se.updatePaintBuffers()),m.uploadCommonUniforms(ge,De,_e.toUnwrapped());const nt=Ke=>{De.draw(m,ne.TRIANGLES,A,Ke,z,a.b5.disabled,ke,h.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,h.paint,m.transform.zoom,Se,[ve.layoutVertexBuffer2])};if(Z){const Ke=m.stencilModeForClipping(_e).ref;Ke===0&&m.terrain&&ge.clear({stencil:0});const Mt={func:ne.EQUAL,mask:255};ke.u_alpha_discard_threshold=.8,nt(new a.b6(Mt,Ke,255,ne.KEEP,ne.KEEP,ne.INVERT)),ke.u_alpha_discard_threshold=0,nt(new a.b6(Mt,Ke,255,ne.KEEP,ne.KEEP,ne.KEEP))}else nt(m.stencilModeForClipping(_e))}Z&&(m.resetStencilClippingMasks(),m.terrain&&ge.clear({stencil:0}))},fill:function(m,l,h,_){const x=h.paint.get("fill-color"),S=h.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const C=h.paint.get("fill-emissive-strength"),A=m.colorModeForDrapableLayerRenderPass(C),z=h.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!z.constantOr(1)&&x.constantOr(a.C.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===O){const N=m.depthModeForSublayer(1,m.renderPass==="opaque"?a.b4.ReadWrite:a.b4.ReadOnly);Ku(m,l,h,_,N,A,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){const N=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,a.b4.ReadOnly);Ku(m,l,h,_,N,A,!0)}},"fill-extrusion":function(m,l,h,_){const x=h.paint.get("fill-extrusion-opacity"),S=m.context,C=S.gl,A=m.terrain,z=A&&A.renderingToTexture;if(x===0)return;const O=m.conflationActive&&m.layerUsedInConflation(h,l.getSource());if(O&&function(N,V,G,W){for(const X of W){const K=V.getTile(X).getBucket(G);K&&(K.updateReplacement(X,N.replacementSource),K.uploadCentroid(N.context))}}(m,l,h,_),A||O)for(const N of _){const V=l.getTile(N).getBucket(h);V&&vy(m.context,l,N,V,h,A,O)}if(m.renderPass==="shadow"&&m.shadowRenderer){const N=m.shadowRenderer;if(A&&x<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.am)return;const V=N.getShadowPassDepthMode(),G=N.getShadowPassColorMode();Ju(m,l,h,_,V,a.b6.disabled,G,O)}else if(m.renderPass==="translucent"){const N=!h.paint.get("fill-extrusion-pattern").constantOr(1),V=h.paint.get("fill-extrusion-color").constantOr(a.C.white);if(!z&&V.a!==0){const G=new a.b4(m.context.gl.LEQUAL,a.b4.ReadWrite,m.depthRangeFor3D);x===1&&N?Ju(m,l,h,_,G,a.b6.disabled,a.a.unblended,O):(Ju(m,l,h,_,G,a.b6.disabled,a.a.disabled,O),Ju(m,l,h,_,G,m.stencilModeFor3D(),m.colorModeForRenderPass(),O),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&N&&(!A&&m.transform.projection.name!=="globe"||z)){const G=h.paint.get("fill-extrusion-opacity"),W=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),X=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),K=h.paint.get("fill-extrusion-flood-light-intensity"),Y=h.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Z=W>0&&X>0,ae=K>0,pe=(ne,ce,_e)=>(1-_e)*ne+_e*ce,ge=ne=>{const ce=m.depthModeForSublayer(1,a.b4.ReadOnly,C.LEQUAL,!0),_e=h.paint.get(ne?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),we=pe(.1,3,_e),ve=m._showOverdrawInspector;if(!ve){const Se=new a.b6({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),qe=new a.a([C.ONE,C.ONE,C.ONE,C.ONE],a.C.transparent,[!1,!1,!1,!0],C.MIN);Gl(m,l,h,_,ce,Se,qe,a.b5.disabled,ne,"sdf",G,W,X,K,Y,we,O,!1)}{const Se=ve?a.b6.disabled:new a.b6({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),qe=ve?m.colorModeForRenderPass():new a.a([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],a.C.transparent,[!0,!0,!0,!0]);Gl(m,l,h,_,ce,Se,qe,a.b5.disabled,ne,"color",G,W,X,K,Y,we,O,!1)}};if(z){const ne=(ce,_e,we)=>{const ve=m.depthModeForSublayer(1,a.b4.ReadOnly,C.LEQUAL,!1),Se=h.paint.get(ce?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),qe=pe(.1,3,Se);{const De=new a.a([C.ONE,C.ONE,C.ONE,C.ONE],a.C.transparent,[!1,!1,!1,!0]);Gl(m,l,h,_,ve,a.b6.disabled,De,a.b5.disabled,ce,"clear",G,W,X,K,Y,qe,O,_e)}{const De=new a.b6({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),Ne=new a.a([C.ONE,C.ONE,C.ONE,C.ONE],a.C.transparent,[!1,!1,!1,!0],C.MIN);Gl(m,l,h,_,ve,De,Ne,a.b5.disabled,ce,"sdf",G,W,X,K,Y,qe,O,_e)}{const De=ce?C.ZERO:C.ONE_MINUS_DST_ALPHA,Ne=new a.b6({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),Me=new a.a([De,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],a.C.transparent,[!0,!0,!0,!0]);Gl(m,l,h,_,ve,Ne,Me,a.b5.disabled,ce,"color",G,W,X,K,Y,qe,O,_e)}{const De=new a.a([C.ONE,C.ONE,C.ONE,ce?C.ZERO:C.ONE],a.C.transparent,[!1,!1,!1,!0],ce?C.FUNC_ADD:C.MAX);Gl(m,l,h,_,ve,a.b6.disabled,De,a.b5.disabled,ce,"clear",G,W,X,K,Y,qe,O,_e,we)}};if(Z||ae){let ce;if(m.prepareDrawTile(),A){const _e=A.drapeBufferSize[0],we=A.drapeBufferSize[1];ce=A.framebufferCopyTexture,ce&&(!ce||ce.size[0]===_e&&ce.size[1]===we)||(ce&&ce.destroy(),ce=A.framebufferCopyTexture=new a.a9(S,new a.a5({width:_e,height:we}),C.RGBA)),ce.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexImage2D(C.TEXTURE_2D,0,C.RGBA,0,0,_e,we,0)}Z&&ne(!0,!1,ce),ae&&ne(!1,!0,ce)}}else Z&&ge(!0),ae&&ge(!1)}}},hillshade:function(m,l,h,_){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const x=m.context,S=m.terrain&&m.terrain.renderingToTexture,[C,A]=m.renderPass!=="translucent"||S?[{},_]:m.stencilConfigForOverlap(_);for(const z of A){const O=l.getTile(z);if(O.needsHillshadePrepare&&m.renderPass==="offscreen")zb(m,O,h);else if(m.renderPass==="translucent"){const N=m.depthModeForSublayer(0,a.b4.ReadOnly),V=h.paint.get("hillshade-emissive-strength"),G=m.colorModeForDrapableLayerRenderPass(V),W=S&&m.terrain?m.terrain.stencilModeForRTTOverlap(z):C[z.overscaledZ];Ib(m,z,O,h,N,W,G)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,h,_,x,S){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const C=m.context,A=C.gl,z=l.getSource(),O=function(_e,we,ve){const Se=_e.paint.get("raster-color"),qe=[],De=_e.paint.get("raster-resampling"),Ne=_e.paint.get("raster-color-mix"),Me=_e.paint.get("raster-color-range"),We=[Ne[0],Ne[1],Ne[2],0],Fe=Ne[3],Xe=De==="nearest"?ve.NEAREST:ve.LINEAR;if(Se&&qe.push("RASTER_COLOR"),Se){we.activeTexture.set(ve.TEXTURE2);let he=_e.colorRampTexture;he||(he=_e.colorRampTexture=new a.a9(we,_e.colorRamp,ve.RGBA)),he.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}return{mix:We,range:Me,offset:Fe,defines:qe,resampling:Xe}}(h,C,A),N=O.defines,V=m.transform.projection.name==="globe";let G=!1;if(z instanceof a.aK&&!_.length){if(!V)return;if(z.onNorthPole)G=!0,N.push("GLOBE_POLES");else{if(!z.onSouthPole)return;G=!0,N.push("GLOBE_POLES")}}const W=h.paint.get("raster-emissive-strength"),X=m.colorModeForDrapableLayerRenderPass(W),K=m.terrain&&m.terrain.renderingToTexture,Y=z instanceof a.aK&&h.paint.get("raster-elevation")!==0,Z=!m.options.moving,ae=h.paint.get("raster-resampling")==="nearest"?A.NEAREST:A.LINEAR;if(G){const _e=l.getSource();if(!(_e instanceof a.aK))return;const we=_e.texture;if(!we)return;const ve=m.globeSharedBuffers;if(!ve)return;const Se=new a.b4(A.LEQUAL,a.b4.ReadWrite,m.depthRangeFor3D),qe=Float32Array.from(m.transform.expandedFarZProjMatrix);let De=a.bj(0,0,m.transform);const Ne=Float32Array.from(a.bh(a.bi(new a.t(0,0,0)))),Me={opacity:1,mix:0};m.terrain&&m.terrain.prepareDrawTile(),C.activeTexture.set(A.TEXTURE0),we.bind(ae,A.CLAMP_TO_EDGE),C.activeTexture.set(A.TEXTURE1),we.bind(ae,A.CLAMP_TO_EDGE),we.useMipmap&&C.extTextureFilterAnisotropic&&m.transform.pitch>20&&A.texParameterf(A.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);const[We,Fe,Xe,he]=ve.getPoleBuffers(0,!0);let ke;_e.onNorthPole?(ke=We,m.renderDefaultNorthPole=!1):(De=a.m.scale(a.m.create(),De,[1,-1,1]),ke=Fe,m.renderDefaultSouthPole=!1);const nt=((Mt,wt,Ft,St,Vt,$t,Rt,Dt,Sr,tr,rn,Gr)=>gy(Mt,wt,Ft,new Float32Array(16),new Float32Array(9),[0,0],0,[0,0],[0,0,0,0],1,St,Vt,[0,0],Rt,2,Sr,tr,rn,1,0,Gr))(qe,Ne,De,Me,h,0,h.paint.get("raster-elevation"),0,O.mix,O.offset,O.range,W),Ke=m.getOrCreateProgram("raster",{defines:O.defines});return m.uploadCommonUniforms(C,Ke,null),void Ke.draw(m,A.TRIANGLES,Se,a.b6.disabled,X,a.b5.disabled,nt,h.id,ke,Xe,he)}if(!_.length)return;const[pe,ge]=z instanceof a.aK||K?[{},_]:m.stencilConfigForOverlap(_),ne=ge[ge.length-1].overscaledZ,ce=Y&&V;ce&&O.defines.push("PROJECTION_GLOBE_VIEW"),Y&&O.defines.push("RENDER_CUTOFF");for(const _e of ge){const we=_e.toUnwrapped(),ve=l.getTile(_e);if(K&&(!ve||!ve.hasData())||!ve.texture)continue;let Se,qe;K?(Se=a.b4.disabled,qe=_e.projMatrix):Y?(Se=new a.b4(A.LEQUAL,a.b4.ReadWrite,m.depthRangeFor3D),qe=V?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(we,Z)):(Se=m.depthModeForSublayer(_e.overscaledZ-ne,h.paint.get("raster-opacity")===1?a.b4.ReadWrite:a.b4.ReadOnly,A.LESS),qe=m.transform.calculateProjMatrix(we,Z));const De=m.terrain&&K?m.terrain.stencilModeForRTTOverlap(_e):pe[_e.overscaledZ],Ne=S?0:h.paint.get("raster-fade-duration");ve.registerFadeDuration(Ne);const Me=l.findLoadedParent(_e,0),We=Sd(ve,Me,l,m.transform,Ne);let Fe,Xe;m.terrain&&m.terrain.prepareDrawTile(),C.activeTexture.set(A.TEXTURE0),ve.texture&&ve.texture.bind(ae,A.CLAMP_TO_EDGE),C.activeTexture.set(A.TEXTURE1),Me?(Me.texture&&Me.texture.bind(ae,A.CLAMP_TO_EDGE),Fe=Math.pow(2,Me.tileID.overscaledZ-ve.tileID.overscaledZ),Xe=[ve.tileID.canonical.x*Fe%1,ve.tileID.canonical.y*Fe%1]):ve.texture&&ve.texture.bind(ae,A.CLAMP_TO_EDGE),ve.texture&&ve.texture.useMipmap&&C.extTextureFilterAnisotropic&&m.transform.pitch>20&&A.texParameterf(A.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);const he=m.transform;let ke;const nt=Y?jb(he):[0,0,0,0];let Ke,Mt,wt,Ft,St;ce&&z instanceof a.aK&&z.coordinates.length>3?(Ke=Float32Array.from(a.bh(a.bi(new a.t(0,0,0)))),Mt=Float32Array.from(he.globeMatrix),wt=Float32Array.from(a.bc(he)),Ft=[a.E(he.center.lng),a.H(he.center.lat)],ke=z.elevatedGlobePerspectiveTransform,St=z.elevatedGlobeGridMatrix||new Float32Array(9)):(ke=z instanceof a.aK?z.perspectiveTransform:[0,0],Ke=new Float32Array(16),Mt=new Float32Array(9),wt=new Float32Array(16),Ft=[0,0],St=new Float32Array(9));const Vt=gy(qe,Ke,Mt,wt,St,Xe||[0,0],a.ao(m.transform.zoom),Ft,nt,Fe||1,We,h,ke,Y?h.paint.get("raster-elevation"):0,2,O.mix,O.offset,O.range,1,0,W),$t=m.isTileAffectedByFog(_e),Rt=m.getOrCreateProgram("raster",{defines:O.defines,overrideFog:$t});if(m.uploadCommonUniforms(C,Rt,we),z instanceof a.aK){const Dt=z.elevatedGlobeVertexBuffer,Sr=z.elevatedGlobeIndexBuffer;if(K||!V)z.boundsBuffer&&z.boundsSegments&&Rt.draw(m,A.TRIANGLES,Se,a.b6.disabled,X,a.b5.disabled,Vt,h.id,z.boundsBuffer,m.quadTriangleIndexBuffer,z.boundsSegments);else if(Dt&&Sr){const tr=he.zoom<=a.Z?z.elevatedGlobeSegments:z.getSegmentsForLongitude(he.center.lng);tr&&(Rt.draw(m,A.TRIANGLES,Se,a.b6.disabled,X,a.b5.backCW,Vt,h.id,Dt,Sr,tr),Rt.draw(m,A.TRIANGLES,Se,a.b6.disabled,X,a.b5.frontCW,Vt,h.id,Dt,Sr,tr))}}else{const{tileBoundsBuffer:Dt,tileBoundsIndexBuffer:Sr,tileBoundsSegments:tr}=m.getTileBoundsBuffers(ve);Rt.draw(m,A.TRIANGLES,Se,De,X,a.b5.disabled,Vt,h.id,Dt,Sr,tr)}}m.resetStencilClippingMasks()},background:function(m,l,h,_){const x=h.paint.get("background-color"),S=h.paint.get("background-opacity"),C=h.paint.get("background-emissive-strength");if(S===0)return;const A=m.context,z=A.gl,O=m.transform,N=O.tileSize,V=h.paint.get("background-pattern");if(m.isPatternMissing(V,h.scope))return;const G=!V&&x.a===1&&S===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==G)return;const W=a.b6.disabled,X=m.depthModeForSublayer(0,G==="opaque"?a.b4.ReadWrite:a.b4.ReadOnly),K=m.colorModeForDrapableLayerRenderPass(C),Y=V?"backgroundPattern":"background";let Z,ae=_;ae||(Z=m.getBackgroundTiles(),ae=Object.values(Z).map(pe=>pe.tileID)),V&&(A.activeTexture.set(z.TEXTURE0),m.imageManager.bind(m.context,h.scope));for(const pe of ae){const ge=m.isTileAffectedByFog(pe),ne=m.getOrCreateProgram(Y,{overrideFog:ge}),ce=pe.toUnwrapped(),_e=_?pe.projMatrix:m.transform.calculateProjMatrix(ce);m.prepareDrawTile();const we=l?l.getTile(pe):Z?Z[pe.key]:new a.bt(pe,N,O.zoom,m),ve=V?Vc(_e,C,S,m,V,h.scope,{tileID:pe,tileSize:N}):Yp(_e,C,S,x);m.uploadCommonUniforms(A,ne,ce);const{tileBoundsBuffer:Se,tileBoundsIndexBuffer:qe,tileBoundsSegments:De}=m.getTileBoundsBuffers(we);ne.draw(m,z.TRIANGLES,X,W,K,a.b5.disabled,ve,h.id,Se,qe,De)}},sky:function(m,l,h){const _=m._atmosphere?a.ao(m.transform.zoom):1,x=h.paint.get("sky-opacity")*_;if(x===0)return;const S=m.context,C=h.paint.get("sky-type"),A=new a.b4(S.gl.LEQUAL,a.b4.ReadOnly,[0,1]),z=m.frameCounter/1e3%1;C==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(O,N,V,G){const W=O.context,X=W.gl;let K=N.skyboxFbo;if(!K){K=N.skyboxFbo=W.createFramebuffer(32,32,!0,null),N.skyboxGeometry=new ms(W),N.skyboxTexture=W.gl.createTexture(),X.bindTexture(X.TEXTURE_CUBE_MAP,N.skyboxTexture),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR);for(let pe=0;pe<6;++pe)X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0,X.RGBA,32,32,0,X.RGBA,X.UNSIGNED_BYTE,null)}W.bindFramebuffer.set(K.framebuffer),W.viewport.set([0,0,32,32]);const Y=N.getCenter(O,!0),Z=O.getOrCreateProgram("skyboxCapture"),ae=new Float64Array(16);a.m.identity(ae),a.m.rotateY(ae,ae,.5*-Math.PI),Qa(O,N,Z,ae,Y,0),a.m.identity(ae),a.m.rotateY(ae,ae,.5*Math.PI),Qa(O,N,Z,ae,Y,1),a.m.identity(ae),a.m.rotateX(ae,ae,.5*-Math.PI),Qa(O,N,Z,ae,Y,2),a.m.identity(ae),a.m.rotateX(ae,ae,.5*Math.PI),Qa(O,N,Z,ae,Y,3),a.m.identity(ae),Qa(O,N,Z,ae,Y,4),a.m.identity(ae),a.m.rotateY(ae,ae,Math.PI),Qa(O,N,Z,ae,Y,5),W.viewport.set([0,0,O.width,O.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(O,N,V,G,W){const X=O.context,K=X.gl,Y=O.transform,Z=O.getOrCreateProgram("skybox");X.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_CUBE_MAP,N.skyboxTexture);const ae=((pe,ge,ne,ce,_e)=>({u_matrix:pe,u_sun_direction:ge,u_cubemap:0,u_opacity:ce,u_temporal_offset:_e}))(Y.skyboxMatrix,N.getCenter(O,!1),0,G,W);O.uploadCommonUniforms(X,Z),Z.draw(O,K.TRIANGLES,V,a.b6.disabled,O.colorModeForRenderPass(),a.b5.backCW,ae,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(m,h,A,x,z):C==="gradient"&&m.renderPass==="sky"&&function(O,N,V,G,W){const X=O.context,K=X.gl,Y=O.transform,Z=O.getOrCreateProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new ms(X)),X.activeTexture.set(K.TEXTURE0);let ae=N.colorRampTexture;ae||(ae=N.colorRampTexture=new a.a9(X,N.colorRamp,K.RGBA)),ae.bind(K.LINEAR,K.CLAMP_TO_EDGE);const pe=((ge,ne,ce,_e,we)=>({u_matrix:ge,u_color_ramp:0,u_center_direction:ne,u_radius:a.d(ce),u_opacity:_e,u_temporal_offset:we}))(Y.skyboxMatrix,N.getCenter(O,!1),N.paint.get("sky-gradient-radius"),G,W);O.uploadCommonUniforms(X,Z),Z.draw(O,K.TRIANGLES,V,a.b6.disabled,O.colorModeForRenderPass(),a.b5.backCW,pe,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(m,h,A,x,z)},debug:function(m,l,h,_,x){for(let S=0;S<h.length;S++)if(x){const z=new a.C(_.r*.8,_.g*.8,_.b*.8,1);Wl(m,l,h[S],_,-1,-1),Wl(m,l,h[S],_,-1,1),Wl(m,l,h[S],_,1,1),Wl(m,l,h[S],_,1,-1),Wl(m,l,h[S],z,0,0)}else Wl(m,l,h[S],_,0,0)},custom:function(m,l,h,_){const x=m.context,S=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isLayerDraped(l)){if(m.renderPass==="offscreen"){const C=S.prerender;if(C){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const A=m.transform.pointMerc;C.call(S,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),a.ao(m.transform.zoom),[A.x,A.y],m.transform.pixelsPerMeterRatio)}else C.call(S,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const A=S.renderToTile;if(A){const z=_[0].canonical,O=new a.M(z.x+_[0].wrap*(1<<z.z),z.y,z.z);x.setDepthMode(a.b4.disabled),x.setStencilMode(a.b6.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),A.call(S,x.gl,O),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(a.b6.disabled);const C=S.renderingMode==="3d"?new a.b4(m.context.gl.LEQUAL,a.b4.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,a.b4.ReadOnly);if(x.setDepthMode(C),m.transform.projection.name==="globe"){const A=m.transform.pointMerc;S.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),a.ao(m.transform.zoom),[A.x,A.y],m.transform.pixelsPerMeterRatio)}else S.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else a.X("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,l,h,_){if(m.renderPass==="opaque")return;const x=h.paint.get("model-opacity");if(x===0)return;const S=h.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!S||m.terrain&&x<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof a.am))return;const C=m.shadowRenderer,A=h.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,A||(C.enabled=!1));const z=()=>{C&&(C.useNormalOffset=!0,A||(C.enabled=!0))},O=l.getSource();if(m.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(Z,ae,pe,ge){const ne=Z.transform;if(ne.projection.name!=="mercator")return void a.X(`Drawing 3D models for ${ne.projection.name} projection is not yet implemented`);const ce=ne.getFreeCameraOptions().position;if(!Z.modelManager)return;const _e=Z.modelManager,we=Z.shadowRenderer;if(!pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ve=pe._unevaluatedLayout._values["model-id"],Se={...pe.layout.get("model-id").parameters};for(const qe of ge){const De=ae.getTile(qe).getBucket(pe);if(!De||De.projection.name!==ne.projection.name)continue;const Ne=Ub(qe,ne);Se.zoom=Ne;const Me=ve.possiblyEvaluate(Se);if($b(Z,De,qe),Wo.shadowUniformsInitialized=!1,Wo.useSingleShadowCascade=!!we&&we.getMaxCascadeForTile(qe.toUnwrapped())===0,Z.renderPass==="shadow"&&we){if(Z.currentShadowCascade===1&&De.isInsideFirstShadowMapFrustum)continue;const Xe=ne.calculatePosMatrix(qe.toUnwrapped(),ne.worldSize);if(Wo.tileMatrix.set(Xe),Wo.shadowTileMatrix=Float32Array.from(we.calculateShadowPassMatrixFromMatrix(Xe)),Wo.aabb.min.fill(0),Wo.aabb.max[0]=Wo.aabb.max[1]=a.J,Wo.aabb.max[2]=0,My(De,Wo,Z,pe.scope))continue}const We=1<<qe.canonical.z,Fe=[((ce.x-qe.wrap)*We-qe.canonical.x)*a.J,(ce.y*We-qe.canonical.y)*a.J,ce.z*We*a.J];for(let Xe in De.instancesPerModel){const he=De.instancesPerModel[Xe];he.features.length>0&&(Xe=Me.evaluate(he.features[0].feature,{}));const ke=_e.getModel(Xe,pe.scope);if(ke&&ke.uploaded)for(const nt of ke.nodes)eh(Z,pe,nt,he,Fe,qe,Wo)}}}(m,l,h,_),void z();if(!O.loaded())return;if(O.type==="batched-model")return function(Z,ae,pe,ge){const ne=Z.context,ce=Z.transform,_e=Z.style.fog,we=Z.shadowRenderer;if(ce.projection.name!=="mercator")return void a.X(`Drawing 3D landmark models for ${ce.projection.name} projection is not yet implemented`);const ve=Z.transform.getFreeCameraOptions().position,Se=a.v.scale([],[ve.x,ve.y,ve.z],Z.transform.worldSize);a.v.negate(Se,Se);const qe=a.m.identity([]),De=a.c4(ce.center.lat,ce.zoom),Ne=a.m.fromScaling([],[1,1,1/De]);a.m.translate(qe,qe,Se);const Me=pe.paint.get("model-opacity"),We=new a.b4(ne.gl.LEQUAL,a.b4.ReadWrite,Z.depthRangeFor3D),Fe=new a.b4(ne.gl.LEQUAL,a.b4.ReadOnly,Z.depthRangeFor3D),Xe=function(he,ke){for(const nt of ge){const Ke=ae.getTile(nt).getBucket(pe);if(!Ke||!Ke.uploaded)continue;let Mt=!1;we&&(Mt=we.getMaxCascadeForTile(nt.toUnwrapped())===0);const wt=ce.calculatePosMatrix(nt.toUnwrapped(),ce.worldSize),Ft=Ke.modelTraits;for(const St of Ke.getNodesInfo()){if(St.hiddenByReplacement||!St.node.meshes)continue;const Vt=St.node,$t=Z.renderPass==="light-beam",Rt=[...wt],Dt=St.evaluatedScale;let Sr=0;Z.terrain&&Vt.elevation&&(Sr=Vt.elevation*Z.terrain.exaggeration()),a.m.translate(Rt,Rt,[(Vt.anchor?Vt.anchor[0]:0)*(Dt[0]-1),(Vt.anchor?Vt.anchor[1]:0)*(Dt[1]-1),Sr]),Dt!==a.c6&&a.m.scale(Rt,Rt,Dt),a.m.multiply(Rt,Rt,Vt.matrix);const tr=a.m.multiply([],Ne,Rt);a.m.multiply(tr,qe,tr);const rn=a.m.invert([],tr);a.m.transpose(rn,rn),a.m.scale(rn,rn,Gb);const Gr=a.m.multiply([],ce.expandedFarZProjMatrix,Rt),Ki=Ft&a.c8.HasMapboxMeshFeatures,Ho=Ki?0:St.evaluatedRMEA[0][2];for(let Nr=0;Nr<Vt.meshes.length;++Nr){const Cr=Vt.meshes[Nr],Ir=Nr===Vt.lightMeshIndex;if(Ir){if(!$t&&!Z.terrain&&Z.shadowRenderer){Z.currentLayer<Z.firstLightBeamLayer&&(Z.firstLightBeamLayer=Z.currentLayer);continue}}else if($t)continue;const un={defines:[]},pi=[];sm(un.defines,pi,Cr,Z),Ki||un.defines.push("DIFFUSE_SHADED"),Mt&&un.defines.push("SHADOWS_SINGLE_CASCADE");const an=Z.renderPass==="shadow";if(an){Qu(Cr,Rt,Z,pe);continue}let Oi=null;if(_e){const _s=Od(Rt,Z.transform);if(Oi=new Float32Array(_s),ce.projection.name!=="globe"){const Zr=Cr.aabb.min,ys=Cr.aabb.max,[Us,ya]=_e.getOpacityForBounds(_s,Zr[0],Zr[1],ys[0],ys[1]);un.overrideFog=Us>=Ui||ya>=Ui}}const Ji=Z.getOrCreateProgram("model",un);!an&&we&&(we.useNormalOffset=!!Cr.normalBuffer,we.setupShadowsFromMatrix(Rt,Ji,we.useNormalOffset)),Z.uploadCommonUniforms(ne,Ji,nt.toUnwrapped(),Oi);const Bi=Cr.material,Zo=Bi.pbrMetallicRoughness;Zo.metallicFactor=.9,Zo.roughnessFactor=.5;const _a=Yu(new Float32Array(Gr),new Float32Array(tr),new Float32Array(rn),Z,Me,Zo.baseColorFactor,Bi.emissiveFactor,Zo.metallicFactor,Zo.roughnessFactor,Bi,Ho,pe);Ji.draw(Z,ne.gl.TRIANGLES,ke&&!Ir?We:Fe,a.b6.disabled,he?Ir||Me<1||St.hasTranslucentParts?a.a.alphaBlended:a.a.unblended:a.a.disabled,a.b5.backCCW,_a,pe.id,Cr.vertexBuffer,Cr.indexBuffer,Cr.segments,pe.paint,Z.transform.zoom,void 0,pi)}}}};(function(he,ke,nt,Ke){const Mt=he.terrain?he.terrain.exaggeration():0,wt=he.transform.zoom;for(const Ft of Ke){const St=ke.getTile(Ft).getBucket(nt);St&&(he.conflationActive&&St.updateReplacement(Ft,he.replacementSource),St.evaluateScale(he,nt),he.terrain&&Mt>0&&St.elevationUpdate(he.terrain,Mt,Ft,nt.source),St.needsReEvaluation(he,wt,nt)&&St.evaluate(nt))}})(Z,ae,pe,ge),Me===1?Xe(!0,!0):(Xe(!1,!0),Xe(!0,!1))}(m,l,h,_),void z();const N=O.getModels(),V=[],G=m.transform.getFreeCameraOptions().position,W=a.v.scale([],[G.x,G.y,G.z],m.transform.worldSize);a.v.negate(W,W);const X=[],K=[];let Y=0;for(const Z of N){const ae=h.paint.get("model-rotation").constantOr(null),pe=h.paint.get("model-scale").constantOr(null),ge=h.paint.get("model-translation").constantOr(null);Z.computeModelMatrix(m,ae,pe,ge,!0,!0,!1);const ne=a.m.identity([]),ce=a.c4(Z.position.lat,m.transform.zoom),_e=a.m.fromScaling([],[1,1,1/ce]);a.m.translate(ne,ne,W),V.push({zScaleMatrix:_e,negCameraPosMatrix:ne});for(const we of Z.nodes)Cy(m.transform,we,Z.matrix,m.transform.expandedFarZProjMatrix,Y,X,K);Y++}if(X.sort((Z,ae)=>ae.depth-Z.depth),m.renderPass!=="shadow"){if(x===1)for(const Z of K)ql(Z,m,h,V[Z.modelIndex],a.b6.disabled,m.colorModeForRenderPass());else{for(const Z of K)ql(Z,m,h,V[Z.modelIndex],a.b6.disabled,a.a.disabled);for(const Z of K)ql(Z,m,h,V[Z.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const Z of X)ql(Z,m,h,V[Z.modelIndex],a.b6.disabled,m.colorModeForRenderPass());z()}else{for(const Z of K)Qu(Z.mesh,Z.nodeModelMatrix,m,h);for(const Z of X)Qu(Z.mesh,Z.nodeModelMatrix,m,h);z()}}},Py={modelUpload:function(m,l,h){const _=l.getSource();if(!_.loaded())return;if(_.type==="vector"||_.type==="geojson")return void(m.modelManager&&m.modelManager.upload(m,h));if(_.type==="batched-model")return;const x=_.getModels();for(const S of x)S.upload(m.context)}};class Wb{constructor(l,h,_,x){this.context=new In(l,h),this.transform=_,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=x,this._debugParams={showTerrainProxyTiles:!1},x.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=a.bq.maxUnderzooming+a.bq.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.ca,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new cm(this),this._wireframeDebugCache=new Wc,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(l,h){const _=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Wp(this,l));const x=this._terrain;this.transform.elevation=_?x:null,x.update(l,this.transform,h),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(l){const h=l.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,x]=h.getFovAdjustedRange(this.transform._fov);if(_>x)return void(this.transform.fogCullDistSq=null);const S=_+.78*(x-_);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(l,h){if(this.width=l*a.a4.devicePixelRatio,this.height=h*a.a4.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._mergedLayers[_].resize()}setup(){const l=this.context,h=new a.bo;h.emplaceBack(0,0),h.emplaceBack(a.J,0),h.emplaceBack(0,a.J),h.emplaceBack(a.J,a.J),this.tileExtentBuffer=l.createVertexBuffer(h,a.bl.members),this.tileExtentSegments=a.bm.simpleSegment(0,0,4,2);const _=new a.bo;_.emplaceBack(0,0),_.emplaceBack(a.J,0),_.emplaceBack(0,a.J),_.emplaceBack(a.J,a.J),this.debugBuffer=l.createVertexBuffer(_,a.bl.members),this.debugSegments=a.bm.simpleSegment(0,0,4,5);const x=new a.bo;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(x,a.bl.members),this.viewportSegments=a.bm.simpleSegment(0,0,4,2);const S=new a.cb;S.emplaceBack(0,0,0,0),S.emplaceBack(a.J,0,a.J,0),S.emplaceBack(0,a.J,0,a.J),S.emplaceBack(a.J,a.J,a.J,a.J),this.mercatorBoundsBuffer=l.createVertexBuffer(S,a.cc.members),this.mercatorBoundsSegments=a.bm.simpleSegment(0,0,4,2);const C=new a.bp;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(C);const A=new a.cd;for(const O of[0,1,3,2,0])A.emplaceBack(O);this.debugIndexBuffer=l.createIndexBuffer(A),this.emptyTexture=new a.a9(l,new a.a5({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=a.m.create();const z=this.context.gl;this.stencilClearMode=new a.b6({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,l.TRIANGLES,a.b4.disabled,this.stencilClearMode,a.a.disabled,a.b5.disabled,wd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,h,_){if(!h||this.currentStencilSource===h.id||!l.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let A=!1;for(const z of _)if(this._tileClippingMaskIDs[z.key]===void 0){A=!0;break}if(!A)return}this.currentStencilSource=h.id;const x=this.context,S=x.gl;this.nextStencilID+_.length>256&&this.clearStencil(),x.setColorMode(a.a.disabled),x.setDepthMode(a.b4.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of _){const z=h.getTile(A),O=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,{tileBoundsBuffer:N,tileBoundsIndexBuffer:V,tileBoundsSegments:G}=this.getTileBoundsBuffers(z);C.draw(this,S.TRIANGLES,a.b4.disabled,new a.b6({func:S.ALWAYS,mask:0},O,255,S.KEEP,S.KEEP,S.REPLACE),a.a.disabled,a.b5.disabled,wd(A.projMatrix),"$clipping",N,V,G)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,h=this.context.gl;return new a.b6({func:h.NOTEQUAL,mask:255},l,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const h=this.context.gl;return new a.b6({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(l){const h=this.context.gl,_=l.sort((C,A)=>A.overscaledZ-C.overscaledZ),x=_[_.length-1].overscaledZ,S=_[0].overscaledZ-x+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const C={};for(let A=0;A<S;A++)C[A+x]=new a.b6({func:h.GEQUAL,mask:255},A+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=S,[C,_]}return[{[x]:a.b6.disabled},_]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new a.a([l.CONSTANT_COLOR,l.ONE,l.CONSTANT_COLOR,l.ONE],new a.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.a.unblended:a.a.alphaBlended}colorModeForDrapableLayerRenderPass(l){const h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new a.a([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new a.C(0,0,0,l===void 0?0:l),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(l,h,_,x=!1){if(!this.opaquePassEnabledForLayer()&&!x)return a.b4.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new a.b4(_||this.context.gl.LEQUAL,h,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,h){this._wireframeDebugCache.update(this.frameCounter),this.style=l,this.options=h;const _=this.style._mergedLayers,x=this.style.order,S=x.map(ne=>_[ne]),C=this.style._mergedSourceCaches;this.imageManager=l.imageManager,this.modelManager=l.modelManager,this.symbolFadeChange=l.placement.symbolFadeChange(a.a4.now()),this.imageManager.beginFrame();let A=0,z=!1;for(const ne in C){const ce=C[ne];ce.used&&(ce.prepare(this.context),ce.getSource().usedInConflation&&++A)}const O={},N={},V={},G={},W={};for(const ne in C){const ce=C[ne];O[ne]=ce.getVisibleCoordinates(),N[ne]=O[ne].slice().reverse(),V[ne]=ce.getVisibleCoordinates(!0).reverse(),G[ne]=ce.getShadowCasterCoordinates(),W[ne]=ce.sortCoordinatesByDistance(O[ne])}const X=ne=>{const ce=this.style.getLayerSourceCache(ne);return ce&&ce.used?ce.getSource():null};if(A){const ne=[];for(const ce of S)this.layerUsedInConflation(ce,X(ce))&&ne.push(ce);if(ne&&ne.length>1){const ce=[];for(const _e of ne){const we=this.style.getLayerSourceCache(_e);we&&we.used&&we.getSource().usedInConflation&&ce.push({layer:_e.fqid,cache:we})}this.replacementSource.setSources(ce),z=!0}}z||this.replacementSource.clear(),this.conflationActive=z,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const ne of S){const ce=ne.cutoffRange();if(this.longestCutoffRange=Math.max(ce,this.longestCutoffRange),ce>0){const _e=X(ne);_e&&(this.minCutoffZoom=Math.max(_e.minzoom,this.minCutoffZoom)),ne.minzoom&&(this.minCutoffZoom=Math.max(ne.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let ne=0;ne<S.length;ne++)if(S[ne].is3D()){this.opaquePassCutoff=ne;break}const K=this.style&&this.style.fog;K?(this._fogVisible=K.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=K.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(V),this.opaquePassCutoff=0);const Y=this._shadowRenderer;if(Y){Y.updateShadowParameters(this.transform,this.style.directionalLight);for(const ne in C)for(const ce of O[ne]){let _e={min:0,max:0};this.terrain&&(_e=this.terrain.getMinMaxForTile(ce)||_e),Y.addShadowReceiver(ce.toUnwrapped(),_e.min,_e.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.ce(this.context));for(const ne of S){if(ne.isHidden(this.transform.zoom))continue;const ce=l.getLayerSourceCache(ne);this.uploadLayer(this,ne,ce)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Vb(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!a.cf(this.context.gl))return;this.renderPass="offscreen";for(const ne of S){const ce=l.getLayerSourceCache(ne);if(!ne.hasOffscreenPass()||ne.isHidden(this.transform.zoom))continue;const _e=ce?N[ce.id]:void 0;(ne.type==="custom"||ne.type==="raster"||ne.isSky()||_e&&_e.length)&&this.renderLayer(this,ce,ne,_e)}this.depthRangeFor3D=[0,1-(S.length+2)*this.numSublayers*this.depthEpsilon];const Z=this.terrain;Z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&Z.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,G)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const ae=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),pe=(()=>{if(h.showOverdrawInspector)return a.C.black;if(this.style.fog&&this.transform.projection.supportsFog&&!ae){const ne=this.style.fog.properties.get("color").toArray01();return new a.C(...ne)}if(this.style.fog&&this.transform.projection.supportsFog&&ae){const ne=this.style.fog.properties.get("space-color").toArray01();return new a.C(...ne)}return a.C.transparent})();if(this.context.clear({color:pe,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ae&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const ne=S[this.currentLayer],ce=l.getLayerSourceCache(ne);if(ne.isSky())continue;const _e=ce?(ne.is3D()?W:N)[ce.id]:void 0;this._renderTileClippingMasks(ne,ce,_e),this.renderLayer(this,ce,ne,_e)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&ae&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.ao(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const ne=S[this.currentLayer],ce=l.getLayerSourceCache(ne);ne.isSky()&&this.renderLayer(this,ce,ne,ce?N[ce.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ge=0;for(Y&&(ge=Y.getShadowCastingLayerCount());this.currentLayer<x.length;){const ne=S[this.currentLayer],ce=l.getLayerSourceCache(ne);if(ne.isSky()){++this.currentLayer;continue}if(Z&&this.style.isLayerDraped(ne)){if(ne.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=Z.renderBatch(this.currentLayer);continue}let _e;if(ce&&(_e=(ne.type==="symbol"?V:ne.is3D()?W:N)[ce.id]),this._renderTileClippingMasks(ne,ce,ce?O[ce.id]:void 0),this.renderLayer(this,ce,ne,_e),!Z&&Y&&ge>0&&ne.hasShadowPass()&&--ge==0&&(Y.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const we=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=we;this.currentLayer++){const ve=S[this.currentLayer];if(!ve.hasLightBeamPass())continue;const Se=l.getLayerSourceCache(ve);this.renderLayer(this,Se,ve,Se?N[Se.id]:void 0)}this.currentLayer=we,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ne=null;S.forEach(ce=>{const _e=l.getLayerSourceCache(ce);_e&&!ce.isHidden(this.transform.zoom)&&_e.getVisibleCoordinates().length&&(!ne||ne.getSource().maxzoom<_e.getSource().maxzoom)&&(ne=_e)}),ne&&this.options.showTileBoundaries&&am.debug(this,ne,ne.getVisibleCoordinates(),a.C.red,!1)}this.terrain&&this._debugParams.showTerrainProxyTiles&&am.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.C(1,.8,.1,1),!0),this.options.showPadding&&function(ne){const ce=ne.transform.padding;wy(ne,ne.transform.height-(ce.top||0),3,em),wy(ne,ce.bottom||0,3,tm),Gc(ne,ce.left||0,3,rm),Gc(ne,ne.transform.width-(ce.right||0),3,nm);const _e=ne.transform.centerPoint;(function(we,ve,Se,qe){Ja(we,ve-1,Se-10,2,20,qe),Ja(we,ve-10,Se-1,20,2,qe)})(ne,_e.x,ne.transform.height-_e.y,by)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),z||(this.conflationActive=!1)}uploadLayer(l,h,_){this.gpuTimingStart(h),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(h.type)||l.terrain&&h.type==="custom")&&Py[`${h.type}Upload`]&&Py[`${h.type}Upload`](l,_,h.scope),this.gpuTimingEnd()}renderLayer(l,h,_,x){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||_.type==="model"||_.type==="raster"||x&&x.length)&&(this.id=_.id,this.gpuTimingStart(_),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(_.type)||l.terrain&&_.type==="custom")&&am[_.type](l,h,_,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,_=this.context.gl;let x=this.gpuTimers[l.id];x||(x=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:_.createQuery()}),x.calls++,_.beginQuery(h.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,h=this.context.gl,_=h.createQuery();this.deferredRenderGpuTimeQueries.push(_),h.beginQuery(l.TIME_ELAPSED_EXT,_)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const h={};for(const _ in l){const x=l[_],S=this.context.extTimerQuery,C=S.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;S.deleteQueryEXT(x.query),h[_]=C}return h}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery,_=this.context.gl;let x=0;for(const S of l)x+=h.getQueryParameter(S,_.QUERY_RESULT)/1e6,h.deleteQueryEXT(S);return x}translatePosMatrix(l,h,_,x,S){if(!_[0]&&!_[1])return l;const C=S?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(C){const O=Math.sin(C),N=Math.cos(C);_=[_[0]*N-_[1]*O,_[0]*O+_[1]*N]}const A=[S?_[0]:a.ay(h,_[0],this.transform.zoom),S?_[1]:a.ay(h,_[1],this.transform.zoom),0],z=new Float32Array(16);return a.m.translate(z,l,A),z}saveTileTexture(l){const h=l.size[0],_=this._tileTextures[h];_?_.push(l):this._tileTextures[h]=[l]}getTileTexture(l){const h=this._tileTextures[l];return h&&h.length>0?h.pop():null}isPatternMissing(l,h){return l===null||l!==void 0&&!this.imageManager.getPattern(l.toString(),h)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(l,h,_){const x=_===void 0?this.terrain&&this.terrain.renderingToTexture:_,S=this.terrain&&this.terrain.exaggeration()===0,C=[];return this.style&&this.style.enable3dLights()&&(l==="globeRaster"||l==="terrainRaster"?(C.push("LIGHTING_3D_MODE"),C.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||C.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||C.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?C.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):C.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(C.push("TERRAIN"),this.linearFloatFilteringSupported()&&C.push("TERRAIN_DEM_FLOAT_FORMAT"),S&&C.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&C.push("GLOBE"),!this._fogVisible||x||h!==void 0&&!h||C.push("FOG","FOG_DITHERING"),x&&C.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&C.push("OVERDRAW_INSPECTOR"),C}getOrCreateProgram(l,h){this.cache=this.cache||{};const _=h&&h.defines||[],x=h&&h.config,S=this.currentGlobalDefines(l,h&&h.overrideFog,h&&h.overrideRtt).concat(_),C=Cd.cacheKey(Fp[l],l,S,x);return this.cache[C]||(this.cache[C]=new Cd(this.context,l,Fp[l],x,yy[l],S)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.a9(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(l,h){if(this.style.enable3dLights()){const _=this.style.directionalLight,x=this.style.ambientLight;if(_&&x){const S=((C,A)=>{const z=C.properties.get("direction"),O=C.properties.get("color").toArray01(),N=C.properties.get("intensity"),V=A.properties.get("color").toArray01(),G=A.properties.get("intensity"),W=[z.x,z.y,z.z],X=a.bv(V,G),K=a.bv(O,N);return{u_lighting_ambient_color:X,u_lighting_directional_dir:W,u_lighting_directional_color:K,u_ground_radiance:fy(W,K,X)}})(_,x);h.setLightsUniformValues(l,S)}}}uploadCommonUniforms(l,h,_,x,S){if(this.uploadCommonLightUniforms(l,h),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const A=C.getOpacity(this.transform.pitch),z=((O,N,V,G,W,X,K,Y,Z,ae,pe,ge)=>{const ne=O.transform,ce=N.properties.get("color").toArray01();ce[3]=G;const _e=O.frameCounter/1e3%1,[we,ve]=N.properties.get("vertical-range");return{u_fog_matrix:V?ne.calculateFogTileMatrix(V):ge||O.identityMat,u_fog_range:N.getFovAdjustedRange(ne._fov),u_fog_color:ce,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(we,ve),ve],u_fog_temporal_offset:_e,u_frustum_tl:W,u_frustum_tr:X,u_frustum_br:K,u_frustum_bl:Y,u_globe_pos:Z,u_globe_radius:ae,u_viewport:pe,u_globe_transition:a.ao(ne.zoom),u_is_globe:+(ne.projection.name==="globe")}})(this,C,_,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.a4.devicePixelRatio,this.transform.height*a.a4.devicePixelRatio],x);h.setFogUniformValues(l,z)}S&&h.setCutoffUniformValues(l,S.uniformValues)}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,h=l.createTexture();return l.bindTexture(l.TEXTURE_2D,h),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const l=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const x of _)h[x.key]=l[x.key]||new a.bt(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(l,h){return!(!l.is3D()||l.minzoom&&l.minzoom>this.transform.zoom||l.sourceLayer!=="building"&&(!h||h.type!=="batched-model"))}isTileAffectedByFog(l){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[l.key];return h||(this._cachedTileFogOpacities[l.key]=h=this.style.fog.getOpacityForTile(l)),h[0]>=Ui||h[1]>=Ui}}const yo={cascadeCount:2,shadowMapResolution:2048};class qb{constructor(l,h){this.aabb=l,this.lastCascade=h}}class lm{add(l,h){const _=this.receivers[l.key];_!==void 0?(_.aabb.min[0]=Math.min(_.aabb.min[0],h.min[0]),_.aabb.min[1]=Math.min(_.aabb.min[1],h.min[1]),_.aabb.min[2]=Math.min(_.aabb.min[2],h.min[2]),_.aabb.max[0]=Math.max(_.aabb.max[0],h.max[0]),_.aabb.max[1]=Math.max(_.aabb.max[1],h.max[1]),_.aabb.max[2]=Math.max(_.aabb.max[2],h.max[2])):this.receivers[l.key]=new qb(h,null)}clear(){this.receivers={}}get(l){return this.receivers[l.key]}computeRequiredCascades(l,h,_){const x=a.c3.fromPoints(l.points);let S=0;for(const C in this.receivers){const A=this.receivers[C];if(!A||!x.intersectsAabb(A.aabb))continue;A.aabb.min=x.closestPoint(A.aabb.min),A.aabb.max=x.closestPoint(A.aabb.max);const z=A.aabb.getCorners();for(let O=0;O<_.length;O++){let N=!0;for(const V of z){const G=[V[0]*h,V[1]*h,V[2]];if(a.v.transformMat4(G,G,_[O].matrix),G[0]<-1||G[0]>1||G[1]<-1||G[1]>1){N=!1;break}}if(A.lastCascade=O,S=Math.max(S,O),N)break}}return S+1}}class cm{constructor(l){this.painter=l,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new lm,this._depthMode=new a.b4(l.context.gl.LEQUAL,a.b4.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,l.tp.registerParameter(yo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),l.tp.registerParameter(yo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const l of this._cascades)l.texture.destroy(),l.framebuffer.destroy();this._cascades=[]}updateShadowParameters(l,h){const _=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const x=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||x<=0||(this._shadowLayerCount=_.style.order.reduce((X,K)=>{const Y=_.style._mergedLayers[K];return X+(Y.hasShadowPass()&&!Y.isHidden(l.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const S=_.context,C=yo.shadowMapResolution,A=yo.shadowMapResolution;if(this._cascades.length===0||yo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let X=0;X<yo.cascadeCount;++X){const K=_._shadowMapDebug,Y=S.gl,Z=S.createFramebuffer(C,A,K,"texture"),ae=new a.a9(S,{width:C,height:A,data:null},Y.DEPTH_COMPONENT);if(Z.depthAttachment.set(ae.texture),K){const pe=new a.a9(S,{width:C,height:A,data:null},Y.RGBA);Z.colorAttachment.set(pe.texture)}this._cascades.push({framebuffer:Z,texture:ae,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.F,scale:0})}}this.shadowDirection=um(h);let z=0;if(l.elevation){const X=l.elevation,K=[1e4,-1e4];X.visibleDemTiles.filter(Y=>Y.dem).forEach(Y=>{const Z=Y.dem.tree;K[0]=Math.min(K[0],Z.minimums[0]),K[1]=Math.max(K[1],Z.maximums[0])}),K[0]!==1e4&&(z=(K[1]-K[0])*X.exaggeration())}const O=1.5*l.cameraToCenterDistance,N=3*O,V=new Float64Array(16);for(let X=0;X<this._cascades.length;++X){const K=this._cascades[X];let Y=l.height/50,Z=1;yo.cascadeCount===1?Z=N:X===0?Z=O:(Y=O,Z=N);const[ae,pe]=Iy(l,this.shadowDirection,Y,Z,yo.shadowMapResolution,z);K.scale=l.scale,K.matrix=ae,K.boundingSphereRadius=pe,a.m.invert(V,K.matrix),K.frustum=a.F.fromInvProjectionMatrix(V,1,0,!0),K.far=Z}const G=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[G].far,this._cascades[G].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/yo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=yo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ci.ShadowMap0,this._uniformValues.u_shadowmap_1=Ci.ShadowMap0+1,this._groundShadowTiles=_.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const W=_.transform.elevation;for(const X of this._groundShadowTiles){let K={min:0,max:0};if(W){const Y=W.getMinMaxForTile(X);Y&&(K=Y)}this.addShadowReceiver(X.toUnwrapped(),K.min,K.max)}}get enabled(){return this._enabled}set enabled(l){this._enabled=l}drawShadowPass(l,h){if(!this._enabled)return;const _=this.painter,x=_.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(_.transform.getFrustum(0),_.transform.worldSize,this._cascades),x.viewport.set([0,0,yo.shadowMapResolution,yo.shadowMapResolution]);for(let S=0;S<this._numCascadesToRender;++S){_.currentShadowCascade=S,x.bindFramebuffer.set(this._cascades[S].framebuffer.framebuffer),x.clear({color:a.C.white,depth:1});for(const C of l.order){const A=l._mergedLayers[C];if(!A.hasShadowPass()||A.isHidden(_.transform.zoom))continue;const z=l.getLayerSourceCache(A),O=z?h[z.id]:void 0;(A.type==="model"||O&&O.length)&&_.renderLayer(_,z,A,O)}}_.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const l=this.painter,h=l.style,_=l.context,x=h.directionalLight,S=h.ambientLight;if(!x||!S)return;const C=[],A=Vl(l,l.longestCutoffRange);A.shouldRenderCutoff&&C.push("RENDER_CUTOFF");const z=Bd(x,S),O=new a.b4(_.gl.LEQUAL,a.b4.ReadOnly,l.depthRangeFor3D);for(const N of this._groundShadowTiles){const V=N.toUnwrapped(),G=l.isTileAffectedByFog(N),W=l.getOrCreateProgram("groundShadow",{defines:C,overrideFog:G});this.setupShadows(V,W),l.uploadCommonUniforms(_,W,V,null,A);const X={u_matrix:l.transform.calculateProjMatrix(V),u_ground_shadow_factor:z};W.draw(l,_.gl.TRIANGLES,O,a.b6.disabled,a.a.multiply,a.b5.disabled,X,"ground_shadow",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments,{},l.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?a.a.unblended:a.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(l){const h=this.painter.transform,_=h.calculatePosMatrix(l,h.worldSize);return a.m.multiply(_,this._cascades[this.painter.currentShadowCascade].matrix,_),Float32Array.from(_)}calculateShadowPassMatrixFromMatrix(l){return a.m.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}setupShadows(l,h,_,x=0){if(!this._enabled)return;const S=this.painter.transform,C=this.painter.context,A=C.gl,z=this._uniformValues,O=new Float64Array(16),N=S.calculatePosMatrix(l,S.worldSize);for(let V=0;V<this._cascades.length;V++)a.m.multiply(O,this._cascades[V].matrix,N),z[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),C.activeTexture.set(A.TEXTURE0+Ci.ShadowMap0+V),this._cascades[V].texture.bind(A.NEAREST,A.CLAMP_TO_EDGE);if(this.useNormalOffset=!!_,this.useNormalOffset){const V=a.cg(l.canonical),G=2/S.tileSize*a.J/yo.shadowMapResolution,W=G*this._cascades[0].boundingSphereRadius,X=G*this._cascades[this._cascades.length-1].boundingSphereRadius,K=(_==="vector-tile"?1:3)/Math.pow(2,x-l.canonical.z-(1-S.zoom+Math.floor(S.zoom)));z.u_shadow_normal_offset=[V,W*K,X*K],z.u_shadow_bias=[6e-5,.0012,.012]}else z.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(C,z)}setupShadowsFromMatrix(l,h,_=!1){if(!this._enabled)return;const x=this.painter.context,S=x.gl,C=this._uniformValues,A=new Float64Array(16);for(let z=0;z<yo.cascadeCount;z++)a.m.multiply(A,this._cascades[z].matrix,l),C[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(A),x.activeTexture.set(S.TEXTURE0+Ci.ShadowMap0+z),this._cascades[z].texture.bind(S.NEAREST,S.CLAMP_TO_EDGE);this.useNormalOffset=_,_?(C.u_shadow_normal_offset=[1,5,5],C.u_shadow_bias=[6e-5,.0012,.012]):C.u_shadow_bias=[36e-5,.0012,.012],h.setShadowUniformValues(x,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(l,h,_,x){if(x[2]>=0)return{};const S=function(z,O,N){const V=N/(1<<z.canonical.z);return new a.c3([z.canonical.x*V+z.wrap*N,z.canonical.y*V+z.wrap*N,0],[(z.canonical.x+1)*V+z.wrap*N,(z.canonical.y+1)*V+z.wrap*N,O])}(l,h,_).getCorners(),C=h/-x[2];x[0]<0?(a.v.add(S[0],S[0],[x[0]*C,0,0]),a.v.add(S[3],S[3],[x[0]*C,0,0])):x[0]>0&&(a.v.add(S[1],S[1],[x[0]*C,0,0]),a.v.add(S[2],S[2],[x[0]*C,0,0])),x[1]<0?(a.v.add(S[0],S[0],[0,x[1]*C,0]),a.v.add(S[1],S[1],[0,x[1]*C,0])):x[1]>0&&(a.v.add(S[2],S[2],[0,x[1]*C,0]),a.v.add(S[3],S[3],[0,x[1]*C,0]));const A={};return A.vertices=S,A.planes=[th(S[1],S[0],S[4]),th(S[2],S[1],S[5]),th(S[3],S[2],S[6]),th(S[0],S[3],S[7])],A}addShadowReceiver(l,h,_){this._receivers.add(l,a.c3.fromTileIdAndHeight(l,h,_))}getMaxCascadeForTile(l){const h=this._receivers.get(l);return h&&h.lastCascade?h.lastCascade:0}}function th(m,l,h){const _=a.v.sub([],h,l),x=a.v.sub([],m,l),S=a.v.cross([],_,x),C=a.v.length(S);return C===0?[0,0,1,0]:(a.v.scale(S,S,1/C),[S[0],S[1],S[2],-a.v.dot(S,l)])}function um(m){const l=m.properties.get("direction"),h=a.b3(l.x,l.y,l.z);h[2]=a.c(h[2],0,75);const _=a.ch([h[0],h[1],h[2]]);return a.v.fromValues(_.x,_.y,_.z)}function Bd(m,l){const h=m.properties.get("color"),_=m.properties.get("intensity"),x=m.properties.get("direction"),S=[x.x,x.y,x.z],C=l.properties.get("color"),A=l.properties.get("intensity"),z=Math.max(a.v.dot([0,0,1],S),0),O=[0,0,0];a.v.scale(O,C.toArray01Linear().slice(0,3),A);const N=[0,0,0];return a.v.scale(N,h.toArray01Linear().slice(0,3),z*_),a.bw([O[0]>0?O[0]/(O[0]+N[0]):0,O[1]>0?O[1]/(O[1]+N[1]):0,O[2]>0?O[2]/(O[2]+N[2]):0])}function Iy(m,l,h,_,x,S){const C=m.zoom,A=m.scale,z=m.worldSize,O=1/z,N=m.aspect,V=Math.sqrt(1+N*N)*Math.tan(.5*m.fovX),G=V*V,W=_-h,X=_+h;let K,Y;G>W/X?(K=_,Y=_*V):(K=.5*X*(1+G),Y=.5*Math.sqrt(W*W+2*(_*_+h*h)*G+X*X*G*G));const Z=m.projection.pixelsPerMeter(m.center.lat,z),ae=m._camera.getCameraToWorldMercator(),pe=[0,0,-K*O];a.v.transformMat4(pe,pe,ae);let ge=Y*O;const ne=m._edgeInsets;if(!(ne.left===0&&ne.top===0&&ne.right===0&&ne.bottom===0||ne.left===ne.right&&ne.top===ne.bottom)){const Ke=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?Z:1),Mt=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,h,_);Mt[8]=2*-m.centerOffset.x/m.width,Mt[9]=2*m.centerOffset.y/m.height;const wt=new Float64Array(16);a.m.mul(wt,Mt,Ke);const Ft=new Float64Array(16);a.m.invert(Ft,wt);const St=a.F.fromInvProjectionMatrix(Ft,z,C,!0);for(const Vt of St.points){const $t=((ce=Vt)[0]/=A,ce[1]/=A,ce[2]=a.b(ce[2],m._center.lat),ce);ge=Math.max(ge,a.v.len(a.v.subtract([],pe,$t)))}}var ce;ge*=x/(x-1);const _e=Math.acos(l[2]),we=Math.atan2(-l[0],-l[1]),ve=new zi;ve.position=pe,ve.setPitchBearing(_e,we);const Se=ve.getWorldToCamera(z,Z),qe=ge*z,De=Math.min(m._mercatorZfromZoom(17)*z*-2,-2*qe),Ne=ve.getCameraToClipOrthographic(-qe,qe,-qe,qe,De,(qe+S*Z)/l[2]),Me=new Float64Array(16);a.m.multiply(Me,Ne,Se);const We=a.v.fromValues(Math.floor(1e6*pe[0])/1e6*z,Math.floor(1e6*pe[1])/1e6*z,0),Fe=.5*x,Xe=[0,0,0];a.v.transformMat4(Xe,We,Me),a.v.scale(Xe,Xe,Fe);const he=[Math.floor(Xe[0]),Math.floor(Xe[1]),Math.floor(Xe[2])],ke=[0,0,0];a.v.sub(ke,Xe,he),a.v.scale(ke,ke,-1/Fe);const nt=new Float64Array(16);return a.m.identity(nt),a.m.translate(nt,nt,ke),a.m.multiply(Me,nt,Me),[Me,qe]}class zy extends a.a6{constructor(l){super(),this.requestManager=l,this.models={"":{}},this.numModelsLoading={}}loadModel(l,h){return a.aO(this.requestManager.transformRequest(h,a.a2.Model).url).then(_=>{if(!_)return;const x=a.aP(_),S=new a.aQ(l,void 0,void 0,x);return S.computeBoundsAndApplyParent(),S}).catch(_=>{this.fire(new a.a7(new Error(`Could not load model ${l} from ${h}: ${_.message}`)))})}load(l,h){this.models[h]||(this.models[h]={});const _=Object.keys(l);this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+_.length;const x=[];for(const S of _)x.push(this.loadModel(S,l[S]));Promise.allSettled(x).then(S=>{for(let C=0;C<S.length;C++){const{status:A,value:z}=S[C];A==="fulfilled"&&z&&(this.models[h][_[C]]=z)}this.numModelsLoading[h]-=_.length,this.fire(new a.a8("data",{dataType:"style"}))}).catch(S=>{this.fire(new a.a7(new Error(`Could not load models: ${S.message}`)))})}isLoaded(){for(const l in this.numModelsLoading)if(this.numModelsLoading[l]>0)return!1;return!0}hasModel(l,h){return!!this.getModel(l,h)}getModel(l,h){return this.models[h]||(this.models[h]={}),this.models[h][l]}addModel(l,h,_){this.models[_]||(this.models[_]={}),this.hasModel(l,_)&&this.removeModel(l,_),this.load({[l]:this.requestManager.normalizeModelURL(h)},_)}addModels(l,h){const _={};for(const x in l)_[x]=this.requestManager.normalizeModelURL(l[x]);this.load(_,h)}removeModel(l,h){this.models[h]||(this.models[h]={});const _=this.models[h][l];delete this.models[h][l],_.destroy()}listModels(l){return this.models[l]||(this.models[l]={}),Object.keys(this.models[l])}upload(l,h){this.models[h]||(this.models[h]={});for(const _ in this.models[h])this.models[h][_].upload(l.context)}}const Hl=(m,l)=>a.ai(m,l&&l.filter(h=>h.identifier!=="source.canvas")),Ry=a.p(Je,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),Dy=a.p(Je,["setCenter","setZoom","setBearing","setPitch"]),hm={version:8,layers:[],sources:{}},el={duration:300,delay:0},rh=new Set(["fill","line","background","hillshade","raster"]);class qo extends a.a6{constructor(l,h={}){super(),this.map=l,this.scope=h.scope||"",this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=a.ak({},el),this._buildingIndex=new $a(this),this.crossTileSymbolIndex=new go,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new Pe,this.dispatcher=h.dispatcher?h.dispatcher:new a.br(a.bs(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new Tn,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new a.cj(l._requestManager,h.localFontFamily?a.ck.all:h.localIdeographFontFamily?a.ck.ideographs:a.ck.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new zy(l._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this.dispatcher.broadcast("setReferrer",a.cl());const _=this;this._rtlTextPluginCallback=qo.registerForPluginStateChange(x=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(S,C)=>{if(a.cm(S),C&&C.every(A=>A))for(const A in _._sourceCaches){const z=_._sourceCaches[A],O=z.getSource().type;O!=="vector"&&O!=="geojson"||z.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const S=this.getOwnSource(x.sourceId);if(S&&S.vectorLayerIds)for(const C in this._layers){const A=this._layers[C];A.source===S.id&&this._validateLayer(A)}})}loadURL(l,h={}){this.fire(new a.a8("dataloading",{dataType:"style"}));const _=typeof h.validate=="boolean"?h.validate:!a.cn(l);l=this.map._requestManager.normalizeStyleURL(l,h.accessToken),this.resolvedImports.add(l);const x=this.importsCache.get(l);if(x)return this._load(x,_);const S=this.map._requestManager.transformRequest(l,a.a2.Style);this._request=a.a1(S,(C,A)=>{if(this._request=null,C)this.fire(new a.a7(C));else if(A)return this.importsCache.set(l,A),this._load(A,_)})}loadJSON(l,h={}){this.fire(new a.a8("dataloading",{dataType:"style"})),this._request=a.a4.frame(()=>{this._request=null,this._load(l,h.validate!==!1)})}loadEmpty(){this.fire(new a.a8("dataloading",{dataType:"style"})),this._load(hm,!1)}_loadImports(l,h){if(this.importDepth>=4)return a.X("Style doesn't support nesting deeper than 5"),Promise.resolve();const _=[];for(const x of l){const S=this._createFragmentStyle(x),C=new Promise(z=>{S.once("style.import.load",z),S.once("error",z)}).then(()=>this.mergeAll());if(_.push(C),this.resolvedImports.has(x.url)){S.loadEmpty();continue}const A=x.data||this.importsCache.get(x.url);A?S.loadJSON(A,{validate:h}):x.url?S.loadURL(x.url,{validate:h}):S.loadEmpty(),this.fragments.push({style:S,id:x.id,config:x.config})}return Promise.allSettled(_)}_createFragmentStyle(l){const h=this.scope?a.aE(l.id,this.scope):l.id,_=new qo(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:l.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return _.setEventedParent(this.map,{style:_}),_}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const l=this.isRootStyle();this._shouldPrecompile=l,this.fire(new a.a8(l?"style.load":"style.import.load"))}_load(l,h){const _=l.schema;if(this.isRootStyle()&&(l.fragment||_&&l.fragment!==!1)){const C=a.ak({},hm,{imports:[{id:"basemap",data:l,url:""}]});return void this._load(C,h)}if(this.setConfig(this._config,_),h&&Hl(this,a.aj(l)))return;this._loaded=!0,this.stylesheet=a.co(l);for(const C in l.sources)this.addSource(C,l.sources[C],{validate:!1,isInitialLoad:!0});l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(l.glyphs,this.scope);const x=da(this.stylesheet.layers);if(this._order=x.map(C=>C.id),this.stylesheet.light&&a.X("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const C=this.stylesheet.lights[0];this.light=new hi(C.properties,C.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new hi(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const C of x){const A=a.cp(C,this.scope,this.options);A.isConfigDependent&&this._configDependentLayers.add(A.fqid),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize();const z=this.getOwnLayerSourceCache(A),O=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&A.canCastShadows()&&O&&(z.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const S=this.stylesheet.terrain;S&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.a4.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?a.X("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(S,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.a8("data",{dataType:"style"})),l.imports?this._loadImports(l.imports,h).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let l,h,_,x,S,C,A,z;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(O=>{if(O.stylesheet){if(O.light!=null&&(l=O.light),O.stylesheet.lights)for(const N of O.stylesheet.lights)N.type==="ambient"&&O.ambientLight!=null&&(h=O.ambientLight),N.type==="directional"&&O.directionalLight!=null&&(_=O.directionalLight);x=this._prioritizeTerrain(x,O.terrain,O.stylesheet.terrain),O.stylesheet.fog&&O.fog!=null&&(S=O.fog),O.stylesheet.camera!=null&&(z=O.stylesheet.camera),O.stylesheet.projection!=null&&(C=O.stylesheet.projection),O.stylesheet.transition!=null&&(A=O.stylesheet.transition)}}),this.light=l,this.ambientLight=h,this.directionalLight=_,this.fog=S,x===null?delete this.terrain:this.terrain=x,this.camera=z||{"camera-projection":"perspective"},this.projection=C||{name:"mercator"},this.transition=a.ak({},el,A),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(l){const h=_=>{for(const x of _.fragments)h(x.style);l(_)};h(this)}_prioritizeTerrain(l,h,_){const x=l&&l.drapeRenderMode===0;return _===null?h&&h.drapeRenderMode===0?h:x?l:null:h!=null&&(!l||x||h&&h.drapeRenderMode===1)?h:l}mergeTerrain(){let l;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{l=this._prioritizeTerrain(l,h.terrain,h.stylesheet.terrain)}),l===null?delete this.terrain:this.terrain=l}mergeProjection(){let l;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(l=h.stylesheet.projection)}),this.projection=l||{name:"mercator"}}mergeSources(){const l={},h={},_={};this.forEachFragmentStyle(x=>{for(const S in x._sourceCaches){const C=a.aE(S,x.scope);l[C]=x._sourceCaches[S]}for(const S in x._otherSourceCaches){const C=a.aE(S,x.scope);h[C]=x._otherSourceCaches[S]}for(const S in x._symbolSourceCaches){const C=a.aE(S,x.scope);_[C]=x._symbolSourceCaches[S]}}),this._mergedSourceCaches=l,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=_}mergeLayers(){const l={},h=[],_={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const C of S._order){const A=S._layers[C];if(A.type==="slot"){const z=a.cq(C);if(l[z])continue;l[z]=[]}A.slot&&l[A.slot]?l[A.slot].push(A):h.push(A)}}),this._mergedOrder=[];const x=(S=[])=>{for(const C of S)if(C.type==="slot"){const A=a.cq(C.id);l[A]&&x(l[A])}else{const A=a.aE(C.id,C.scope);this._mergedOrder.push(A),_[A]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0)}};x(h),this._mergedLayers=_,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(l){return this.stylesheet.camera=a.ak({},this.stylesheet.camera,l),this.camera=this.stylesheet.camera,this}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(l){this._spriteRequest=function(h,_,x){let S,C,A;const z=a.a4.devicePixelRatio>1?"@2x":"";let O=a.a1(_.transformRequest(_.normalizeSpriteURL(h,z,".json"),a.a2.SpriteJSON),(G,W)=>{O=null,A||(A=G,S=W,V())}),N=a.a3(_.transformRequest(_.normalizeSpriteURL(h,z,".png"),a.a2.SpriteImage),(G,W)=>{N=null,A||(A=G,C=W,V())});function V(){if(A)x(A);else if(S&&C){const G=a.a4.getImageData(C),W={};for(const X in S){const{width:K,height:Y,x:Z,y:ae,sdf:pe,pixelRatio:ge,stretchX:ne,stretchY:ce,content:_e}=S[X],we=new a.a5({width:K,height:Y});a.a5.copy(G,we,{x:Z,y:ae},{x:0,y:0},{width:K,height:Y}),W[X]={data:we,pixelRatio:ge,sdf:pe,stretchX:ne,stretchY:ce,content:_e}}x(null,W)}}return{cancel(){O&&(O.cancel(),O=null),N&&(N.cancel(),N=null)}}}(l,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new a.a7(h));else if(_)for(const x in _)this.imageManager.addImage(x,this.scope,_[x]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.a8("data",{dataType:"style"}))})}_validateLayer(l){const h=this.getOwnSource(l.source);if(!h)return;const _=l.sourceLayer;_&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.a7(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:l}of this.fragments)if(!l.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((l,h)=>{const _=this.fragments[h];return _&&_.style&&(l.data=_.style.serialize()),l})}_serializeSources(){const l={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();l[_.id]||(l[_.id]=_.serialize())}return l}_serializeLayers(l){const h=[];for(const _ of l){const x=this._layers[_];x&&x.type!=="custom"&&h.push(x.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(l){return!!this.terrain&&(typeof l.isLayerDraped=="function"?l.isLayerDraped(this.getLayerSourceCache(l)):rh.has(l.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(l){const h=this.getOwnLayer(l);if(h)return h;this.fire(new a.a7(new Error(`The layer '${l}' does not exist in the map's style.`)))}_checkSource(l){const h=this.getOwnSource(l);if(h)return h;this.fire(new a.a7(new Error(`The source '${l}' does not exist in the map's style.`)))}update(l){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l);const h=this.calculateLightsBrightness();l.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));const _=this._changes.isDirty();if(this._changes.isDirty()){const S=this._changes.getLayerUpdatesByScope();for(const C in S){const{updatedIds:A,removedIds:z}=S[C];(A||z)&&this._updateWorkerLayers(C,A,z)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(l),this.light&&this.light.updateTransitions(l),this.ambientLight&&this.ambientLight.updateTransitions(l),this.directionalLight&&this.directionalLight.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._changes.reset()}const x={};for(const S in this._mergedSourceCaches){const C=this._mergedSourceCaches[S];x[S]=C.used,C.used=!1}for(const S of this._mergedOrder){const C=this._mergedLayers[S];if(C.recalculate(l,this._availableImages),!C.isHidden(l.zoom)){const A=this.getLayerSourceCache(C);A&&(A.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let A=C.minzoom||0;A<(C.maxzoom||25.5);A++){const z=this.map.painter;if(z){const O=C.getProgramIds();if(!O)continue;for(const N of O){const V=C.getDefaultProgramParams(N,l.zoom);V&&(z.style=this,this.fog&&(z._fogVisible=!0,V.overrideFog=!0,z.getOrCreateProgram(N,V)),z._fogVisible=!1,V.overrideFog=!1,z.getOrCreateProgram(N,V),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(V.overrideRtt=!0,z.getOrCreateProgram(N,V)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const S in x){const C=this._mergedSourceCaches[S];x[S]!==C.used&&C.getSource().fire(new a.a8("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light&&this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),_&&this.fire(new a.a8("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=this._changes.getUpdatedImages();if(l.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],l);this._changes.resetUpdatedImages()}}_updateWorkerLayers(l,h,_){const x=this.getFragmentStyle(l);x&&this.dispatcher.broadcast("updateLayers",{layers:h?x._serializeLayers(h):[],scope:l,removedIds:_||[],options:x.options})}setState(l){if(this._checkLoaded(),Hl(this,a.aj(l)))return!1;(l=a.co(l)).layers=da(l.layers);const h=function(x,S){if(!x)return[{command:Je.setStyle,args:[S]}];let C=[];try{if(!P(x.version,S.version))return[{command:Je.setStyle,args:[S]}];P(x.center,S.center)||C.push({command:Je.setCenter,args:[S.center]}),P(x.zoom,S.zoom)||C.push({command:Je.setZoom,args:[S.zoom]}),P(x.bearing,S.bearing)||C.push({command:Je.setBearing,args:[S.bearing]}),P(x.pitch,S.pitch)||C.push({command:Je.setPitch,args:[S.pitch]}),P(x.sprite,S.sprite)||C.push({command:Je.setSprite,args:[S.sprite]}),P(x.glyphs,S.glyphs)||C.push({command:Je.setGlyphs,args:[S.glyphs]}),P(x.imports,S.imports)||function(V=[],G=[],W){G=G||[];const X=(V=V||[]).map(fa),K=G.map(fa),Y=V.reduce(Bs,{}),Z=G.reduce(Bs,{}),ae=X.slice();let pe,ge,ne,ce;for(pe=0,ge=0;pe<X.length;pe++)ne=X[pe],Z.hasOwnProperty(ne)?ge++:(W.push({command:Je.removeImport,args:[ne]}),ae.splice(ae.indexOf(ne,ge),1));for(pe=0,ge=0;pe<K.length;pe++)ne=K[K.length-1-pe],ae[ae.length-1-pe]!==ne&&(Y.hasOwnProperty(ne)?(W.push({command:Je.removeImport,args:[ne]}),ae.splice(ae.lastIndexOf(ne,ae.length-ge),1)):ge++,ce=ae[ae.length-pe],W.push({command:Je.addImport,args:[Z[ne],ce]}),ae.splice(ae.length-pe,0,ne));for(const _e of G){const we=Y[_e.id];if(!we||P(we,_e))continue;P(we.config,_e.config)||W.push({command:Je.setImportConfig,args:[_e.id,_e.config]}),P(we.url,_e.url)||W.push({command:Je.setImportUrl,args:[_e.id,_e.url]});const ve=_e.data;P(we&&we.data,ve)||W.push({command:Je.setImportData,args:[_e.id,ve]})}}(x.imports,S.imports,C),P(x.transition,S.transition)||C.push({command:Je.setTransition,args:[S.transition]}),P(x.light,S.light)||C.push({command:Je.setLight,args:[S.light]}),P(x.fog,S.fog)||C.push({command:Je.setFog,args:[S.fog]}),P(x.projection,S.projection)||C.push({command:Je.setProjection,args:[S.projection]}),P(x.lights,S.lights)||C.push({command:Je.setLights,args:[S.lights]}),P(x.camera,S.camera)||C.push({command:Je.setCamera,args:[S.camera]});const A={},z=[];(function(V,G,W,X){let K;for(K in G=G||{},V=V||{})V.hasOwnProperty(K)&&(G.hasOwnProperty(K)||Er(K,W,X));for(K in G){if(!G.hasOwnProperty(K))continue;const Y=G[K];V.hasOwnProperty(K)?P(V[K],Y)||(V[K].type==="geojson"&&Y.type==="geojson"&&Ua(V,G,K)?W.push({command:Je.setGeoJSONSourceData,args:[K,Y.data]}):mo(K,G,W,X)):pr(K,G,W)}})(x.sources,S.sources,z,A);const O=[];x.layers&&x.layers.forEach(V=>{V.source&&A[V.source]?C.push({command:Je.removeLayer,args:[V.id]}):O.push(V)});let N=x.terrain;N&&A[N.source]&&(C.push({command:Je.setTerrain,args:[void 0]}),N=void 0),C=C.concat(z),P(N,S.terrain)||C.push({command:Je.setTerrain,args:[S.terrain]}),function(V,G,W){G=G||[];const X=(V=V||[]).map(fa),K=G.map(fa),Y=V.reduce(Bs,{}),Z=G.reduce(Bs,{}),ae=X.slice(),pe=Object.create(null);let ge,ne,ce,_e,we,ve,Se;for(ge=0,ne=0;ge<X.length;ge++)ce=X[ge],Z.hasOwnProperty(ce)?ne++:(W.push({command:Je.removeLayer,args:[ce]}),ae.splice(ae.indexOf(ce,ne),1));for(ge=0,ne=0;ge<K.length;ge++)ce=K[K.length-1-ge],ae[ae.length-1-ge]!==ce&&(Y.hasOwnProperty(ce)?(W.push({command:Je.removeLayer,args:[ce]}),ae.splice(ae.lastIndexOf(ce,ae.length-ne),1)):ne++,ve=ae[ae.length-ge],W.push({command:Je.addLayer,args:[Z[ce],ve]}),ae.splice(ae.length-ge,0,ce),pe[ce]=!0);for(ge=0;ge<K.length;ge++)if(ce=K[ge],_e=Y[ce],we=Z[ce],!pe[ce]&&!P(_e,we))if(P(_e.source,we.source)&&P(_e["source-layer"],we["source-layer"])&&P(_e.type,we.type)){for(Se in cr(_e.layout,we.layout,W,ce,null,Je.setLayoutProperty),cr(_e.paint,we.paint,W,ce,null,Je.setPaintProperty),P(_e.slot,we.slot)||W.push({command:Je.setSlot,args:[ce,we.slot]}),P(_e.filter,we.filter)||W.push({command:Je.setFilter,args:[ce,we.filter]}),P(_e.minzoom,we.minzoom)&&P(_e.maxzoom,we.maxzoom)||W.push({command:Je.setLayerZoomRange,args:[ce,we.minzoom,we.maxzoom]}),_e)_e.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&Se!=="slot"&&(Se.indexOf("paint.")===0?cr(_e[Se],we[Se],W,ce,Se.slice(6),Je.setPaintProperty):P(_e[Se],we[Se])||W.push({command:Je.setLayerProperty,args:[ce,Se,we[Se]]}));for(Se in we)we.hasOwnProperty(Se)&&!_e.hasOwnProperty(Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&Se!=="slot"&&(Se.indexOf("paint.")===0?cr(_e[Se],we[Se],W,ce,Se.slice(6),Je.setPaintProperty):P(_e[Se],we[Se])||W.push({command:Je.setLayerProperty,args:[ce,Se,we[Se]]}))}else W.push({command:Je.removeLayer,args:[ce]}),ve=ae[ae.lastIndexOf(ce)+1],W.push({command:Je.addLayer,args:[we,ve]})}(O,S.layers,C)}catch(A){console.warn("Unable to compute style diff:",A),C=[{command:Je.setStyle,args:[S]}]}return C}(this.serialize(),l).filter(x=>!(x.command in Dy));if(h.length===0)return!1;const _=h.filter(x=>!(x.command in Ry));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);return h.forEach(x=>{this[x.command].apply(this,x.args)}),this.stylesheet=l,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(l,h){return this.getImage(l)?this.fire(new a.a7(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,this.scope,h),this._afterImageUpdated(l),this)}updateImage(l,h){this.imageManager.updateImage(l,this.scope,h)}getImage(l){return this.imageManager.getImage(l,this.scope)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l,this.scope),this._afterImageUpdated(l),this):this.fire(new a.a7(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(l),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.a8("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(l,h,_={}){return this._checkLoaded(),this._validate(a.cr,`models.${l}`,h,null,_)||(this.modelManager.addModel(l,h,this.scope),this._changes.setDirty()),this}hasModel(l){return this.modelManager.hasModel(l,this.scope)}removeModel(l){return this.hasModel(l)?(this.modelManager.removeModel(l,this.scope),this):this.fire(new a.a7(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(l,h,_={}){if(this._checkLoaded(),this.getOwnSource(l)!==void 0)throw new Error(`There is already a source with ID "${l}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(a.cs,`sources.${l}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=Po(l,h,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const S=C=>{const A=(C?"symbol:":"other:")+x.id,z=a.aE(A,this.scope),O=this._sourceCaches[A]=new a.bq(z,x,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=O,O.onAdd(this.map)};S(!1),h.type!=="vector"&&h.type!=="geojson"||S(!0),x.onAdd&&x.onAdd(this.map),_.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(l){this._checkLoaded();const h=this.getOwnSource(l);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===l)return this.fire(new a.a7(new Error(`Source "${l}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===l)return this.fire(new a.a7(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const _=this.getOwnSourceCaches(l);for(const x of _){const S=a.cq(x.id);delete this._sourceCaches[S],this._changes.discardSourceCacheUpdate(x.id),x.fire(new a.a8("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(l,h){this._checkLoaded(),this.getOwnSource(l).setData(h),this._changes.setDirty()}getOwnSource(l){const h=this.getOwnSourceCache(l);return h&&h.getSource()}getOwnSources(){const l=[];for(const h in this._otherSourceCaches){const _=this.getOwnSourceCache(h);_&&l.push(_.getSource())}return l}areTilesLoaded(){const l=this._mergedSourceCaches;for(const h in l){const _=l[h]._tiles;for(const x in _){const S=_[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}setLights(l){if(this._checkLoaded(),!l)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const x of l){if(this._validate(a.ct,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(x),S.updateTransitions(h)}else this.ambientLight=new Ol(x,$o,this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(x),S.updateTransitions(h)}else this.directionalLight=new Ol(x,Gu,this.scope,this.options)}}const _=new a.al(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(_),this.directionalLight&&this.directionalLight.recalculate(_),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const l=this.directionalLight,h=this.ambientLight;if(!l||!h)return;const _=V=>.2126*(V[0]<=.03928?V[0]/12.92:Math.pow((V[0]+.055)/1.055,2.4))+.7152*(V[1]<=.03928?V[1]/12.92:Math.pow((V[1]+.055)/1.055,2.4))+.0722*(V[2]<=.03928?V[2]/12.92:Math.pow((V[2]+.055)/1.055,2.4)),x=l.properties.get("color").toArray01(),S=l.properties.get("intensity"),C=l.properties.get("direction"),A=1-a.b3(C.x,C.y,C.z)[2]/90,z=_(x)*S*A,O=h.properties.get("color").toArray01(),N=h.properties.get("intensity");return(z+_(O)*N)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const l=[];return this.directionalLight&&l.push(this.directionalLight.get()),this.ambientLight&&l.push(this.ambientLight.get()),l}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(l){if(!l)return this;if(a.cu(l)){const h=a.cv(l),_=this.fragments.find(({id:S})=>S===h);if(!_)throw new Error(`Style import not found: ${l}`);const x=a.cq(l);return _.style.getFragmentStyle(x)}{const h=this.fragments.find(({id:_})=>_===l);if(!h)throw new Error(`Style import not found: ${l}`);return h.style}}getConfigProperty(l,h){const _=this.getFragmentStyle(l);if(!_)return null;const x=a.aE(h,_.scope),S=_.options.get(x),C=S?S.value||S.default:null;return C?C.serialize():null}setConfigProperty(l,h,_){const x=a.cw(_);if(x.result!=="success")return void Hl(this,x.value);const S=x.value.expression,C=this.getFragmentStyle(l);if(!C)return;const A=a.aE(h,C.scope),z=C.options.get(A);z&&(this.options.set(A,{...z,value:S}),this.updateConfigDependencies())}setConfig(l,h){if(this._config=l,l||h)if(h)for(const _ in h){let x,S;const C=a.cw(h[_].default);if(C.result==="success"&&(x=C.value.expression),l&&l[_]!==void 0){const G=a.cw(l[_]);G.result==="success"&&(S=G.value.expression)}const{minValue:A,maxValue:z,stepValue:O,type:N,values:V}=h[_];if(x){const G=a.aE(_,this.scope);this.options.set(G,{default:x,value:S,minValue:A,maxValue:z,stepValue:O,type:N,values:V})}else this.fire(new a.a7(new Error(`No schema defined for config option "${_}".`)))}else this.fire(new a.a7(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const l of this._configDependentLayers){const h=this.getLayer(l);h&&(h.possiblyEvaluateVisibility(),this._updateLayer(h))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(l,h,_={}){this._checkLoaded();const x=l.id;if(this._layers[x])return void this.fire(new a.a7(new Error(`Layer with id "${x}" already exists on this map`)));let S;if(l.type==="custom"){if(Hl(this,a.cx(l)))return;S=a.cp(l,this.scope,this.options)}else{if(typeof l.source=="object"&&(this.addSource(x,l.source),l=a.co(l),l=a.ak(l,{source:x})),this._validate(a.cy,`layers.${x}`,l,{arrayIndex:-1},_))return;S=a.cp(l,this.scope,this.options),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[S.id]=S.serialize()}S.isConfigDependent&&this._configDependentLayers.add(S.fqid);let C=this._order.length;if(h){const N=this._order.indexOf(h);if(N===-1)return void this.fire(new a.a7(new Error(`Layer with id "${h}" does not exist on this map.`)));S.slot===this._layers[h].slot?C=N:a.X(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,x),this._layerOrderChanged=!0,this._layers[x]=S;const A=this.getOwnLayerSourceCache(S),z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();A&&S.canCastShadows()&&z&&(A.castsShadows=!0);const O=this._changes.getRemovedLayer(S);if(O&&S.source&&A&&S.type!=="custom"){this._changes.discardLayerRemoval(S);const N=a.aE(S.source,S.scope);O.type!==S.type?this._changes.updateSourceCache(N,"clear"):(this._changes.updateSourceCache(N,"reload"),A.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),S.scope=this.scope,this.mergeLayers()}moveLayer(l,h){this._checkLoaded();const _=this._checkLayer(l);if(!_||l===h)return;const x=this._order.indexOf(l);this._order.splice(x,1);let S=this._order.length;if(h){const C=this._order.indexOf(h);if(C===-1)return void this.fire(new a.a7(new Error(`Layer with id "${h}" does not exist on this map.`)));_.slot===this._layers[h].slot?S=C:a.X(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,l),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(l){this._checkLoaded();const h=this._checkLayer(l);if(!h)return;h.setEventedParent(null);const _=this._order.indexOf(l);this._order.splice(_,1),delete this._layers[l],delete this._serializedLayers[l],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const x=this.getOwnLayerSourceCache(h);if(x&&x.castsShadows){let S=!1;for(const C in this._layers)if(this._layers[C].source===h.source&&this._layers[C].canCastShadows()){S=!0;break}x.castsShadows=S}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(l){return this._layers[l]}hasLayer(l){return l in this._mergedLayers}hasLayerType(l){for(const h in this._layers)if(this._layers[h].type===l)return!0;return!1}setLayerZoomRange(l,h,_){this._checkLoaded();const x=this._checkLayer(l);x&&(x.minzoom===h&&x.maxzoom===_||(h!=null&&(x.minzoom=h),_!=null&&(x.maxzoom=_),this._updateLayer(x)))}setSlot(l,h){this._checkLoaded();const _=this._checkLayer(l);_&&_.slot!==h&&(_.slot=h,this._updateLayer(_))}setFilter(l,h,_={}){this._checkLoaded();const x=this._checkLayer(l);if(x&&!P(x.filter,h))return h==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.cz,`layers.${x.id}.filter`,h,{layerType:x.type},_)||(x.filter=a.co(h),this._updateLayer(x)))}getFilter(l){const h=this._checkLayer(l);if(h)return a.co(h.filter)}setLayoutProperty(l,h,_,x={}){this._checkLoaded();const S=this._checkLayer(l);S&&(P(S.getLayoutProperty(h),_)||(S.setLayoutProperty(h,_,x),S.isConfigDependent&&this._configDependentLayers.add(S.fqid),this._updateLayer(S)))}getLayoutProperty(l,h){const _=this._checkLayer(l);if(_)return _.getLayoutProperty(h)}setPaintProperty(l,h,_,x={}){this._checkLoaded();const S=this._checkLayer(l);if(!S||P(S.getPaintProperty(h),_))return;const C=S.setPaintProperty(h,_,x);S.isConfigDependent&&this._configDependentLayers.add(S.fqid),C&&this._updateLayer(S),this._changes.updatePaintProperties(S)}getPaintProperty(l,h){const _=this._checkLayer(l);if(_)return _.getPaintProperty(h)}setFeatureState(l,h){this._checkLoaded();const _=l.source,x=l.sourceLayer,S=this._checkSource(_);if(!S)return;const C=S.type;if(C==="geojson"&&x)return void this.fire(new a.a7(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!x)return void this.fire(new a.a7(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new a.a7(new Error("The feature id parameter must be provided.")));const A=this.getOwnSourceCaches(_);for(const z of A)z.setFeatureState(x,l.id,h)}removeFeatureState(l,h){this._checkLoaded();const _=l.source,x=this._checkSource(_);if(!x)return;const S=x.type,C=S==="vector"?l.sourceLayer:void 0;if(S==="vector"&&!C)return void this.fire(new a.a7(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new a.a7(new Error("A feature id is required to remove its specific state property.")));const A=this.getOwnSourceCaches(_);for(const z of A)z.removeFeatureState(C,l.id,h)}getFeatureState(l){this._checkLoaded();const h=l.source,_=l.sourceLayer,x=this._checkSource(h);if(x){if(x.type!=="vector"||_)return l.id===void 0&&this.fire(new a.a7(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(_,l.id);this.fire(new a.a7(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(l){return this.stylesheet.transition=a.ak({},this.stylesheet.transition,l),this.transition=this.stylesheet.transition,this}getTransition(){return a.ak({},this.stylesheet.transition)}serialize(){this._checkLoaded();const l=this.getTerrain(),h=l&&this.terrain&&this.terrain.scope===this.scope?l:this.stylesheet.terrain;return a.cA({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},_=>_!==void 0)}_updateLayer(l){this._changes.updateLayer(l);const h=this.getLayerSourceCache(l),_=a.aE(l.source,l.scope),x=this._changes.getUpdatedSourceCaches();l.source&&!x[_]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(_,"reload"),h.pause()),l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const h=A=>this._mergedLayers[A].type==="fill-extrusion",_=this.order,x={},S=[];for(let A=_.length-1;A>=0;A--){const z=_[A];if(h(z)){x[z]=A;for(const O of l){const N=O[z];if(N)for(const V of N)S.push(V)}}}S.sort((A,z)=>z.intersectionZ-A.intersectionZ);const C=[];for(let A=_.length-1;A>=0;A--){const z=_[A];if(h(z))for(let O=S.length-1;O>=0;O--){const N=S[O].feature;if(x[N.layer.id]<A)break;C.push(N),S.pop()}else for(const O of l){const N=O[z];if(N)for(const V of N)C.push(V.feature)}}return C}queryRenderedFeatures(l,h,_){h&&h.filter&&this._validate(a.cz,"queryRenderedFeatures.filter",h.filter,null,h),h.scope=this.scope,h.availableImages=this._availableImages,h.serializedLayers=this._serializedLayers;const x={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.a7(new Error("parameters.layers must be an Array."))),[];for(const O of h.layers){const N=this._mergedLayers[O];if(!N)return this.fire(new a.a7(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];x[N.source]=!0}}const S=[],C=h.serializedLayers||{},A=h&&h.layers?h.layers.some(O=>{const N=this.getLayer(O);return N&&N.is3D()}):this.has3DLayers(),z=Di.createFromScreenPoints(l,_);for(const O in this._mergedSourceCaches){const N=this._mergedSourceCaches[O].getSource();if(!N||N.scope!==h.scope)continue;const V=this._mergedSourceCaches[O].getSource().id;h.layers&&!x[V]||S.push(hs(this._mergedSourceCaches[O],this._mergedLayers,C,z,h,_,A,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(O,N,V,G,W,X,K){const Y={},Z=X.queryRenderedSymbols(G),ae=[];for(const pe of Object.keys(Z).map(Number))ae.push(K[pe]);ae.sort(Io);for(const pe of ae){const ge=pe.featureIndex.lookupSymbolFeatures(Z[pe.bucketInstanceId],N,pe.bucketIndex,pe.sourceLayerIndex,W.filter,W.layers,W.availableImages,O);for(const ne in ge){const ce=Y[ne]=Y[ne]||[],_e=ge[ne];_e.sort((we,ve)=>{const Se=pe.featureSortOrder;if(Se){const qe=Se.indexOf(we.featureIndex);return Se.indexOf(ve.featureIndex)-qe}return ve.featureIndex-we.featureIndex});for(const we of _e)ce.push(we)}}for(const pe in Y)Y[pe].forEach(ge=>{const ne=ge.feature,ce=V(O[pe]);if(!ce)return;const _e=ce.getFeatureState(ne.layer["source-layer"],ne.id);ne.source=ne.layer.source,ne.layer["source-layer"]&&(ne.sourceLayer=ne.layer["source-layer"]),ne.state=_e});return Y}(this._mergedLayers,C,this.getLayerSourceCache.bind(this),z.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(l,h){h&&h.filter&&this._validate(a.cz,"querySourceFeatures.filter",h.filter,null,h);const _=this.getOwnSourceCaches(l);let x=[];for(const S of _)x=x.concat(Lp(S,h));return x}addSourceType(l,h,_){return qo.getSourceType(l)?_(new Error(`A source type called "${l}" already exists.`)):(qo.setSourceType(l,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:h.workerSourceURL},_):_(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(l,h,_={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const A in l)if(!P(l[A],x[A])){S=!0;break}if(!S)return;const C=this._getTransitionParameters();this.light.setLight(l,h,_),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,h=1){if(this._checkLoaded(),!l)return delete this.terrain,l===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=l;const x=l.source==null;if(h===1){if(typeof _.source=="object"){const A="terrain-dem-src";this.addSource(A,_.source),_=a.co(_),_=a.ak(_,{source:A})}const S=a.ak({},_),C={};if(this.terrain&&x){S.source=this.terrain.get().source;const A=this.terrain?this.getFragmentStyle(this.terrain.scope):null;A&&(C.style=A.serialize())}if(this._validate(a.cB,"terrain",S,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&h!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,h),this.fire(new a.a8("data",{dataType:"style"}))}else{const S=this.terrain,C=S.get();for(const A of Object.keys(a.ae.terrain))!_.hasOwnProperty(A)&&a.ae.terrain[A].default&&(_[A]=a.ae.terrain[A].default);for(const A in l)if(!P(l[A],C[A])){S.set(l,this.options),this.stylesheet.terrain=l;const z=this._getTransitionParameters({duration:0});S.updateTransitions(z),this.fire(new a.a8("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const h=this.fog=new Ll(l,this.map.transform);this.stylesheet.fog=h.get();const _=this._getTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!P(h.get(),l)){h.set(l),this.stylesheet.fog=h.get();const _=this._getTransitionParameters({duration:0});h.updateTransitions(_)}}else this._createFog(l);this._markersNeedUpdate=!0}_getTransitionParameters(l){return{now:a.a4.now(),transition:a.ak(this.transition,l)}}updateDrapeFirstLayers(){if(!this.terrain)return;const l=[],h=[];for(const _ in this._mergedLayers)this.isLayerDraped(this._mergedLayers[_])?l.push(_):h.push(_);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...h)}_createTerrain(l,h){const _=this.terrain=new fo(l,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=l),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});_.updateTransitions(x)}_force3DLayerUpdate(){for(const l in this._layers){const h=this._layers[l];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const h=this._layers[l];h.type==="symbol"&&this._updateLayer(h)}}_validate(l,h,_,x,S={}){if(S&&S.validate===!1)return!1;const C=a.ak({},this.serialize());return Hl(this,l.call(a.aj,a.ak({key:h,style:C,value:_,styleSpec:a.ae},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.cC.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._mergedLayers)this._mergedLayers[l].setEventedParent(null);for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles(),this._mergedSourceCaches[l].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(l){const h=this.getSourceCaches(l);for(const _ of h)_.clearTiles()}clearSources(){for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].clearTiles()}reloadSource(l){const h=this.getSourceCaches(l);for(const _ of h)_.resume(),_.reload()}reloadSources(){for(const l of this.getSources())l.reload&&l.reload()}updateSources(l){let h;this.directionalLight&&(h=um(this.directionalLight));for(const _ in this._mergedSourceCaches)this._mergedSourceCaches[_].update(l,void 0,void 0,h)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const h=this._sourceCaches[l];h.resume(),h.reload()}}_updatePlacement(l,h,_,x,S=!1){let C=!1,A=!1;const z={},O={};for(const N of this._mergedOrder){const V=this._mergedLayers[N];if(V.type!=="symbol")continue;const G=a.aE(V.source,V.scope);let W=z[G];if(!W){const K=this.getLayerSourceCache(V);if(!K)continue;const Y=K.getRenderableIds(!0).map(Z=>K.getTileByID(Z));O[G]=Y.slice(),W=z[G]=Y.sort((Z,ae)=>ae.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(ae.tileID)?-1:1))}const X=this.crossTileSymbolIndex.addLayer(V,W,l.center.lng,l.projection);C=C||X}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),S=S||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new a.a8("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.a4.now(),l.zoom))&&(this.pauseablePlacement=new Br(l,this._mergedOrder,S,h,_,x,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,z,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.a4.now()),A=!0),C&&this.pauseablePlacement.placement.setStale()),A||C)for(const N of this._mergedOrder){const V=this._mergedLayers[N];V.type==="symbol"&&this.placement.updateLayerOpacities(V,z[a.aE(V.source,V.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.a4.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}addImport(l){this._checkLoaded();const h=this.stylesheet.imports=this.stylesheet.imports||[];return h.findIndex(({id:_})=>_===l.id)!==-1?this.fire(new a.a7(new Error(`Import with id '${l.id}' already exists in the map's style.`))):(h.push(l),this._loadImports([l],!0),this)}setImportUrl(l,h){this._checkLoaded();const _=this.stylesheet.imports||[],x=this.getImportIndex(l);if(x===-1)return this;_[x].url=h;const S=this.fragments[x];return S.style=this._createFragmentStyle(_[x]),S.style.on("style.import.load",()=>this.mergeAll()),S.style.loadURL(h),this}setImportData(l,h){this._checkLoaded();const _=this.getImportIndex(l),x=this.stylesheet.imports||[];return _===-1?this:h?(this.fragments[_].style.setState(h),this._reloadImports(),this):(delete x[_].data,this.setImportUrl(l,x[_].url))}setImportConfig(l,h){this._checkLoaded();const _=this.getImportIndex(l),x=this.stylesheet.imports||[];if(_===-1)return this;h?x[_].config=h:delete x[_].config;const S=this.fragments[_],C=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=h,S.style.setConfig(h,C),this.updateConfigDependencies(),this}removeImport(l){this._checkLoaded();const h=this.stylesheet.imports||[],_=this.getImportIndex(l);return _===-1||(h.splice(_,1),this.fragments[_].style._remove(),this.fragments.splice(_,1),this._reloadImports()),this}getImportIndex(l){const h=(this.stylesheet.imports||[]).findIndex(_=>_.id===l);return h===-1&&this.fire(new a.a7(new Error(`Import '${l}' does not exist in the map's style and cannot be updated.`))),h}getLayer(l){return this._mergedLayers[l]}getSources(){const l=[];for(const h in this._mergedOtherSourceCaches){const _=this._mergedOtherSourceCaches[h];_&&l.push(_.getSource())}return l}getSource(l,h){const _=this.getSourceCache(l,h);return _&&_.getSource()}getLayerSource(l){const h=this.getLayerSourceCache(l);return h&&h.getSource()}getSourceCache(l,h){const _=a.aE(l,h);return this._mergedOtherSourceCaches[_]}getLayerSourceCache(l){const h=a.aE(l.source,l.scope);return l.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(l){const h=[];return this._mergedOtherSourceCaches[l]&&h.push(this._mergedOtherSourceCaches[l]),this._mergedSymbolSourceCaches[l]&&h.push(this._mergedSymbolSourceCaches[l]),h}updateSourceCaches(){const l=this._changes.getUpdatedSourceCaches();for(const h in l){const _=l[h];_==="reload"?this.reloadSource(h):_==="clear"&&this.clearSource(h)}}updateLayers(l){const h=this._changes.getUpdatedPaintProperties();for(const _ of h){const x=this.getLayer(_);x&&x.updateTransitions(l)}}getImages(l,h,_){this.imageManager.getImages(h.icons,h.scope,_),this._updateTilesForChangedImages();const x=S=>{S&&S.setDependencies(h.tileID.key,h.type,h.icons)};x(this._otherSourceCaches[h.source]),x(this._symbolSourceCaches[h.source])}getGlyphs(l,h,_){this.glyphManager.getGlyphs(h.stacks,h.scope,_)}getResource(l,h,_){return a.cD(h,_)}getOwnSourceCache(l){return this._otherSourceCaches[l]}getOwnLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}getOwnSourceCaches(l){const h=[];return this._otherSourceCaches[l]&&h.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&h.push(this._symbolSourceCaches[l]),h}_isSourceCacheLoaded(l){const h=this.getOwnSourceCaches(l);return h.length===0?(this.fire(new a.a7(new Error(`There is no source with ID '${l}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function tl(m,l){let h=!1,_=null;const x=()=>{_=null,h&&(m(),_=setTimeout(x,l),h=!1)};return()=>(h=!0,_||x(),_)}qo.getSourceType=function(m){return Go[m]},qo.setSourceType=function(m,l){Go[m]=l},qo.registerForPluginStateChange=a.ci;class Ly{constructor(l){this._hashName=l&&encodeURIComponent(l),a.aR(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=tl(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const h=rl(l);if(this._hashName){const _=this._hashName;let x=!1;const S=location.hash.slice(1).split("&").map(C=>{const A=C.split("=")[0];return A===_?(x=!0,`${A}=${h}`):C}).filter(C=>C);return x||S.push(`${_}=${h}`),`#${S.join("&")}`}return`#${h}`}_getCurrentHash(){const l=location.hash.replace("#","");if(this._hashName){let h;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){const _=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(h[3]||0):l.getBearing();return l.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function rl(m,l){const h=m.getCenter(),_=Math.round(100*m.getZoom())/100,x=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,x),C=Math.round(h.lng*S)/S,A=Math.round(h.lat*S)/S,z=m.getBearing(),O=m.getPitch();let N=l?`/${C}/${A}/${_}`:`${_}/${A}/${C}`;return(z||O)&&(N+="/"+Math.round(10*z)/10),O&&(N+=`/${Math.round(O)}`),N}const nh={linearity:.3,easing:a.cE(0,0,.3,1)},dm=a.ak({deceleration:2500,maxSpeed:1400},nh),fm=a.ak({deceleration:20,maxSpeed:1400},nh),Fd=a.ak({deceleration:1e3,maxSpeed:360},nh),Hb=a.ak({deceleration:1e3,maxSpeed:90},nh);class Oy{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.a4.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,h=a.a4.now();for(;l.length>0&&h-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)h.zoom+=S.zoomDelta||0,h.bearing+=S.bearingDelta||0,h.pitch+=S.pitchDelta||0,S.panDelta&&h.pan._add(S.panDelta),S.around&&(h.around=S.around),S.pinchAround&&(h.pinchAround=S.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const S=Nd(h.pan.mag(),_,a.ak({},dm,l||{}));x.offset=h.pan.mult(S.amount/h.pan.mag()),x.center=this._map.transform.center,nl(x,S)}if(h.zoom){const S=Nd(h.zoom,_,fm);x.zoom=this._map.transform.zoom+S.amount,nl(x,S)}if(h.bearing){const S=Nd(h.bearing,_,Fd);x.bearing=this._map.transform.bearing+a.c(S.amount,-179,179),nl(x,S)}if(h.pitch){const S=Nd(h.pitch,_,Hb);x.pitch=this._map.transform.pitch+S.amount,nl(x,S)}if(x.zoom||x.bearing){const S=h.pinchAround===void 0?h.around:h.pinchAround;x.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function nl(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function Nd(m,l,h){const{maxSpeed:_,linearity:x,deceleration:S}=h,C=a.c(m*x/(l/1e3),-_,_),A=Math.abs(C)/(S*x);return{easing:h.easing,duration:1e3*A,amount:C*(A/2)}}class zo extends a.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_,x={}){const S=je(h.getCanvasContainer(),_),C=h.unproject(S);super(l,a.ak({point:S,lngLat:C,originalEvent:_},x)),this._defaultPrevented=!1,this.target=h}}class ih extends a.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){const x=l==="touchend"?_.changedTouches:_.touches,S=Be(h.getCanvasContainer(),x),C=S.map(z=>h.unproject(z)),A=S.reduce((z,O,N,V)=>z.add(O.div(V.length)),new a.P(0,0));super(l,{points:S,point:A,lngLats:C,lngLat:h.unproject(A),originalEvent:_}),this._defaultPrevented=!1}}class Zb extends a.a8{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){super(l,{originalEvent:_}),this._defaultPrevented=!1}}class pm{constructor(l,h){this._map=l,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new Zb(l.type,this._map,l))}mousedown(l,h){return this._mousedownPos=h,this._firePreventable(new zo(l.type,this._map,l))}mouseup(l){this._map.fire(new zo(l.type,this._map,l))}preclick(l){const h=a.ak({},l);h.type="preclick",this._map.fire(new zo(h.type,this._map,h))}click(l,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(l),this._map.fire(new zo(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new zo(l.type,this._map,l))}mouseover(l){this._map.fire(new zo(l.type,this._map,l))}mouseout(l){this._map.fire(new zo(l.type,this._map,l))}touchstart(l){return this._firePreventable(new ih(l.type,this._map,l))}touchmove(l){this._map.fire(new ih(l.type,this._map,l))}touchend(l){this._map.fire(new ih(l.type,this._map,l))}touchcancel(l){this._map.fire(new ih(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jd{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new zo(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new zo(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oh{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,h){this.isEnabled()&&l.shiftKey&&l.button===0&&(te(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(l,h){if(!this._active)return;const _=h,x=this._startPos,S=this._lastPos;if(!x||!S||S.equals(_)||!this._box&&_.dist(x)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=$("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const C=Math.min(x.x,_.x),A=Math.max(x.x,_.x),z=Math.min(x.y,_.y),O=Math.max(x.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${z}px)`,this._box.style.width=A-C+"px",this._box.style.height=O-z+"px")})}mouseupWindow(l,h){if(!this._active)return;const _=this._startPos,x=h;if(_&&l.button===0){if(this.reset(),Ee(),_.x!==x.x||_.y!==x.y)return this._map.fire(new a.a8("boxzoomend",{originalEvent:l})),{cameraAnimation:S=>S.fitScreenCoordinates(_,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),se(),delete this._startPos,delete this._lastPos}_fireEvent(l,h){return this._map.fire(new a.a8(l,{originalEvent:h}))}}function sh(m,l){const h={};for(let _=0;_<m.length;_++)h[m[_].identifier]=l[_];return h}class ah{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),_.length===this.numTouches&&(this.centroid=function(x){const S=new a.P(0,0);for(const C of x)S._add(C);return S.div(x.length)}(h),this.touches=sh(_,h)))}touchmove(l,h,_){if(this.aborted||!this.centroid)return;const x=sh(_,h);for(const S in this.touches){const C=x[S];(!C||C.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(l,h,_){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class lh{constructor(l){this.singleTap=new ah(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,h,_){this.singleTap.touchstart(l,h,_)}touchmove(l,h,_){this.singleTap.touchmove(l,h,_)}touchend(l,h,_){const x=this.singleTap.touchend(l,h,_);if(x){const S=l.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(x)<30;if(S&&C||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Vd{constructor(){this._zoomIn=new lh({numTouches:1,numTaps:2}),this._zoomOut=new lh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,h,_){this._zoomIn.touchstart(l,h,_),this._zoomOut.touchstart(l,h,_)}touchmove(l,h,_){this._zoomIn.touchmove(l,h,_),this._zoomOut.touchmove(l,h,_)}touchend(l,h,_){const x=this._zoomIn.touchend(l,h,_),S=this._zoomOut.touchend(l,h,_);return x?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(x)},{originalEvent:l})}):S?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(S)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const $d={0:1,2:2};class vo{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,h){return!1}_move(l,h){return{}}mousedown(l,h){if(this._lastPoint)return;const _=Ze(l);this._correctButton(l,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(l,h){const _=this._lastPoint;if(_){if(l.preventDefault(),this._eventButton!=null&&function(x,S){const C=$d[S];return x.buttons===void 0||(x.buttons&C)!==C}(l,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}}mouseupWindow(l){this._lastPoint&&Ze(l)===this._eventButton&&(this._moved&&Ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class By extends vo{mousedown(l,h){super.mousedown(l,h),this._lastPoint&&(this._active=!0)}_correctButton(l,h){return h===0&&!l.ctrlKey}_move(l,h){return{around:h,panDelta:h.sub(l)}}}class mm extends vo{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){const _=.8*(h.x-l.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(l){l.preventDefault()}}class gm extends vo{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){const _=-.5*(h.y-l.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(l){l.preventDefault()}}class Zl{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),a.aR(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(l,h,_){return this._calculateTransform(l,h,_)}touchmove(l,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!a.cF())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,h,_)}}touchend(l,h,_){this._calculateTransform(l,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,h,_){_.length>0&&(this._active=!0);const x=sh(_,h),S=new a.P(0,0),C=new a.P(0,0);let A=0;for(const O in x){const N=x[O],V=this._touches[O];V&&(S._add(N),C._add(N.sub(V)),A++,x[O]=N)}if(this._touches=x,A<this._minTouches||!C.mag())return;const z=C.div(A);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(A),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ud{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,h,_){return{}}touchstart(l,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(l,h,_){const x=this._firstTwoTouches;if(!x)return;l.preventDefault();const[S,C]=x,A=Xl(_,h,S),z=Xl(_,h,C);if(!A||!z)return;const O=this._aroundCenter?null:A.add(z).div(2);return this._move([A,z],O,l)}touchend(l,h,_){if(!this._firstTwoTouches)return;const[x,S]=this._firstTwoTouches,C=Xl(_,h,x),A=Xl(_,h,S);C&&A||(this._active&&Ee(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Xl(m,l,h){for(let _=0;_<m.length;_++)if(m[_].identifier===h)return l[_]}function Gd(m,l){return Math.log(m/l)/Math.LN2}class Wd extends Ud{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,h){const _=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Gd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gd(this._distance,_),pinchAround:h}}}function _m(m,l){return 180*m.angleWith(l)/Math.PI}class Fy extends Ud{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,h){const _=this._vector;if(this._vector=l[0].sub(l[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:_m(this._vector,_),pinchAround:h}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const x=_m(l,_);return Math.abs(x)<h}}function il(m){return Math.abs(m.y)>Math.abs(m.x)}class Xb extends Ud{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,il(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,h,_){const x=this._lastPoints;if(!x)return;const S=l[0].sub(x[0]),C=l[1].sub(x[1]);return this._map._cooperativeGestures&&!a.cF()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(S,C,_.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(S.y+C.y)/2*-.5})}gestureBeginsVertically(l,h,_){if(this._valid!==void 0)return this._valid;const x=l.mag()>=2,S=h.mag()>=2;if(!x&&!S)return;if(!x||!S)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const C=l.y>0==h.y>0;return il(l)&&il(h)&&C}}const Yb={panStep:100,bearingStep:15,pitchStep:10};class Ny{constructor(){const l=Yb;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let h=0,_=0,x=0,S=0,C=0;switch(l.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:l.shiftKey?_=-1:(l.preventDefault(),S=-1);break;case 39:l.shiftKey?_=1:(l.preventDefault(),S=1);break;case 38:l.shiftKey?x=1:(l.preventDefault(),C=-1);break;case 40:l.shiftKey?x=-1:(l.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(_=0,x=0),{cameraAnimation:A=>{const z=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:qd,zoom:h?Math.round(z)+h*(l.shiftKey?2:1):z,bearing:A.getBearing()+_*this._bearingStep,pitch:A.getPitch()+x*this._pitchStep,offset:[-S*this._panStep,-C*this._panStep],center:A.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qd(m){return m*(2-m)}const Hd=4.000244140625;class jy{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.aR(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||a.cF()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const _=a.a4.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,h!==0&&h%Hd==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),l.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=l,this._delta-=h,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=je(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>Hd?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&N!==0&&(N=1/N);const V=h(),G=Math.pow(2,V),W=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):G;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(W*N))),this._type==="wheel"&&(this._startZoom=V,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:h(),x=this._startZoom,S=this._easing;let C,A=!1;if(this._type==="wheel"&&x&&S){const O=Math.min((a.a4.now()-this._lastWheelEventTime)/200,1),N=S(O);C=a.n(x,_,N),O<1?this._frameId||(this._frameId=!0):A=!0}else C=_,A=!0;this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let z=C-h();return z*this._lastDelta<0&&(z=0),{noInertia:!0,needsRenderFrame:!A,zoomDelta:z,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let h=a.cG;if(this._prevEase){const _=this._prevEase,x=(a.a4.now()-_.start)/_.duration,S=_.easing(x+.01)-_.easing(x),C=.27/Math.sqrt(S*S+1e-4)*.01,A=Math.sqrt(.0729-C*C);h=a.cE(C,A,.25,1)}return this._prevEase={start:a.a4.now(),duration:l,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=$("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Vy{constructor(l,h){this._clickZoom=l,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Zd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,h){return l.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(l.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ym{constructor(){this._tap=new lh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,h,_){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(l,h,_))}touchmove(l,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const x=h[0],S=x.y-this._swipePoint.y;return this._swipePoint=x,l.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(l,h,_)}touchend(l,h,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(l,h,_)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $y{constructor(l,h,_){this._el=l,this._mousePan=h,this._touchPan=_}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Uy{constructor(l,h,_){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gy{constructor(l,h,_,x){this._el=l,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ch=m=>m.zoom||m.drag||m.pitch||m.rotate;class Wy extends a.a8{}class qc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,h){const _=a.v.sub([],h,l);this.radius=a.v.length(_[2]<0?a.v.div([],_,this.constants):[_[0],_[1],0])}projectRay(l){a.v.div(l,l,this.constants),a.v.normalize(l,l),a.v.mul(l,l,this.constants);const h=a.v.scale([],l,this.radius);if(h[2]>0){const _=a.v.scale([],[0,0,1],a.v.dot(h,[0,0,1])),x=a.v.scale([],a.v.normalize([],[h[0],h[1],0]),this.radius),S=a.v.add([],h,a.v.scale([],a.v.sub([],a.v.add([],x,_),h),2));h[0]=S[0],h[1]=S[1]}return h}}function uh(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class qy{constructor(l,h){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Oy(l),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),a.aR(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,S,C]of this._listeners){const A=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(S,A,C)}}destroy(){for(const[l,h,_]of this._listeners){const x=l===document?this.handleWindowEvent:this.handleEvent;l.removeEventListener(h,x,_)}}_addDefaultHandlers(l){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new pm(h,l));const x=h.boxZoom=new oh(h,l);this._add("boxZoom",x);const S=new Vd,C=new Zd;h.doubleClickZoom=new Vy(C,S),this._add("tapZoom",S),this._add("clickZoom",C);const A=new ym;this._add("tapDragZoom",A);const z=h.touchPitch=new Xb(h);this._add("touchPitch",z);const O=new mm(l),N=new gm(l);h.dragRotate=new Uy(l,O,N),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]);const V=new By(l),G=new Zl(h,l);h.dragPan=new $y(_,V,G),this._add("mousePan",V),this._add("touchPan",G,["touchZoom","touchRotate"]);const W=new Fy,X=new Wd;h.touchZoomRotate=new Gy(_,X,W,A),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),this._add("blockableMapEvent",new jd(h));const K=h.scrollZoom=new jy(h,this);this._add("scrollZoom",K,["mousePan"]);const Y=h.keyboard=new Ny;this._add("keyboard",Y);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[Z]&&h[Z].enable(l[Z])}_add(l,h,_){this._handlers.push({handlerName:l,handler:h,allowed:_}),this._handlersById[l]=h}stop(l){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ch(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,h,_){for(const x in l)if(x!==_&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const h=[];for(const _ of l)this._el.contains(_.target)&&h.push(_);return h}handleEvent(l,h){this._updatingCamera=!0;const _=l.type==="renderFrame",x=_?void 0:l,S={needsRenderFrame:!1},C={},A={},z=l.touches?this._getMapTouches(l.touches):void 0,O=z?Be(this._el,z):_?void 0:je(this._el,l);for(const{handlerName:G,handler:W,allowed:X}of this._handlers){if(!W.isEnabled())continue;let K;this._blockedByActive(A,X,G)?W.reset():W[h||l.type]&&(K=W[h||l.type](l,O,z),this.mergeHandlerResult(S,C,K,G,x),K&&K.needsRenderFrame&&this._triggerRenderFrame()),(K||W.isActive())&&(A[G]=W)}const N={};for(const G in this._previousActiveHandlers)A[G]||(N[G]=x);this._previousActiveHandlers=A,(Object.keys(N).length||uh(S))&&(this._changes.push([S,C,N]),this._triggerRenderFrame()),(Object.keys(A).length||uh(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=S;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(l,h,_,x,S){if(!_)return;a.ak(l,_);const C={handlerName:x,originalEvent:_.originalEvent||S};_.zoomDelta!==void 0&&(h.zoom=C),_.panDelta!==void 0&&(h.drag=C),_.pitchDelta!==void 0&&(h.pitch=C),_.bearingDelta!==void 0&&(h.rotate=C)}_applyChanges(){const l={},h={},_={};for(const[x,S,C]of this._changes)x.panDelta&&(l.panDelta=(l.panDelta||new a.P(0,0))._add(x.panDelta)),x.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(l.around=x.around),x.aroundCoord!==void 0&&(l.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(l.pinchAround=x.pinchAround),x.noInertia&&(l.noInertia=x.noInertia),a.ak(h,S),a.ak(_,C);this._updateMapTransform(l,h,_),this._changes=[]}_updateMapTransform(l,h,_){const x=this._map,S=x.transform,C=ae=>[ae.x,ae.y,ae.z];if((ae=>{const pe=this._eventsInProgress.drag;return pe&&!this._handlersById[pe.handlerName].isActive()})()&&!uh(l)){const ae=S.zoom;S.cameraElevationReference="sea",this._originalZoom!=null&&S._orthographicProjectionAtLowPitch&&S.projection.name!=="globe"&&S.pitch===0?(S.cameraElevationReference="ground",S.zoom=this._originalZoom):(S.recenterOnTerrain(),S.cameraElevationReference="ground"),ae!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&x._stop(!0),!uh(l))return void this._fireEvents(h,_,!0);let{panDelta:A,zoomDelta:z,bearingDelta:O,pitchDelta:N,around:V,aroundCoord:G,pinchAround:W}=l;S._isCameraConstrained&&(z>0&&(z=0),S._isCameraConstrained=!1),W!==void 0&&(V=W),(z||(ae=>h[ae]&&!this._eventsInProgress[ae])("drag"))&&V&&(this._dragOrigin=C(S.pointCoordinate3D(V)),this._originalZoom=S.zoom,this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",x._stop(!0),V=V||x.transform.centerPoint,O&&(S.bearing+=O),N&&(S.pitch+=N),S._updateCameraState();const X=[0,0,0];if(A)if(S.projection.name==="mercator"){const ae=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(V).dir),pe=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(V.sub(A)).dir);X[0]=pe[0]-ae[0],X[1]=pe[1]-ae[1]}else{const ae=S.pointCoordinate(V);if(S.projection.name==="globe"){A=A.rotate(-S.angle);const pe=S._pixelsPerMercatorPixel/S.worldSize;X[0]=-A.x*a.cH(a.l(ae.y))*pe,X[1]=-A.y*a.cH(S.center.lat)*pe}else{const pe=S.pointCoordinate(V.sub(A));ae&&pe&&(X[0]=pe.x-ae.x,X[1]=pe.y-ae.y)}}const K=S.zoom,Y=[0,0,0];if(z){const ae=C(G||S.pointCoordinate3D(V)),pe={dir:a.v.normalize([],a.v.sub([],ae,S._camera.position))};if(pe.dir[2]<0){const ge=S.zoomDeltaToMovement(ae,z);a.v.scale(Y,pe.dir,ge)}}const Z=a.v.add(X,X,Y);S._translateCameraConstrained(Z),z&&Math.abs(S.zoom-K)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(h,_,!0)}_fireEvents(l,h,_){const x=ch(this._eventsInProgress),S=ch(l),C={};for(const N in l){const{originalEvent:V}=l[N];this._eventsInProgress[N]||(C[`${N}start`]=V),this._eventsInProgress[N]=l[N]}!x&&S&&this._fireEvent("movestart",S.originalEvent);for(const N in C)this._fireEvent(N,C[N]);S&&this._fireEvent("move",S.originalEvent);for(const N in l){const{originalEvent:V}=l[N];this._fireEvent(N,V)}const A={};let z;for(const N in this._eventsInProgress){const{handlerName:V,originalEvent:G}=this._eventsInProgress[N];this._handlersById[V].isActive()||(delete this._eventsInProgress[N],z=h[V]||G,A[`${N}end`]=z)}for(const N in A)this._fireEvent(N,A[N]);const O=ch(this._eventsInProgress);if(_&&(x||S)&&!O){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;N?(V(N.bearing||this._map.getBearing())&&(N.bearing=0),this._map.easeTo(N,{originalEvent:z})):(this._map.fire(new a.a8("moveend",{originalEvent:z})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,h){this._map.fire(new a.a8(l,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new Wy("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Hy="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zy extends a.a6{constructor(l,h){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,a.aR(["_renderFrameCallback"],this)}getCenter(){return new a.L(this.transform.center.lng,this.transform.center.lat)}setCenter(l,h){return this.jumpTo({center:l},h)}panBy(l,h,_){return l=a.P.convert(l).mult(-1),this.panTo(this.transform.center,a.ak({offset:l},h),_)}panTo(l,h,_){return this.easeTo(a.ak({center:l},h),_)}getZoom(){return this.transform.zoom}setZoom(l,h){return this.jumpTo({zoom:l},h),this}zoomTo(l,h,_){return this.easeTo(a.ak({zoom:l},h),_)}zoomIn(l,h){return this.zoomTo(this.getZoom()+1,l,h),this}zoomOut(l,h){return this.zoomTo(this.getZoom()-1,l,h),this}getBearing(){return this.transform.bearing}setBearing(l,h){return this.jumpTo({bearing:l},h),this}getPadding(){return this.transform.padding}setPadding(l,h){return this.jumpTo({padding:l},h),this}rotateTo(l,h,_){return this.easeTo(a.ak({bearing:l},h),_)}resetNorth(l,h){return this.rotateTo(0,a.ak({duration:1e3},l),h),this}resetNorthPitch(l,h){return this.easeTo(a.ak({bearing:0,pitch:0,duration:1e3},l),h),this}snapToNorth(l,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,h):this}getPitch(){return this.transform.pitch}setPitch(l,h){return this.jumpTo({pitch:l},h),this}cameraForBounds(l,h){l=a.D.convert(l);const _=h&&h.bearing||0,x=h&&h.pitch||0,S=l.getNorthWest(),C=l.getSouthEast();return this._cameraForBounds(this.transform,S,C,_,x,h)}_extendCameraOptions(l){const h={top:0,bottom:0,right:0,left:0};if(typeof(l=a.ak({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){const _=l.padding;l.padding={top:_,bottom:_,right:_,left:_}}return l.padding=a.ak(h,l.padding),l}_minimumAABBFrustumDistance(l,h){const _=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return _/x>l.aspect?_/(2*Math.tan(.5*l.fovX)*l.aspect):x/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,h,_,x,S,C){const A=l.clone(),z=this._extendCameraOptions(C);A.bearing=x,A.pitch=S;const O=a.L.convert(h),N=a.L.convert(_),V=.5*(O.lat+N.lat),G=.5*(O.lng+N.lng),W=a.cI(V,G),X=a.v.normalize([],W),K=a.v.normalize([],a.v.cross([],X,[0,1,0])),Y=a.v.cross([],K,X),Z=[K[0],K[1],K[2],0,Y[0],Y[1],Y[2],0,X[0],X[1],X[2],0,0,0,0,1],ae=[W,a.cI(O.lat,O.lng),a.cI(N.lat,O.lng),a.cI(N.lat,N.lng),a.cI(O.lat,N.lng),a.cI(V,O.lng),a.cI(V,N.lng),a.cI(O.lat,G),a.cI(N.lat,G)];let pe=a.c3.fromPoints(ae.map(ke=>[a.v.dot(K,ke),a.v.dot(Y,ke),a.v.dot(X,ke)]));const ge=a.v.transformMat4([],pe.center,Z);a.v.squaredLength(ge)===0&&a.v.set(ge,0,0,1),a.v.normalize(ge,ge),a.v.scale(ge,ge,a.aC),A.center=a.cJ(ge);const ne=A.getWorldToCameraMatrix(),ce=a.m.invert(new Float64Array(16),ne);pe=a.c3.applyTransform(pe,a.m.multiply([],ne,Z)),a.v.transformMat4(ge,ge,ne);const _e=.5*(pe.max[2]-pe.min[2]),we=this._minimumAABBFrustumDistance(A,pe),ve=a.v.scale([],[0,0,1],_e),Se=a.v.add(ve,ge,ve),qe=we+(A.pitch===0?0:a.v.distance(ge,Se)),De=A.globeCenterInViewSpace,Ne=a.v.sub([],ge,[De[0],De[1],De[2]]);a.v.normalize(Ne,Ne),a.v.scale(Ne,Ne,qe);const Me=a.v.add([],ge,Ne);a.v.transformMat4(Me,Me,ce);const We=a.cL/a.aC,Fe=a.v.length(Me),Xe=a.b(Math.max(Fe*We-a.cL,Number.EPSILON),0),he=Math.min(A.zoomFromMercatorZAdjusted(Xe),z.maxZoom);return he>.5*(a.Z+a.G)?(A.setProjection({name:"mercator"}),A.zoom=he,this._cameraForBounds(A,h,_,x,S,C)):{center:A.center,zoom:he,bearing:x,pitch:S}}queryTerrainElevation(l,h){const _=this.transform.elevation;return _?(h=a.ak({},{exaggerated:!0},h),_.getAtPoint(a.M.fromLngLat(l),null,h.exaggerated)):null}_cameraForBounds(l,h,_,x,S,C){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,h,_,x,S,C);const A=l.clone(),z=this._extendCameraOptions(C),O=A.padding;A.bearing=x,A.pitch=S;const N=a.L.convert(h),V=a.L.convert(_),G=new a.L(N.lng,V.lat),W=new a.L(V.lng,N.lat),X=A.project(N),K=A.project(V),Y=this.queryTerrainElevation(N),Z=this.queryTerrainElevation(V),ae=this.queryTerrainElevation(G),pe=this.queryTerrainElevation(W),ge=[[X.x,X.y,Math.min(Y||0,Z||0,ae||0,pe||0)],[K.x,K.y,Math.max(Y||0,Z||0,ae||0,pe||0)]];let ne=a.c3.fromPoints(ge);const ce=A.getWorldToCameraMatrix(),_e=a.m.invert(new Float64Array(16),ce);ne=a.c3.applyTransform(ne,ce);const we=a.v.sub([],ne.max,ne.min),ve=O.left||0,Se=O.right||0,qe=O.bottom||0,De=O.top||0,{left:Ne,right:Me,top:We,bottom:Fe}=z.padding,Xe=.5*(ve+Se),he=.5*(De+qe),ke=Math.min(A.scaleZoom(A.scale*Math.min((A.width-(ve+Se+Ne+Me))/we[0],(A.height-(qe+De+Fe+We))/we[1])),z.maxZoom),nt=A.scale/A.zoomScale(ke);ne=new a.c3([ne.min[0]-(Ne+Xe)*nt,ne.min[1]-(Fe+he)*nt,ne.min[2]],[ne.max[0]+(Me+Xe)*nt,ne.max[1]+(We+he)*nt,ne.max[2]]);const Ke=.5*we[2],Mt=this._minimumAABBFrustumDistance(A,ne),wt=[0,0,1,0];a.e.transformMat4(wt,wt,ce),a.e.normalize(wt,wt);const Ft=a.v.scale([],wt,Mt+Ke),St=a.v.add([],ne.center,Ft),Vt=(typeof z.offset.x=="number"&&typeof z.offset.y=="number"?new a.P(z.offset.x,z.offset.y):a.P.convert(z.offset)).rotate(-a.d(x));ne.center[0]-=Vt.x*nt,ne.center[1]+=Vt.y*nt,a.v.transformMat4(ne.center,ne.center,_e),a.v.transformMat4(St,St,_e);const $t=[ne.center[0],ne.center[1],St[2]*A.pixelsPerMeter];a.v.scale($t,$t,1/A.worldSize);const Rt=a.cK($t[0]),Dt=a.l($t[1]),Sr=Math.min(A._zoomFromMercatorZ($t[2]),z.maxZoom),tr=new a.L(Rt,Dt);return A.mercatorFromTransition&&Sr<.5*(a.Z+a.G)?(A.setProjection({name:"globe"}),A.zoom=Sr,this._cameraForBounds(A,h,_,x,S,C)):{center:tr,zoom:Sr,bearing:x,pitch:S}}fitBounds(l,h,_){const x=this.cameraForBounds(l,h);return this._fitInternal(x,h,_)}fitScreenCoordinates(l,h,_,x,S){const C=a.P.convert(l),A=a.P.convert(h),z=new a.P(Math.min(C.x,A.x),Math.min(C.y,A.y)),O=new a.P(Math.max(C.x,A.x),Math.max(C.y,A.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,A))return this;const N=this.transform.pointLocation3D(z),V=this.transform.pointLocation3D(O),G=this.transform.pointLocation3D(new a.P(z.x,O.y)),W=this.transform.pointLocation3D(new a.P(O.x,z.y)),X=[Math.min(N.lng,V.lng,G.lng,W.lng),Math.min(N.lat,V.lat,G.lat,W.lat)],K=[Math.max(N.lng,V.lng,G.lng,W.lng),Math.max(N.lat,V.lat,G.lat,W.lat)],Y=x&&x.pitch?x.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,X,K,_,Y,x);return this._fitInternal(Z,x,S)}_fitInternal(l,h,_){return l?(delete(h=a.ak(l,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(l,h){this.stop();const _=l.preloadOnly?this.transform.clone():this.transform;let x=!1,S=!1,C=!1;return"zoom"in l&&_.zoom!==+l.zoom&&(x=!0,_.zoom=+l.zoom),l.center!==void 0&&(_.center=a.L.convert(l.center)),"bearing"in l&&_.bearing!==+l.bearing&&(S=!0,_.bearing=+l.bearing),"pitch"in l&&_.pitch!==+l.pitch&&(C=!0,_.pitch=+l.pitch),l.padding==null||_.isPaddingEqual(l.padding)||(_.padding=l.padding),l.preloadOnly?(this._preloadTiles(_),this):(this.fire(new a.a8("movestart",h)).fire(new a.a8("move",h)),x&&this.fire(new a.a8("zoomstart",h)).fire(new a.a8("zoom",h)).fire(new a.a8("zoomend",h)),S&&this.fire(new a.a8("rotatestart",h)).fire(new a.a8("rotate",h)).fire(new a.a8("rotateend",h)),C&&this.fire(new a.a8("pitchstart",h)).fire(new a.a8("pitch",h)).fire(new a.a8("pitchend",h)),this.fire(new a.a8("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.X(Hy),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return a.X(Hy),this;this.stop();const x=_.zoom,S=_.pitch,C=_.bearing;_.setFreeCameraOptions(l);const A=x!==_.zoom,z=S!==_.pitch,O=C!==_.bearing;return this.fire(new a.a8("movestart",h)).fire(new a.a8("move",h)),A&&this.fire(new a.a8("zoomstart",h)).fire(new a.a8("zoom",h)).fire(new a.a8("zoomend",h)),O&&this.fire(new a.a8("rotatestart",h)).fire(new a.a8("rotate",h)).fire(new a.a8("rotateend",h)),z&&this.fire(new a.a8("pitchstart",h)).fire(new a.a8("pitch",h)).fire(new a.a8("pitchend",h)),this.fire(new a.a8("moveend",h)),this}easeTo(l,h){this._stop(!1,l.easeId),((l=a.ak({offset:[0,0],duration:500,easing:a.cG},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);const _=this.transform,x=this.getZoom(),S=this.getBearing(),C=this.getPitch(),A=this.getPadding(),z="zoom"in l?+l.zoom:x,O="bearing"in l?this._normalizeBearing(l.bearing,S):S,N="pitch"in l?+l.pitch:C,V="padding"in l?l.padding:_.padding,G=a.P.convert(l.offset);let W,X,K;if(_.projection.name==="globe"){const ve=a.M.fromLngLat(_.center),Se=G.rotate(-_.angle);ve.x+=Se.x/_.worldSize,ve.y+=Se.y/_.worldSize;const qe=ve.toLngLat(),De=a.L.convert(l.center||qe);this._normalizeCenter(De),W=_.centerPoint.add(Se),X=new a.P(ve.x,ve.y).mult(_.worldSize),K=new a.P(a.E(De.lng),a.H(De.lat)).mult(_.worldSize).sub(X)}else{W=_.centerPoint.add(G);const ve=_.pointLocation(W),Se=a.L.convert(l.center||ve);this._normalizeCenter(Se),X=_.project(ve),K=_.project(Se).sub(X)}const Y=_.zoomScale(z-x);let Z,ae;l.around&&(Z=a.L.convert(l.around),ae=_.locationPoint(Z));const pe=this._zooming||z!==x,ge=this._rotating||S!==O,ne=this._pitching||N!==C,ce=!_.isPaddingEqual(V),_e=ve=>Se=>{if(pe&&(ve.zoom=a.n(x,z,Se)),ge&&(ve.bearing=a.n(S,O,Se)),ne&&(ve.pitch=a.n(C,N,Se)),ce&&(ve.interpolatePadding(A,V,Se),W=ve.centerPoint.add(G)),Z)ve.setLocationAtPoint(Z,ae);else{const qe=ve.zoomScale(ve.zoom-x),De=z>x?Math.min(2,Y):Math.max(.5,Y),Ne=Math.pow(De,1-Se),Me=ve.unproject(X.add(K.mult(Se*Ne)).mult(qe));ve.setLocationAtPoint(ve.renderWorldCopies?Me.wrap():Me,W)}return l.preloadOnly||this._fireMoveEvents(h),ve};if(l.preloadOnly){const ve=this._emulate(_e,l.duration,_);return this._preloadTiles(ve),this}const we={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=pe,this._rotating=ge,this._pitching=ne,this._easeId=l.easeId,this._prepareEase(h,l.noMoveStart,we),this._ease(_e(_),ve=>{_.cameraElevationReference==="sea"&&_.recenterOnTerrain(),this._afterEase(h,ve)},l),this}_prepareEase(l,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||_.moving||this.fire(new a.a8("movestart",l)),this._zooming&&!_.zooming&&this.fire(new a.a8("zoomstart",l)),this._rotating&&!_.rotating&&this.fire(new a.a8("rotatestart",l)),this._pitching&&!_.pitching&&this.fire(new a.a8("pitchstart",l))}_fireMoveEvents(l){this.fire(new a.a8("move",l)),this._zooming&&this.fire(new a.a8("zoom",l)),this._rotating&&this.fire(new a.a8("rotate",l)),this._pitching&&this.fire(new a.a8("pitch",l))}_afterEase(l,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,x=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,_&&this.fire(new a.a8("zoomend",l)),x&&this.fire(new a.a8("rotateend",l)),S&&this.fire(new a.a8("pitchend",l)),this.fire(new a.a8("moveend",l))}flyTo(l,h){if(this._prefersReducedMotion(l)){const Fe=a.p(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Fe,h)}this.stop(),l=a.ak({offset:[0,0],speed:1.2,curve:1.42,easing:a.cG},l);const _=this.transform,x=this.getZoom(),S=this.getBearing(),C=this.getPitch(),A="zoom"in l?a.c(+l.zoom,_.minZoom,_.maxZoom):x,z="bearing"in l?this._normalizeBearing(l.bearing,S):S,O="pitch"in l?+l.pitch:C,N=_.zoomScale(A-x),V=a.P.convert(l.offset),G=_.centerPoint.add(V),W=_.pointLocation(G);let X=l.center;if(X&&l.padding){const Fe=this._cameraForBounds(this.transform,X,X,z,O,l);Fe&&(X=Fe.center)}X=a.L.convert(X||W),this._normalizeCenter(X);const K=_.project(W),Y=_.project(X).sub(K);let Z=l.curve;const ae=Math.max(_.width,_.height),pe=ae/N,ge=Y.mag();if("minZoom"in l){const Fe=a.c(Math.min(l.minZoom,x,A),_.minZoom,_.maxZoom),Xe=ae/_.zoomScale(Fe-x);Z=Math.sqrt(Xe/ge*2)}const ne=Z*Z;function ce(Fe){const Xe=(pe*pe-ae*ae+(Fe?-1:1)*ne*ne*ge*ge)/(2*(Fe?pe:ae)*ne*ge);return Math.log(Math.sqrt(Xe*Xe+1)-Xe)}function _e(Fe){return(Math.exp(Fe)-Math.exp(-Fe))/2}function we(Fe){return(Math.exp(Fe)+Math.exp(-Fe))/2}const ve=ce(0);let Se=function(Fe){return we(ve)/we(ve+Z*Fe)},qe=function(Fe){return ae*((we(ve)*(_e(Xe=ve+Z*Fe)/we(Xe))-_e(ve))/ne)/ge;var Xe},De=(ce(1)-ve)/Z;if(Math.abs(ge)<1e-6||!isFinite(De)){if(Math.abs(ae-pe)<1e-6)return this.easeTo(l,h);const Fe=pe<ae?-1:1;De=Math.abs(Math.log(pe/ae))/Z,qe=function(){return 0},Se=function(Xe){return Math.exp(Fe*Z*Xe)}}l.duration="duration"in l?+l.duration:1e3*De/("screenSpeed"in l?+l.screenSpeed/Z:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const Ne=S!==z,Me=O!==C,We=Fe=>Xe=>{const he=Xe*De,ke=1/Se(he);Fe.zoom=Xe===1?A:x+Fe.scaleZoom(ke),Ne&&(Fe.bearing=a.n(S,z,Xe)),Me&&(Fe.pitch=a.n(C,O,Xe));const nt=Xe===1?X:Fe.unproject(K.add(Y.mult(qe(he))).mult(ke));return Fe.setLocationAtPoint(Fe.renderWorldCopies?nt.wrap():nt,G),Fe._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(h),Fe};if(l.preloadOnly){const Fe=this._emulate(We,l.duration,_);return this._preloadTiles(Fe),this}return this._zooming=!0,this._rotating=Ne,this._pitching=Me,this._prepareEase(h,!1),this._ease(We(_),()=>this._afterEase(h),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!l){const _=this.handlers;_&&_.stop(!1)}return this}_ease(l,h,_){_.animate===!1||_.duration===0?(l(1),h()):(this._easeStart=a.a4.now(),this._easeOptions=_,this._onEaseFrame=l,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((a.a4.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,h){l=a.w(l,-180,180);const _=Math.abs(l-h);return Math.abs(l-360-h)<_&&(l-=360),Math.abs(l+360-h)<_&&(l+=360),l}_normalizeCenter(l){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const _=l.lng-h.center.lng;l.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&a.a4.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,h,_){const x=Math.ceil(15*h/1e3),S=[],C=l(_.clone());for(let A=0;A<=x;A++){const z=C(A/x);S.push(z.clone())}return S}}class vm{constructor(l={}){this.options=l,a.aR(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const h=this.options&&this.options.compact;return this._map=l,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=$("button","mapboxgl-ctrl-attrib-button",this._container),$("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=$("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,h){const _=this._map._getUIString(`AttributionControl.${h}`);l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.cM.ACCESS_TOKEN}];if(l){const _=h.reduce((x,S,C)=>(S.value&&(x+=`${S.key}=${S.value}${C<h.length-1?"&":""}`),x),"?");l.href=`${a.cM.FEEDBACK_URL}/${_}#${rl(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._mergedSourceCaches;for(const x in h){const S=h[x];if(S.used){const C=S.getSource();C.attribution&&l.indexOf(C.attribution)<0&&l.push(C.attribution)}}l.sort((x,S)=>x.length-S.length),l=l.filter((x,S)=>{for(let C=S+1;C<l.length;C++)if(l[C].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const _=l.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,l.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class xm{constructor(){a.aR(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=$("div","mapboxgl-ctrl");const h=$("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(const h in l){const _=l[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const h=l[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class bm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const h=++this._id;return this._queue.push({callback:l,id:h,cancelled:!1}),h}remove(l){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const x of _)if(x.id===l)return void(x.cancelled=!0)}run(l=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function wm(m,l,h){if(m=new a.L(m.lng,m.lat),l){const _=new a.L(m.lng-360,m.lat),x=new a.L(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),C=h.locationPoint(m).distSqr(l),A=l.x<0||l.y<0||l.x>h.width||l.y>h.height;h.locationPoint(_).distSqr(l)<C&&(A||Math.abs(_.lng-h.center.lng)<S)?m=_:h.locationPoint(x).distSqr(l)<C&&(A||Math.abs(x.lng-h.center.lng)<S)&&(m=x)}for(;Math.abs(m.lng-h.center.lng)>180;){const _=h.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Xd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Qn extends a.a6{constructor(l,h){if(super(),(l instanceof HTMLElement||h)&&(l=a.ak({element:l},h)),a.aR(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=a.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=$("div");const S=41,C=27,A=H("svg",{display:"block",height:S*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${S}`},this._element),z=H("radialGradient",{id:"shadowGradient"},H("defs",{},A));H("stop",{offset:"10%","stop-opacity":.4},z),H("stop",{offset:"100%","stop-opacity":.05},z),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},A),H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},A),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},A),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},A),this._offset=a.P.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const _=this._element.classList;for(const S in Xd)_.remove(`mapboxgl-marker-anchor-${S}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=l&&l.className?l.className.trim().split(/\s+/):[];_.add(...x),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=a.L.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const h=l.code,_=l.charCode||l.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(l){const h=l.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,h=this._pos;if(!l||!h)return!1;const _=l.unproject(h),x=l.getFreeCameraOptions();if(!x.position)return!1;const S=x.position.toLngLat();return S.distanceTo(_)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const h=this._pos;if(!h||h.x<0||h.x>l.transform.width||h.y<0||h.y>l.transform.height)return void this._clearFadeTimer();const _=l.unproject(h);let x;l._showingGlobe()&&a.cN(l.transform,this._lngLat)?x=0:(x=1-l._queryFogOpacity(_),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${Xd[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const l=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!l||_!=="map")return"";if(!h._showingGlobe()){const z=h.getPitch();return z?`rotateX(${z}deg)`:""}const x=a.Y(a.cO(h.transform,this._lngLat)),S=l.sub(a.cP(h.transform)),C=Math.abs(S.x)+Math.abs(S.y);if(C===0)return"";const A=x/C;return`rotateX(${-S.y*A}deg) rotateY(${S.x*A}deg)`}_calculateZTransform(){const l=this._pos,h=this._map;if(!h||!l)return"";let _=0;const x=this.getRotationAlignment();if(x==="map")if(h._showingGlobe()){const S=h.project(new a.L(this._lngLat.lng,this._lngLat.lat+.001)),C=h.project(new a.L(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);_=a.Y(Math.atan2(C.y,C.x))-90}else _=-h.getBearing();else if(x==="horizon"){const S=a.an(4,6,h.getZoom()),C=a.cP(h.transform);C.y+=S*h.transform.height;const A=l.sub(C),z=a.Y(Math.atan2(A.y,A.x));_=(z>90?z-270:z+90)*(1-S)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(l){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=wm(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),l===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=a.P.convert(l),this._update(),this}addClassName(l){return this._element.classList.add(l),this}removeClassName(l){return this._element.classList.remove(l),this}toggleClassName(l){return this._element.classList.toggle(l)}_onMove(l){const h=this._map;if(!h)return;const _=this._pointerdownPos,x=this._positionDelta;if(_&&x){if(!this._isDragging){const S=this._clickTolerance||h._clickTolerance;if(l.point.dist(_)<S)return;this._isDragging=!0}this._pos=l.point.sub(x),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.a8("dragstart"))),this.fire(new a.a8("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.a8("dragend")),this._state="inactive"}_addDragHandler(l){const h=this._map,_=this._pos;h&&_&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(_),this._pointerdownPos=l.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const h=this._map;return h&&(l?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Kb={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Xy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sm(m=new a.P(0,0),l="bottom"){if(typeof m=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new a.P(0,m);case"top-left":return new a.P(h,h);case"top-right":return new a.P(-h,h);case"bottom":return new a.P(0,-m);case"bottom-left":return new a.P(h,-h);case"bottom-right":return new a.P(-h,-h);case"left":return new a.P(m,0);case"right":return new a.P(-m,0)}return new a.P(0,0)}return m instanceof a.P||Array.isArray(m)?a.P.convert(m):a.P.convert(m[l]||[0,0])}class Jb{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const h=a.ba((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,h,_){this._start=this.getValue(h),this._end=l,this._startTime=h,this._endTime=h+_}}const Qb={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},gs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class Yy{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.continuousRedraw=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const ew={showCompass:!0,showZoom:!0,visualizePitch:!1};class ol{constructor(l,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new mm({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,_&&(this.mousePitch=new gm({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),a.aR(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(l,h){this.mouseRotate.mousedown(l,h),this.mousePitch&&this.mousePitch.mousedown(l,h),te()}move(l,h){const _=this.map,x=this.mouseRotate.mousemoveWindow(l,h),S=x&&x.bearingDelta;if(S&&_.setBearing(_.getBearing()+S),this.mousePitch){const C=this.mousePitch.mousemoveWindow(l,h),A=C&&C.pitchDelta;A&&_.setPitch(_.getPitch()+A)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){se(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(a.ak({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),je(this.element,l)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,je(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Be(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=Be(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const $s={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Hc={maxWidth:100,unit:"metric"},Yd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:a.c$,supported:D,setRTLTextPlugin:a.d1,getRTLTextPluginStatus:a.d2,Map:class extends Zy{constructor(m){const l=m;if((m=a.ak({},gs,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&a.cQ(window)&&(m.antialias=!1,a.X("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Or(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._repaint=!1,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new bm,this._domRenderTaskQueue=new bm,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.cR(),this._locale=a.ak({},Qb,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Jb(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.cS(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?{...m.contextCreateOptions}:{},typeof m.container=="string"){const h=document.getElementById(m.container);if(!h)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=h}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&a.X("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),a.aR(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new Yy,this._tp=m.devtools?new ky(this):new ky,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,h=>{this.repaint=h}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new qy(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||a.cM.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),m.hash&&(this._hash=new Ly(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){l.center==null&&l.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const h=m.bounds;h&&(this.resize(),this.fitBounds(h,a.ak({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new vm({customAttribution:m.customAttribution})),this._logoControl=new xm,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new a.a8(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new a.a8(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(m,l){if(l===void 0&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new a.a7(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[l];return l.indexOf("bottom")!==-1?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new a.a7(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new a.a8("movestart",m)).fire(new a.a8("move",m)),this.fire(new a.a8("resize",m)),l&&this.fire(new a.a8("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(a.D.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new a.a8("zoomstart")).fire(new a.a8("zoom")).fire(new a.a8("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new a.a8("zoomstart")).fire(new a.a8("zoom")).fire(new a.a8("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new a.a8("pitchstart")).fire(new a.a8("pitch")).fire(new a.a8("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new a.a8("pitchstart")).fire(new a.a8("pitch")).fire(new a.a8("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(l=>l==="auto"?navigator.language:l):m}setLanguage(m){const l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,l=m.projection.name;let h;l==="globe"&&m.zoom>=a.G?(m.setMercatorFromTransition(),h=!0):l==="mercator"&&m.zoom<a.G&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;return l=m.name==="globe"&&this.transform.zoom>=a.G?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m){return this.transform.locationPoint3D(a.L.convert(m))}unproject(m){return this.transform.pointLocation3D(a.P.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,h){if(m==="mouseenter"||m==="mouseover"){let _=!1;const x=C=>{const A=l.filter(O=>this.getLayer(O)),z=A.length?this.queryRenderedFeatures(C.point,{layers:A}):[];z.length?_||(_=!0,h.call(this,new zo(m,this,C.originalEvent,{features:z}))):_=!1},S=()=>{_=!1};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:S}}}if(m==="mouseleave"||m==="mouseout"){let _=!1;const x=C=>{const A=l.filter(z=>this.getLayer(z));(A.length?this.queryRenderedFeatures(C.point,{layers:A}):[]).length?_=!0:_&&(_=!1,h.call(this,new zo(m,this,C.originalEvent)))},S=C=>{_&&(_=!1,h.call(this,new zo(m,this,C.originalEvent)))};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:S}}}{const _=x=>{const S=l.filter(A=>this.getLayer(A)),C=S.length?this.queryRenderedFeatures(x.point,{layers:S}):[];C.length&&(x.features=C,h.call(this,x),delete x.features)};return{layers:new Set(l),listener:h,delegates:{[m]:_}}}}on(m,l,h){if(h===void 0)return super.on(m,l);if(Array.isArray(l)||(l=[l]),l){for(const x of l)if(!this._isValidId(x))return this}const _=this._createDelegatedListener(m,l,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const x in _.delegates)this.on(x,_.delegates[x]);return this}once(m,l,h){if(h===void 0)return super.once(m,l);if(Array.isArray(l)||(l=[l]),l){for(const x of l)if(!this._isValidId(x))return this}const _=this._createDelegatedListener(m,l,h);for(const x in _.delegates)this.once(x,_.delegates[x]);return this}off(m,l,h){if(h===void 0)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);for(const S of l)if(!this._isValidId(S))return this;const _=(S,C)=>{if(S.size!==C.size)return!1;for(const A of S)if(!C.has(A))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[m]:void 0;return x&&(S=>{for(let C=0;C<S.length;C++){const A=S[C];if(A.listener===h&&_(A.layers,l)){for(const z in A.delegates)this.off(z,A.delegates[z]);return S.splice(C,1),this}}})(x),this}queryRenderedFeatures(m,l){if(!this.style)return[];if(l!==void 0||m===void 0||m instanceof a.P||Array.isArray(m)||(l=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],(l=l||{}).layers&&Array.isArray(l.layers)){for(const h of l.layers)if(!this._isValidId(h))return[]}return this.style.queryRenderedFeatures(m,l,this.transform)}querySourceFeatures(m,l){return this._isValidId(m)?this.style.querySourceFeatures(m,l):[]}isPointOnSurface(m){const{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&a.X(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(m))}setStyle(m,l){return(l=a.ak({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){const l=this._locale[m];if(l==null)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new qo(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new qo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if(typeof m=="string"){const h=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(h,a.a2.Style);a.a1(_,(x,S)=>{x?this.fire(new a.a7(x)):S&&this._updateDiff(S,l)})}else typeof m=="object"&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(h){a.X(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.X("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new a.a7(new Error("IDs can't be empty."))),!1):!a.cu(m)||(this.fire(new a.a7(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}addSource(m,l){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,l,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,h)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,l,{pixelRatio:h=1,sdf:_=!1,stretchX:x,stretchY:S,content:C}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap){const{width:A,height:z,data:O}=a.a4.getImageData(l);this.style.addImage(m,{data:new a.a5({width:A,height:z},O),pixelRatio:h,stretchX:x,stretchY:S,content:C,sdf:_,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new a.a7(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:A,height:z}=l,O=l;this.style.addImage(m,{data:new a.a5({width:A,height:z},new Uint8Array(O.data)),pixelRatio:h,stretchX:x,stretchY:S,content:C,sdf:_,version:0,userImage:O}),O.onAdd&&O.onAdd(this,m)}}updateImage(m,l){this._lazyInitEmptyStyle();const h=this.style.getImage(m);if(!h)return void this.fire(new a.a7(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap?a.a4.getImageData(l):l,{width:x,height:S}=_,C=_.data;if(x===void 0||S===void 0)return void this.fire(new a.a7(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==h.data.width||S!==h.data.height)return void this.fire(new a.a7(new Error(`The width and height of the updated image (${x}, ${S})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`)));const A=!(l instanceof HTMLImageElement||ImageBitmap&&l instanceof ImageBitmap);h.data.replace(C,A),this.style.updateImage(m,h)}hasImage(m){return m?!!this.style&&!!this.style.getImage(m):(this.fire(new a.a7(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){a.a3(this._requestManager.transformRequest(m,a.a2.Image),(h,_)=>{l(h,_ instanceof HTMLImageElement?a.a4.getImageData(_):_)})}listImages(){return this.style.listImages()}addModel(m,l){this._lazyInitEmptyStyle(),this.style.addModel(m,l)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new a.a7(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,l){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)):this}moveLayer(m,l){return this._isValidId(m)?(this.style.moveLayer(m,l),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){return this._isValidId(m)?this.style.getOwnLayer(m):null}setLayerZoomRange(m,l,h){return this._isValidId(m)?(this.style.setLayerZoomRange(m,l,h),this._update(!0)):this}setFilter(m,l,h={}){return this._isValidId(m)?(this.style.setFilter(m,l,h),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,l,h,_={}){return this._isValidId(m)?(this.style.setPaintProperty(m,l,h,_),this._update(!0)):this}getPaintProperty(m,l){return this._isValidId(m)?this.style.getPaintProperty(m,l):null}setLayoutProperty(m,l,h,_={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,l,h,_),this._update(!0)):this}getLayoutProperty(m,l){return this._isValidId(m)?this.style.getLayoutProperty(m,l):null}getConfigProperty(m,l){return this.style.getConfigProperty(m,l)}setConfigProperty(m,l,h){return this.style.setConfigProperty(m,l,h),this._update(!0)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const l=m[0];l.properties?this.style.setFlatLight(l.properties,l.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,l={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.L.convert(m),this.transform):0}setFeatureState(m,l){return this._isValidId(m.source)?(this.style.setFeatureState(m,l),this._update()):this}removeFeatureState(m,l){return this._isValidId(m.source)?(this.style.removeFeatureState(m,l),this._update()):this}getFeatureState(m){return this._isValidId(m.source)?this.style.getFeatureState(m):null}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let h,_,x,S=this._container;for(;S&&(!_||!x);){const C=window.getComputedStyle(S).transform;C&&C!=="none"&&(h=C.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(_=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(x=h[3])),S=S.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=x?Math.abs(l/x):l}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.X("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=$("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=$("div","mapboxgl-canvas-container",m);this._canvas=$("canvas","mapboxgl-canvas",l),this._interactive&&(l.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=$("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=$("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){const h=a.a4.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const l=this._markers.indexOf(m);l!==-1&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const l=this._popups.indexOf(m);l!==-1&&this._popups.splice(l,1)}_setupPainter(){const m=a.ak({},D.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl2",m);l?(a.cT(l,!0),this.painter=new Wb(l,this._contextCreateOptions,this.transform,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.cU.testSupport(l)):this.fire(new a.a7(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.a8("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new a.a8("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l;this.fire(new a.a8("renderstart"));const h=this.painter.context.extTimerQuery,_=a.a4.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(l=x.createQuery(),x.beginQuery(h.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,O=this.transform.pitch,N=a.a4.now(),V=new a.al(z,{now:N,fadeDuration:S,pitch:O,transition:this.style.transition});this.style.update(V)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(_),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.a8("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.a8("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const z=a.a4.now()-_;x.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const O=x.getQueryParameter(l,x.QUERY_RESULT)/1e6;x.deleteQuery(l),this.fire(new a.a8("gpu-timing-frame",{cpuTime:z,gpuTime:O}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const O=this.painter.queryGpuTimers(z);this.fire(new a.a8("gpu-timing-layer",{layerTimes:O}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const O=this.painter.queryGpuTimeDeferredRender(z);this.fire(new a.a8("gpu-timing-deferred-render",{gpuTime:O}))},50)}const A=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(A||this._repaint)this.triggerRepaint();else{const z=!this.isMoving()&&this.loaded();if(z&&(C=this._updateAverageElevation(_,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new a.a8("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const O=this._calculateSpeedIndex();this.fire(new a.a8("speedindexcompleted",{speedIndex:O})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,this._performanceMetricsCollection&&a.cV(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){const h=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const _=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(_||(l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=m;const C=Math.abs(x-S);if(C>1){if(this._isInitialLoad||_)return this._averageElevation.jumpTo(S),h(S);this._averageElevation.easeTo(S,m,300)}else if(C>1e-4)return this._averageElevation.jumpTo(S),h(S)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){a.cW(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===a.cX||m.status===401)){const l=this.painter.context.gl;a.cT(l,!1),this._logoControl instanceof xm&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.a7(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.cY(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function x(S){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,S,0);const C=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,C),C}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(x(m),l.canvasCopies.map(x),l.timeStamps)}_canvasPixelComparison(m,l,h){let _=h[1]-h[0];const x=m.length/4;for(let S=0;S<l.length;S++){const C=l[S];let A=0;for(let z=0;z<C.length;z+=4)C[z]===m[z]&&C[z+1]===m[z+1]&&C[z+2]===m[z+2]&&C[z+3]===m[z+3]&&(A+=1);_+=(h[S+2]-h[S+1])*(1-A/x)}return _}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.cZ(this.painter.context.gl),this._removed=!0,this.fire(new a.a8("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=a.a4.frame(l=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(l)}))}_preloadTiles(m){const l=this.style?Object.values(this.style._sourceCaches):[];return a.c_(l,(h,_)=>h._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){a.d0(m,l)}get version(){return a.c$}},NavigationControl:class{constructor(m){this.options=a.ak({},ew,m),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(a.aR(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),$("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),$("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aR(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:l}):h.resetNorth({},{originalEvent:l}))}),this._compassIcon=$("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const l=m.getZoom(),h=l===m.getMaxZoom(),_=l===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ol(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){const h=$("button",m,this._container);return h.type="button",h.addEventListener("click",l),h}_setButtonTitle(m,l){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends a.a6{constructor(m){super();const l=navigator.geolocation;this.options=a.ak({geolocation:l},$s,m),a.aR(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=tl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const l=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>l(h.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),h=m.coords;return!!l&&(h.longitude<l.getWest()||h.longitude>l.getEast()||h.latitude<l.getSouth()||h.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new a.a8("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.a8("geolocate",m)),this._finish()}}_updateCamera(m){const l=new a.L(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,_=this._map.getBearing(),x=a.ak({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(h),x,{geolocateSource:!0})}_updateMarker(m){if(m){const l=new a.L(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,l=a.b(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.a8("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=$("button","mapboxgl-ctrl-geolocate",this._container),$("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){a.X("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=$("div","mapboxgl-user-location"),this._dotElement.appendChild($("div","mapboxgl-user-location-dot")),this._dotElement.appendChild($("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Qn({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=$("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.a8("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.X("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.a8("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.a8("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.a8("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:vm,ScaleControl:class{constructor(m){this.options=a.ak({},Hc,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aR(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,l=this._map,h=l._containerHeight/2,_=l._containerWidth/2-m/2,x=l.unproject([_,h]),S=l.unproject([_+m,h]),C=x.distanceTo(S);if(this.options.unit==="imperial"){const A=3.2808*C;A>5280?this._setScale(m,A/5280,"mile"):this._setScale(m,A,"foot")}else this.options.unit==="nautical"?this._setScale(m,C/1852,"nautical-mile"):C>=1e3?this._setScale(m,C/1e3,"kilometer"):this._setScale(m,C,"meter")}_setScale(m,l,h){this._map._requestDomTask(()=>{const _=function(S){const C=Math.pow(10,`${Math.floor(S)}`.length-1);let A=S/C;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(z){const O=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*O)/O}(A),C*A}(l),x=_/l;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(_):`${_}&nbsp;${Yd[h]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=$("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:a.X("Full screen control 'container' must be a DOM element.")),a.aR(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=$("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.X("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=$("button","mapboxgl-ctrl-fullscreen",this._controlContainer);$("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.a6{constructor(m){super(),this.options=a.ak(Object.create(Kb),m),a.aR(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new a.a8("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new a.a8("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=a.L.convert(m),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const l=document.createDocumentFragment(),h=document.createElement("body");let _;for(h.innerHTML=m;_=h.firstChild,_;)l.appendChild(_);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=$("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){const h=this._closeButton=$("button","mapboxgl-popup-close-button",l);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const l=this._map,h=this._container,_=this._pos;if(!l||!h||!_)return"bottom";const x=h.offsetWidth,S=h.offsetHeight,C=_.x<x/2,A=_.x>l.transform.width-x/2;if(_.y+m<S)return C?"top-left":A?"top-right":"top";if(_.y>l.transform.height-S){if(C)return"bottom-left";if(A)return"bottom-right"}return C?"left":A?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){const l=this._map,h=this._content;if(!l||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=$("div","mapboxgl-popup",l.getContainer()),this._tip=$("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=wm(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){const x=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),S=Sm(this.options.offset),C=this._anchor=this._getAnchor(S.y),A=Sm(this.options.offset,C),z=x.add(A).round();l._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${Xd[C]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&l._showingGlobe()){const x=a.cN(l.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Xy);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Qn,Style:qo,LngLat:a.L,LngLatBounds:a.D,Point:a.P,MercatorCoordinate:a.M,FreeCameraOptions:kn,Evented:a.a6,config:a.cM,prewarm:a.d3,clearPrewarmedResources:a.d4,get accessToken(){return a.cM.ACCESS_TOKEN},set accessToken(m){a.cM.ACCESS_TOKEN=m},get baseApiUrl(){return a.cM.API_URL},set baseApiUrl(m){a.cM.API_URL=m},get workerCount(){return a.d5.workerCount},set workerCount(m){a.d5.workerCount=m},get maxParallelImageRequests(){return a.cM.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){a.cM.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){a.d6(m)},get workerUrl(){return a.d7.workerUrl},set workerUrl(m){a.d7.workerUrl=m},get workerClass(){return a.d7.workerClass},set workerClass(m){a.d7.workerClass=m},get workerParams(){return a.d7.workerParams},set workerParams(m){a.d7.workerParams=m},get dracoUrl(){return a.d8()},set dracoUrl(m){a.d9(m)},setNow:a.a4.setNow,restoreNow:a.a4.restoreNow}});var E=y;return E})})(C8);var hpe=C8.exports;const cE=P1(hpe),dpe=({selectedDay:e,selectedMetric:n,isMobileScreen:o})=>{const[c,p]=re.useState(null),[y,w]=re.useState(null);return re.useEffect(()=>{cE.accessToken="pk.eyJ1Ijoia3ByaWp1biIsImEiOiJjajd4OHVweTYzb2l1MndvMzlvdm90c2ltIn0.J25C2fbC1KpcqIRglAh4sA";const E=new cE.Map({container:"map-container",style:"mapbox://styles/kprijun/clsns5ahr006g01pkfe183e2m",center:[18.0686,59.3293],zoom:13,minZoom:10.2});return E.addControl(new cE.NavigationControl,"top-right"),p(E),()=>{E.remove()}},[]),re.useEffect(()=>{if(c&&e&&n){const E=`./raster-image/${n}_daily/${n}_${e}.png`;c.loadImage(E,(a,P)=>{if(a){console.error("Failed to load image:",a);return}c.getSource("overlay")&&(c.removeLayer("overlay"),c.removeSource("overlay"),c.removeImage("overlay")),c.addImage("overlay",P),c.addSource("overlay",{type:"image",url:E,coordinates:[[17.732179,59.522258],[18.348042,59.522258],[18.348042,59.208266],[17.732179,59.208266]]}),c.addLayer({id:"overlay",type:"raster",source:"overlay",paint:{"raster-opacity":.75}})})}},[c,e,n,y]),Q.jsxs("div",{id:"isopleth-map-container",children:[Q.jsx("div",{id:"map-container"}),Q.jsx("div",{children:o&&Q.jsx(jj,{})})]})},fpe=({onDateChange:e})=>{const[n,o]=re.useState("d01"),c=p=>{o(p),e(p)};return Q.jsxs("div",{children:[Q.jsx("button",{className:`button ${n==="d01"?"active":""}`,onClick:()=>c("d01"),children:"March 12"}),Q.jsx("button",{className:`button ${n==="d02"?"active":""}`,onClick:()=>c("d02"),children:"March 13"}),Q.jsx("button",{className:`button ${n==="d03"?"active":""}`,onClick:()=>c("d03"),children:"March 14"})]})},ppe={data:{NitrogenDioxide:{name:"Nitrogen Dioxide",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:.654},{time:"d02",value:.2428},{time:"d03",value:.5106}]},Ozone:{name:"Ozone",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:1.8184},{time:"d02",value:1.7963},{time:"d03",value:2.104}]},PM10:{name:"PM10",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:2.736},{time:"d02",value:2.9577},{time:"d03",value:3.1486}]},BirchPollen:{name:"Birch Pollen",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:0},{time:"d02",value:0},{time:"d03",value:0}]},RiskIndexWithoutBirchPollen:{name:"Risk Index without Birch Pollen",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:5.2085},{time:"d02",value:4.9967},{time:"d03",value:5.7631}]},RiskIndexWithBirchPollen:{name:"Risk Index with Birch Pollen",forecast_timestamp:"2024-03-07",values:[{time:"d01",value:5.2085},{time:"d02",value:4.9967},{time:"d03",value:5.7631}]}}},mpe=()=>{const e=re.useRef(),[n,o]=re.useState("NitrogenDioxide"),c={d01:"Day 1",d02:"Day 2",d03:"Day 3"};re.useEffect(()=>{P(n)},[n]);const p={top:30,right:30,bottom:70,left:60},y=420-p.left-p.right,w=300-p.top-p.bottom,E=bk().range([0,y]).padding(.1),a=wk().range([w,0]),P=L=>{const F=ppe.data[L].values.map(({time:q,value:le})=>({time:q,value:le}));E.domain(F.map(q=>q.time)),a.domain([0,$j(F,q=>+q.value)]);const H=Da("#chart").html("").append("g").attr("transform",`translate(${p.left},${p.top})`);H.append("g").attr("transform",`translate(0,${w})`).call(Gj(E).tickValues(F.map(q=>q.time)).tickFormat((q,le)=>["March 12","March 13","March 14"][le])),H.append("g").call(bce(a)),H.append("path").datum(F).attr("fill","none").attr("stroke","#0067b5").attr("stroke-width",2).attr("d",Qfe().x(({time:q})=>E(q)+E.bandwidth()/2).y(({value:q})=>a(q))),H.append("div").attr("class","tooltip").style("opacity",0),H.selectAll("circle").data(F).join("circle").attr("cx",({time:q})=>E(q)+E.bandwidth()/2).attr("cy",({value:q})=>a(q)).attr("r",10).attr("fill","#0067b5").on("mouseover",(q,le)=>{const ie=e.current;ie.style.visibility="visible",ie.innerHTML=`${c[le.time]}<br/>Value: ${le.value}`,ie.style.left=`${q.pageX+5}px`,ie.style.top=`${q.pageY+5}px`,Da(q.currentTarget).attr("r",12).attr("fill","orange")}).on("mouseout",function(){const q=e.current;q.style.visibility="hidden",Da(this).transition().duration(200).attr("r",10).attr("fill","#0067b5")})},D=L=>{o(L.target.value)};return Q.jsxs(El,{direction:"column",align:"flex-start",children:[Q.jsx(Cn,{mt:4,mb:2,children:Q.jsxs(ck,{fontSize:"sm",borderRadius:"none",border:"none",borderBottom:"1px",value:n,onChange:D,children:[Q.jsx("option",{value:"NitrogenDioxide",children:"Nitrogen Dioxide (NO2)"}),Q.jsx("option",{value:"PM10",children:"Particle - PM10"}),Q.jsx("option",{value:"Ozone",children:"Ozone(O3)"}),Q.jsx("option",{value:"BirchPollen",children:"Pollen"}),Q.jsx("option",{value:"RiskIndexWithoutBirchPollen",children:"AQHI"}),Q.jsx("option",{value:"RiskIndexWithBirchPollen",children:"AQI"})]})}),Q.jsx("svg",{id:"chart",width:y+p.left+p.right,height:w+p.top+p.bottom}),Q.jsx("div",{ref:e,style:{position:"absolute",visibility:"hidden",background:"white",border:"1px solid",padding:"5px"},children:"Tooltip"})]})};var gpe=jie({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const A8=({onSelectAqi:e,variant:n})=>{const[o,c]=re.useState([]),[p,y]=re.useState(null),[w,E]=re.useState(""),a=re.useRef(null);re.useEffect(()=>{fetch("https://api.waqi.info/search/?keyword=stockholm&token=a3bf1197881754e07fb1a334116289ffb6104296").then($=>$.json()).then($=>{console.log("Fetched Data:",$),c($.data),y($.data)}).catch($=>console.log($));const F=$=>{a.current&&!a.current.contains($.target)&&c([])};return document.addEventListener("mousedown",F),()=>{document.removeEventListener("mousedown",F)}},[]);const P=F=>{if(E(F),p){const $=p.filter(H=>H.station.name.toLowerCase().includes(F.toLowerCase()));c($),F===""&&c([])}},D=(F,$)=>{e({aqi:F,name:$}),c([]),E($)},L=F=>{const $=["stockholm","sweden",",","108","59","70","E4","107","E20","83"],H=new RegExp($.join("|"),"gi");return F.replace(H,"")};return Q.jsxs("div",{className:`input-wrapper ${n}`,children:[Q.jsxs(fj,{children:[Q.jsx(lk,{type:"text",placeholder:"Search Location...",value:L(w),onChange:F=>P(F.target.value)}),Q.jsx(ak,{width:"4.5rem",children:Q.jsx(gpe,{})})]}),Q.jsx("div",{className:"search-results",ref:a,children:Array.isArray(o)&&o.map((F,$)=>Q.jsx("div",{onClick:()=>D(F.aqi,F.station.name),children:L(F.station.name)},$))})]})},_pe=()=>{const{isOpen:e,onOpen:n,onClose:o}=Lae(),[c,p]=re.useState(null),[y,w]=re.useState(null),[E,a]=re.useState(null),[P,D]=re.useState(null);re.useState("aqi"),re.useState("d01"),re.useState(null),re.useEffect(()=>{fetch("https://api.waqi.info/feed/here/?token=a3bf1197881754e07fb1a334116289ffb6104296").then($=>$.json()).then($=>{if($.status==="ok"){p($.data.aqi);const H=$.data.city.name.split(" ");w(H.slice(0,4).join(" "));const{text:q,color:le}=L($.data.aqi);a(q),D(le)}else console.error("Error fetching data:",$.message)}).catch($=>{console.error("Error fetching data:",$)})},[]);const L=$=>$>=0&&$<=50?{text:"Good",color:"#C0E49A"}:$<=100?{text:"Moderate",color:"#fdd64b"}:$<=150?{text:"Unhealthy for Sensitive Groups",color:"#f99049"}:$<=200?{text:"Unhealthy",color:"#f65e5f"}:$<=300?{text:"Very Unhealthy",color:"#a070b6"}:{text:"Hazardous",color:"#a06a7b"},F=({aqi:$,name:H})=>{p($),w(H)};return Q.jsxs("div",{className:"container",children:[Q.jsx("div",{className:"toggle-bar",children:Q.jsx(io,{ml:"0px",color:"#0183fd",fontSize:"sm",textDecoration:"underline",className:"toggle-btn",onClick:n,children:"Compare Place"})}),Q.jsxs(wj,{isOpen:e,onClose:o,isCentered:!0,size:"xl",children:[Q.jsx(Ij,{}),Q.jsxs(kj,{pb:4,children:[Q.jsx(Pj,{children:"Compare Places"}),Q.jsx(Rj,{}),Q.jsxs(zj,{children:[Q.jsx(A8,{onSelectAqi:F,variant:"page2"}),Q.jsx("div",{className:"heading-container",style:{backgroundColor:P},children:Q.jsxs("div",{className:"cp-heading-container",children:[Q.jsx("div",{className:"cp-aqi-text",children:E}),Q.jsxs("div",{className:"cp-header-aqi-value",children:[Q.jsx(so,{className:"cp-search-header",as:"h3",size:"md",children:y||"Loading..."}),Q.jsxs("div",{className:"cp-aqi-value-container",children:[Q.jsx("div",{className:"cp-aqi-value",children:c||"..."}),Q.jsx(io,{fontSize:"xs",color:"#495e1b",children:"AQI Value"})]})]})]})})]})]})]})]})},ype=[{hour:1,value:.2051},{hour:2,value:.1669},{hour:3,value:.1462},{hour:4,value:.1429},{hour:5,value:.1366},{hour:6,value:.1163},{hour:7,value:.128},{hour:8,value:.1884},{hour:9,value:.1583},{hour:10,value:.1478},{hour:11,value:.1544},{hour:12,value:.1555},{hour:13,value:.1508},{hour:14,value:.1639},{hour:15,value:.1757},{hour:16,value:.1807},{hour:17,value:.1911},{hour:18,value:.2012},{hour:19,value:.2022},{hour:20,value:.1981},{hour:21,value:.1833},{hour:22,value:.1882},{hour:23,value:.2299},{hour:24,value:.2485},{hour:25,value:.2917},{hour:26,value:.3013},{hour:27,value:.3219},{hour:28,value:.2971},{hour:29,value:.3146},{hour:30,value:.2825},{hour:31,value:.251},{hour:32,value:.2476},{hour:33,value:.2591},{hour:34,value:.2857},{hour:35,value:.3276},{hour:36,value:.3101},{hour:37,value:.2987},{hour:38,value:.6136},{hour:39,value:.2989},{hour:40,value:.2903},{hour:41,value:.3323},{hour:42,value:.3259},{hour:43,value:.3116},{hour:44,value:.282},{hour:45,value:.2892},{hour:46,value:.3439},{hour:47,value:.3512},{hour:48,value:.3123},{hour:49,value:.3096},{hour:50,value:.3411},{hour:51,value:.3099},{hour:52,value:.2741},{hour:53,value:.2553},{hour:54,value:.2366},{hour:55,value:.254},{hour:56,value:.265},{hour:57,value:.2728},{hour:58,value:.306},{hour:59,value:.3175},{hour:60,value:.3334},{hour:61,value:.3715},{hour:62,value:.38},{hour:63,value:.3861},{hour:64,value:.4003},{hour:65,value:.4046},{hour:66,value:.412},{hour:67,value:.3647},{hour:68,value:.3543},{hour:69,value:.3415},{hour:70,value:.2555},{hour:71,value:.215},{hour:72,value:.1965}],vpe=[{hour:1,value:1.3338},{hour:2,value:1.4963},{hour:3,value:1.8569},{hour:4,value:1.9031},{hour:5,value:2.0917},{hour:6,value:2.1483},{hour:7,value:2.2088},{hour:8,value:2.1942},{hour:9,value:2.0874},{hour:10,value:2.0398},{hour:11,value:2.0134},{hour:12,value:2.2673},{hour:13,value:2.4466},{hour:14,value:2.5729},{hour:15,value:2.5575},{hour:16,value:2.6706},{hour:17,value:2.5597},{hour:18,value:2.2561},{hour:19,value:2.3819},{hour:20,value:2.4042},{hour:21,value:2.1938},{hour:22,value:2.148},{hour:23,value:2.196},{hour:24,value:2.1953},{hour:25,value:2.2124},{hour:26,value:2.2097},{hour:27,value:2.4754},{hour:28,value:2.4878},{hour:29,value:2.364},{hour:30,value:2.3146},{hour:31,value:2.3021},{hour:32,value:2.3183},{hour:33,value:2.2683},{hour:34,value:2.2385},{hour:35,value:2.372},{hour:36,value:2.343},{hour:37,value:2.3052},{hour:38,value:2.313},{hour:39,value:2.2956},{hour:40,value:2.2954},{hour:41,value:2.3002},{hour:42,value:2.3189},{hour:43,value:2.3557},{hour:44,value:2.3822},{hour:45,value:2.4681},{hour:46,value:2.6171},{hour:47,value:2.6687},{hour:48,value:2.7927},{hour:49,value:2.8805},{hour:50,value:2.9245},{hour:51,value:3.0205},{hour:52,value:3.1911},{hour:53,value:3.2812},{hour:54,value:3.3042},{hour:55,value:3.2647},{hour:56,value:3.241},{hour:57,value:3.2554},{hour:58,value:3.2457},{hour:59,value:3.3187},{hour:60,value:3.3982},{hour:61,value:3.4606},{hour:62,value:3.5006},{hour:63,value:3.5519},{hour:64,value:3.5902},{hour:65,value:3.6224},{hour:66,value:3.6327},{hour:67,value:3.6426},{hour:68,value:3.6471},{hour:69,value:3.6541},{hour:70,value:3.6734},{hour:71,value:3.6897},{hour:72,value:3.7102}],xpe=[{hour:1,value:1.686},{hour:2,value:1.5896},{hour:3,value:1.5777},{hour:4,value:1.5982},{hour:5,value:1.6138},{hour:6,value:1.6255},{hour:7,value:1.652},{hour:8,value:1.7628},{hour:9,value:1.7809},{hour:10,value:1.853},{hour:11,value:1.9079},{hour:12,value:1.9763},{hour:13,value:2.0193},{hour:14,value:2.0963},{hour:15,value:2.1324},{hour:16,value:2.009},{hour:17,value:1.9705},{hour:18,value:1.9784},{hour:19,value:1.9959},{hour:20,value:1.9607},{hour:21,value:1.9643},{hour:22,value:1.9634},{hour:23,value:1.9501},{hour:24,value:1.9245},{hour:25,value:1.8652},{hour:26,value:1.8538},{hour:27,value:1.8791},{hour:28,value:1.9276},{hour:29,value:2.1208},{hour:30,value:2.1425},{hour:31,value:2.235},{hour:32,value:2.2257},{hour:33,value:2.2777},{hour:34,value:2.2093},{hour:35,value:2.061},{hour:36,value:2.0043},{hour:37,value:2.0137},{hour:38,value:2.1276},{hour:39,value:2.1911},{hour:40,value:2.1727},{hour:41,value:2.1812},{hour:42,value:2.2553},{hour:43,value:2.2997},{hour:44,value:2.298},{hour:45,value:2.2729},{hour:46,value:2.2934},{hour:47,value:2.2278},{hour:48,value:2.0853},{hour:49,value:2.0154},{hour:50,value:1.9497},{hour:51,value:1.9167},{hour:52,value:1.9161},{hour:53,value:2.1623},{hour:54,value:2.0524},{hour:55,value:2.1732},{hour:56,value:2.2418},{hour:57,value:2.2362},{hour:58,value:2.317},{hour:59,value:2.419},{hour:60,value:2.3841},{hour:61,value:2.3832},{hour:62,value:2.3016},{hour:63,value:2.3246},{hour:64,value:2.3294},{hour:65,value:2.4074},{hour:66,value:2.297},{hour:67,value:2.3034},{hour:68,value:2.3452},{hour:69,value:2.2888},{hour:70,value:2.3157},{hour:71,value:2.3337},{hour:72,value:2.2758}],bpe=[{hour:1,value:.2722},{hour:2,value:.3031},{hour:3,value:.3138},{hour:4,value:.3369},{hour:5,value:.3729},{hour:6,value:.4143},{hour:7,value:.439},{hour:8,value:.4181},{hour:9,value:.371},{hour:10,value:.3299},{hour:11,value:.3068},{hour:12,value:.3025},{hour:13,value:.2999},{hour:14,value:.3192},{hour:15,value:.3656},{hour:16,value:.4381},{hour:17,value:.5268},{hour:18,value:.8539},{hour:19,value:1.895},{hour:20,value:1.1234},{hour:21,value:.8618},{hour:22,value:.9988},{hour:23,value:1.1393},{hour:24,value:1.2316},{hour:25,value:1.5318},{hour:26,value:1.6942},{hour:27,value:1.8478},{hour:28,value:1.3004},{hour:29,value:.7662},{hour:30,value:.4983},{hour:31,value:.3795},{hour:32,value:.4048},{hour:33,value:.3819},{hour:34,value:.331},{hour:35,value:.2822},{hour:36,value:.267},{hour:37,value:.2347},{hour:38,value:.2253},{hour:39,value:.2244},{hour:40,value:.2425},{hour:41,value:.3102},{hour:42,value:.3242},{hour:43,value:.2906},{hour:44,value:.2514},{hour:45,value:.2091},{hour:46,value:.1912},{hour:47,value:.1966},{hour:48,value:.2075},{hour:49,value:.2173},{hour:50,value:.2218},{hour:51,value:.2183},{hour:52,value:.2222},{hour:53,value:.1977},{hour:54,value:.2128},{hour:55,value:.2361},{hour:56,value:.2346},{hour:57,value:.193},{hour:58,value:.169},{hour:59,value:.1553},{hour:60,value:.141},{hour:61,value:.132},{hour:62,value:.1307},{hour:63,value:.1368},{hour:64,value:.1532},{hour:65,value:.1718},{hour:66,value:.1739},{hour:67,value:.1656},{hour:68,value:.1498},{hour:69,value:.1551},{hour:70,value:.1581},{hour:71,value:.1521},{hour:72,value:.1377}],wpe=[{hour:1,value:3.225},{hour:2,value:3.2528},{hour:3,value:3.5808},{hour:4,value:3.6442},{hour:5,value:3.8421},{hour:6,value:3.8901},{hour:7,value:3.9887},{hour:8,value:4.1454},{hour:9,value:4.0267},{hour:10,value:4.0406},{hour:11,value:4.0757},{hour:12,value:4.3991},{hour:13,value:4.6168},{hour:14,value:4.8331},{hour:15,value:4.8656},{hour:16,value:4.8603},{hour:17,value:4.7212},{hour:18,value:4.4356},{hour:19,value:4.58},{hour:20,value:4.5631},{hour:21,value:4.3414},{hour:22,value:4.2996},{hour:23,value:4.376},{hour:24,value:4.3683},{hour:25,value:4.3694},{hour:26,value:4.3648},{hour:27,value:4.6765},{hour:28,value:4.7125},{hour:29,value:4.7994},{hour:30,value:4.7396},{hour:31,value:4.788},{hour:32,value:4.7916},{hour:33,value:4.8052},{hour:34,value:4.7335},{hour:35,value:4.7606},{hour:36,value:4.7609},{hour:37,value:4.8301},{hour:38,value:6.6993},{hour:39,value:4.9556},{hour:40,value:4.8758},{hour:41,value:4.9378},{hour:42,value:4.9973},{hour:43,value:5.0384},{hour:44,value:5.0299},{hour:45,value:4.9084},{hour:46,value:4.6039},{hour:47,value:4.7723},{hour:48,value:4.6691},{hour:49,value:4.4751},{hour:50,value:4.489},{hour:51,value:4.5257},{hour:52,value:4.279},{hour:53,value:4.5615},{hour:54,value:4.6159},{hour:55,value:4.7881},{hour:56,value:4.8334},{hour:57,value:4.8018},{hour:58,value:4.8834},{hour:59,value:5.0332},{hour:60,value:5.2639},{hour:61,value:5.5929},{hour:62,value:5.6254},{hour:63,value:5.7431},{hour:64,value:5.9039},{hour:65,value:6.0077},{hour:66,value:5.855},{hour:67,value:5.6672},{hour:68,value:5.4659},{hour:69,value:5.1791},{hour:70,value:4.8181},{hour:71,value:4.6716},{hour:72,value:4.4971}],Spe=[{hour:1,value:0},{hour:2,value:0},{hour:3,value:0},{hour:4,value:0},{hour:5,value:0},{hour:6,value:0},{hour:7,value:0},{hour:8,value:0},{hour:9,value:0},{hour:10,value:0},{hour:11,value:0},{hour:12,value:0},{hour:13,value:0},{hour:14,value:0},{hour:15,value:0},{hour:16,value:0},{hour:17,value:0},{hour:18,value:0},{hour:19,value:0},{hour:20,value:0},{hour:21,value:0},{hour:22,value:0},{hour:23,value:0},{hour:24,value:0},{hour:25,value:0},{hour:26,value:0},{hour:27,value:0},{hour:28,value:0},{hour:29,value:0},{hour:30,value:0},{hour:31,value:0},{hour:32,value:0},{hour:33,value:0},{hour:34,value:0},{hour:35,value:0},{hour:36,value:0},{hour:37,value:0},{hour:38,value:0},{hour:39,value:0},{hour:40,value:0},{hour:41,value:0},{hour:42,value:0},{hour:43,value:0},{hour:44,value:0},{hour:45,value:0},{hour:46,value:0},{hour:47,value:0},{hour:48,value:0},{hour:49,value:0},{hour:50,value:0},{hour:51,value:0},{hour:52,value:0},{hour:53,value:0},{hour:54,value:0},{hour:55,value:0},{hour:56,value:0},{hour:57,value:0},{hour:58,value:0},{hour:59,value:0},{hour:60,value:0},{hour:61,value:0},{hour:62,value:0},{hour:63,value:0},{hour:64,value:0},{hour:65,value:0},{hour:66,value:0},{hour:67,value:0},{hour:68,value:0},{hour:69,value:0},{hour:70,value:0},{hour:71,value:0},{hour:72,value:0}],kL={no2:ype,pm10:vpe,ozone:xpe,aqhi:bpe,aqhich:wpe,birch:Spe},Tpe=()=>{const e=re.useRef(null),n=re.useRef(null),[o,c]=re.useState("no2");re.useEffect(()=>{if(!kL[o])return;const y={top:10,right:30,bottom:30,left:30},w=400-y.left-y.right,E=200-y.top-y.bottom,a=6,P=12,D=E/a,L=w/P,F=kL[o].map(se=>se.value);Da(e.current).selectAll("*").remove();const $=Da(e.current).attr("width",w+y.left+y.right).attr("height",E+y.top+y.bottom).append("g").attr("transform",`translate(${y.left},${y.top})`),H=wk().domain([fce(F),$j(F)]).range(["#C0E49A","#FD8C3C"]),q=Array.from({length:12},(se,be)=>be+0),le=Bfe().domain(q).range([0,w]),ie=Gj(le);$.append("g").attr("transform",`translate(0, ${E})`).call(ie);const te=["AM","PM","AM","PM","AM","PM"];$.selectAll(".periodLabel").data(te).enter().append("text").text(se=>se).attr("x",-10).attr("y",(se,be)=>be*D+D/2+5).attr("text-anchor","end").attr("alignment-baseline","middle").attr("font-size","10px"),$.selectAll("rect").data(F).enter().append("rect").attr("x",(se,be)=>be%P*L).attr("y",(se,be)=>Math.floor(be/P)*D).attr("width",L).attr("height",D).attr("fill",se=>H(se)).on("mouseover",(se,be)=>{Da(n.current).style("visibility","visible").text(`Value: ${be}`)}).on("mousemove",se=>{Da(n.current).style("top",se.pageY-100+"px").style("left",se.pageX-50+"px")}).on("mouseout",()=>{Da(n.current).style("visibility","hidden")})},[o]);const p=y=>{c(y.target.value)};return Q.jsxs(El,{mt:"4",flexDirection:"column",alignItems:"flex-start",children:[Q.jsx(Cn,{mt:4,mb:2,children:Q.jsxs(ck,{onChange:p,value:o,children:[Q.jsx("option",{value:"no2",children:"Nitrogen Dioxide (NO2)"}),Q.jsx("option",{value:"pm10",children:"Particle - PM10"}),Q.jsx("option",{value:"ozone",children:"Ozone (O3)"}),Q.jsx("option",{value:"birch",children:"Pollen"}),Q.jsx("option",{value:"aqhich",children:"AQHICH"}),Q.jsx("option",{value:"aqhi",children:"AQHI"})]})}),Q.jsx("div",{ref:n,style:{position:"absolute",visibility:"hidden",background:"white",border:"1px solid",padding:"5px"},children:"Tooltip"}),Q.jsx("svg",{ref:e})]})},Epe=({onDayChange:e})=>{const[n,o]=re.useState(null),[c,p]=re.useState(null),[y,w]=re.useState(null),[E,a]=re.useState(null),[P,D]=re.useState("aqi"),[L,F]=re.useState("d01");re.useState(null),re.useEffect(()=>{fetch("https://api.waqi.info/feed/stockholm/?token=a3bf1197881754e07fb1a334116289ffb6104296").then(le=>le.json()).then(le=>{if(le.status==="ok"){o(le.data.aqi);const ie=le.data.city.name.split(" ");p(ie.slice(0,4).join(" "));const{text:te,color:se}=$(le.data.aqi);w(te),a(se)}else console.error("Error fetching data:",le.message)}).catch(le=>{console.error("Error fetching data:",le)})},[]);const $=le=>le>=0&&le<=50?{text:"Good",color:"#C0E49A"}:le<=100?{text:"Moderate",color:"#FFFFB5"}:le<=150?{text:"Unhealthy for Sensitive Groups",color:"#f99049"}:le<=200?{text:"Unhealthy",color:"#f65e5f"}:le<=300?{text:"Very Unhealthy",color:"#a070b6"}:{text:"Hazardous",color:"#a06a7b"},H=(le,ie)=>{console.log("Updating day and metric:",{date:le,metric:ie}),F(le),D(ie),e({day:le,metric:ie})},q=({aqi:le,name:ie})=>{o(le),p(ie)};return Q.jsxs("div",{className:"sidebar-container",children:[Q.jsx(A8,{variant:"page1",onSelectAqi:q}),Q.jsxs("div",{className:"heading-container",style:{backgroundColor:E},children:[Q.jsxs("div",{className:"header-aqi-value",children:[Q.jsxs(so,{className:"search-header",as:"h3",size:"md",mb:"4",children:[c||"Loading...",Q.jsx(_pe,{})]}),Q.jsxs("div",{className:"aqi-value-container",children:[Q.jsx("div",{className:"aqi-value",children:n||"..."}),Q.jsx(io,{fontSize:"xs",color:"#495e1b",children:"AQI Value"})]})]}),Q.jsx("div",{className:"aqi-text",children:y})]}),Q.jsxs("div",{className:"filter-section",children:[Q.jsx(so,{as:"h3",fontSize:"md",mb:"4",children:"Select Pollutant Particles and Day"}),Q.jsx(Cn,{mr:"2",mb:"4",children:Q.jsx(Lj,{value:P,onChange:le=>H(L,le),children:Q.jsxs(Sb,{spacing:[1,8],direction:["column","row"],children:[Q.jsx(Lg,{value:"aqi",children:"AQI"}),Q.jsx(Lg,{value:"pm10",children:"PM10"}),Q.jsx(Lg,{value:"nox",children:"NoX"}),Q.jsx(Lg,{value:"pollen",children:"Pollen"})]})})}),Q.jsx(Cn,{children:Q.jsx(fpe,{onDateChange:le=>H(le,P)})})]}),Q.jsxs(bb,{bg:"gray.100",allowMultiple:!0,children:[Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"Daily Forecast"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:Q.jsx(mpe,{})})]}),Q.jsxs(na,{children:[Q.jsx("h2",{children:Q.jsxs(ta,{_expanded:{bg:"#3182CE",color:"white"},children:[Q.jsx(Cn,{as:"span",flex:"1",textAlign:"left",children:"72 Hour Forecast"}),Q.jsx(ra,{})]})}),Q.jsx(ia,{pb:4,children:Q.jsx(Tpe,{})})]})]})]})},Cpe=()=>{const[e,n]=re.useState(null),[o,c]=re.useState(!1),[p,y]=re.useState("d01"),[w,E]=re.useState({aqiValue:null,aqiText:null,cityName:null});re.useEffect(()=>{const F=()=>{c(window.innerWidth>=768)};return F(),window.addEventListener("resize",F),()=>{window.removeEventListener("resize",F)}},[]);const[a,P]=re.useState("aqi"),D=({day:F,metric:$})=>{y(F),P($)},L=F=>{y(F)};return Q.jsx(PW,{children:Q.jsxs("div",{className:"App",children:[Q.jsx(Qle,{isMobileScreen:o}),Q.jsxs(SW,{children:[Q.jsx(Qv,{path:"/home",element:Q.jsxs("div",{className:"container",children:[Q.jsx("div",{className:"left-container",children:Q.jsx(dpe,{isMobileScreen:o,selectedDay:p,selectedMetric:a,onDayChange:L})}),Q.jsx("div",{className:"right-container",children:Q.jsx(Epe,{onDayChange:D,aqiData:w,selectedAqi:e})})]})}),Q.jsx(Qv,{path:"/about-air-pollution",element:Q.jsx(spe,{})}),Q.jsx(Qv,{path:"/about-us",element:Q.jsx(upe,{})})]})]})})};UB(document.getElementById("root")).render(Q.jsx(re.StrictMode,{children:Q.jsx(noe,{children:Q.jsx(Cpe,{})})}));
